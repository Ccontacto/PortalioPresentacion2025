Omitir e ir al contenido
Tú dijiste:
Producing a concise DSL prompt for the user
The user wants a direct, agnostic DSL prompt for LLM instructions — efficient, minimal, ready to execute. I'll craft a structure with sections, commands, constraints, tokens, schema, and more, ensuring it’s semantic and execution-level. No clarifying questions needed, I’ll deliver the prompt directly.

Creating a DSL prompt in Spanish with a playful tone
It's clear I need to create a precise, direct execution-ready DSL prompt in Spanish. No fluff, but it should maintain a friendly tone. I'll outline the prompt with key sections like "INPUTS", "TASKS", "CONSTRAINTS", and "DELIVERABLES". The final response will be concise, copy-paste ready, while ensuring clarity and accessibility, with mapping support for i18n.

Crafting a precise prompt with clear guidelines
Got it! I’ll produce the prompt based on the user’s request. It will include determinism, atomic mapping, accessibility, SEO guidelines, flow enumerations, data contracts, and performance considerations like PWA. The structure will ensure clarity—providing clear "state diagrams," "prioritized actions," and organized for optimized workflow, sticking to final output without internal reasoning.

Creating a clean and effective DSL prompt
For this request, I’ll use Roman numerals, Greek letters for variables, and algebraic-like sets for clarity. The DSL prompt will be minimal but precise, without unnecessary prose. I'll format it with clear instructions, placeholders, and symbols like ∑, ⇒, and ⊕. There won’t be references to previous examples unless directly relevant.

The user wants to research current trends in prompt engineering and contextual prompts, including emerging trends applicable today, by consulting multiple sources, to help generate the best possible system.

Considering resources and structure for searching framing
Okay, I’ll search for things related to prompt engineering trends and different advanced techniques like chain of thought caution, structured prompting, and multi-agent prompts. I don’t really need a navlist, since it’s more like research articles or blog posts. A simple table or checklist might be helpful instead.

Aligning with prompting trends and techniques
I need to make sure everything aligns with OpenAI’s policy, especially about discussing chain-of-thought details. We can still mention concepts like DSPy and updates to prompting methods, along with tools like "Guidance," "PromptFlow," and "LangChain Expression." Trends include function-calling, JSON output, and self-reflective decoding.

Searching trends in prompt engineering and context prompting
Gathering reliable resources for citations
I’ll focus on gathering solid resources for citations, like Lakera 2025 guide, Vellum blog, and PromptingGuide. I’ll use known outlets like Reuters and El País, while avoiding too many posts from unknown authors. I'll pull specific pieces on advanced in-context learning and trending techniques for 2024-2025.

The user wants a final, comprehensive response that provides the best possible analysis and synthesis of all the previous content and instructions shared throughout the conversation.

Searching for resources on advanced prompting techniques
Consolidating tech trends and sources
Alright, I’ve narrowed down key areas: structured outputs & schema-driven prompting, dynamic context selection, RAG advancements, auto-prompting, and prompt libraries. I'll cite reputable sources like OpenAI blog, Vellum, Microsoft, and Anthropic docs, focusing on trends like JSON prompting, RAG 2025, and AI agent context engineering.

Summarizing prompt strategies and enterprise adoption
I’ll create an actionable bullet list focusing on strategies for things like structured outputs, context planning, prompt caching, and function calling. I'll also include enterprise adoption with articles from sources like El País and Reuters. Evaluation frameworks like “Promptfoo” should be mentioned for prompt testing and A/B testing best practices.

Consolidating AI trends in prompting and evaluation
Exploring multi-agent systems and frameworks
I think it’s important to get some solid info on multi-agent prompt systems like AutoGen, including agent workflows and frameworks. I'll include references to sources like Data Nucleus for agentic workflows, and Microsoft's AutoGen 2025, along with the potential upcoming "OpenAI AgentKit" from DevDay 2025, to round it all out.

Searching for multi-agent systems and agent frameworks
Delivering research summary and actionable guidance
I’ve covered structured outputs, context engineering, agentic workflows, RAG advanced, etc. Now I need to translate this into actionable guidance in Spanish, as requested. I'll provide a concise research summary, plus immediate application steps for the user’s DSL. I’ll focus on top recommendations, dos/don’ts, and pitfalls.

Preparing trends summary and actionable guidance
For the trends in prompt engineering and context prompts, I'll focus on structured outputs, function calls, and context engineering. I'll provide concise bullet points with relevant sources for each trend, highlighting actionable recommendations. Each trend will have clear citations for reference, like OpenAI structured outputs, dynamic prompts, and context packers.

Exploring trends and providing actionable insights
For trends in JSON and structured prompting, I'll list top resources like "JSON prompting 2025" and "PromptingGuide.ai". I'll also include agentic workflows, multi-agent systems, and RAG. I'll outline best practices for hierarchical indexing, chunking, and test evaluation frameworks like "promptfoo" and "DeepEval".

Research on trends and applying them to DSL
I’m covering various trends like multimodal flows, auto-prompting, and structured outputs. For now, I’ll provide actionable insights: adding elements like SCHEMA with JSON, CONTEXT_PLAN steps, EVAL harness, and AGENTIC_FLAG for multi-agent features in a DSL patch. I'll also emphasize using

The user wants to transform the content into a direct text prompt in DSL format that is applicable for LLMs like the one used here.

Researching prompt engineering trends and DSL creation
I need to gather research on current trends in prompt and context engineering, using multiple sources. I'll summarize the findings and then create a Direct Specification Language (DSL) prompt for LLMs, in Spanish, with clear instructions, minimal fluff, and potential use of symbols or Roman numerals to structure the content.

Summarizing prompt engineering trends and final DSL output
I need to cite key claims like structured outputs, context engineering, agent workflows, and advanced indexing. These should be backed by sources. After summarizing, I’ll write a DSL code block with direct instructions, instructing the model not to reveal its thinking process. I’ll ensure this is structured and crisp for clarity.

Creating a minimal DSL for LLM tasks
The user's task is to create a DSL that incorporates UI/UX design principles, trends like structured outputs, context engineering, and agentic assistance, specifically for LLMs. I'll focus on a minimal DSL that guides token compilation, atomic components, accessibility (a11y), structured output JSON, context packer directives, and an evaluation plan. The result will be succinct and aligned with LLM tasks and trends.

Creating concise and direct deliverables
I need to provide a direct, no-frills response according to the user’s instructions. There will be two sections: "I. Hallazgos (trends) con citas" and "II. Prompt DSL Maestra vX". I'll include a UTF-8 header, specify LANG as es-MX, and format the output using markdown, JSON, and tables. Deliverables will include tokens JSON, screen contracts, flows, accessibility (a11y), SEO meta, PWA, and an evaluation plan, while avoiding unnecessary disclaimers or narrative.

Defining clear deliverables and incorporating key systems
The deliverables will include tokens JSON, screen contracts, flows, accessibility (a11y), SEO meta, PWA, and an evaluation plan. I'll reference structured outputs and incorporate a context engineering pipeline with filtering, ranking, and compression. We’ll add RAG best practices, agentic workflows (planner, researcher, checker, writer), and structured output validation using JSON Schema.

Balancing LLM configuration and citation placement
We need to be cautious as the LLM environment may not support multi-agent functionality. We can simulate roles sequentially but must avoid relying on external tools. For evaluation frameworks, we'll reference trending tools like "Promptfoo" and "HELM" and include an "EVAL_PLAN" in the DSL. Citations will go outside code blocks.

Ensuring diverse and trustworthy sources
We should prioritize citing trusted and diverse sources for our guide, including OpenAI's blog on structured outputs, Anthropic's docs on context engineering, and Microsoft’s materials on dynamic prompt middleware. We’ll keep citations focused on key concepts, aiming for 8-10 relevant and strong sources, and condense the research into clear bullet points.

Creating structured DSL
I need to create a DSL with concise sections. I'll use roman numerals for organization, focusing on META, INPUTS, GOALS, and OUTPUT_FORMATS. The user asked for brevity, so I'll keep it minimal. The DSL will include options for agentic workflows but will avoid unnecessary complexity. We’ll clarify a "HomePage" section as optional, with the necessary microcopy guidelines. Not all outputs need structured formatting in this environment, so markdown with code blocks will be fine instead of enforced structured outputs.

Crafting a research summary
I need to prepare a crisp research summary with bullet points. The title will be "Investigación: tendencias 2025 en prompt engineering y 'context prompts' (aplicable hoy)". I'll break it down into points like structural outputs, context engineering, RAG, agentic workflows, and eval frameworks. Citations will follow each point, and the focus will be on "best practice" trends. I'll keep it concise and clear, using JSON/structured outputs and context engineering insights. The goal is to establish a structured yet minimal presentation.

The user wants a complete end-to-end functional flow inferred for the Home screen and the entire page.

Summarizing prompt engineering trends and delivering DSL
The user's looking for trends in prompt engineering, especially as applied to context prompts and LLMs. They want a research summary with citations on this. I also need to provide a DSL prompt for LLMs, focusing on home-page and end-to-end functional UX/UI flows with structured output.

Summary of trends and crafting DSL for prompt engineering
I’ll create a research summary with 8-10 concise points, citing the most important sources. Citations will be outside any code blocks in the DSL. Also, I’ll include UX/UI concepts like SPA/PWA atomic design from earlier, shaping the DSL for home + end-to-end functional flows, focusing on the core aspects with minimal fluff.

Adhering to user's style preference while maintaining clarity
The user prefers directness with minimal narrative, so I’ll avoid long explanations and keep responses crisp. I won’t mention internal reasoning or calculations. Since I can’t ask clarifying questions, I’ll focus on inferring details carefully. Also, I’ll include the UTF-8 header where necessary.

Structuring the DSL for Home page flow
I’ll structure the DSL into key sections:

META

INPUT (placeholders)

FLAGS (output specifications)

OUTPUTS (tokens, homepage contracts, flows, etc.)

SCHEMAS (JSON schemas)

PIPELINE (context engineering steps)

RAG (retrieval toggles)

AGENTIC (optional multi-role pipeline)

EVAL (test scenarios, metrics)

PRIORITY (top improvements)

This will guide the DSL for generating home page and flow specs.

Clarifying DSL design and structure
The task is to focus on crafting an effective DSL in a minimalistic format. We'll specify environment toggles like STRUCTURED_OUTPUT=auto, CONTEXT_ENGINEERING=on, and include optional parameters like RAG and AGENTIC. Following that, I’ll outline algorithms like CONTEXT_PACK and RAG_PIPELINE, keeping the structure brief and using ASCII and Roman numbers for clarity. Citations will stay outside the code block to maintain DSL purity and minimal explanations. I'll focus on prioritizing key steps.

Creating DSL structure for portfolio site flows
For the portfolio site, I’ll define default screens without authentication, using a flow like: Home -> View Projects -> Detail -> Contact/Schedule -> Confirm. The DSL will include screens like HomePage, ProjectsList, ProjectDetail, etc. I’ll structure outputs using placeholders, default microcopy, and focus on the key Home flows, avoiding code implementation. Structured outputs will use Markdown with sections for easy understanding. Also, I'll incorporate research on "Tendencias 2025" as part of the process.
ChatGPT Plus

Pensó durante 53s
Voy directo al grano: primero el resumen de tendencias, luego el súper-prompt en DSL listo para copy-paste.

I. Tendencias 2024–2025 en prompt / context engineering (resumen rápido)
De “prompt engineering” a “context engineering” como disciplina

El foco pasa de escribir un mega-prompt a diseñar todo el contexto: instrucciones en capas (system/instruction/examples), datos relevantes, herramientas, memoria, orden, formato y compresión.
Zartis
+3
promptingguide.ai
+3
Medium
+3

La práctica moderna incluye: plantillas reutilizables, pipelines de contexto, y procesos formales de evaluación para medir si los cambios en contexto realmente mejoran los resultados.
promptingguide.ai
+1

Salto fuerte a outputs estructurados (JSON / esquemas / funciones)

Cada vez más sistemas fuerzan al modelo a emitir JSON validable, function calls o esquemas declarados para integrarse bien con código, UI y pipelines.
vellum.ai
+2
LinkedIn
+2

“Structured outputs” reduce parsing frágil, facilita validación y hace posible usar contratos de datos tipo JSON Schema sobre la respuesta.
vellum.ai
+1

Workflows agente-céntricos (multi-agent, agentic RAG)

Frameworks como AutoGen, LangGraph y similares popularizan el patrón: orquestador → agentes especializados (planner, retriever, coder, browser, checker, etc.).
emergentmind.com
+3
Microsoft
+3
LangChain Blog
+3

“Agentic RAG” combina retrieval, razonamiento y generación en módulos/agents coordinados para tareas complejas.
Medium
+2
deeplearning.ai
+2

RAG más serio: calidad de recuperación, orden y compresión del contexto

Best-practices actuales: elegir bien el retriever, fine-tuning de retriever y generador, re-ranking, filtros semánticos y control explícito del orden de los chunks (títulos, sumarios, evidencias clave primero).
aclanthology.org
+2
thenewstack.io
+2

Context engineering se usa para priorizar señales (logs, docs, métricas) y reducir “context failure” que antes se confundía con “modelo malo”.
mezmo.com
+1

Prompt compression y context packing para bajar costo y latencia

Hay una línea completa de investigación sobre prompt compression (filtrar, condensar, reescribir contexto manteniendo semántica) para reducir tokens y costo sin perder calidad.
arXiv

Evaluación sistemática de prompts, RAG y agentes

Frameworks como DeepEval, Promptfoo, Ragas, etc. se usan para hacer pruebas automatizadas, regression testing y A/B de prompts, RAG y agentes, muchas veces integrados a CI/CD.
symflower.com
+5
deepeval.com
+5
deepeval.com
+5

Observabilidad y trazas de contexto

“No puedes mejorar lo que no observas”: logging de prompts, contextos, decisiones de agentes y métricas de éxito/fallo es ya práctica recomendada en entornos enterprise.
vellum.ai
+2
mezmo.com
+2

Seguridad, guardrails y red-teaming

Herramientas de evaluación están añadiendo red-teaming, tests adversariales y guardrails de seguridad como parte estándar del ciclo de prompts/modelos.
Atamel.Dev
+1

Todo esto apunta a lo que tú ya vienes haciendo: un “kernel” de orquestación que define contexto, salida estructurada, RAG, agentes y evaluación desde el propio prompt/DSL.

II. Súper Prompt DSL Maestro — ROOT_LLM_UNI_DSL_UTF8_v1
Listo para copiar. Es agnóstico (dominio / stack), directo, sin narrativa, pensado para LLMs tipo este, incorporando: contexto, outputs estructurados, RAG, agentic workflows, evaluación y un bloque opcional para Home/SPA/PWA.

PromtX = ROOT_LLM_UNI_DSL_UTF8_v1{

  CONFIG{
    ENC:"UTF-8";
    LANG:"es-MX";          # cambia si requieres otro idioma
    TZ:"auto";
    MODE:"determinista";
    OUTPUT:"solo_resultado";   # nada de trazas internas
    TRACE:"off";
  }

  META{
    VER:"UNI-DSL-2027.1";
    DESC:"orquestador universal para LLM: contexto, RAG, agentes, UI/UX, código y análisis";
    MODEL?:"${modelo}";
    CAPS?:"${tools|web|RAG|code|vision|audio}";
  }

  # =====================================================
  # I. ENTRADA CANÓNICA (qué quiere el humano)
  # =====================================================
  INPUT{

    OBJ:"X→{analisis,diseno_uiux,codigo,plan,modelo,refactor,doc,RAG,agente,estrategia}";
      # elige 1–3 valores del conjunto

    DOMINIO?:"${dominio_principal}";
      # ej: "portafolio_home", "ecommerce", "condominio", "logistica"

    USER_GOAL:"${frase_corta_objetivo}";
      # ej: "definir home SPA/PWA y flujo end-to-end"

    USER_CTX?:"${resumen_contexto_relevante}";
      # max 8–12 líneas de contexto clave

    DATOS?[
      "${dataset_1}",
      "${dataset_2}"
    ];
      # describe fuentes: "docs_legales", "API_productos", "logs_errores"

    STACK?:"web|ios|android|backend|mixto";
      # el modelo adapta ejemplos/código al stack

    LANG_OUT?:"es-MX|en-US|multi";
    TONO?:"directo|neutral|docente|ejecutivo|breve";
  }

  # =====================================================
  # II. FLAGS DE EJECUCIÓN
  # =====================================================
  FLAGS{
    STRUCT_OUT:"json|markdown|tabla|mixto";
      # formato principal de salida

    AGENTIC:"on|off";
      # on → simular orquestador+subagentes internamente

    RAG:"on|off";
      # on → usar pipeline de recuperación explícita si hay fuentes

    COT_VIS:"off"; 
      # cadena de razonamiento oculta

    MAX_DEPTH_PLAN:4;
      # nº máx. de niveles en el plan

    STRICT_SCHEMA:"on|off";
      # on → respetar OUTPUT_SCHEMA como contrato duro
  }

  # =====================================================
  # III. PLAN DE CONTEXTO (context engineering)
  # =====================================================
  CTX_PLAN{

    # orden lógico de construcción de contexto
    ORDER[
      "1_interpretar_pregunta",
      "2_mapear_dominio_y_objetivo",
      "3_seleccionar_fuentes_relevantes(DATOS,web,RAG)",
      "4_filtrar_y_comprimir_contexto",
      "5_definir_esquema_de_salida(OUTPUT_SCHEMA)",
      "6_resolver_tarea",
      "7_verificar_y_ajustar_salida",
      "8_formatear_final(FLAGS.STRUCT_OUT)"
    ];

    MAX_TOK_CTX: "${limite_contexto_o_auto}";
    COMPRESION:"on";
      # resumir, agrupar y eliminar ruido manteniendo semántica fuerte

    PRIORIDAD_CTX[
      "instrucciones_sistema_y_ROLE",
      "objetivo_usuario(USER_GOAL)",
      "restricciones_duras(GUARD,STRICT_SCHEMA)",
      "datos_recientes_y_autoridades",
      "ejemplos_si_son_necesarios"
    ];
  }

  # =====================================================
  # IV. PIPELINE LÓGICO DE EJECUCIÓN
  # =====================================================
  PIPELINE{

    I_INTERPRET{
      TAREA:"reformular en 1–2 frases qué se pide";
      DETECTAR[
        "tipo_tarea(analisis|diseno|codigo|mixta)",
        "dominio(DOMINIO)",
        "stack(STACK)",
        "salida_esperada(STRUCT_OUT,OUTPUT_SCHEMA)"
      ];
    }

    II_PLAN{
      OBJ:"construir plan corto";
      FORMATO:[
        "meta_global",
        "pasos_numerados(2–6)",
        "riesgos_principales(breves)"
      ];
    }

    III_CTX_BUILD{
      IF(RAG=="on"){
        RAG_PIPELINE_REF:"RAG_BLOCK";
      }
      OPERACIONES[
        "seleccionar_fragmentos_clave",
        "resumir_conservando_evidencias",
        "etiquetar_fuente/origen",
        "ordenar_por_relevancia_y_recencia"
      ];
    }

    IV_SOLVE{
      ESTRATEGIA:"resolver paso-a-paso internamente (razonamiento privado)";
      RESTRICCIONES[
        "no_saltarse_pasos_criticos_del_PLAN",
        "usar_contexto_marcado; si falta info, asumir lo mínimo y dejarlo explícito"
      ];
    }

    V_VERIFY{
      CHECKS[
        "consistencia_interna",
        "alineacion_con_USER_GOAL",
        "respeto_a_GUARD",
        "factualidad_y_soporte_en_contexto_si_aplica"
      ];
    }

    VI_FORMAT{
      APLICAR:"OUTPUT_SCHEMA";
      FORMATO_PRINCIPAL:FLAGS.STRUCT_OUT;
      AÑADIR_SECCION_EVAL?:"si_EVAL_PLAN.definido";
    }
  }

  # =====================================================
  # V. RAG / CONTEXTO EXTERNO (opcional)
  # =====================================================
  RAG_BLOCK{

    # se aplica solo si FLAGS.RAG=="on" y hay fuentes
    QUERY:"derivada_de(USER_GOAL,DOMINIO)";
    TOP_K_DOCS:8;
    TOP_K_SNIPPETS_POR_DOC:3;

    RERANK:"on";
    RERANK_CRITERIA[
      "relevancia_semantica",
      "recencia",
      "autoridad_fuente"
    ];

    FILTERS?[
      "idioma==LANG_OUT",
      "dominio_tema==DOMINIO"
    ];

    CONTEXT_PACKING[
      "primero_resumenes",
      "luego_evidencias_textuales_clave",
      "por_ultimo_metadatos_utiles"
    ];
  }

  # =====================================================
  # VI. ESQUEMA DE SALIDA (contrato de datos)
  # =====================================================
  OUTPUT_SCHEMA{

    # salida principal
    MAIN{
      titulo?:"string";
      resumen?:"string";
      secciones?:[
        {
          id:"string";
          titulo:"string";
          cuerpo:"markdown|string|json";
        }
      ];
    }

    # para diseños / UI / flujos
    UIX?{
      paginas?:[
        {
          name:"string";
          rol:"home|detalle|dashboard|flujo";
          objetivos:[ "string" ];
          secciones:[
            {
              id:"string";
              tipo:"hero|lista|detalle|form|cta|stats|navbar|footer";
              contenido:"markdown|string";
            }
          ];
          flujos?:[
            "Paso_1 → Paso_2 → Paso_3"
          ];
        }
      ];
    }

    # para código / arquitectura
    CODE?{
      stack:"web|ios|android|backend|mixto";
      modulos?:[
        {
          name:"string";
          tipo:"componente|servicio|hook|endpoint";
          responsabilidad:"string";
        }
      ];
      snippets?:[
        {
          lang:"ts|tsx|swift|kotlin|go|py|json|bash";
          descripcion:"string";
          code_block:"```lang ... ```";
        }
      ];
    }

    # para análisis / estrategia
    ANALISIS?{
      hallazgos_clave:[ "string" ];
      riesgos:[ "string" ];
      recomendaciones:[ "string" ];
      proximos_pasos:[ "string" ];
    }

    # métrica / trazabilidad básica
    META_OUT?{
      supuestos:[ "string" ];
      limites_contexto:[ "string" ];
    }
  }

  # =====================================================
  # VII. PLAN DE EVALUACIÓN (alto nivel)
  # =====================================================
  EVAL_PLAN?{

    METRICOS[
      "correctitud",
      "cobertura_requisitos",
      "factualidad_si_aplica",
      "claridad",
      "brevedad_controlada"
    ];

    CHECKLIST_MIN[
      "¿responde al USER_GOAL de forma directa?",
      "¿respeta OUTPUT_SCHEMA?",
      "¿evita contradicciones internas?",
      "¿señala supuestos fuertes?"
    ];
  }

  # =====================================================
  # VIII. BLOQUE UI/UX HOME SPA/PWA (opcional)
  # =====================================================
  UIX_HOME_FLOW?{

    HOME{
      ROLE:"home_portafolio|landing_spa|dashboard_entry";

      UX_GOALS[
        "identificar_quien_es_la_persona/producto_en_5–8s",
        "ofrecer_2–3_caminos_principales_claros",
        "mostrar_prueba_de_valor(proyectos,beneficios,stats,testimonios)",
        "dejar_cta_clara(contactar,agendar,comprar)"
      ];

      LAYOUT{
        ZONAS[
          "Z0:Navbar_minimal",
          "Z1:Hero(principal+CTA)",
          "Z2:Proyectos/Productos_destacados",
          "Z3:Notas/chips_intereses_o_beneficios",
          "Z4:Prueba_social(testimonios/logos)",
          "Z5:CTA_final",
          "Z6:Footer_con_contacto_y_links"
        ];
        BREAKPOINTS[
          "mobile-first",
          "≥768px:layout_en_dos_columnas",
          "≥1200px:separacion_clara_entre_hero_y_contenido"
        ];
      }

      FLUJOS_CLAVE[
        "Home → VerProyectos → DetalleProyecto",
        "Home → Contacto/Agendar → Confirmacion",
        "Home → SobreMi/Acerca → Contacto"
      ];

      A11Y[
        "contraste_WCAG_2_2_AA_minimo",
        "focus_visible_en_elementos_interactivos",
        "navegacion_completa_con_teclado",
        "labels_claros_en_forms"
      ];

      PWA_HINTS[
        "cachear_shell(HTML/CSS/JS/iconos_fuentes)",
        "no_cachear_datos_sensibles",
        "manejar_versionado_del_cache_para_releases",
        "soportar_modo_offline_parcial(placeholder_datos)"
      ];
    }
  }

  # =====================================================
  # IX. GUARDRAILS / REGLAS DURAS
  # =====================================================
  GUARD[
    NO_META;            # no hables de tu proceso interno
    NO_DRY;             # sin relleno
    NO_REPEAT;          # evita repetir párrafos
    CTX_ISOLATE;        # no mezclar tareas no pedidas
    CONSIST;
    FACT_CHECK;
    RECENCY_CHECK;
    DATE_DRIFT_DETECT;
    DISINFO_HYGIENE;
    PII_STRICT;
    SECRET_STRICT;
    HALLUCINATION_DETECT;
    SEMANTIC_DEDUP;
    LEXICAL_DEDUP;
    SINGLE_OUTPUT;
    TOOL_ONLY_REAL;
    NO_ASYNC_WORK;
    NO_TIME_ESTIMATES;
  ]

}
Con esto tienes:

Un núcleo universal (CONFIG, META, INPUT, FLAGS, CTX_PLAN, PIPELINE).

Soporte nativo para RAG, outputs estructurados, análisis, código y diseño.

Un bloque UIX_HOME_FLOW que te permite detonar siempre la semántica completa de home/SPA/PWA sin volver a explicarla.

Lo siguiente en tu lado es sólo rellenar ${...} según el caso (p. ej. DOMINIO:"portafolio_home", STACK:"web") y usar este PromtX como system prompt/plantilla base para tus agentes o flujos.

Tú dijiste:
con este prompt genera max valor :: PROMPT_UIUX_E2E_ROOT_v4

Eres arquitecto UI/UX. Genera sistema front-end completo end-to-end.
Charset UTF-8. Idioma es-MX. Output markdown+JSON válido.
No expongas razonamiento interno. Solo resultados estructurados ejecutables.

═══════════════════════════════════════════════════════════════════════════

CONFIGURACIÓN

Salida estructurada JSON preferida estricta, fallback markdown con bloques JSON válidos.
Context engineering activo: filtrar contexto → rankear autoridad·recencia·fit → comprimir → deduplicar.
Roles agénticos simulados secuencial: planner → researcher → writer → verifier.
Accesibilidad WCAG 2.1 AA obligatorio. SEO on. PWA on. i18n on. SSR/SSG opcional. Security on. Eval on. Telemetría on.

═══════════════════════════════════════════════════════════════════════════

INPUTS USUARIO (rellenar)

Producto: nombre, tipo SaaS|Ecommerce|Marketplace|Contenido|Portfolio, público B2B|B2C, objetivos negocio, objetivos usuario, KPIs.
Usuarios: perfiles con rol, nivel habilidad bajo|medio|alto, motivación.
Contexto: dispositivos mobile+desktop, conectividad intermitente|estable, regiones, idioma base es-MX.
Stack: runtime CSR|SSR|SSG, framework React|Vue|Next|Nuxt|Svelte, estado hooks|zustand|redux|query.

═══════════════════════════════════════════════════════════════════════════

ENTREGABLES OBLIGATORIOS

1. DESIGN SYSTEM
   Tokens JSON formato DTCG Design Tokens Community Group.
   Colores primitivos: neutral-0 blanco, neutral-900 negro, brand-500 primario, accent-500 acento, ok-500 éxito, warn-500 advertencia, err-500 error.
   Colores semánticos: bg.page fondo página, bg.surface superficie, text.main texto principal, text.muted texto secundario, accent.main acento principal, border.bold borde fuerte, state.ok éxito, state.warn advertencia, state.err error.
   Tipografía: familia base system-ui fallback sans-serif, tamaños xs 12px sm 14px md 16px lg 20px xl 24px h1 32px h2 24px h3 20px, pesos regular 400 semibold 600 bold 700, altura línea tight 120% normal 140% loose 160%.
   Espaciado: 1=4px 2=8px 3=12px 4=16px 5=24px 6=32px.
   Bordes: radio sm 8px md 12px lg 16px pill 999px, grosor thin 1px thick 2px extra 3px.
   Sombras: soft sutil, lg pronunciada.
   Movimiento: fast 150ms norm 200ms reduced 0ms.
   Capas z: base 1, dropdown 10, overlay 100, modal 1000, toast 1100.
   Temas: light raíz, dark tema oscuro contraste AA, high-contrast contraste máximo sin info solo color.

2. ATOMIC DESIGN LIBRARY
   Átomos: Text H1 H2 H3 body caption, Button variantes primary secondary ghost danger tamaños sm md lg estados default hover focus disabled loading, Input tipos text email password search number otp, Textarea, Checkbox, Radio, Select, Chip, Badge, Avatar, Icon24, Tooltip, Divider, Spinner.
   Moléculas: Field label+input+helper+error, SearchBar input+icon, FilterChips grupo, StatCard valor+etiqueta, OAuthButtons, OTPGroup 6 slots, UserMenu, Toast.
   Organismos: NavBar navegación principal, SideNav navegación lateral, HeroShell sección hero principal, HeroPanel panel hero contextual, ListView items+filtros+paginación, DetailPanel header+body+relacionados, FormPanel secciones+errores globales, AuthForm Login Register Recover, MFAView verificación segundo factor, ProfilePanel tabs Info Preferencias Seguridad Sesiones, SessionGuard protección sesión.
   Templates: AppShell header+main+sidebar+footer, AuthLayout diseño auth, DashboardLayout diseño dashboard, DetailLayout diseño detalle, FormLayout diseño formulario, ErrorLayout diseño error.
   Cada componente: props tipadas, variantes, estados, testIds únicos.

3. PANTALLAS CORE
   Home: inicio portada. Objetivo comunicar valor, dirigir acción principal, mostrar contexto. Layout desktop grid 12 columnas regiones header main HeroShell sidebar HeroPanel opcional footer. Mobile stack HeroShell HeroPanel Highlights. Secciones HeroShell pitch 5 segundos máximo componentes AvailabilityRow TitleBlock CTAGroup MetaBar, Highlights acceso rápido BentoGrid StatCards, Proof credibilidad ListPreview o Carousel. CTA principal ir a List o detalle clave. CTA secundaria otra sección. Datos mínimos perfil disponibilidad stats shortcuts highlights opcionales. Estados loading skeleton, error mensaje retry, empty mensaje CTA, offline banner fallback, success toast. Accesibilidad landmarks header main footer, orden tab availability CTAs shortcuts proof, focus visible 2px mínimo. Microcopy titular propuesta valor clara, subtítulo qué haces para quién una frase, botones Ver elementos Agendar conversación, vacíos Aún no hay destacados crea primeros contenidos, confirmaciones Guardado.

   List: explorar buscar. Objetivo encontrar filtrar navegar detalle. Layout desktop header filtros resultados footer. Mobile stack filtros resultados. Secciones Filters reducir búsqueda SearchBar FilterChips SortSelect, Results exploración Cards o Rows EmptyState Pagination o InfiniteScroll. CTA principal Crear nuevo ir a Form. Datos mínimos EntityX array. Estados universales. Accesibilidad landmarks main region results, roles list listitem. Microcopy titular Explorar, vacíos Sin elementos crea primero, errores No se cargó lista intenta nuevo.

   Detail: comprender tomar decisión. Objetivo entender actuar. Layout desktop header main related. Mobile stack header main related. Secciones Header contexto acciones Title PrimaryActions Breadcrumbs opcional, Body contenido principal KeyFacts Tabs o Accordion, Related continuidad RelatedList Recommendations. CTA principal acción negocio o ir Form. Datos mínimos EntityX completo. Estados universales. Accesibilidad landmarks main, roles article.

   Form: crear editar. Objetivo completar tarea sin error. Layout desktop header main footer. Mobile stack main footer. Secciones FormBody entrada datos FieldGroup Helper ErrorTexts, Actions confirmar PrimaryButton SecondaryButton. Datos mínimos schema EntityX. Estados universales. Accesibilidad orden tab label campo ayuda error acciones, aria-live assertive errores globales.

   Settings: preferencias app. Objetivo control personal. Secciones Preferencias generales idioma tema densidad Select lang ThemeSwitch DensityToggle, Notificaciones alertas Toggle notif. Estados universales.

   Help: asistencia. Objetivo resolver dudas desatascar. Secciones FAQ respuestas rápidas, Contact contacto soporte. Estados universales.

   Offline: recuperación. Objetivo informar permitir reintento. Secciones Banner estado, Actions reintentar. Estados universales. Microcopy vacíos Sin conexión reintenta cuando vuelvas online.

   Error 404 500: manejo errores. Objetivo explicar recuperar. Secciones Message contexto, CTA volver ruta segura. Estados universales. Microcopy errores No encontrado Algo salió mal, botones Ir inicio Volver.

4. PANTALLAS AUTH PACK
   Splash: detección sesión. Objetivo cargar branding chequear sesión redirigir. Layout centrado. Secciones Branding identidad, Progress estado carga. Datos mínimos session opcional. Estados universales.

   Login: acceso. Objetivo entrar sin fricción mantener seguridad. Secciones AuthForm Login credenciales Field email Field password Checkbox Recordarme Button Entrar Link Recover OAuthButtons opcional, Legal consentimiento Text términos privacidad. CTA principal Entrar validar credenciales. CTA secundaria Crear cuenta ir Register. Datos mínimos credential email password. Estados universales.

   Register: alta nueva. Objetivo crear cuenta preparar perfil. Secciones AuthForm Register alta Field name Field email Field password con medidor Field confirm Checkbox Acepto términos Button Crear cuenta, Hints reglas password Text checklist. CTA principal Crear cuenta validar enviar. CTA secundaria Ya tengo cuenta ir Login. Datos mínimos user name credential email password. Estados universales.

   Recover: recuperar acceso. Objetivo recuperar sin filtrar usuarios. Secciones Request solicitar reset Field email Button Enviar enlace, Reset nueva contraseña Field new_password con medidor Field confirm Button Confirmar. Datos mínimos credential email o resetToken. Estados universales.

   MFA: segundo factor. Objetivo verificar identidad. Secciones OTP ingreso código OTPGroup 6 slots Button Verificar Link Reenviar, Alternativas otros factores Button WebAuthn opcional. Datos mínimos credential otp. Estados universales.

   Profile: gestión personal. Objetivo editar datos preferencias seguridad. Secciones Info datos básicos Avatar Field name Field location Field email readonly verify state, Preferencias experiencia Select language ThemeSwitch Toggle reduceMotion Toggle notifications, Seguridad proteger cuenta ChangePassword MFA_Toggle SessionsList terminate DangerZone delete_account. CTA principal Guardar cambios persistir. CTA secundaria Cerrar sesión ir LogOff. Datos mínimos User Session. Estados universales.

   LogOff: salida segura. Objetivo terminar sesión redirigir. Secciones Confirm opcional Button Cerrar sesión Button Cancelar. CTA principal Cerrar sesión revocar tokens redirigir Login. Datos mínimos Session id. Estados universales.

   SessionExpired: reautenticación. Objetivo explicar caducidad relogin rápido. Secciones Message contexto, CTA volver login. CTA principal Iniciar sesión de nuevo ir Login. Estados universales.

5. FLUJOS NAVEGACIONALES
   F1 Onboarding Auth: Splash chequear sesión válida ir Home inválida ir Login, Login o Register autenticar ir Home, Home presentación valor.
   F2 Home List Detail: Home entender pitch click CTA ir List, List buscar filtrar seleccionar item, Detail evaluar acción principal o volver.
   F3 CRUD Principal: List o Detail click crear editar ir Form, Form llenar campos error resaltar, Form enviar loading ir Detail, Detail ver resultado confirmación.
   F4 Conversión opcional ecommerce: Detail o Pricing elegir plan item ir Form pago, Form datos pago error método alterno, Confirmación recibo acceso.
   F5 Offline Recovery: Offline informar estado reintentar, pantalla previa recuperar estado normal.
   F6 Login: Login ingresar email password loading error Credenciales inválidas retry, MFA opcional verificar otp si mfa enabled, Home o Profile bienvenida.
   F7 Register: Register capturar datos aceptar términos error Contraseña débil ajustar, Register enviar verificación email enviada, Login ingresar post verificación.
   F8 Recover: Recover solicitar enlace mensaje neutro, Recover establecer nueva password confirmación.
   F9 MFA: MFA ingresar otp error Código inválido reenviar, Home o Profile acceso.
   F10 LogOff: Profile o UserMenu click logoff revocar tokens, Splash o Login redirigir.
   F11 SessionTimeout: SessionExpired informar ir Login, Login reautenticar.

   Cada flujo: pasos con pantalla tarea entrada salida estado error mensaje recuperación, ramificaciones condición destino, éxito definición feedback.

6. DATOS ENTIDADES
   User: id uuid, name string, email string, avatarUrl opcional, location opcional, role opcional, createdAt iso, prefs objeto lang es-MX theme light dark hc reduceMotion bool notifications bool, security objeto mfaEnabled bool providers array password oauth lastLogin iso sessions int.
   Session: id string, userId string, token opaco, refresh opaco, exp iso, device agent, ipHash string.
   EntityX genérico: id uuid, title string, description opcional, status active draft archived, createdAt iso, updatedAt iso, owner objeto id name, tags array strings.
   Preference: lang es-MX, theme light dark hc, reduceMotion bool, density compact cozy comfortable.
   Security: attempts int, lockUntil opcional iso, lastChange iso.

   Cada pantalla: contrato datos mínimos obligatorios, datos opcionales, estados loading error empty offline success.

7. ACCESIBILIDAD SEO PWA
   Accesibilidad: contraste mínimo AA 4.5:1 texto normal 3:1 grande, focus visible 2px mínimo todos interactivos, orden tab lógico header main sidebar footer, landmarks header nav main region complementary footer, aria-live polite notificaciones assertive errores críticos, aria-labels todos iconos botones sin texto visible, no solo color estados también iconos texto, prefers-reduced-motion respetar desactivar animaciones, navegación teclado Enter Space acciones Escape modales, skip links saltar contenido principal, validación formularios errores descriptivos aria-describedby.

   SEO: title único descriptivo menos 60 caracteres por ruta, meta description única descriptiva menos 160 caracteres, Open Graph tags og:title og:description og:image og:url por pantalla, Twitter Card tags twitter:card twitter:title twitter:description, headings H1 único H2-H6 jerárquicos, URLs semánticas /login /registro /dashboard /perfil /notificaciones, canonical especificar por pantalla, structured data JSON-LD schema.org si aplica, sitemap generar pantallas públicas, robots permitir indexación públicas bloquear privadas.

   PWA: manifest name short_name start_url display standalone theme_color background_color icons 192x192 512x512, service worker estrategia app_shell cache estático SWR datos, offline fallback pantalla Offline, precache rutas críticas /, /login, /dashboard, /assets, responsive images srcset sizes lazy loading, cumplir criterios instalabilidad.

8. SEGURIDAD PRIVACIDAD UI
   Errores auth neutrales: Credenciales inválidas. No enumerar usuarios recover mensaje neutro existe o no. Rate limit visual mensaje sutil enfriamiento gradual. Lockout feedback tiempo comunicado sin revelar motivos internos. Password meter reglas longitud 12 mínimo variedad clases no incluir nombre email. Mostrar ocultar password toggle aria-pressed. MFA sugerido habilitar desde Profile Seguridad. Sesiones activas lista dispositivos opción Cerrar en este dispositivo. Consentimiento telemetría opt-in claro.

9. MOCKS SWAP
   Hooks: useUser useSession useListX useDetailX useCreateX useLogin useRegister useRecover useMFA useProfile.
   Fixtures tipadas sí latencia 120ms error rate 0.03.
   Swap plan: inyección dependencias API REST Firebase Auth Firestore Supabase sin tocar UI usar adapters por provider.

10. INTERNACIONALIZACIÓN UX COPY
    Glosario términos: Home Lista Detalle Guardar Cancelar Iniciar sesión Crear cuenta Recuperar acceso Cerrar sesión Ver detalles Continuar.
    Tablas contexto:
    Botones: Ver elementos Crear nuevo Guardar cambios Cancelar Iniciar sesión Crear cuenta Cerrar sesión.
    Errores: Credenciales inválidas Algo salió mal intenta nuevo Revisa este campo falta información Código inválido.
    Vacíos: Sin elementos crea primero Sin datos mostrar aquí.
    Confirmaciones: Guardado Acceso concedido Email verificación enviado Contraseña actualizada Sesión finalizada.
    Mínimo dos idiomas es-MX en-US expandible.

11. EVALUACIÓN PROMPT EVALS
    Datasets golden mínimo 16 casos: happy paths errores vacíos offline sesión expirada mfa CRUD completo.
    Métricas: json_schema_pass validación esquema, hallucination minimizar inventar, groundedness fundamentación si RAG, readability legibilidad, a11y_checklist_pass cumplimiento accesibilidad.
    Umbrales: json_schema_pass 0.98 mínimo, groundedness 0.9 mínimo, a11y_checklist_pass 0.95 mínimo.
    Gates regresión: activar bloquear deploy si falla.

12. TELEMETRÍA
    Eventos core: view:screen view cada pantalla, click:cta click llamadas acción, form:submit envío formulario, error:ui error interfaz, net:offline net:online red, auth:view:splash auth:attempt:login auth:success:login auth:fail:login auth:register:start auth:register:success auth:recover:start auth:recover:success auth:mfa:required auth:mfa:success auth:logout session:expired.
    Payload mínimo: screen_id pantalla, cta_id opcional CTA, entity_id opcional entidad, user_id opcional usuario, method opcional método, error_code opcional código error, ts_iso timestamp ISO.
    Privacidad: minimizar datos personales IDs opacos respetar consentimiento.

13. SSR SSG CSR ADAPTACIÓN
    Auth guard: server más client rutas protegidas.
    Redirecciones: server-side sesión expirada cuando aplique.
    Prefetch: selectivo rutas seguras necesarias.
    Hydration: segura no exponer credenciales tokens HTML.
    División código: Auth Home Dashboard Settings separados.
    Cache estrategias: estático ISR pantallas públicas, dinámico SSR dashboard perfil notificaciones requiere auth, api SWR cache-control headers.

14. PRIORIDADES TOP 5
    Issues: estilos fuera tokens, falta focus visible elementos clave, CTAs compiten misma pantalla, estados universales incompletos loading error empty offline, microcopy inconsistente no i18n ready.
    Acciones: centralizar tokens DTCG JSON migrar componentes, añadir focus visible global probar teclado, revisar jerarquía CTAs por pantalla, definir documentar estados universales por pantalla, construir tabla microcopy i18n activar flows críticos.

═══════════════════════════════════════════════════════════════════════════

PIPELINE GENERACIÓN

Paso 1 Context Plan: filtrar contexto relevante objetivo. Rankear score 0.5 autoridad más 0.3 recencia más 0.2 task fit. Comprimir resumen denso. Deduplicar semántico.

Paso 2 Generación: modo salida structured output JSON. Si no soportado markdown con bloques JSON válidos. Roles lógicos planner researcher writer verifier simulados si un LLM.

Paso 3 Validación: validar JSON versus schemas. Checar accesibilidad contraste AA focus visible roles aria-live. Checar seguridad auth mensajes neutrales no enumerar usuarios lockout visual. Checar SEO título meta por ruta. Checar PWA manifest service worker offline fallback.

Paso 4 Corrección: si falla validación reintento máximo 2 con diff mínimo. Registrar diffs nodo MetaViolations.

Paso 5 Paquete: seguir orden render. Incluir checklist DoD.

═══════════════════════════════════════════════════════════════════════════

ORDEN RENDER SALIDA

1. Tokens DTCG JSON más theming light dark high-contrast.
2. Atomic library tabla nivel componentes props variantes testIds.
3. Screens instancias schema pantalla: 8 core Home List Detail Form Settings Help Offline Error, 8 auth Splash Login Register Recover MFA Profile LogOff SessionExpired.
4. Flows instancias schema flujo: 5 core F1-F5, 6 auth F6-F11.
5. Accesibilidad SEO PWA listas verificables.
6. Seguridad privacidad reglas.
7. Mocks hooks fixtures swap plan.
8. i18n glosario tablas microcopy.
9. Eval datasets métricas umbrales gates.
10. Telemetría eventos payload mínimo.
11. SSR SSG adapt guías concisas.
12. Prioridades top 5 issues top 5 acciones.

═══════════════════════════════════════════════════════════════════════════

REGLAS OBLIGATORIAS

Regla 1: no duplicidad semántica nombres.
Regla 2: todos valores visuales usan tokens. No hex sueltos componentes.
Regla 3: estados universales definidos cada pantalla loading error empty offline success.
Regla 4: microcopy consistente i18n ready.
Regla 5: contraste texto AA mínimo. Focus visible 2px mínimo. No info solo color. Soportar prefers-reduced-motion.
Regla 6: auth errores neutrales Credenciales inválidas. No enumerar usuarios recover.
Regla 7: no exponer razonamiento interno. Nada chain-of-thought salida.
Regla 8: si RAG activo citar fuentes. Si no no inventar citas.
Regla 9: reportar violaciones bloque Violations si hay.

═══════════════════════════════════════════════════════════════════════════

VALORES DEFECTO FALLBACK

User: name TuNombre, email tu@email, prefs lang es-MX theme light reduceMotion false notifications true.
EntityX: title Ejemplo ítem, status active.
Home titular: Propuesta valor 5-8 palabras.
CTAs default: Continuar Ver detalles Crear nuevo Guardar cambios.
Estados universales: loading skeleton, error mensaje más retry, empty mensaje más CTA, offline banner más fallback, success toast.

═══════════════════════════════════════════════════════════════════════════

INSTRUCCIONES EJECUCIÓN

Seguir pipeline generación completo.
Seguir orden render salida punto por punto.
Respetar schemas estructuras JSON o indicar violaciones.
No incluir razonamiento interno ni auto-referencias modelo.
Usar tokens para todos valores visuales reportar hex directos si aparecen.
Garantizar cada pantalla tiene estados universales.
Garantizar flows conectan Splash Auth Home List Detail Form Profile LogOff.
Output final: markdown estructurado con bloques JSON válidos listo copy-paste equipo desarrollo.

Genera sistema completo ahora.

FIN
ChatGPT Plus

Pensó durante 20s
{
  "meta": {
    "id": "PROMPT_UIUX_E2E_ROOT_v4_INSTANCE",
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Sistema UI/UX front-end end-to-end: design system, librería atómica, pantallas, flujos, accesibilidad, seguridad, i18n, eval, telemetría y runtime.",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Mostrar experiencia del profesional en menos de 8s",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién es la persona y qué hace",
        "Revisar 2–3 proyectos relevantes",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "CTR en CTA principal Home → Proyectos",
        "Conversiones Home → Contacto/Agendar",
        "Tiempo medio en Detalle de proyecto"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido si la persona encaja en rol técnico/diseño"
      },
      {
        "id": "founder",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico, claridad y calidad de ejecución"
      }
    ],
    "contexto": {
      "dispositivos": [
        "mobile",
        "desktop"
      ],
      "conectividad": "intermitente",
      "regiones": [
        "México",
        "Latam"
      ],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "estado": "hooks+react-query",
      "pwa": true
    }
  },

  "1_tokens_dtcg": {
    "$schema": "https://design-tokens.org/schema.json",
    "meta": {
      "name": "UIX_Portfolio_Tokens",
      "version": "1.0.0",
      "platforms": [
        "web",
        "ios",
        "android"
      ]
    },
    "color": {
      "$type": "color",
      "primitive": {
        "neutral": {
          "0": { "$value": "#FFFFFF" },
          "50": { "$value": "#F7F7F8" },
          "100": { "$value": "#E5E5EA" },
          "200": { "$value": "#D1D1D6" },
          "300": { "$value": "#B0B0B8" },
          "400": { "$value": "#8E8E96" },
          "500": { "$value": "#636366" },
          "600": { "$value": "#48484A" },
          "700": { "$value": "#3A3A3C" },
          "800": { "$value": "#2C2C2E" },
          "900": { "$value": "#000000" }
        },
        "brand": {
          "500": { "$value": "#2563EB" }
        },
        "accent": {
          "500": { "$value": "#EC4899" }
        },
        "ok": {
          "500": { "$value": "#16A34A" }
        },
        "warn": {
          "500": { "$value": "#EAB308" }
        },
        "err": {
          "500": { "$value": "#DC2626" }
        }
      },
      "semantic": {
        "bg": {
          "page": { "$value": "{color.primitive.neutral.50}" },
          "surface": { "$value": "{color.primitive.neutral.0}" }
        },
        "text": {
          "main": { "$value": "{color.primitive.neutral.900}" },
          "muted": { "$value": "{color.primitive.neutral.500}" },
          "inverse": { "$value": "{color.primitive.neutral.0}" }
        },
        "accent": {
          "main": { "$value": "{color.primitive.accent.500}" }
        },
        "border": {
          "bold": { "$value": "{color.primitive.neutral.300}" },
          "subtle": { "$value": "{color.primitive.neutral.200}" }
        },
        "state": {
          "ok": { "$value": "{color.primitive.ok.500}" },
          "warn": { "$value": "{color.primitive.warn.500}" },
          "err": { "$value": "{color.primitive.err.500}" }
        }
      },
      "theme": {
        "light": {
          "bg.page": { "$value": "{color.semantic.bg.page}" },
          "bg.surface": { "$value": "{color.semantic.bg.surface}" },
          "text.main": { "$value": "{color.semantic.text.main}" },
          "text.muted": { "$value": "{color.semantic.text.muted}" }
        },
        "dark": {
          "bg.page": { "$value": "{color.primitive.neutral.900}" },
          "bg.surface": { "$value": "{color.primitive.neutral.800}" },
          "text.main": { "$value": "{color.primitive.neutral.0}" },
          "text.muted": { "$value": "{color.primitive.neutral.300}" }
        },
        "high-contrast": {
          "bg.page": { "$value": "#000000" },
          "bg.surface": { "$value": "#000000" },
          "text.main": { "$value": "#FFFFFF" },
          "text.muted": { "$value": "#FFFFFF" },
          "accent.main": { "$value": "#FFFF00" }
        }
      }
    },
    "typography": {
      "$type": "typography",
      "family": {
        "base": { "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif" }
      },
      "size": {
        "xs": { "$value": "12px" },
        "sm": { "$value": "14px" },
        "md": { "$value": "16px" },
        "lg": { "$value": "20px" },
        "xl": { "$value": "24px" },
        "h1": { "$value": "32px" },
        "h2": { "$value": "24px" },
        "h3": { "$value": "20px" }
      },
      "weight": {
        "regular": { "$value": 400 },
        "semibold": { "$value": 600 },
        "bold": { "$value": 700 }
      },
      "lineHeight": {
        "tight": { "$value": "1.2" },
        "normal": { "$value": "1.4" },
        "loose": { "$value": "1.6" }
      }
    },
    "spacing": {
      "$type": "dimension",
      "scale": {
        "1": { "$value": "4px" },
        "2": { "$value": "8px" },
        "3": { "$value": "12px" },
        "4": { "$value": "16px" },
        "5": { "$value": "24px" },
        "6": { "$value": "32px" }
      }
    },
    "radius": {
      "$type": "dimension",
      "sm": { "$value": "8px" },
      "md": { "$value": "12px" },
      "lg": { "$value": "16px" },
      "pill": { "$value": "999px" }
    },
    "border": {
      "$type": "dimension",
      "thin": { "$value": "1px" },
      "thick": { "$value": "2px" },
      "extra": { "$value": "3px" }
    },
    "shadow": {
      "$type": "shadow",
      "soft": {
        "$value": "0 4px 12px rgba(0,0,0,0.08)"
      },
      "lg": {
        "$value": "0 16px 40px rgba(0,0,0,0.18)"
      }
    },
    "motion": {
      "$type": "duration",
      "fast": { "$value": "150ms" },
      "norm": { "$value": "200ms" },
      "reduced": { "$value": "0ms" }
    },
    "z": {
      "$type": "number",
      "base": { "$value": 1 },
      "dropdown": { "$value": 10 },
      "overlay": { "$value": 100 },
      "modal": { "$value": 1000 },
      "toast": { "$value": 1100 }
    }
  },

  "2_atomic_design_library": {
    "atoms": [
      {
        "name": "Text",
        "variants": [
          "h1",
          "h2",
          "h3",
          "body",
          "caption"
        ],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main",
          "truncate": "boolean"
        },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "variants": [
          "primary",
          "secondary",
          "ghost",
          "danger"
        ],
        "sizes": [
          "sm",
          "md",
          "lg"
        ],
        "states": [
          "default",
          "hover",
          "focus",
          "disabled",
          "loading"
        ],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "ariaLabel": "string?"
        },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "variants": [
          "text",
          "email",
          "password",
          "search",
          "number",
          "otp"
        ],
        "props": {
          "type": "text|email|password|search|number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?"
        },
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string"
        },
        "testIdPattern": "chk-{name}"
      },
      {
        "name": "Radio",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "variants": [
          "default",
          "filter",
          "status"
        ],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "variants": [
          "neutral",
          "ok",
          "warn",
          "err"
        ],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "description": "Label + control + helper + error",
        "parts": [
          "label",
          "control",
          "helper",
          "error"
        ],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "parts": [
          "icon",
          "input",
          "clear"
        ],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "description": "Navegación principal",
        "slots": [
          "logo",
          "primary-links",
          "secondary-actions",
          "user-menu"
        ],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "slots": [
          "section-links",
          "footer-links"
        ],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "description": "Sección hero principal",
        "slots": [
          "eyebrow",
          "title",
          "subtitle",
          "ctas",
          "meta",
          "illustration"
        ],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "description": "Panel hero contextual (disponibilidad, tags)",
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "description": "Lista de elementos con filtros",
        "slots": [
          "filters",
          "results",
          "pagination"
        ],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "slots": [
          "header",
          "body",
          "related"
        ],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "slots": [
          "title",
          "sections",
          "global-errors",
          "actions"
        ],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "slots": [
          "title",
          "fields",
          "actions",
          "secondary-links",
          "legal"
        ],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "slots": [
          "tabs",
          "tab-content",
          "danger-zone"
        ],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "description": "Protección de rutas según sesión",
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "regions": [
          "header",
          "sidebar",
          "main",
          "footer",
          "toasts"
        ],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "regions": [
          "branding",
          "auth-card"
        ],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "regions": [
          "header",
          "sidebar",
          "main"
        ],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "regions": [
          "header",
          "main",
          "related"
        ],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "regions": [
          "header",
          "main",
          "footer"
        ],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "regions": [
          "icon",
          "message",
          "actions"
        ],
        "testIdPattern": "layout-error"
      }
    ]
  },

  "3_screens": {
    "core": {
      "Home": {
        "id": "screen-home",
        "template": "AppShell",
        "role": "home",
        "objetivo": "Comunicar propuesta de valor en 5–8 segundos y dirigir a Proyectos o Contacto.",
        "layout": {
          "desktop": "grid-12: header full; main col-8; HeroPanel col-4; footer full",
          "mobile": "stack: HeroShell → HeroPanel → Highlights → Proof → Footer"
        },
        "secciones": [
          {
            "id": "home-hero",
            "tipo": "HeroShell",
            "componentes": [
              "Text.h1",
              "Text.body",
              "Button.primary",
              "Button.secondary",
              "Chip",
              "MetaBar"
            ],
            "microcopy": {
              "title": "Diseño y código que sí llegan a producción",
              "subtitle": "Portafolio técnico centrado en producto para equipos que necesitan shipping real.",
              "primaryCta": "Ver proyectos",
              "secondaryCta": "Agendar conversación"
            }
          },
          {
            "id": "home-highlights",
            "tipo": "BentoGrid",
            "componentes": [
              "StatCard",
              "CardProyectoDestacado"
            ],
            "microcopy": {
              "title": "Proyectos destacados"
            }
          },
          {
            "id": "home-proof",
            "tipo": "Proof",
            "componentes": [
              "LogoStrip",
              "TestimonialCard"
            ],
            "microcopy": {
              "title": "Confianza y resultados"
            }
          }
        ],
        "ctas": {
          "principal": "Home → List (Proyectos)",
          "secundaria": "Home → Form (Contacto/Agendar)"
        },
        "datos_minimos": [
          "User.name",
          "User.prefs.lang",
          "lista_proyectos_destacados",
          "disponibilidad_actual",
          "stats_resumidas"
        ],
        "estados": {
          "loading": "skeleton hero + skeleton cards",
          "error": "mensajes explícitos + botón Reintentar",
          "empty": "mensaje 'Aún no hay proyectos destacados' + CTA 'Crear primer proyecto'",
          "offline": "banner superior 'Sin conexión' + datos cacheados",
          "success": "toast 'Actualizado' en acciones clave"
        },
        "a11y": {
          "landmarks": [
            "header",
            "main",
            "footer"
          ],
          "tabOrder": [
            "skip-link",
            "navbar",
            "hero-cta-primary",
            "hero-cta-secondary",
            "highlights",
            "proof",
            "footer"
          ]
        }
      },
      "List": {
        "id": "screen-list",
        "role": "list",
        "objetivo": "Permitir explorar proyectos filtrando y encontrando uno relevante rápido.",
        "secciones": [
          {
            "id": "list-filters",
            "tipo": "Filters",
            "componentes": [
              "SearchBar",
              "FilterChips",
              "Select (Sort)"
            ],
            "microcopy": {
              "title": "Explorar proyectos",
              "searchPlaceholder": "Buscar por nombre, tecnología o tipo…"
            }
          },
          {
            "id": "list-results",
            "tipo": "Results",
            "componentes": [
              "ListView",
              "CardProyecto"
            ]
          }
        ],
        "ctas": {
          "principal": "Crear nuevo proyecto",
          "secundaria": "Volver a Home"
        },
        "datos_minimos": [
          "EntityX[] (proyectos)"
        ],
        "estados_universales": true
      },
      "Detail": {
        "id": "screen-detail",
        "role": "detail",
        "objetivo": "Profundizar en un proyecto y tomar decisión (contacto, agendar, compartir).",
        "secciones": [
          {
            "id": "detail-header",
            "tipo": "Header",
            "componentes": [
              "Breadcrumbs",
              "Text.h1",
              "Badge",
              "PrimaryActions"
            ]
          },
          {
            "id": "detail-body",
            "tipo": "Body",
            "componentes": [
              "KeyFacts",
              "Tabs",
              "CodeSnippetPreview",
              "Metrics"
            ]
          },
          {
            "id": "detail-related",
            "tipo": "RelatedList",
            "componentes": [
              "CardProyecto"
            ]
          }
        ],
        "estados_universales": true
      },
      "Form": {
        "id": "screen-form",
        "role": "form",
        "objetivo": "Crear/editar proyectos o enviar solicitud de contacto sin errores.",
        "layout": "FormLayout",
        "secciones": [
          {
            "id": "form-body",
            "tipo": "FormBody",
            "componentes": [
              "Field.title",
              "Field.description",
              "Field.tags",
              "Field.status",
              "Field.links"
            ]
          },
          {
            "id": "form-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary (Guardar cambios)",
              "Button.secondary (Cancelar)"
            ]
          }
        ],
        "schema": "EntityX",
        "estados_universales": true
      },
      "Settings": {
        "id": "screen-settings",
        "role": "settings",
        "objetivo": "Control de preferencias personales.",
        "secciones": [
          {
            "id": "settings-general",
            "tipo": "Preferences",
            "componentes": [
              "Select (Idioma)",
              "Switch (Tema)",
              "Switch (Densidad)"
            ]
          },
          {
            "id": "settings-notifications",
            "tipo": "Notifications",
            "componentes": [
              "Toggle email",
              "Toggle push"
            ]
          }
        ],
        "estados_universales": true
      },
      "Help": {
        "id": "screen-help",
        "role": "help",
        "objetivo": "Responder dudas frecuentes y ofrecer contacto.",
        "secciones": [
          {
            "id": "help-faq",
            "tipo": "FAQ",
            "componentes": [
              "Accordion"
            ]
          },
          {
            "id": "help-contact",
            "tipo": "Contact",
            "componentes": [
              "FormPanel"
            ]
          }
        ],
        "estados_universales": true
      },
      "Offline": {
        "id": "screen-offline",
        "role": "offline",
        "objetivo": "Informar falta de conexión y permitir reintentar.",
        "secciones": [
          {
            "id": "offline-banner",
            "tipo": "Banner",
            "microcopy": {
              "title": "Sin conexión",
              "body": "Revisa tu conexión y vuelve a intentarlo."
            }
          },
          {
            "id": "offline-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary (Reintentar)"
            ]
          }
        ],
        "estados_universales": true
      },
      "Error": {
        "id": "screen-error",
        "role": "error",
        "objetivo": "Explicar error y ofrecer ruta segura.",
        "secciones": [
          {
            "id": "error-404",
            "tipo": "ErrorNotFound",
            "microcopy": {
              "title": "No encontrado",
              "body": "La página que buscas no existe o cambió de lugar.",
              "cta": "Ir al inicio"
            }
          },
          {
            "id": "error-500",
            "tipo": "ErrorServer",
            "microcopy": {
              "title": "Algo salió mal",
              "body": "Hubo un problema inesperado. Intenta de nuevo en unos momentos.",
              "cta": "Volver"
            }
          }
        ],
        "estados_universales": true
      }
    },
    "auth": {
      "Splash": {
        "id": "screen-splash",
        "role": "auth-splash",
        "objetivo": "Verificar sesión y decidir Login vs Home.",
        "secciones": [
          {
            "id": "splash-branding",
            "tipo": "Branding"
          },
          {
            "id": "splash-progress",
            "tipo": "Progress"
          }
        ],
        "datos_minimos": [
          "Session?"
        ]
      },
      "Login": {
        "id": "screen-login",
        "role": "auth-login",
        "objetivo": "Permitir acceso seguro sin fricción.",
        "secciones": [
          {
            "id": "login-form",
            "tipo": "AuthForm",
            "fields": [
              "email",
              "password",
              "remember_me"
            ]
          },
          {
            "id": "login-links",
            "tipo": "AuthLinks",
            "links": [
              "Ir a Registro",
              "Recuperar acceso"
            ]
          }
        ],
        "microcopy": {
          "title": "Iniciar sesión",
          "primaryCta": "Entrar",
          "secondaryCta": "Crear cuenta"
        },
        "estados_universales": true
      },
      "Register": {
        "id": "screen-register",
        "role": "auth-register",
        "objetivo": "Crear cuenta nueva y preparar perfil.",
        "secciones": [
          {
            "id": "register-form",
            "tipo": "AuthForm",
            "fields": [
              "name",
              "email",
              "password",
              "confirm",
              "terms"
            ]
          }
        ],
        "estados_universales": true
      },
      "Recover": {
        "id": "screen-recover",
        "role": "auth-recover",
        "objetivo": "Recuperar acceso sin filtrar existencia de usuarios.",
        "secciones": [
          {
            "id": "recover-request",
            "tipo": "RecoverRequest",
            "fields": [
              "email"
            ]
          },
          {
            "id": "recover-reset",
            "tipo": "RecoverReset",
            "fields": [
              "new_password",
              "confirm_password"
            ]
          }
        ],
        "estados_universales": true
      },
      "MFA": {
        "id": "screen-mfa",
        "role": "auth-mfa",
        "objetivo": "Verificar segundo factor.",
        "secciones": [
          {
            "id": "mfa-otp",
            "tipo": "MFAView",
            "components": [
              "OTPGroup",
              "Button.primary",
              "Link.resend"
            ]
          }
        ],
        "estados_universales": true
      },
      "Profile": {
        "id": "screen-profile",
        "role": "auth-profile",
        "objetivo": "Gestionar datos, preferencias y seguridad.",
        "secciones": [
          {
            "id": "profile-info",
            "tipo": "Tab",
            "title": "Información",
            "fields": [
              "avatar",
              "name",
              "location",
              "email"
            ]
          },
          {
            "id": "profile-preferences",
            "tipo": "Tab",
            "title": "Preferencias",
            "fields": [
              "lang",
              "theme",
              "reduceMotion",
              "notifications"
            ]
          },
          {
            "id": "profile-security",
            "tipo": "Tab",
            "title": "Seguridad",
            "fields": [
              "change_password",
              "mfa_toggle",
              "sessions_list",
              "danger_zone"
            ]
          }
        ],
        "estados_universales": true
      },
      "LogOff": {
        "id": "screen-logoff",
        "role": "auth-logoff",
        "objetivo": "Cerrar sesión de forma segura y redirigir.",
        "secciones": [
          {
            "id": "logoff-confirm",
            "tipo": "Confirm",
            "microcopy": {
              "title": "Cerrar sesión",
              "body": "¿Seguro que quieres cerrar tu sesión en este dispositivo?"
            }
          }
        ],
        "estados_universales": true
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "role": "auth-session-expired",
        "objetivo": "Explicar caducidad de sesión y forzar re-login.",
        "secciones": [
          {
            "id": "session-expired-message",
            "tipo": "Message",
            "microcopy": {
              "title": "Tu sesión expiró",
              "body": "Por seguridad, necesitamos que inicies sesión de nuevo."
            }
          },
          {
            "id": "session-expired-actions",
            "tipo": "Actions",
            "components": [
              "Button.primary (Iniciar sesión de nuevo)"
            ]
          }
        ],
        "estados_universales": true
      }
    }
  },

  "4_flows": {
    "F1_OnboardingAuth": {
      "name": "Onboarding + Auth",
      "steps": [
        "Splash: checar sesión válida",
        "IF sesión válida → Home",
        "ELSE → Login",
        "Login/Register → éxito auth",
        "Opcional MFA → éxito",
        "Home"
      ],
      "success_feedback": "Bienvenida sutil + acceso directo a proyectos."
    },
    "F2_Home_List_Detail": {
      "steps": [
        "Home: entender pitch",
        "Click CTA 'Ver proyectos' → List",
        "List: filtrar/buscar",
        "Seleccionar elemento → Detail",
        "Detail: decidir contacto/compartir"
      ]
    },
    "F3_CRUD_Principal": {
      "steps": [
        "List o Detail: click 'Crear nuevo' o 'Editar'",
        "Form: rellenar campos, validar inline",
        "Submit → loading",
        "Éxito → Detail con toast 'Guardado'",
        "Error → mostrar mensajes claros + retry"
      ]
    },
    "F4_Conversion_Ecommerce_Optional": {
      "steps": [
        "Detail/Pricing: elegir plan",
        "Form pago: datos + validación",
        "Confirmación: recibo + acceso"
      ]
    },
    "F5_Offline_Recovery": {
      "steps": [
        "Detectar offline → mostrar Offline",
        "Intento reconexión",
        "Éxito → restaurar pantalla previa"
      ]
    },
    "F6_Login": {
      "steps": [
        "Login: email+password",
        "Validar credenciales",
        "Si requiere MFA → F9",
        "Éxito → Home/Profile"
      ]
    },
    "F7_Register": {
      "steps": [
        "Register: campos + aceptación términos",
        "Validar reglas de password",
        "Crear cuenta",
        "Enviar email verificación",
        "Redirigir a Login"
      ]
    },
    "F8_Recover": {
      "steps": [
        "Recover: solicitar email",
        "Mostrar mensaje neutro 'Si existe la cuenta…'",
        "Email con enlace",
        "Pantalla reset: nueva password",
        "Confirmación 'Contraseña actualizada'"
      ]
    },
    "F9_MFA": {
      "steps": [
        "MFA: ingresar OTP",
        "Error → mensaje 'Código inválido'",
        "Reenviar OTP",
        "Éxito → Home/Profile"
      ]
    },
    "F10_LogOff": {
      "steps": [
        "Profile/UserMenu: click 'Cerrar sesión'",
        "Confirmación",
        "Revocar tokens en servidor",
        "Redirigir a Splash o Login"
      ]
    },
    "F11_SessionTimeout": {
      "steps": [
        "Detectar expiración → SessionExpired",
        "Mensaje de contexto",
        "Ir a Login reautenticación",
        "Volver a ruta segura (ej. Home)"
      ]
    }
  },

  "5_datos_entidades": {
    "User": {
      "id": "uuid",
      "name": "string",
      "email": "string",
      "avatarUrl": "string?",
      "location": "string?",
      "role": "string?",
      "createdAt": "iso-datetime",
      "prefs": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "notifications": "boolean"
      },
      "security": {
        "mfaEnabled": "boolean",
        "providers": "string[]",
        "lastLogin": "iso-datetime",
        "sessions": "number"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "token": "opaque-string",
      "refresh": "opaque-string",
      "exp": "iso-datetime",
      "device": "user-agent-string",
      "ipHash": "string"
    },
    "EntityX": {
      "id": "uuid",
      "title": "string",
      "description": "string?",
      "status": "active|draft|archived",
      "createdAt": "iso-datetime",
      "updatedAt": "iso-datetime",
      "owner": {
        "id": "uuid",
        "name": "string"
      },
      "tags": "string[]"
    },
    "Preference": {
      "lang": "es-MX",
      "theme": "light|dark|hc",
      "reduceMotion": "boolean",
      "density": "compact|cozy|comfortable"
    },
    "Security": {
      "attempts": "number",
      "lockUntil": "iso-datetime?",
      "lastChange": "iso-datetime"
    }
  },

  "6_accesibilidad_seo_pwa": {
    "accesibilidad": {
      "contraste": {
        "texto_normal": "AA >= 4.5:1",
        "texto_grande": "AA >= 3:1"
      },
      "focus_visible": "mínimo borde 2px con token de border.bold",
      "orden_tab": "header → main → sidebar → footer, respetando lógica visual",
      "landmarks": [
        "header",
        "nav",
        "main",
        "aside",
        "footer"
      ],
      "aria": {
        "aria_live": {
          "notificaciones": "polite",
          "errores_criticos": "assertive"
        },
        "iconos": "aria-label obligatorio si no hay texto visible"
      },
      "color": "no depender solo de color; usar iconos + texto para estados",
      "reduced_motion": "respetar prefers-reduced-motion: desactivar animaciones no esenciales",
      "teclado": [
        "Enter/Space activan botones",
        "Escape cierra modales",
        "Tab/Shift+Tab recorren controles"
      ],
      "skip_links": [
        "Ir al contenido principal"
      ],
      "formularios": "errores descriptivos, aria-describedby ligando mensaje de error con campo"
    },
    "seo": {
      "titles": "H1 único por ruta, < 60 caracteres",
      "meta_description": "< 160 caracteres, única por ruta",
      "open_graph": [
        "og:title",
        "og:description",
        "og:image",
        "og:url"
      ],
      "twitter_card": [
        "twitter:card",
        "twitter:title",
        "twitter:description"
      ],
      "headings": "jerarquía H1 → H2 → H3 sin saltos arbitrarios",
      "urls": [
        "/",
        "/login",
        "/registro",
        "/dashboard",
        "/perfil",
        "/proyectos",
        "/ayuda"
      ],
      "canonical": "una por pantalla pública",
      "structured_data": "JSON-LD schema.org si procede",
      "sitemap": "incluir pantallas públicas",
      "robots": "permitir indexar públicas, bloquear privadas"
    },
    "pwa": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "estrategia": "app_shell",
        "static_cache": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "data_strategy": "network-first con fallback cache",
        "offline_fallback": "/offline"
      },
      "instalabilidad": [
        "HTTPS",
        "manifest válido",
        "service worker registrado"
      ],
      "imagenes": "srcset + sizes + lazy loading"
    }
  },

  "7_seguridad_privacidad_ui": {
    "auth_errores": {
      "mensaje_neutro": "Credenciales inválidas.",
      "recover": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
    },
    "rate_limit": "mostrar mensaje sutil al usuario cuando se alcance el límite, sin detallar razones internas.",
    "lockout": "si la cuenta se bloquea, indicar tiempo restante sin exponer umbrales exactos.",
    "password": {
      "reglas": "mínimo 12 caracteres, mayúsculas, minúsculas, número y símbolo; no incluir nombre ni correo.",
      "meter": "visual, con texto de ayuda accesible."
    },
    "password_visibility": "toggle mostrar/ocultar con aria-pressed.",
    "mfa": "sugerir habilitar MFA desde Profile → Seguridad.",
    "sesiones": "lista de dispositivos activos con opción 'Cerrar sesión en este dispositivo'.",
    "telemetria_privacidad": "consentimiento explícito opt-in, IDs opacos, sin PII innecesaria."
  },

  "8_mocks_hooks_swap": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "latencia_ms": 120,
      "error_rate": 0.03,
      "usuarios_demo": [
        {
          "id": "u-demo",
          "name": "TuNombre",
          "email": "tu@email",
          "prefs": {
            "lang": "es-MX",
            "theme": "light",
            "reduceMotion": false,
            "notifications": true
          }
        }
      ]
    },
    "swap_plan": "usar adapters por proveedor (REST, Firebase, Supabase) detrás de hooks; UI no conoce implementación concreta."
  },

  "9_i18n_microcopy": {
    "idiomas": [
      "es-MX",
      "en-US"
    ],
    "botones": {
      "es-MX": [
        "Ver elementos",
        "Crear nuevo",
        "Guardar cambios",
        "Cancelar",
        "Iniciar sesión",
        "Crear cuenta",
        "Cerrar sesión",
        "Ver detalles",
        "Continuar"
      ],
      "en-US": [
        "View items",
        "Create new",
        "Save changes",
        "Cancel",
        "Sign in",
        "Sign up",
        "Sign out",
        "View details",
        "Continue"
      ]
    },
    "errores": {
      "es-MX": [
        "Credenciales inválidas.",
        "Algo salió mal, intenta de nuevo.",
        "Revisa este campo, falta información.",
        "Código inválido."
      ],
      "en-US": [
        "Invalid credentials.",
        "Something went wrong, please try again.",
        "Check this field, information is missing.",
        "Invalid code."
      ]
    },
    "vacíos": {
      "es-MX": [
        "Sin elementos, crea el primero.",
        "Sin datos para mostrar aquí."
      ],
      "en-US": [
        "No items yet, create the first one.",
        "No data to display here."
      ]
    },
    "confirmaciones": {
      "es-MX": [
        "Guardado.",
        "Acceso concedido.",
        "Email de verificación enviado.",
        "Contraseña actualizada.",
        "Sesión finalizada."
      ],
      "en-US": [
        "Saved.",
        "Access granted.",
        "Verification email sent.",
        "Password updated.",
        "Session ended."
      ]
    }
  },

  "10_eval": {
    "datasets": {
      "golden_cases_min": 16,
      "tipos": [
        "happy_path_auth",
        "errores_login",
        "pantallas_vacías",
        "offline",
        "sesión_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metricas": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": "si json_schema_pass o a11y_checklist_pass caen por debajo de umbral, bloquear release hasta corregir."
  },

  "11_telemetria": {
    "eventos": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_minimo": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "usar IDs opacos; no enviar PII salvo que sea imprescindible y con consentimiento."
  },

  "12_runtime_ssr_ssg_csr": {
    "auth_guard": "protección de rutas tanto en cliente como en servidor (si se usa SSR).",
    "redirecciones": "si sesión expirada o nula en ruta protegida, redirigir a Login o Splash.",
    "prefetch": "rutas críticas (Home, List, Detail) para mejorar UX.",
    "hydration": "no inyectar tokens de acceso en HTML; usarlos sólo en runtime.",
    "code_splitting": [
      "bundle Auth",
      "bundle Home",
      "bundle Dashboard",
      "bundle Settings"
    ],
    "cache": {
      "publicas": "SSG/ISR donde aplique (ej. Home, About)",
      "privadas": "CSR/SSR con caché de datos (SWR/react-query)",
      "headers": "cache-control adecuados para APIs"
    }
  },

  "13_prioridades": {
    "issues_top5": [
      "Estilos sueltos fuera de tokens: riesgo de inconsistencia.",
      "Falta de focus visible en componentes clave.",
      "Demasiadas CTAs con mismo peso visual en una pantalla.",
      "Estados universales incompletos (loading, error, empty, offline, success) en algunas vistas.",
      "Microcopy no unificada ni lista para i18n."
    ],
    "acciones_top5": [
      "Centralizar tokens en DTCG JSON y mapearlos a CSS variables/ThemeProvider.",
      "Añadir estilo de focus visible global y testear navegación por teclado.",
      "Revisar jerarquía visual de CTAs en Home, List y Detail; definir una primaria por pantalla.",
      "Documentar y aplicar patrón de estados universales por pantalla.",
      "Construir glosario y tablas de microcopy e i18n; conectarlo al sistema de traducciones."
    ]
  },

  "14_violations": []
}
Tú dijiste:
lo mas completo con esa base , revisa que tenga lo max semantica posible+}
ChatGPT Plus

Pensó durante 5m 6s

Pensó durante 58s
Va, aquí está la versión “MAX semántica” basada en tu PROMPT_UIUX_E2E_ROOT_v4: contrato completo en JSON, compacto dentro de lo posible pero muy denso.

{
  "spec_version": "PROMPT_UIUX_E2E_ROOT_v4_MAX_SEMANTIC_1",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Sistema UI/UX front-end end-to-end para portfolio/producto, alineado con PROMPT_UIUX_E2E_ROOT_v4.",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Demostrar calidad de diseño + código en menos de 8 segundos",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién es la persona y qué hace",
        "Revisar 2–3 proyectos alineados a sus necesidades",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "ctr_home_to_projects",
        "ctr_home_to_contact",
        "avg_time_on_detail",
        "completion_rate_main_form"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido fit vs rol abierto sin leer demasiado texto."
      },
      {
        "id": "founder-cto",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico y capacidad de llevar cosas a producción."
      }
    ],
    "contexto": {
      "dispositivos": [
        "mobile",
        "desktop"
      ],
      "conectividad": "intermitente",
      "regiones": [
        "México",
        "Latam"
      ],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "router": "React Router / Next Router equivalente",
      "estado": "React hooks + React Query",
      "pwa": true
    },
    "render_order": [
      "design_system",
      "components",
      "screens",
      "flows",
      "data_model",
      "a11y_seo_pwa",
      "security_privacy",
      "mocks_and_swap",
      "i18n",
      "eval_plan",
      "telemetry",
      "runtime",
      "priorities",
      "violations"
    ]
  },
  "design_system": {
    "tokens_dtcg": {
      "$schema": "https://design-tokens.org/schema.json",
      "meta": {
        "name": "UIX_Portfolio_Tokens",
        "version": "1.0.0",
        "source": "PROMPT_UIUX_E2E_ROOT_v4",
        "platforms": [
          "web",
          "ios",
          "android"
        ]
      },
      "color": {
        "$type": "color",
        "primitive": {
          "neutral": {
            "0": {
              "$value": "#FFFFFF"
            },
            "50": {
              "$value": "#F7F7F8"
            },
            "100": {
              "$value": "#E5E5EA"
            },
            "200": {
              "$value": "#D1D1D6"
            },
            "300": {
              "$value": "#B0B0B8"
            },
            "400": {
              "$value": "#8E8E96"
            },
            "500": {
              "$value": "#636366"
            },
            "600": {
              "$value": "#48484A"
            },
            "700": {
              "$value": "#3A3A3C"
            },
            "800": {
              "$value": "#2C2C2E"
            },
            "900": {
              "$value": "#000000"
            }
          },
          "brand": {
            "500": {
              "$value": "#2563EB"
            }
          },
          "accent": {
            "500": {
              "$value": "#EC4899"
            }
          },
          "ok": {
            "500": {
              "$value": "#16A34A"
            }
          },
          "warn": {
            "500": {
              "$value": "#EAB308"
            }
          },
          "err": {
            "500": {
              "$value": "#DC2626"
            }
          }
        },
        "semantic": {
          "bg": {
            "page": {
              "$value": "{color.primitive.neutral.50}"
            },
            "surface": {
              "$value": "{color.primitive.neutral.0}"
            }
          },
          "text": {
            "main": {
              "$value": "{color.primitive.neutral.900}"
            },
            "muted": {
              "$value": "{color.primitive.neutral.500}"
            },
            "inverse": {
              "$value": "{color.primitive.neutral.0}"
            }
          },
          "accent": {
            "main": {
              "$value": "{color.primitive.accent.500}"
            }
          },
          "border": {
            "bold": {
              "$value": "{color.primitive.neutral.300}"
            },
            "subtle": {
              "$value": "{color.primitive.neutral.200}"
            }
          },
          "state": {
            "ok": {
              "$value": "{color.primitive.ok.500}"
            },
            "warn": {
              "$value": "{color.primitive.warn.500}"
            },
            "err": {
              "$value": "{color.primitive.err.500}"
            }
          }
        },
        "theme": {
          "light": {
            "bg.page": {
              "$value": "{color.semantic.bg.page}"
            },
            "bg.surface": {
              "$value": "{color.semantic.bg.surface}"
            },
            "text.main": {
              "$value": "{color.semantic.text.main}"
            },
            "text.muted": {
              "$value": "{color.semantic.text.muted}"
            },
            "accent.main": {
              "$value": "{color.semantic.accent.main}"
            }
          },
          "dark": {
            "bg.page": {
              "$value": "{color.primitive.neutral.900}"
            },
            "bg.surface": {
              "$value": "{color.primitive.neutral.800}"
            },
            "text.main": {
              "$value": "{color.primitive.neutral.0}"
            },
            "text.muted": {
              "$value": "{color.primitive.neutral.300}"
            },
            "accent.main": {
              "$value": "{color.primitive.accent.500}"
            }
          },
          "high-contrast": {
            "bg.page": {
              "$value": "#000000"
            },
            "bg.surface": {
              "$value": "#000000"
            },
            "text.main": {
              "$value": "#FFFFFF"
            },
            "text.muted": {
              "$value": "#FFFFFF"
            },
            "accent.main": {
              "$value": "#FFFF00"
            }
          }
        }
      },
      "typography": {
        "$type": "typography",
        "family": {
          "base": {
            "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
          }
        },
        "size": {
          "xs": {
            "$value": "12px"
          },
          "sm": {
            "$value": "14px"
          },
          "md": {
            "$value": "16px"
          },
          "lg": {
            "$value": "20px"
          },
          "xl": {
            "$value": "24px"
          },
          "h1": {
            "$value": "32px"
          },
          "h2": {
            "$value": "24px"
          },
          "h3": {
            "$value": "20px"
          }
        },
        "weight": {
          "regular": {
            "$value": 400
          },
          "semibold": {
            "$value": 600
          },
          "bold": {
            "$value": 700
          }
        },
        "lineHeight": {
          "tight": {
            "$value": "1.2"
          },
          "normal": {
            "$value": "1.4"
          },
          "loose": {
            "$value": "1.6"
          }
        }
      },
      "spacing": {
        "$type": "dimension",
        "scale": {
          "1": {
            "$value": "4px"
          },
          "2": {
            "$value": "8px"
          },
          "3": {
            "$value": "12px"
          },
          "4": {
            "$value": "16px"
          },
          "5": {
            "$value": "24px"
          },
          "6": {
            "$value": "32px"
          }
        }
      },
      "radius": {
        "$type": "dimension",
        "sm": {
          "$value": "8px"
        },
        "md": {
          "$value": "12px"
        },
        "lg": {
          "$value": "16px"
        },
        "pill": {
          "$value": "999px"
        }
      },
      "border": {
        "$type": "dimension",
        "thin": {
          "$value": "1px"
        },
        "thick": {
          "$value": "2px"
        },
        "extra": {
          "$value": "3px"
        }
      },
      "shadow": {
        "$type": "shadow",
        "soft": {
          "$value": "0 4px 12px rgba(0,0,0,0.08)"
        },
        "lg": {
          "$value": "0 16px 40px rgba(0,0,0,0.18)"
        }
      },
      "motion": {
        "$type": "duration",
        "fast": {
          "$value": "150ms"
        },
        "norm": {
          "$value": "200ms"
        },
        "reduced": {
          "$value": "0ms"
        }
      },
      "z": {
        "$type": "number",
        "base": {
          "$value": 1
        },
        "dropdown": {
          "$value": 10
        },
        "overlay": {
          "$value": 100
        },
        "modal": {
          "$value": 1000
        },
        "toast": {
          "$value": 1100
        }
      }
    }
  },
  "components": {
    "atoms": [
      {
        "name": "Text",
        "semantic_role": "typography",
        "variants": [
          "h1",
          "h2",
          "h3",
          "body",
          "caption"
        ],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err",
          "truncate": "boolean",
          "ariaLabel": "string?"
        },
        "states": [
          "default"
        ],
        "a11y": {
          "h1": "unico_por_pantalla",
          "caption": "no_usar_para_texto_largo"
        },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "semantic_role": "interactive-cta",
        "variants": [
          "primary",
          "secondary",
          "ghost",
          "danger"
        ],
        "sizes": [
          "sm",
          "md",
          "lg"
        ],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "disabled": "boolean",
          "loading": "boolean",
          "ariaLabel": "string?"
        },
        "states": [
          "default",
          "hover",
          "focus",
          "disabled",
          "loading"
        ],
        "tokens": {
          "bg": "brand|neutral|transparent|state.err",
          "radius": "radius.md",
          "shadow": "shadow.soft"
        },
        "a11y": {
          "role": "button",
          "focusVisible": "borde 2px usando color.border.bold",
          "keyboard": "Enter/Space activan acción"
        },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "semantic_role": "form-field",
        "variants": [
          "text",
          "email",
          "password",
          "search",
          "number"
        ],
        "props": {
          "type": "text|email|password|search|number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?",
          "hasError": "boolean"
        },
        "states": [
          "default",
          "focus",
          "error",
          "disabled"
        ],
        "tokens": {
          "border": "border.subtle|border.bold",
          "radius": "radius.sm",
          "shadow": "none"
        },
        "a11y": {
          "role": "textbox",
          "error": "aria-invalid=true cuando hasError"
        },
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "semantic_role": "form-field-multiline",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "hasError": "boolean"
        },
        "states": [
          "default",
          "focus",
          "error",
          "disabled"
        ],
        "tokens": {
          "border": "border.subtle|border.bold",
          "radius": "radius.sm"
        },
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "semantic_role": "binary-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "indeterminate": "boolean?"
        },
        "states": [
          "checked",
          "unchecked",
          "indeterminate",
          "disabled"
        ],
        "a11y": {
          "role": "checkbox",
          "keyboard": "Space alterna estado"
        },
        "testIdPattern": "chk-{label}"
      },
      {
        "name": "Radio",
        "semantic_role": "exclusive-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "states": [
          "checked",
          "unchecked",
          "disabled"
        ],
        "a11y": {
          "role": "radio"
        },
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "semantic_role": "single-select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "states": [
          "default",
          "open",
          "disabled"
        ],
        "a11y": {
          "role": "combobox"
        },
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "semantic_role": "filter-token|status-indicator",
        "variants": [
          "default",
          "filter",
          "status"
        ],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "states": [
          "selected",
          "unselected",
          "disabled"
        ],
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "semantic_role": "status-indicator",
        "variants": [
          "neutral",
          "ok",
          "warn",
          "err"
        ],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "semantic_role": "user-identity",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "states": [
          "default",
          "fallback"
        ],
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "semantic_role": "decorative|informative",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "states": [
          "decorative",
          "informative"
        ],
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "semantic_role": "description",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "states": [
          "closed",
          "open"
        ],
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "semantic_role": "layout-separator",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "semantic_role": "progress-indicator",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "states": [
          "spinning"
        ],
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "semantic_role": "form-field-wrapper",
        "parts": [
          "label",
          "control",
          "helper",
          "error"
        ],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "states": [
          "default",
          "error",
          "disabled"
        ],
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "semantic_role": "search-entry",
        "parts": [
          "icon",
          "input",
          "clear"
        ],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "states": [
          "default",
          "with-query"
        ],
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "semantic_role": "filter-group",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "states": [
          "empty",
          "with-selection"
        ],
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "semantic_role": "metric-display",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "semantic_role": "social-login",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "semantic_role": "mfa-otp-input",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "states": [
          "empty",
          "partial",
          "full"
        ],
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "semantic_role": "user-shortcut-menu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "states": [
          "closed",
          "open"
        ],
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "semantic_role": "ephemeral-feedback",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "states": [
          "visible",
          "hidden"
        ],
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "semantic_role": "primary-navigation",
        "slots": [
          "logo",
          "primary-links",
          "secondary-actions",
          "user-menu"
        ],
        "states": [
          "default",
          "scrolled"
        ],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "semantic_role": "secondary-navigation",
        "slots": [
          "section-links",
          "footer-links"
        ],
        "states": [
          "expanded",
          "collapsed"
        ],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "semantic_role": "page-hero",
        "slots": [
          "eyebrow",
          "title",
          "subtitle",
          "ctas",
          "meta",
          "illustration"
        ],
        "states": [
          "default",
          "compact"
        ],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "semantic_role": "context-panel",
        "slots": [
          "availability",
          "chips",
          "meta"
        ],
        "states": [
          "default"
        ],
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "semantic_role": "collection-display",
        "slots": [
          "filters",
          "results",
          "pagination"
        ],
        "states": [
          "loading",
          "error",
          "empty",
          "success"
        ],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "semantic_role": "entity-detail",
        "slots": [
          "header",
          "body",
          "related"
        ],
        "states": [
          "loading",
          "error",
          "success"
        ],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "semantic_role": "entity-form",
        "slots": [
          "title",
          "sections",
          "global-errors",
          "actions"
        ],
        "states": [
          "editing",
          "submitting",
          "error",
          "success"
        ],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "semantic_role": "auth-form",
        "slots": [
          "title",
          "fields",
          "actions",
          "secondary-links",
          "legal"
        ],
        "states": [
          "idle",
          "submitting",
          "error"
        ],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "semantic_role": "mfa-step",
        "slots": [
          "title",
          "otp",
          "resend",
          "alternate"
        ],
        "states": [
          "idle",
          "submitting",
          "error"
        ],
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "semantic_role": "account-settings",
        "slots": [
          "tabs",
          "tab-content",
          "danger-zone"
        ],
        "states": [
          "view",
          "editing",
          "saving"
        ],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "semantic_role": "route-guard",
        "states": [
          "checking",
          "allowed",
          "blocked"
        ],
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "semantic_role": "app-layout",
        "regions": [
          "header",
          "sidebar",
          "main",
          "footer",
          "toasts"
        ],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "semantic_role": "auth-layout",
        "regions": [
          "branding",
          "auth-card"
        ],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "semantic_role": "dashboard-layout",
        "regions": [
          "header",
          "sidebar",
          "main"
        ],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "semantic_role": "detail-layout",
        "regions": [
          "header",
          "main",
          "related"
        ],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "semantic_role": "form-layout",
        "regions": [
          "header",
          "main",
          "footer"
        ],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "semantic_role": "error-layout",
        "regions": [
          "icon",
          "message",
          "actions"
        ],
        "testIdPattern": "layout-error"
      }
    ]
  },
  "screens": {
    "core": {
      "Home": {
        "id": "screen-home",
        "route": "/",
        "template": "AppShell",
        "rol": "home",
        "objetivo_ux": "Comunicar propuesta de valor en 5–8s y dirigir a Proyectos o Contacto.",
        "layout": {
          "desktop": "grid-12: header full; main col-span-8; HeroPanel col-span-4; footer full",
          "mobile": "stack: HeroShell → HeroPanel → Highlights → Proof → Footer"
        },
        "contrato_datos": {
          "obligatorios": [
            "User.name",
            "User.prefs.lang",
            "proyectos_destacados[]",
            "disponibilidad_actual"
          ],
          "opcionales": [
            "stats_resumidas",
            "testimonios[]",
            "logos_confianza[]"
          ]
        },
        "secciones": [
          {
            "id": "home-hero",
            "tipo": "HeroShell",
            "componentes": [
              "Text.h1",
              "Text.body",
              "Button.primary",
              "Button.secondary",
              "Chip",
              "MetaBar"
            ]
          },
          {
            "id": "home-highlights",
            "tipo": "Highlights",
            "componentes": [
              "BentoGrid",
              "StatCard"
            ]
          },
          {
            "id": "home-proof",
            "tipo": "Proof",
            "componentes": [
              "LogoStrip",
              "TestimonialCard"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargar skeleton de hero y cards.",
            "ui": [
              "Spinner",
              "skeletons"
            ]
          },
          "error": {
            "descripcion": "Error al cargar datos iniciales.",
            "ui": [
              "Alert.error",
              "Button.reintentar"
            ]
          },
          "empty": {
            "descripcion": "No hay proyectos destacados aún.",
            "ui": [
              "EmptyState",
              "Button.primary"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, se muestran datos cacheados.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Datos cargados correctamente.",
            "ui": [
              "HeroShell",
              "Highlights",
              "Proof"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-home')",
          "ctas": [
            {
              "id": "cta-home-view-projects",
              "evento": "click:cta",
              "destino": "/proyectos"
            },
            {
              "id": "cta-home-book-call",
              "evento": "click:cta",
              "destino": "/contacto"
            }
          ]
        },
        "a11y": {
          "landmarks": [
            "header",
            "main",
            "footer"
          ],
          "tab_order": [
            "skip-link",
            "navbar",
            "hero-primary-cta",
            "hero-secondary-cta",
            "highlights",
            "proof",
            "footer"
          ],
          "h1_unico": true
        },
        "seo": {
          "title": "Portafolio técnico – Home",
          "meta_description": "Portafolio técnico centrado en producto: proyectos reales, código en producción y foco en negocio.",
          "og_title": "Portafolio técnico",
          "og_type": "website"
        }
      },
      "List": {
        "id": "screen-list",
        "route": "/proyectos",
        "template": "AppShell",
        "rol": "list",
        "objetivo_ux": "Permitir encontrar un proyecto relevante mediante búsqueda y filtros.",
        "contrato_datos": {
          "obligatorios": [
            "EntityX[]"
          ],
          "opcionales": [
            "filtros_disponibles[]",
            "paginacion"
          ]
        },
        "secciones": [
          {
            "id": "list-filters",
            "tipo": "Filters",
            "componentes": [
              "SearchBar",
              "FilterChips",
              "Select"
            ]
          },
          {
            "id": "list-results",
            "tipo": "Results",
            "componentes": [
              "ListView",
              "CardProyecto"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Se están cargando los proyectos.",
            "ui": [
              "Spinner",
              "skeleton-list"
            ]
          },
          "error": {
            "descripcion": "Error al cargar lista.",
            "ui": [
              "Alert.error",
              "Button.reintentar"
            ]
          },
          "empty": {
            "descripcion": "No hay proyectos.",
            "ui": [
              "EmptyState",
              "Button.primary"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, mostrar datos cacheados si hay.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Proyectos cargados correctamente.",
            "ui": [
              "ListView"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-list')",
          "ctas": [
            {
              "id": "cta-list-create",
              "evento": "click:cta",
              "destino": "/proyectos/nuevo"
            }
          ]
        }
      },
      "Detail": {
        "id": "screen-detail",
        "route": "/proyectos/:id",
        "template": "DetailLayout",
        "rol": "detail",
        "objetivo_ux": "Profundizar en un proyecto y decidir acción (contactar, agendar, compartir).",
        "contrato_datos": {
          "obligatorios": [
            "EntityX",
            "User"
          ],
          "opcionales": [
            "relacionados[]",
            "links_codigo[]",
            "metricas"
          ]
        },
        "secciones": [
          {
            "id": "detail-header",
            "tipo": "Header",
            "componentes": [
              "Breadcrumbs",
              "Text.h1",
              "Badge",
              "PrimaryActions"
            ]
          },
          {
            "id": "detail-body",
            "tipo": "Body",
            "componentes": [
              "KeyFacts",
              "Tabs",
              "CodeSnippetPreview",
              "Metrics"
            ]
          },
          {
            "id": "detail-related",
            "tipo": "RelatedList",
            "componentes": [
              "CardProyecto"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargando detalles de proyecto.",
            "ui": [
              "Spinner",
              "skeleton-detail"
            ]
          },
          "error": {
            "descripcion": "Error al cargar proyecto.",
            "ui": [
              "ErrorLayout"
            ]
          },
          "empty": {
            "descripcion": "No se encontró el proyecto.",
            "ui": [
              "ErrorLayout-404"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, mostrar último estado cacheado.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Detalle completo cargado.",
            "ui": [
              "DetailPanel"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-detail')",
          "ctas": [
            {
              "id": "cta-detail-contact",
              "evento": "click:cta",
              "destino": "/contacto"
            }
          ]
        }
      },
      "Form": {
        "id": "screen-form",
        "route": "/proyectos/nuevo|/proyectos/:id/editar",
        "template": "FormLayout",
        "rol": "form",
        "objetivo_ux": "Crear/editar proyectos con mínima fricción y sin errores silenciosos.",
        "contrato_datos": {
          "obligatorios": [
            "EntityX.schema"
          ],
          "opcionales": [
            "plantillas",
            "tags_sugeridos[]"
          ]
        },
        "secciones": [
          {
            "id": "form-body",
            "tipo": "FormBody",
            "componentes": [
              "Field.title",
              "Field.description",
              "Field.tags",
              "Field.status",
              "Field.links"
            ]
          },
          {
            "id": "form-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary",
              "Button.secondary"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargando datos iniciales (modo edición).",
            "ui": [
              "Spinner"
            ]
          },
          "error": {
            "descripcion": "Error al cargar/guardar.",
            "ui": [
              "Alert.error"
            ]
          },
          "empty": {
            "descripcion": "Formulario en modo creación.",
            "ui": [
              "FormPanel"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, deshabilitar envío y mostrar aviso.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Guardado correcto.",
            "ui": [
              "Toast.success"
            ]
          }
        },
        "eventos": {
          "submit": "form:submit (screen_id='screen-form')"
        }
      },
      "Settings": {
        "id": "screen-settings",
        "route": "/perfil/preferencias",
        "template": "DashboardLayout",
        "rol": "settings",
        "objetivo_ux": "Permitir configurar idioma, tema, densidad y notificaciones.",
        "contrato_datos": {
          "obligatorios": [
            "User.prefs"
          ],
          "opcionales": []
        },
        "estados_universales": true
      },
      "Help": {
        "id": "screen-help",
        "route": "/ayuda",
        "template": "AppShell",
        "rol": "help",
        "objetivo_ux": "Resolver dudas rápidas y ofrecer contacto.",
        "contrato_datos": {
          "obligatorios": [],
          "opcionales": [
            "faq_items[]",
            "contacto_form"
          ]
        },
        "estados_universales": true
      },
      "Offline": {
        "id": "screen-offline",
        "route": "/offline",
        "template": "ErrorLayout",
        "rol": "offline",
        "objetivo_ux": "Explicar falta de conexión y ofrecer reintento.",
        "estados_universales": true
      },
      "Error": {
        "id": "screen-error",
        "route": "/error",
        "template": "ErrorLayout",
        "rol": "error",
        "objetivo_ux": "Explicar errores 404/500 y ofrecer salida segura.",
        "estados_universales": true
      }
    },
    "auth": {
      "Splash": {
        "id": "screen-splash",
        "route": "/splash",
        "template": "AuthLayout",
        "rol": "auth-splash",
        "objetivo_ux": "Detectar sesión y dirigir a Login o Home sin parpadeos.",
        "contrato_datos": {
          "obligatorios": [
            "Session?"
          ],
          "opcionales": []
        },
        "estados": {
          "checking": {
            "descripcion": "Consultando estado de sesión.",
            "ui": [
              "Spinner",
              "Branding"
            ]
          },
          "no_session": {
            "descripcion": "No hay sesión, redirigir a Login.",
            "ui": []
          },
          "has_session": {
            "descripcion": "Sesión válida, redirigir a Home.",
            "ui": []
          }
        }
      },
      "Login": {
        "id": "screen-login",
        "route": "/login",
        "template": "AuthLayout",
        "rol": "auth-login",
        "objetivo_ux": "Permitir acceso seguro con mensajes neutros.",
        "secciones": [
          {
            "id": "login-form",
            "tipo": "AuthForm",
            "fields": [
              "email",
              "password",
              "remember_me"
            ]
          }
        ],
        "estados_universales": true
      },
      "Register": {
        "id": "screen-register",
        "route": "/registro",
        "template": "AuthLayout",
        "rol": "auth-register",
        "objetivo_ux": "Crear cuenta nueva con feedback claro de password.",
        "estados_universales": true
      },
      "Recover": {
        "id": "screen-recover",
        "route": "/recuperar",
        "template": "AuthLayout",
        "rol": "auth-recover",
        "objetivo_ux": "Permitir recuperar acceso sin filtrar existencia de cuenta.",
        "estados_universales": true
      },
      "MFA": {
        "id": "screen-mfa",
        "route": "/mfa",
        "template": "AuthLayout",
        "rol": "auth-mfa",
        "objetivo_ux": "Completar segundo factor de forma rápida.",
        "estados_universales": true
      },
      "Profile": {
        "id": "screen-profile",
        "route": "/perfil",
        "template": "DashboardLayout",
        "rol": "auth-profile",
        "objetivo_ux": "Gestionar datos, preferencias y seguridad personal.",
        "estados_universales": true
      },
      "LogOff": {
        "id": "screen-logoff",
        "route": "/logout",
        "template": "AuthLayout",
        "rol": "auth-logoff",
        "objetivo_ux": "Cerrar sesión de forma explícita y comprensible.",
        "estados_universales": true
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "route": "/session-expired",
        "template": "AuthLayout",
        "rol": "auth-session-expired",
        "objetivo_ux": "Explicar expiración y forzar re-login.",
        "estados_universales": true
      }
    }
  },
  "flows": {
    "F1_OnboardingAuth": {
      "objetivo": "Llevar al usuario desde carga inicial a Home o Login según sesión.",
      "pantallas": [
        "Splash",
        "Login",
        "Home"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Splash",
          "tarea": "Consultar estado de sesión.",
          "entrada": [
            "Session?"
          ],
          "salida": {
            "decision": "has_session|no_session"
          },
          "errores": [
            "timeout_backend",
            "network_error"
          ],
          "recuperacion": [
            "mostrar ErrorLayout o Offline según caso"
          ]
        },
        {
          "orden": 2,
          "condicion": "has_session",
          "accion": "redirigir a Home"
        },
        {
          "orden": 3,
          "condicion": "no_session",
          "accion": "redirigir a Login"
        }
      ],
      "exito": "Usuario aterriza en Home con sesión válida o en Login listo para autenticarse."
    },
    "F2_Home_List_Detail": {
      "objetivo": "Exploración básica del contenido.",
      "pantallas": [
        "Home",
        "List",
        "Detail"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Home",
          "tarea": "Comunicar pitch y ofrecer CTA principal.",
          "entrada": [
            "User",
            "proyectos_destacados[]"
          ],
          "salida": {
            "accion": "click CTA o abandonar"
          },
          "errores": [],
          "recuperacion": []
        },
        {
          "orden": 2,
          "pantalla": "List",
          "tarea": "Permitir buscar/filtrar proyectos.",
          "entrada": [
            "EntityX[]"
          ],
          "salida": {
            "seleccion": "EntityX.id?"
          },
          "errores": [
            "empty_results",
            "network_error"
          ],
          "recuperacion": [
            "mostrar EmptyState",
            "botón reintentar"
          ]
        },
        {
          "orden": 3,
          "pantalla": "Detail",
          "tarea": "Profundizar y decidir acción.",
          "entrada": [
            "User",
            "EntityX"
          ],
          "salida": {
            "accion": "contactar|compartir|volver"
          },
          "errores": [
            "not_found",
            "network_error"
          ],
          "recuperacion": [
            "Error 404",
            "botón Volver a lista"
          ]
        }
      ],
      "exito": "Usuario encuentra un proyecto relevante y sabe cómo avanzar."
    },
    "F3_CRUD_Principal": {
      "objetivo": "Crear o editar entidad principal sin errores.",
      "pantallas": [
        "List",
        "Detail",
        "Form"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "List|Detail",
          "tarea": "Iniciar acción de crear/editar.",
          "entrada": [],
          "salida": {
            "accion": "navegar a Form"
          }
        },
        {
          "orden": 2,
          "pantalla": "Form",
          "tarea": "Rellenar campos con validación.",
          "entrada": [
            "EntityX.schema"
          ],
          "salida": {
            "estado": "listo_para_submit"
          },
          "errores": [
            "errores_validacion"
          ],
          "recuperacion": [
            "marcar campos",
            "mensajes de error claros"
          ]
        },
        {
          "orden": 3,
          "pantalla": "Form",
          "tarea": "Enviar formulario.",
          "entrada": [
            "EntityX.payload"
          ],
          "salida": {
            "estado": "success|error"
          },
          "errores": [
            "network_error",
            "server_error"
          ],
          "recuperacion": [
            "toast error",
            "retry"
          ]
        },
        {
          "orden": 4,
          "condicion": "success",
          "accion": "redirigir a Detail y mostrar toast 'Guardado'"
        }
      ],
      "exito": "Entidad creada/actualizada y visible en Detail."
    },
    "F4_Conversion_Ecommerce_Optional": {
      "objetivo": "Flujo de compra o selección de plan (opcional).",
      "pantallas": [
        "Detail",
        "Form",
        "Confirmacion"
      ],
      "pasos": [],
      "exito": "Pago completado y acceso al servicio."
    },
    "F5_Offline_Recovery": {
      "objetivo": "Mantener UX coherente en modo offline.",
      "pantallas": [
        "Offline",
        "previa"
      ],
      "pasos": [
        {
          "orden": 1,
          "tarea": "Detectar desconexión y mostrar pantalla/estado Offline.",
          "entrada": {
            "network_status": "offline"
          },
          "salida": {
            "screen": "Offline"
          }
        },
        {
          "orden": 2,
          "tarea": "Ofrecer reintento y/o seguir navegando contenido cacheado.",
          "entrada": {},
          "salida": {
            "network_status": "online?"
          },
          "errores": [],
          "recuperacion": []
        }
      ],
      "exito": "Usuario entiende el estado y puede recuperar operación al volver la conexión."
    },
    "F6_Login": {
      "objetivo": "Autenticar usuario o explicar por qué no se puede.",
      "pantallas": [
        "Login",
        "MFA",
        "Home"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Login",
          "tarea": "Capturar email y contraseña.",
          "entrada": [],
          "salida": {
            "credenciales": "email+password"
          },
          "errores": [
            "validacion_basica"
          ],
          "recuperacion": [
            "marcar campos",
            "mensajes claros"
          ]
        },
        {
          "orden": 2,
          "pantalla": "Login",
          "tarea": "Enviar credenciales.",
          "entrada": {
            "credenciales": "validas"
          },
          "salida": {
            "estado": "ok|mfa|required|error"
          },
          "errores": [
            "Credenciales inválidas"
          ],
          "recuperacion": [
            "mensaje neutro 'Credenciales inválidas.'"
          ]
        },
        {
          "orden": 3,
          "condicion": "mfa|required",
          "accion": "redirigir a MFA"
        },
        {
          "orden": 4,
          "condicion": "ok",
          "accion": "redirigir a Home o Profile"
        }
      ],
      "exito": "Inicio de sesión exitoso con feedback adecuado."
    },
    "F7_Register": {
      "objetivo": "Crear una cuenta nueva correctamente.",
      "pantallas": [
        "Register",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario con cuenta creada, listo para iniciar sesión."
    },
    "F8_Recover": {
      "objetivo": "Recuperar acceso sin filtrar si existe la cuenta.",
      "pantallas": [
        "Recover",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario restaura contraseña y puede iniciar sesión."
    },
    "F9_MFA": {
      "objetivo": "Completar segundo factor.",
      "pantallas": [
        "MFA",
        "Home"
      ],
      "pasos": [],
      "exito": "Seguridad extra sin fricción excesiva."
    },
    "F10_LogOff": {
      "objetivo": "Cerrar sesión de manera explícita.",
      "pantallas": [
        "Profile",
        "LogOff",
        "Splash|Login"
      ],
      "pasos": [],
      "exito": "Sesión invalidada, usuario en pantalla segura."
    },
    "F11_SessionTimeout": {
      "objetivo": "Gestionar expiración de sesión sin confusión.",
      "pantallas": [
        "SessionExpired",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario entiende que su sesión caducó y vuelve a autenticarse."
    }
  },
  "data_model": {
    "User": {
      "description": "Entidad usuario final.",
      "fields": {
        "id": "uuid",
        "name": "string",
        "email": "string",
        "avatarUrl": "string?",
        "location": "string?",
        "role": "string?",
        "createdAt": "iso-datetime",
        "prefs": {
          "lang": "es-MX",
          "theme": "light|dark|hc",
          "reduceMotion": "boolean",
          "notifications": "boolean"
        },
        "security": {
          "mfaEnabled": "boolean",
          "providers": "string[]",
          "lastLogin": "iso-datetime",
          "sessions": "number"
        }
      }
    },
    "Session": {
      "description": "Sesión autenticada.",
      "fields": {
        "id": "string",
        "userId": "string",
        "token": "opaque-string",
        "refresh": "opaque-string",
        "exp": "iso-datetime",
        "device": "user-agent-string",
        "ipHash": "string"
      }
    },
    "EntityX": {
      "description": "Entidad genérica de proyecto/case study.",
      "fields": {
        "id": "uuid",
        "title": "string",
        "description": "string?",
        "status": "active|draft|archived",
        "createdAt": "iso-datetime",
        "updatedAt": "iso-datetime",
        "owner": {
          "id": "uuid",
          "name": "string"
        },
        "tags": "string[]"
      }
    },
    "Preference": {
      "description": "Preferencias visuales y de idioma.",
      "fields": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "density": "compact|cozy|comfortable"
      }
    },
    "Security": {
      "description": "Estado de seguridad de la cuenta.",
      "fields": {
        "attempts": "number",
        "lockUntil": "iso-datetime?",
        "lastChange": "iso-datetime"
      }
    }
  },
  "a11y_seo_pwa": {
    "accesibilidad": {
      "contraste": {
        "texto_normal_AA": ">= 4.5:1",
        "texto_grande_AA": ">= 3:1"
      },
      "focus_visible": {
        "minimo": "borde 2px",
        "token_color": "color.semantic.border.bold"
      },
      "orden_tab": "header → nav → main → aside → footer según layout.",
      "landmarks": [
        "header",
        "nav",
        "main",
        "aside",
        "footer"
      ],
      "aria": {
        "aria_live": {
          "notificaciones": "polite",
          "errores_criticos": "assertive"
        },
        "iconos_sin_texto": "aria-label obligatorio."
      },
      "color_no_unico_canal": true,
      "prefers_reduced_motion": "desactivar animaciones no esenciales.",
      "teclado": {
        "enter_space": "activan botones",
        "escape": "cierra modales",
        "tab": "recorre controles en orden lógico"
      },
      "skip_links": [
        "Ir al contenido principal"
      ],
      "formularios": "usar aria-describedby para vincular mensajes de error al campo."
    },
    "seo": {
      "rules": [
        "Un H1 por ruta.",
        "Title < 60 caracteres.",
        "Meta description < 160 caracteres.",
        "URLs semánticas.",
        "Canonical por pantalla pública."
      ],
      "open_graph": [
        "og:title",
        "og:description",
        "og:image",
        "og:url"
      ],
      "twitter_card": [
        "twitter:card",
        "twitter:title",
        "twitter:description"
      ],
      "structured_data": "usar schema.org para persona/organization/proyecto si aplica."
    },
    "pwa": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "strategy": "app_shell",
        "precache_routes": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "data_strategy": "network-first con fallback a cache para datos no sensibles",
        "offline_fallback": "/offline"
      },
      "instalabilidad": [
        "HTTPS",
        "manifest válido",
        "service worker activo"
      ],
      "imagenes": "usar srcset, sizes y lazy loading."
    }
  },
  "security_privacy": {
    "mensajes_auth": {
      "login_error_neutro": "Credenciales inválidas.",
      "recover_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
    },
    "rate_limit": "mostrar mensaje genérico de demasiados intentos, sin detalles técnicos.",
    "lockout": "indicar tiempo aproximado hasta poder reintentar, sin exponer umbral exacto.",
    "password": {
      "reglas": "mínimo 12 caracteres, mayúsculas, minúsculas, número y símbolo; no incluir nombre ni correo.",
      "meter": "indicador visual con texto accesible que explique qué falta."
    },
    "password_visibility": "toggle mostrar/ocultar con aria-pressed y label claro.",
    "mfa": "promocionar activación desde Profile.Seguridad.",
    "sesiones_activas": "lista de dispositivos con opción 'Cerrar sesión en este dispositivo'.",
    "telemetria_privacidad": "usar IDs opacos, respetar consentimiento y minimizar PII."
  },
  "mocks_and_swap": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "latencia_ms": 120,
      "error_rate": 0.03,
      "demo_user": {
        "id": "u-demo",
        "name": "TuNombre",
        "email": "tu@email",
        "prefs": {
          "lang": "es-MX",
          "theme": "light",
          "reduceMotion": false,
          "notifications": true
        }
      }
    },
    "swap_plan": "usar adapters REST/Firebase/Supabase detrás de hooks; UI no se acopla a proveedor."
  },
  "i18n": {
    "idiomas": [
      "es-MX",
      "en-US"
    ],
    "glosario": {
      "Home": {
        "es-MX": "Inicio",
        "en-US": "Home"
      },
      "List": {
        "es-MX": "Lista",
        "en-US": "List"
      },
      "Detail": {
        "es-MX": "Detalle",
        "en-US": "Detail"
      },
      "Save": {
        "es-MX": "Guardar",
        "en-US": "Save"
      }
    },
    "botones": {
      "es-MX": [
        "Ver elementos",
        "Crear nuevo",
        "Guardar cambios",
        "Cancelar",
        "Iniciar sesión",
        "Crear cuenta",
        "Cerrar sesión",
        "Ver detalles",
        "Continuar"
      ],
      "en-US": [
        "View items",
        "Create new",
        "Save changes",
        "Cancel",
        "Sign in",
        "Sign up",
        "Sign out",
        "View details",
        "Continue"
      ]
    },
    "errores": {
      "es-MX": [
        "Credenciales inválidas.",
        "Algo salió mal, intenta de nuevo.",
        "Revisa este campo, falta información.",
        "Código inválido."
      ],
      "en-US": [
        "Invalid credentials.",
        "Something went wrong, please try again.",
        "Check this field, information is missing.",
        "Invalid code."
      ]
    },
    "vacios": {
      "es-MX": [
        "Sin elementos, crea el primero.",
        "Sin datos para mostrar aquí."
      ],
      "en-US": [
        "No items yet, create the first one.",
        "No data to display here."
      ]
    },
    "confirmaciones": {
      "es-MX": [
        "Guardado.",
        "Acceso concedido.",
        "Email de verificación enviado.",
        "Contraseña actualizada.",
        "Sesión finalizada."
      ],
      "en-US": [
        "Saved.",
        "Access granted.",
        "Verification email sent.",
        "Password updated.",
        "Session ended."
      ]
    }
  },
  "eval_plan": {
    "datasets": {
      "golden_cases_min": 16,
      "tipos": [
        "happy_path_auth",
        "errores_login",
        "pantallas_vacias",
        "offline",
        "sesion_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metricas": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": "si json_schema_pass o a11y_checklist_pass < umbral, bloquear release hasta corregir."
  },
  "telemetry": {
    "eventos": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_minimo": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "usar IDs opacos y no incluir PII salvo que sea estrictamente necesario."
  },
  "runtime": {
    "auth_guard": "proteger rutas en cliente y servidor (si SSR) según Session.",
    "redirecciones": "si ruta protegida y no hay sesión, redirigir a Login o Splash.",
    "prefetch": "prefetch de Home, List, Detail tras login.",
    "hydration": "no exponer tokens de acceso en HTML; usarlos solo en llamadas de cliente.",
    "code_splitting": [
      "chunk-auth",
      "chunk-home",
      "chunk-dashboard",
      "chunk-settings"
    ],
    "cache": {
      "publicas": "SSG/ISR",
      "privadas": "CSR/SSR con SWR/react-query",
      "headers_api": "cache-control configurado por endpoint"
    }
  },
  "priorities": {
    "issues_top5": [
      "Estilos definidos fuera de tokens DTCG generan inconsistencia.",
      "Falta de focus visible en algunos componentes interactivos.",
      "CTAs con mismo peso visual compiten en pantallas clave.",
      "Estados universales incompletos en ciertas vistas.",
      "Microcopy no unificada ni lista para i18n."
    ],
    "acciones_top5": [
      "Centralizar tokens visuales en DTCG y mapearlos a theme CSS.",
      "Configurar focus visible global y testear navegación por teclado.",
      "Revisar jerarquía de CTAs en Home, List y Detail; definir una primaria por pantalla.",
      "Definir patrón uniforme de estados (loading, error, empty, offline, success) por pantalla.",
      "Construir glosario + tablas de microcopy y conectarlas al sistema de traducciones."
    ]
  },
  "violations": []
}
Esto ya es prácticamente un “contrato semántico” completo: si a esto le conectas tu runtime (React/Next + hooks + SWR/query), ya tienes todo lo necesario para generar componentes, rutas, flujos, tests, tracking y hasta checklists de accesibilidad desde un solo artefacto.

Tú dijiste:

Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1

# ─────────────────────────────────────
# META
# ─────────────────────────────────────
META{
  ENC:"UTF-8"; LANG:"es-MX";
  STYLE:"conciso"; DENSIDAD:"alta";
  OUTPUT:"markdown+json"; PRIVACY:"no_chain_of_thought";
}

FLAGS{
  STRUCTURED_OUTPUT:"preferido"; JSON_SCHEMA:"estricto"; FALLBACK_MD:"on";
  CONTEXT_ENGINEERING:"on"; RAG:"opt"; AGENTIC_ROLES:"planner,researcher,writer,verifier";
  A11Y:"WCAG2.1_AA"; SEO:"on"; PWA:"on"; I18N:"on"; SSR_SSG:"opt";
  SECURITY:"on"; PRIVACY:"on"; EVAL:"on"; TELEMETRÍA:"on";
}

# ─────────────────────────────────────
# INPUTS (a rellenar por el usuario)
# ─────────────────────────────────────
INPUTS{
  PRODUCTO{
    nombre:"<string>",
    tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Otro>",
    público:"<B2B|B2C|Mixto>",
    objetivo_negocio:["<...>"],
    objetivo_usuario:["<...>"],
    KPI:["<activación|retención|conversión|NPS|...>"]
  };

  USUARIOS{
    perfiles:[
      {rol:"<recruiter|cliente|admin|usuario final>", nivel:"<bajo|medio|alto>", motivación:"<...>"}
    ];
  };

  CONTEXTO{
    dispositivos:["mobile","desktop"],
    conectividad:"<intermitente|estable>",
    regiones:["<...>"],
    idioma_base:"es-MX"
  };

  STACK_HINT{
    runtime:"<CSR|SSR|SSG>",
    framework:"<React|Vue|Svelte|Next|Nuxt|Otro>",
    estado_app:"<hooks|zustand|redux|query|otro>"
  };
}

# ─────────────────────────────────────
# CONTRATO DE SALIDA (qué debe generar el LLM)
# ─────────────────────────────────────
CONTRATO_SALIDA{
  I.DESIGN_SYSTEM{ TOKENS:DTCG_JSON; THEMES:["light","dark","high-contrast"]; }
  II.ATOMIC_LIBRARY{ atoms,molecules,organisms,templates → props,variantes,estados,testIds; }
  III.SCREENS{
    lista:[
      # Core producto
      "Home","List","Detail","Form","Settings","Help","Offline","Error",
      # Auth pack
      "Splash","Login","Register","Recover","MFA(opc)","Profile","LogOff","SessionExpired"
    ];
    contrato_por_pantalla(SCREEN_SCHEMA);
  }
  IV.FLOWS{
    lista:[
      "F1_Onboarding/Auth","F2_Home→List→Detail","F3_CRUD_Principal",
      "F4_Conversión(opc)","F5_Offline_Recovery",
      "F6_Login","F7_Register","F8_Recover","F9_MFA(opc)","F10_LogOff","F11_SessionTimeout"
    ];
    formato(FLOW_SCHEMA);
  }
  V.DATOS{
    ENTIDADES:{ User,Session,EntityX,Preference,Security };
    contratos_por_pantalla(datos_minimos,opc,estados);
  }
  VI.A11Y_SEO_PWA{ reglas_mínimas_verificables; }
  VII.SECURITY_PRIVACY{ reglas_UI_auth+datos; }
  VIII.MOCKS{ fixtures,factories,hooks_mock; swap_plan("API|Firebase|Firestore"); }
  IX.I18N_UX_COPY{ glosario, claves, tablas_microcopy; }
  X.EVAL{ golden_set, métricas, umbrales, gates_regresión; }
  XI.TELEMETRÍA{ eventos, payload_min, privacidad; }
  XII.SSR_SSG_ADAPT{ guías concretas; }
  XIII.PRIORIDADES{ top5_issues, top5_acciones; }
}

# ─────────────────────────────────────
# SCHEMAS
# ─────────────────────────────────────
SCHEMAS{

  TOKENS_DTCG_JSON{
    color:{
      primitive:{
        "neutral-0":"#FFFFFF",
        "neutral-50":"#F7F7F8",
        "neutral-900":"#050509",
        "brand-500":"#3366FF",
        "accent-500":"#FF7AE0",
        "ok-500":"#22C55E",
        "warn-500":"#FFC857",
        "err-500":"#FF4B4B"
      },
      semantic:{
        "bg.page":"{color.primitive.neutral-0}",
        "bg.surface":"{color.primitive.neutral-0}",
        "bg.surface-alt":"{color.primitive.neutral-50}",
        "text.main":"{color.primitive.neutral-900}",
        "text.muted":"rgba(15,23,42,.6)",
        "accent.main":"{color.primitive.brand-500}",
        "border.bold":"{color.primitive.neutral-900}",
        "state.ok":"{color.primitive.ok-500}",
        "state.warn":"{color.primitive.warn-500}",
        "state.err":"{color.primitive.err-500}"
      }
    },
    type:{
      "family.base":"system-ui, -apple-system, Segoe UI, Inter, Roboto, sans-serif",
      size:{ xs:"12px", sm:"14px", md:"16px", lg:"20px", xl:"24px", h1:"32px", h2:"24px", h3:"20px" },
      weight:{ reg:400, semib:600, bold:700 },
      line:{ tight:"120%", normal:"140%", loose:"160%" }
    },
    space:{ 1:"4px",2:"8px",3:"12px",4:"16px",5:"24px",6:"32px" },
    radius:{ sm:"8px", md:"12px", lg:"16px", pill:"999px" },
    border:{ thin:"1px", thick:"2px", extra:"3px" },
    shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)", lg:"0 12px 32px rgba(15,23,42,.18)" },
    motion:{ fast:"150ms", norm:"200ms", reduced:"0ms" },
    z:{ base:1, dropdown:10, overlay:100, modal:1000, toast:1100 }
  }

  THEMING{
    light:":root ← TOKENS_DTCG_JSON.semantic";
    dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
    hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
  }

  SCREEN_SCHEMA{
    id, nombre, rol, objetivoUX[≤3],
    layout_desktop{grid_12, regiones:[header?,main,sidebar?,footer?]},
    layout_mobile{orden_stack:[...], colapsos:[...]},
    secciones[{nombre, propósito, componentes(organisms|molecules)}],
    ctas_principales[{label,accion}], ctas_secundarias[],
    datos_minimos[], datos_opcionales[],
    estados:{loading,error,empty,offline,success},
    a11y:{landmarks,tab_order,focus_visible:"≥2px",aria_roles[]},
    microcopy:{titular,sub,botones[],errores[],vacios[],confirmaciones[]}
  }

  FLOW_SCHEMA{
    id, nombre,
    pasos[
      {pantalla, tarea, entrada?, salida?, estado?, error?{mensaje,recuperación}}
    ],
    ramificaciones[{condición, destino}],
    éxito{definición, feedback}
  }

  ENTITY.User{
    id:"string|uuid",
    name:"string",
    email:"string",
    avatarUrl?:"string",
    location?:"string",
    role?:"string",
    createdAt:"iso",
    prefs:{lang:"es-MX", theme:"light|dark|hc", reduceMotion:"bool", notifications:"bool"},
    security:{mfaEnabled:"bool", providers:["password|oauth"], lastLogin:"iso", sessions:int}
  }

  ENTITY.Session{
    id:"string", userId:"string",
    token:"opaque", refresh:"opaque",
    exp:"iso", device:"agent", ipHash:"string"
  }

  ENTITY.EntityX{
    id:"string|uuid",
    title:"string",
    description:"string?",
    status:"active|draft|archived",
    createdAt:"iso",
    updatedAt:"iso",
    owner:{id:"string",name:"string"},
    tags:["string"]
  }

  ENTITY.Preference{
    lang:"es-MX",
    theme:"light|dark|hc",
    reduceMotion:"bool",
    density:"compact|cozy|comfortable"
  }

  ENTITY.Security{
    attempts:int,
    lockUntil?:"iso",
    lastChange:"iso"
  }

  MOCK_HOOK_SCHEMA{
    nombre, entidad, shape_JSON, lat_ms, error_rate, swap_plan:"API|Firebase|Firestore"
  }

  EVAL_SCHEMA{
    datasets:{golden:[≥16 casos incluyendo empty/error/offline/timeout/mfa/CRUD]},
    metrics:["json_schema_pass","hallucination↓","groundedness(si_RAG)","readability","a11y_checklist_pass"],
    umbrales:{json_schema_pass≥0.98, a11y_checklist_pass≥0.95, groundedness≥0.9},
    gates:{regresión:true}
  }

  TELEMETRY_SCHEMA{
    eventos_core:[
      "view:screen","click:cta","form:submit","error:ui",
      "net:offline","net:online",
      "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
      "auth:register:start","auth:register:success",
      "auth:recover:start","auth:recover:success",
      "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
    ],
    payload_min:{screen_id, cta_id?, entity_id?, user_id?, method?, error_code?, ts_iso}
  }
}

# ─────────────────────────────────────
# PIPELINE (α…ε)
# ─────────────────────────────────────
PIPELINE (α…ε){
  α.CONTEXT_PLAN{
    filtrar_contexto_relevante;
    rank_score=0.5*autoridad+0.3*recencia+0.2*task_fit;
    comprimir_resumen_denso;
    dedup_semántico;
  }

  β.GENERACIÓN{
    modo_salida="STRUCTURED_OUTPUT|JSON"; si_no_soportado→"Markdown con bloques JSON válidos";
    roles_logicos:"planner→researcher→writer→verifier" (simulados si 1 LLM);
  }

  γ.VALIDACIÓN{
    validar_JSON_vs_SCHEMAS;
    checar_A11Y(contrasteAA, focus_visible, roles, aria_live);
    checar_SECURITY(auth_mensajes_neutros, no_enumerar_usuarios, lockout_visual);
    checar_SEO_min(título/meta por ruta);
    checar_PWA(manifest+SW+offline_fallback);
  }

  δ.CORRECCIÓN{
    si_falla_validación→reintento_max=2_con_diff_min;
    registrar_diffs_en_nodo_MetaViolations;
  }

  ε.PAQUETE{
    seguir_RENDER_ORDER;
    incluir_checklist_DoD;
  }
}

# ─────────────────────────────────────
# RENDER_ORDER
# ─────────────────────────────────────
RENDER_ORDER{
  1)TOKENS(DTCG_JSON+THEMING);
  2)ATOMIC_LIBRARY(tabla:nivel→componentes→props/variantes→testIds);
  3)SCREENS(instancias SCREEN_SCHEMA);
  4)FLOWS(F1..F11 instancias FLOW_SCHEMA);
  5)A11Y_SEO_PWA(listas verificables);
  6)SECURITY_PRIVACY(reglas);
  7)MOCKS(hooks+fixtures+swap_plan);
  8)I18N_UX_COPY(glosario+tablas);
  9)EVAL(datasets+metrics+umbrales+gates);
  10)TELEMETRÍA(eventos+payload_min);
  11)SSR_SSG_ADAPT(guías concisas);
  12)PRIORIDADES(top5_issues/top5_acciones);
}

# ─────────────────────────────────────
# REGLAS GLOBALES (R₁…R₉)
# ─────────────────────────────────────
REGLAS{
  R1:no_duplicidad_semántica_en_nombres;
  R2:todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes;
  R3:estados_universales_definidos_en_cada_pantalla:{loading,error,empty,offline,success};
  R4:microcopy_consistente_e_i18n_ready;
  R5:contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion;
  R6:auth_errores_neutros("Credenciales inválidas"); no_enumerar_usuarios_en_recover;
  R7:no_exponer_razonamiento_interno; nada_de_COT_en_salida;
  R8:si_RAG_on→citar_fuentes; si_no→no_inventar_citas;
  R9:reportar_violaciones_en_bloque_"Violations" si las hay.
}

# ─────────────────────────────────────
# INFERENCIAS POR DEFECTO (fallbacks)
# ─────────────────────────────────────
INFERENCIAS_DEFECTO{
  User:{name:"<TuNombre>", email:"<tu@email>",
        prefs:{lang:"es-MX",theme:"light",reduceMotion:false,notifications:true}};
  EntityX:{title:"Ejemplo de ítem", status:"active"};
  Home_titular:"Propuesta de valor en 5–8 palabras";
  ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
  ESTADOS_UNIVERSALES:{loading:"skeleton",error:"mensaje+retry",empty:"mensaje+CTA",offline:"banner+fallback",success:"toast"};
}

# ─────────────────────────────────────
# LIBRERÍA ATÓMICA (resumen)
# ─────────────────────────────────────
ATOMIC_LIBRARY{
  atoms:[
    "Text(H1,H2,H3,body,caption)",
    "Button{variant:primary|secondary|ghost|danger,size:sm|md|lg,state:default|hover|focus|disabled|loading}",
    "Input{type:text|email|password|search|number|otp}",
    "Textarea","Checkbox","Radio","Select","Chip/Badge","Avatar","Icon24","TooltipTrigger","Divider","Spinner"
  ];
  molecules:[
    "Field{label+input+helper+error}",
    "SearchBar{input+icon}",
    "FilterChipsGroup",
    "StatCard{value+label}",
    "OAuthButtons",
    "OTPGroup(6 slots)",
    "UserMenu",
    "Toast"
  ];
  organisms:[
    "NavBar","SideNav|NavRail","HeroShell","HeroPanel",
    "ListView{items+filters+paginación|infiniteScroll}",
    "DetailPanel{header+body+related}",
    "FormPanel{secciones+errores_globales}",
    "AuthForm(Login|Register|Recover)",
    "MFAView",
    "ProfilePanel{tabs:Info|Prefs|Seguridad|Sesiones}",
    "SessionGuard"
  ];
  templates:[
    "AppShell{header+main+sidebar?+footer}",
    "AuthLayout",
    "DashboardLayout",
    "DetailLayout",
    "FormLayout",
    "ErrorLayout"
  ];
}

# ─────────────────────────────────────
# PANTALLAS CORE (Home/List/Detail/Form/Settings/Help/Offline/Error)
# ─────────────────────────────────────
SCREEN_HOME (SCREEN_SCHEMA){
  id:"P1"; nombre:"Home"; rol:"inicio/portada";
  objetivoUX:["comunicar_valor","dirigir_a_acción_principal","mostrar_contexto_clave"];
  layout_desktop:{grid_12, regiones:["header","main(HeroShell)","sidebar(HeroPanel opc)","footer"]};
  layout_mobile:{orden_stack:["HeroShell","HeroPanel","Highlights"]};
  secciones:[
    {nombre:"HeroShell", propósito:"pitch_≤5s",
     componentes:["HeroAvailabilityRow","HeroTitleBlock","CTAGroup","MetaBar"]},
    {nombre:"Highlights", propósito:"acceso_rápido",
     componentes:["BentoGrid","StatCards"]},
    {nombre:"Proof/Evidencia", propósito:"credibilidad",
     componentes:["ListPreview|Carousel"]}
  ];
  ctas_principales:[{label:"CTA_Principal",accion:"→List|Detalle_clave"}];
  ctas_secundarias:[{label:"CTA_Secundaria",accion:"→otra_sección"}];
  datos_minimos:["profile","availability","stats[]","shortcuts?","highlights?"];
  estados:ESTADOS_UNIVERSALES;
  a11y:{landmarks:["header","main","footer"],tab_order:"availability→CTAs→shortcuts→proof"};
  microcopy:{
    titular:"Propuesta de valor clara",
    sub:"Qué haces y para quién en una frase",
    botones:["Ver elementos","Agendar conversación"],
    errores:[],
    vacíos:["Aún no hay elementos destacados. Agrega tus primeros contenidos."],
    confirmaciones:["Listo, se guardó tu información."]
  };
}

SCREEN_LIST (SCREEN_SCHEMA){
  id:"P2"; nombre:"List"; rol:"explorar/buscar";
  objetivoUX:["encontrar","filtrar","navegar_detalle"];
  layout_desktop:{grid_12,regiones:["header","filters","results","footer"]};
  layout_mobile:{orden_stack:["filters","results"]};
  secciones:[
    {nombre:"Filters",propósito:"reducir_búsqueda",componentes:["SearchBar","FilterChipsGroup","SortSelect"]},
    {nombre:"Results",propósito:"explorar",componentes:["Cards|Rows","EmptyState","Pagination|InfiniteScroll"]}
  ];
  ctas_principales:[{label:"Crear nuevo",accion:"→Form"}];
  datos_minimos:["EntityX[]"], estados:ESTADOS_UNIVERSALES;
  a11y:{landmarks:["main","region(results)"],aria_roles:["list","listitem"]};
  microcopy:{
    titular:"Explorar",
    vacíos:["Aún no hay elementos. Crea el primero."],
    errores:["No pudimos cargar la lista. Intenta de nuevo."]
  };
}

SCREEN_DETAIL (SCREEN_SCHEMA){
  id:"P3"; nombre:"Detail"; rol:"comprender_tomar_decisión";
  objetivoUX:["entender","actuar"];
  layout_desktop:{grid_12,regiones:["header","main","related"]};
  layout_mobile:{orden_stack:["header","main","related"]};
  secciones:[
    {nombre:"Header",propósito:"contexto+acciones",componentes:["Title","PrimaryActions","Breadcrumbs(opc)"]},
    {nombre:"Body",propósito:"contenido_principal",componentes:["KeyFacts","Tabs|Accordion"]},
    {nombre:"Related",propósito:"continuidad",componentes:["RelatedList|Recommendations"]}
  ];
  ctas_principales:[{label:"Acción principal",accion:"→Form|acción_negocio"}];
  datos_minimos:["EntityX"], estados:ESTADOS_UNIVERSALES;
  a11y:{landmarks:["main"],aria_roles:["article"]};
}

SCREEN_FORM (SCREEN_SCHEMA){
  id:"P4"; nombre:"Form"; rol:"crear/editar";
  objetivoUX:["completar_tarea_sin_error"];
  layout_desktop:{grid_12,regiones:["header","main","footer"]};
  layout_mobile:{orden_stack:["main","footer"]};
  secciones:[
    {nombre:"FormBody",propósito:"entrada_datos",componentes:["FieldGroup","Helper/ErrorTexts"]},
    {nombre:"Actions",propósito:"confirmar",componentes:["PrimaryButton","SecondaryButton"]}
  ];
  datos_minimos:["EntityX_schema"], estados:ESTADOS_UNIVERSALES;
  a11y:{tab_order:"label→campo→ayuda→error→acciones",aria_live:"assertive para errores globales"};
}

SCREEN_SETTINGS (SCREEN_SCHEMA){
  id:"P5"; nombre:"Settings"; rol:"preferencias_app";
  objetivoUX:["control_personal"];
  secciones:[
    {nombre:"Preferencias generales",propósito:"idioma+tema+density",componentes:["Select(lang)","ThemeSwitch","DensityToggle"]},
    {nombre:"Notificaciones",propósito:"alertas",componentes:["Toggle(notifications)"]}
  ];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_HELP (SCREEN_SCHEMA){
  id:"P6"; nombre:"Help"; rol:"asistencia";
  objetivoUX:["resolver_dudas","desatascar_usuario"];
  secciones:[
    {nombre:"FAQ",propósito:"respuestas_rápidas"},
    {nombre:"Contact",propósito:"contacto_soporte"}
  ];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_OFFLINE (SCREEN_SCHEMA){
  id:"P7"; nombre:"Offline"; rol:"recuperación";
  objetivoUX:["informar","permitir_reintento"];
  secciones:[
    {nombre:"Banner",propósito:"estado"},
    {nombre:"Actions",propósito:"reintentar"}
  ];
  estados:ESTADOS_UNIVERSALES;
  microcopy:{vacios:["Sin conexión. Reintenta cuando vuelvas a estar online."]};
}

SCREEN_ERROR (SCREEN_SCHEMA){
  id:"P8"; nombre:"Error(404/500)"; rol:"error";
  objetivoUX:["explicar","recuperar"];
  secciones:[
    {nombre:"Message",propósito:"contexto"},
    {nombre:"CTA",propósito:"volver_a_ruta_segura"}
  ];
  estados:ESTADOS_UNIVERSALES;
  microcopy:{
    errores:["No encontramos esto.","Algo salió mal."],
    botones:["Ir al inicio","Volver"]
  };
}

# ─────────────────────────────────────
# PANTALLAS AUTH PACK (Splash/Login/Register/Recover/MFA/Profile/LogOff/SessionExpired)
# ─────────────────────────────────────
SCREEN_SPLASH (SCREEN_SCHEMA){
  id:"A0"; nombre:"Splash"; rol:"detección_sesión";
  objetivoUX:["cargar_branding","chequear_sesión","redirigir"];
  layout_desktop:{grid_12,regiones:["main"]};
  layout_mobile:{orden_stack:["main"]};
  secciones:[
    {nombre:"Branding",propósito:"identidad"},
    {nombre:"Progress",propósito:"estado_carga"}
  ];
  datos_minimos:["session?" ];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_LOGIN (SCREEN_SCHEMA){
  id:"A1"; nombre:"Login"; rol:"acceso";
  objetivoUX:["entrar_sin_fricción","mantener_seguridad"];
  secciones:[
    {nombre:"AuthForm(Login)",propósito:"credenciales",
     componentes:["Field(email)","Field(password)","Checkbox(Recordarme)","Button(Entrar)","Link(Recover)","OAuthButtons(opc)"]},
    {nombre:"Legal",propósito:"consentimiento",componentes:["Text(terminos/privacidad)"]}
  ];
  ctas_principales:[{label:"Entrar",accion:"validar_credenciales"}];
  ctas_secundarias:[{label:"Crear cuenta",accion:"→Register"}];
  datos_minimos:["credential.email","credential.password"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_REGISTER (SCREEN_SCHEMA){
  id:"A2"; nombre:"Register"; rol:"alta_nueva";
  objetivoUX:["crear_cuenta","preparar_perfil"];
  secciones:[
    {nombre:"AuthForm(Register)",propósito:"alta",
     componentes:["Field(name)","Field(email)","Field(password+meter)","Field(confirm)","Checkbox(Acepto términos)","Button(Crear cuenta)"]},
    {nombre:"Hints",propósito:"reglas_password",componentes:["Text(checklist)"]}
  ];
  ctas_principales:[{label:"Crear cuenta",accion:"validar+enviar"}];
  ctas_secundarias:[{label:"Ya tengo cuenta",accion:"→Login"}];
  datos_minimos:["user.name","credential.email","credential.password"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_RECOVER (SCREEN_SCHEMA){
  id:"A3"; nombre:"Recover"; rol:"recuperar_acceso";
  objetivoUX:["recuperar_sin_filtrar_usuarios"];
  secciones:[
    {nombre:"Request",propósito:"solicitar_reset",componentes:["Field(email)","Button(Enviar enlace)"]},
    {nombre:"Reset",propósito:"nueva_contraseña",componentes:["Field(new_password+meter)","Field(confirm)","Button(Confirmar)"]}
  ];
  datos_minimos:["credential.email|resetToken"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_MFA (SCREEN_SCHEMA){
  id:"A4"; nombre:"MFA"; rol:"segundo_factor";
  objetivoUX:["verificar_identidad"];
  secciones:[
    {nombre:"OTP",propósito:"ingreso_código",componentes:["OTPGroup(6)","Button(Verificar)","Link(Reenviar)"]},
    {nombre:"Alternativas",propósito:"otros_factores",componentes:["Button(WebAuthn) opc"]}
  ];
  datos_minimos:["credential.otp"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_PROFILE (SCREEN_SCHEMA){
  id:"A5"; nombre:"Profile"; rol:"gestión_personal";
  objetivoUX:["editar_datos","preferencias","seguridad"];
  secciones:[
    {nombre:"Info",propósito:"datos_básicos",componentes:["Avatar","Field(name)","Field(location)","Field(email:readonly|verify_state)"]},
    {nombre:"Preferencias",propósito:"experiencia",componentes:["Select(language)","ThemeSwitch","Toggle(reduceMotion)","Toggle(notifications)"]},
    {nombre:"Seguridad",propósito:"proteger_cuenta",componentes:["ChangePassword","MFA_Toggle","SessionsList(terminate)","DangerZone(delete_account)"]}
  ];
  ctas_principales:[{label:"Guardar cambios",accion:"persistir"}];
  ctas_secundarias:[{label:"Cerrar sesión",accion:"→LogOff"}];
  datos_minimos:["User","Session"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_LOGOFF (SCREEN_SCHEMA){
  id:"A6"; nombre:"LogOff"; rol:"salida_segura";
  objetivoUX:["terminar_sesión","redirigir"];
  secciones:[
    {nombre:"Confirm",propósito:"opcional",componentes:["Button(Cerrar sesión)","Button(Cancelar)"]}
  ];
  ctas_principales:[{label:"Cerrar sesión",accion:"revocar_tokens→redirigir→Login"}];
  datos_minimos:["Session.id"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_SESSION_EXPIRED (SCREEN_SCHEMA){
  id:"A7"; nombre:"SessionExpired"; rol:"reautenticación";
  objetivoUX:["explicar_caducidad","relogin_rápido"];
  secciones:[
    {nombre:"Message",propósito:"contexto"},
    {nombre:"CTA",propósito:"volver_a_login"}
  ];
  ctas_principales:[{label:"Iniciar sesión de nuevo",accion:"→Login"}];
  estados:ESTADOS_UNIVERSALES;
}

# ─────────────────────────────────────
# FLOWS (APP CORE + AUTH)
# ─────────────────────────────────────
FLOWS{
  F1_Onboarding/Auth (FLOW_SCHEMA){
    id:"F1"; nombre:"Onboarding/Auth";
    pasos:[
      {pantalla:"Splash",tarea:"chequear_sesión",salida:"valida?→Home:Login"},
      {pantalla:"Login|Register",tarea:"auth",salida:"→Home"},
      {pantalla:"Home",tarea:"presentación_valor"}
    ];
    éxito:{definición:"sesión_valida_o_login_exitoso"};
  }

  F2_Home→List→Detail (FLOW_SCHEMA){
    id:"F2"; nombre:"Home a List+Detail";
    pasos:[
      {pantalla:"Home",tarea:"entender_pitch+click_CTA_Principal",salida:"→List"},
      {pantalla:"List",tarea:"buscar/filtrar",salida:"seleccionar_item"},
      {pantalla:"Detail",tarea:"evaluar",salida:"acción_principal|volver"}
    ];
    éxito:{definición:"usuario_encuentra_y_entiende_elemento_clave"};
  }

  F3_CRUD_Principal (FLOW_SCHEMA){
    id:"F3"; nombre:"Crear/Editar EntityX";
    pasos:[
      {pantalla:"List|Detail",tarea:"click_crear/editar",salida:"→Form"},
      {pantalla:"Form",tarea:"llenar_campos",error:{mensaje:"Faltan datos",recuperación:"resaltar_campos"}},
      {pantalla:"Form",tarea:"enviar",estado:"loading",salida:"→Detail"},
      {pantalla:"Detail",tarea:"ver_resultado",salida:"confirmación"}
    ];
    éxito:{definición:"entidad_guardada_sin_errores_criticos"};
  }

  F4_Conversión (FLOW_SCHEMA){
    id:"F4"; nombre:"Conversión (checkout/plan)";
    pasos:[
      {pantalla:"Detail|Pricing",tarea:"elegir_plan|item",salida:"→Form_pago"},
      {pantalla:"Form",tarea:"ingresar_datos_pago",error:{mensaje:"Pago rechazado",recuperación:"método_alterno"}},
      {pantalla:"Confirmación(Detail|otra)",tarea:"recibo/acceso"}
    ];
    éxito:{definición:"transacción_exitosa"};
  }

  F5_Offline_Recovery (FLOW_SCHEMA){
    id:"F5"; nombre:"Offline/Recuperación";
    pasos:[
      {pantalla:"Offline",tarea:"informar_estado",salida:"reintentar"},
      {pantalla:"pantalla_previa",tarea:"recuperar_estado",salida:"normal"}
    ];
    éxito:{definición:"sesión/flujo_recuperado"};
  }

  F6_Login (FLOW_SCHEMA){
    id:"F6"; nombre:"Login";
    pasos:[
      {pantalla:"Login",tarea:"ingresar_email_password",estado:"loading",error:{mensaje:"Credenciales inválidas",recuperación:"reintentar"}},
      {pantalla:"MFA(opc)",tarea:"verificar_otp",ramificaciones:"si_mfa_enabled"},
      {pantalla:"Home|Profile",tarea:"bienvenida"}
    ];
    éxito:{definición:"auth_ok"};
  }

  F7_Register (FLOW_SCHEMA){
    id:"F7"; nombre:"Registro";
    pasos:[
      {pantalla:"Register",tarea:"capturar_datos+aceptar_terminos",error:{mensaje:"Contraseña débil",recuperación:"ajustar"}},
      {pantalla:"Register",tarea:"enviar_form",salida:"verificación_email_enviada"},
      {pantalla:"Login",tarea:"ingresar_post_verificación"}
    ];
    éxito:{definición:"cuenta_creada+verificada"};
  }

  F8_Recover (FLOW_SCHEMA){
    id:"F8"; nombre:"Recuperar acceso";
    pasos:[
      {pantalla:"Recover",tarea:"solicitar_enlace",salida:"mensaje_neutro"},
      {pantalla:"Recover",tarea:"establecer_nueva_password",salida:"confirmación"}
    ];
    éxito:{definición:"password_actualizada"};
  }

  F9_MFA (FLOW_SCHEMA){
    id:"F9"; nombre:"MFA";
    pasos:[
      {pantalla:"MFA",tarea:"ingresar_otp",error:{mensaje:"Código inválido",recuperación:"reenviar"}},
      {pantalla:"Home|Profile",tarea:"acceso"}
    ];
    éxito:{definición:"segundo_factor_ok"};
  }

  F10_LogOff (FLOW_SCHEMA){
    id:"F10"; nombre:"Cerrar sesión";
    pasos:[
      {pantalla:"Profile|UserMenu",tarea:"click_logoff",salida:"revocar_tokens"},
      {pantalla:"Splash|Login",tarea:"redirigir"}
    ];
    éxito:{definición:"tokens_revocados+redirección"};
  }

  F11_SessionTimeout (FLOW_SCHEMA){
    id:"F11"; nombre:"Sesión expirada";
    pasos:[
      {pantalla:"SessionExpired",tarea:"informar",salida:"→Login"},
      {pantalla:"Login",tarea:"reautenticar"}
    ];
    éxito:{definición:"sesión_renovada"};
  }
}

# ─────────────────────────────────────
# A11Y / SEO / PWA
# ─────────────────────────────────────
A11Y_SEO_PWA{
  A11Y_MIN{
    contraste:"AA"; focus_visible:"≥2px en todos los elementos interactivos";
    orden_tab:"lógico(header→main→sidebar→footer)";
    landmarks:["header","nav","main","region","footer"];
    aria_live:"toasts/errores_globales";
    no_solo_color:"sí";
    prefers-reduced-motion:"animaciones degradan a estados estáticos";
  };

  SEO_MIN{
    title_y_meta_por_ruta:"Home,List,Detail,Form,Auth,Profile";
    OG_min:"title,description,image para Home y páginas clave";
    headings:"H1 único por pantalla, jerarquía H2/H3 coherente";
    urls_semánticas:"/items,/items/:id,/settings,/login,/register";
  };

  PWA_MIN{
    manifest:"sí";
    service_worker:"app_shell+SWR_datos_criticos";
    offline_fallback:"pantalla Offline y estados seguros en flows",
    responsive_images:"srcset+sizes+lazy donde aplique";
  };
}

# ─────────────────────────────────────
# SECURITY & PRIVACY (UI LEVEL)
# ─────────────────────────────────────
SECURITY_PRIVACY{
  errores_neutros_auth:"Credenciales inválidas";
  no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
  rate_limit_visual:"mensaje_sutil y enfriamiento gradual";
  lockout_feedback:"tiempo de espera comunicado sin revelar motivos internos";
  password_meter:"reglas mínimas: longitud≥12, variedad de clases, no incluir nombre/email";
  mostrar_ocultar_password:"toggle con aria-pressed";
  mfa_sugerido:"habilitar desde Profile/Seguridad";
  sesiones_activas:"lista de dispositivos con opción 'Cerrar en este dispositivo'";
  consentimiento_telemetría:"opt-in claro";
}

# ─────────────────────────────────────
# MOCKS + SWAP
# ─────────────────────────────────────
MOCKS{
  hooks:[
    "useUser","useSession","useListX","useDetailX","useCreateX",
    "useLogin","useRegister","useRecover","useMFA","useProfile"
  ];
  fixtures_tipadas:"sí";
  lat_ms:120;
  error_rate:0.03;
  swap_plan:"inyección_de_dependencias → API/Firebase/Firestore sin tocar UI";
}

# ─────────────────────────────────────
# I18N + UX COPY (resumen)
# ─────────────────────────────────────
I18N_UX_COPY{
  glosario:{
    "Home","Lista","Detalle","Guardar cambios","Cancelar",
    "Iniciar sesión","Crear cuenta","Recuperar acceso","Cerrar sesión",
    "Ver detalles","Continuar"
  };
  tablas:[
    {contexto:"botones",
     textos:["Ver elementos","Crear nuevo","Guardar cambios","Cancelar","Iniciar sesión","Crear cuenta","Cerrar sesión"]},
    {contexto:"errores",
     textos:["Credenciales inválidas","Algo salió mal. Intenta de nuevo.","Revisa este campo: falta información.","Código inválido"]},
    {contexto:"vacíos",
     textos:["Aún no hay elementos. Crea el primero.","Aún no hay datos para mostrar aquí."]},
    {contexto:"confirmaciones",
     textos:["Listo, se guardó tu información.","Acceso concedido.","Te enviamos el correo de verificación.","Contraseña actualizada.","Sesión finalizada."]}
  ];
}

# ─────────────────────────────────────
# EVALUACIÓN (PROMPT EVALS)
# ─────────────────────────────────────
EVAL{
  datasets_golden:"≥16 casos, cubriendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";
  metrics:["json_schema_pass","groundedness(si_RAG)","a11y_checklist_pass","readability"];
  umbrales:{json_schema_pass≥0.98, groundedness≥0.9, a11y_checklist_pass≥0.95};
  gates_regresión:"on";
}

# ─────────────────────────────────────
# TELEMETRÍA
# ─────────────────────────────────────
TELEMETRÍA{
  eventos:TELEMETRY_SCHEMA.eventos_core;
  payload_min:TELEMETRY_SCHEMA.payload_min;
  privacidad:"minimizar datos personales; IDs opacos; respetar consentimiento";
}

# ─────────────────────────────────────
# SSR / SSG / CSR ADAPT
# ─────────────────────────────────────
SSR_SSG_ADAPT{
  auth_guard:"server+client para rutas protegidas";
  redirecciones:"server-side en sesión expirada cuando aplique";
  prefetch_selectivo:"solo para rutas seguras y necesarias";
  hydration_segura:"no exponer credenciales ni tokens en HTML";
  división_código_por_ruta:"Auth, Home/Dashboard, Settings separados";
}

# ─────────────────────────────────────
# PRIORIDADES (para backlog inmediato)
# ─────────────────────────────────────
PRIORIDADES{
  top5_issues:[
    "estilos_fuera_de_tokens",
    "falta_focus_visible_en_elementos_clave",
    "CTAs_compiten_en_la_misma_pantalla",
    "estados_universales_incompletos(loading/error/empty/offline)",
    "microcopy_inconsistente||no_i18n_ready"
  ];
  top5_acciones:[
    "centralizar_tokens_en_DTCG_JSON_y_migrar_componentes",
    "añadir_focus_visible_global_y_probar_con_teclado",
    "revisar_jerarquía_de_CTAs_por_pantalla",
    "definir_y_documentar_estados_universales_por_pantalla",
    "construir_tabla_microcopy+i18n_y_activarla_en_flows_críticos"
  ];
}

# ─────────────────────────────────────
# INSTRUCCIONES AL LLM
# ─────────────────────────────────────
INSTRUCCIONES_AL_LLM{
  1:"Usar PIPELINE y RENDER_ORDER como guía de generación.";
  2:"Respetar SCHEMAS en estructuras JSON, o indicar violaciones en 'Violations'.";
  3:"No incluir razonamiento interno ni auto-referencias al modelo.";
  4:"Usar TOKENS para todos los valores visuales; reportar hex directos si aparecen.";
  5:"Garantizar que cada pantalla tenga estados universales y que flows conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff.";
}

FIN
{
  "spec_version": "PROMPT_UIUX_E2E_ROOT_v4_MAX_SEMANTIC_1",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Sistema UI/UX front-end end-to-end para portfolio/producto, alineado con PROMPT_UIUX_E2E_ROOT_v4.",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Demostrar calidad de diseño + código en menos de 8 segundos",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién es la persona y qué hace",
        "Revisar 2–3 proyectos alineados a sus necesidades",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "ctr_home_to_projects",
        "ctr_home_to_contact",
        "avg_time_on_detail",
        "completion_rate_main_form"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido fit vs rol abierto sin leer demasiado texto."
      },
      {
        "id": "founder-cto",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico y capacidad de llevar cosas a producción."
      }
    ],
    "contexto": {
      "dispositivos": [
        "mobile",
        "desktop"
      ],
      "conectividad": "intermitente",
      "regiones": [
        "México",
        "Latam"
      ],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "router": "React Router / Next Router equivalente",
      "estado": "React hooks + React Query",
      "pwa": true
    },
    "render_order": [
      "design_system",
      "components",
      "screens",
      "flows",
      "data_model",
      "a11y_seo_pwa",
      "security_privacy",
      "mocks_and_swap",
      "i18n",
      "eval_plan",
      "telemetry",
      "runtime",
      "priorities",
      "violations"
    ]
  },
  "design_system": {
    "tokens_dtcg": {
      "$schema": "https://design-tokens.org/schema.json",
      "meta": {
        "name": "UIX_Portfolio_Tokens",
        "version": "1.0.0",
        "source": "PROMPT_UIUX_E2E_ROOT_v4",
        "platforms": [
          "web",
          "ios",
          "android"
        ]
      },
      "color": {
        "$type": "color",
        "primitive": {
          "neutral": {
            "0": {
              "$value": "#FFFFFF"
            },
            "50": {
              "$value": "#F7F7F8"
            },
            "100": {
              "$value": "#E5E5EA"
            },
            "200": {
              "$value": "#D1D1D6"
            },
            "300": {
              "$value": "#B0B0B8"
            },
            "400": {
              "$value": "#8E8E96"
            },
            "500": {
              "$value": "#636366"
            },
            "600": {
              "$value": "#48484A"
            },
            "700": {
              "$value": "#3A3A3C"
            },
            "800": {
              "$value": "#2C2C2E"
            },
            "900": {
              "$value": "#000000"
            }
          },
          "brand": {
            "500": {
              "$value": "#2563EB"
            }
          },
          "accent": {
            "500": {
              "$value": "#EC4899"
            }
          },
          "ok": {
            "500": {
              "$value": "#16A34A"
            }
          },
          "warn": {
            "500": {
              "$value": "#EAB308"
            }
          },
          "err": {
            "500": {
              "$value": "#DC2626"
            }
          }
        },
        "semantic": {
          "bg": {
            "page": {
              "$value": "{color.primitive.neutral.50}"
            },
            "surface": {
              "$value": "{color.primitive.neutral.0}"
            }
          },
          "text": {
            "main": {
              "$value": "{color.primitive.neutral.900}"
            },
            "muted": {
              "$value": "{color.primitive.neutral.500}"
            },
            "inverse": {
              "$value": "{color.primitive.neutral.0}"
            }
          },
          "accent": {
            "main": {
              "$value": "{color.primitive.accent.500}"
            }
          },
          "border": {
            "bold": {
              "$value": "{color.primitive.neutral.300}"
            },
            "subtle": {
              "$value": "{color.primitive.neutral.200}"
            }
          },
          "state": {
            "ok": {
              "$value": "{color.primitive.ok.500}"
            },
            "warn": {
              "$value": "{color.primitive.warn.500}"
            },
            "err": {
              "$value": "{color.primitive.err.500}"
            }
          }
        },
        "theme": {
          "light": {
            "bg.page": {
              "$value": "{color.semantic.bg.page}"
            },
            "bg.surface": {
              "$value": "{color.semantic.bg.surface}"
            },
            "text.main": {
              "$value": "{color.semantic.text.main}"
            },
            "text.muted": {
              "$value": "{color.semantic.text.muted}"
            },
            "accent.main": {
              "$value": "{color.semantic.accent.main}"
            }
          },
          "dark": {
            "bg.page": {
              "$value": "{color.primitive.neutral.900}"
            },
            "bg.surface": {
              "$value": "{color.primitive.neutral.800}"
            },
            "text.main": {
              "$value": "{color.primitive.neutral.0}"
            },
            "text.muted": {
              "$value": "{color.primitive.neutral.300}"
            },
            "accent.main": {
              "$value": "{color.primitive.accent.500}"
            }
          },
          "high-contrast": {
            "bg.page": {
              "$value": "#000000"
            },
            "bg.surface": {
              "$value": "#000000"
            },
            "text.main": {
              "$value": "#FFFFFF"
            },
            "text.muted": {
              "$value": "#FFFFFF"
            },
            "accent.main": {
              "$value": "#FFFF00"
            }
          }
        }
      },
      "typography": {
        "$type": "typography",
        "family": {
          "base": {
            "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
          }
        },
        "size": {
          "xs": {
            "$value": "12px"
          },
          "sm": {
            "$value": "14px"
          },
          "md": {
            "$value": "16px"
          },
          "lg": {
            "$value": "20px"
          },
          "xl": {
            "$value": "24px"
          },
          "h1": {
            "$value": "32px"
          },
          "h2": {
            "$value": "24px"
          },
          "h3": {
            "$value": "20px"
          }
        },
        "weight": {
          "regular": {
            "$value": 400
          },
          "semibold": {
            "$value": 600
          },
          "bold": {
            "$value": 700
          }
        },
        "lineHeight": {
          "tight": {
            "$value": "1.2"
          },
          "normal": {
            "$value": "1.4"
          },
          "loose": {
            "$value": "1.6"
          }
        }
      },
      "spacing": {
        "$type": "dimension",
        "scale": {
          "1": {
            "$value": "4px"
          },
          "2": {
            "$value": "8px"
          },
          "3": {
            "$value": "12px"
          },
          "4": {
            "$value": "16px"
          },
          "5": {
            "$value": "24px"
          },
          "6": {
            "$value": "32px"
          }
        }
      },
      "radius": {
        "$type": "dimension",
        "sm": {
          "$value": "8px"
        },
        "md": {
          "$value": "12px"
        },
        "lg": {
          "$value": "16px"
        },
        "pill": {
          "$value": "999px"
        }
      },
      "border": {
        "$type": "dimension",
        "thin": {
          "$value": "1px"
        },
        "thick": {
          "$value": "2px"
        },
        "extra": {
          "$value": "3px"
        }
      },
      "shadow": {
        "$type": "shadow",
        "soft": {
          "$value": "0 4px 12px rgba(0,0,0,0.08)"
        },
        "lg": {
          "$value": "0 16px 40px rgba(0,0,0,0.18)"
        }
      },
      "motion": {
        "$type": "duration",
        "fast": {
          "$value": "150ms"
        },
        "norm": {
          "$value": "200ms"
        },
        "reduced": {
          "$value": "0ms"
        }
      },
      "z": {
        "$type": "number",
        "base": {
          "$value": 1
        },
        "dropdown": {
          "$value": 10
        },
        "overlay": {
          "$value": 100
        },
        "modal": {
          "$value": 1000
        },
        "toast": {
          "$value": 1100
        }
      }
    }
  },
  "components": {
    "atoms": [
      {
        "name": "Text",
        "semantic_role": "typography",
        "variants": [
          "h1",
          "h2",
          "h3",
          "body",
          "caption"
        ],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err",
          "truncate": "boolean",
          "ariaLabel": "string?"
        },
        "states": [
          "default"
        ],
        "a11y": {
          "h1": "unico_por_pantalla",
          "caption": "no_usar_para_texto_largo"
        },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "semantic_role": "interactive-cta",
        "variants": [
          "primary",
          "secondary",
          "ghost",
          "danger"
        ],
        "sizes": [
          "sm",
          "md",
          "lg"
        ],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "disabled": "boolean",
          "loading": "boolean",
          "ariaLabel": "string?"
        },
        "states": [
          "default",
          "hover",
          "focus",
          "disabled",
          "loading"
        ],
        "tokens": {
          "bg": "brand|neutral|transparent|state.err",
          "radius": "radius.md",
          "shadow": "shadow.soft"
        },
        "a11y": {
          "role": "button",
          "focusVisible": "borde 2px usando color.border.bold",
          "keyboard": "Enter/Space activan acción"
        },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "semantic_role": "form-field",
        "variants": [
          "text",
          "email",
          "password",
          "search",
          "number"
        ],
        "props": {
          "type": "text|email|password|search|number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?",
          "hasError": "boolean"
        },
        "states": [
          "default",
          "focus",
          "error",
          "disabled"
        ],
        "tokens": {
          "border": "border.subtle|border.bold",
          "radius": "radius.sm",
          "shadow": "none"
        },
        "a11y": {
          "role": "textbox",
          "error": "aria-invalid=true cuando hasError"
        },
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "semantic_role": "form-field-multiline",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "hasError": "boolean"
        },
        "states": [
          "default",
          "focus",
          "error",
          "disabled"
        ],
        "tokens": {
          "border": "border.subtle|border.bold",
          "radius": "radius.sm"
        },
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "semantic_role": "binary-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "indeterminate": "boolean?"
        },
        "states": [
          "checked",
          "unchecked",
          "indeterminate",
          "disabled"
        ],
        "a11y": {
          "role": "checkbox",
          "keyboard": "Space alterna estado"
        },
        "testIdPattern": "chk-{label}"
      },
      {
        "name": "Radio",
        "semantic_role": "exclusive-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "states": [
          "checked",
          "unchecked",
          "disabled"
        ],
        "a11y": {
          "role": "radio"
        },
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "semantic_role": "single-select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "states": [
          "default",
          "open",
          "disabled"
        ],
        "a11y": {
          "role": "combobox"
        },
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "semantic_role": "filter-token|status-indicator",
        "variants": [
          "default",
          "filter",
          "status"
        ],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "states": [
          "selected",
          "unselected",
          "disabled"
        ],
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "semantic_role": "status-indicator",
        "variants": [
          "neutral",
          "ok",
          "warn",
          "err"
        ],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "semantic_role": "user-identity",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "states": [
          "default",
          "fallback"
        ],
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "semantic_role": "decorative|informative",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "states": [
          "decorative",
          "informative"
        ],
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "semantic_role": "description",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "states": [
          "closed",
          "open"
        ],
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "semantic_role": "layout-separator",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "semantic_role": "progress-indicator",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "states": [
          "spinning"
        ],
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "semantic_role": "form-field-wrapper",
        "parts": [
          "label",
          "control",
          "helper",
          "error"
        ],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "states": [
          "default",
          "error",
          "disabled"
        ],
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "semantic_role": "search-entry",
        "parts": [
          "icon",
          "input",
          "clear"
        ],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "states": [
          "default",
          "with-query"
        ],
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "semantic_role": "filter-group",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "states": [
          "empty",
          "with-selection"
        ],
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "semantic_role": "metric-display",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "semantic_role": "social-login",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "semantic_role": "mfa-otp-input",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "states": [
          "empty",
          "partial",
          "full"
        ],
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "semantic_role": "user-shortcut-menu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "states": [
          "closed",
          "open"
        ],
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "semantic_role": "ephemeral-feedback",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "states": [
          "visible",
          "hidden"
        ],
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "semantic_role": "primary-navigation",
        "slots": [
          "logo",
          "primary-links",
          "secondary-actions",
          "user-menu"
        ],
        "states": [
          "default",
          "scrolled"
        ],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "semantic_role": "secondary-navigation",
        "slots": [
          "section-links",
          "footer-links"
        ],
        "states": [
          "expanded",
          "collapsed"
        ],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "semantic_role": "page-hero",
        "slots": [
          "eyebrow",
          "title",
          "subtitle",
          "ctas",
          "meta",
          "illustration"
        ],
        "states": [
          "default",
          "compact"
        ],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "semantic_role": "context-panel",
        "slots": [
          "availability",
          "chips",
          "meta"
        ],
        "states": [
          "default"
        ],
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "semantic_role": "collection-display",
        "slots": [
          "filters",
          "results",
          "pagination"
        ],
        "states": [
          "loading",
          "error",
          "empty",
          "success"
        ],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "semantic_role": "entity-detail",
        "slots": [
          "header",
          "body",
          "related"
        ],
        "states": [
          "loading",
          "error",
          "success"
        ],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "semantic_role": "entity-form",
        "slots": [
          "title",
          "sections",
          "global-errors",
          "actions"
        ],
        "states": [
          "editing",
          "submitting",
          "error",
          "success"
        ],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "semantic_role": "auth-form",
        "slots": [
          "title",
          "fields",
          "actions",
          "secondary-links",
          "legal"
        ],
        "states": [
          "idle",
          "submitting",
          "error"
        ],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "semantic_role": "mfa-step",
        "slots": [
          "title",
          "otp",
          "resend",
          "alternate"
        ],
        "states": [
          "idle",
          "submitting",
          "error"
        ],
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "semantic_role": "account-settings",
        "slots": [
          "tabs",
          "tab-content",
          "danger-zone"
        ],
        "states": [
          "view",
          "editing",
          "saving"
        ],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "semantic_role": "route-guard",
        "states": [
          "checking",
          "allowed",
          "blocked"
        ],
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "semantic_role": "app-layout",
        "regions": [
          "header",
          "sidebar",
          "main",
          "footer",
          "toasts"
        ],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "semantic_role": "auth-layout",
        "regions": [
          "branding",
          "auth-card"
        ],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "semantic_role": "dashboard-layout",
        "regions": [
          "header",
          "sidebar",
          "main"
        ],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "semantic_role": "detail-layout",
        "regions": [
          "header",
          "main",
          "related"
        ],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "semantic_role": "form-layout",
        "regions": [
          "header",
          "main",
          "footer"
        ],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "semantic_role": "error-layout",
        "regions": [
          "icon",
          "message",
          "actions"
        ],
        "testIdPattern": "layout-error"
      }
    ]
  },
  "screens": {
    "core": {
      "Home": {
        "id": "screen-home",
        "route": "/",
        "template": "AppShell",
        "rol": "home",
        "objetivo_ux": "Comunicar propuesta de valor en 5–8s y dirigir a Proyectos o Contacto.",
        "layout": {
          "desktop": "grid-12: header full; main col-span-8; HeroPanel col-span-4; footer full",
          "mobile": "stack: HeroShell → HeroPanel → Highlights → Proof → Footer"
        },
        "contrato_datos": {
          "obligatorios": [
            "User.name",
            "User.prefs.lang",
            "proyectos_destacados[]",
            "disponibilidad_actual"
          ],
          "opcionales": [
            "stats_resumidas",
            "testimonios[]",
            "logos_confianza[]"
          ]
        },
        "secciones": [
          {
            "id": "home-hero",
            "tipo": "HeroShell",
            "componentes": [
              "Text.h1",
              "Text.body",
              "Button.primary",
              "Button.secondary",
              "Chip",
              "MetaBar"
            ]
          },
          {
            "id": "home-highlights",
            "tipo": "Highlights",
            "componentes": [
              "BentoGrid",
              "StatCard"
            ]
          },
          {
            "id": "home-proof",
            "tipo": "Proof",
            "componentes": [
              "LogoStrip",
              "TestimonialCard"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargar skeleton de hero y cards.",
            "ui": [
              "Spinner",
              "skeletons"
            ]
          },
          "error": {
            "descripcion": "Error al cargar datos iniciales.",
            "ui": [
              "Alert.error",
              "Button.reintentar"
            ]
          },
          "empty": {
            "descripcion": "No hay proyectos destacados aún.",
            "ui": [
              "EmptyState",
              "Button.primary"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, se muestran datos cacheados.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Datos cargados correctamente.",
            "ui": [
              "HeroShell",
              "Highlights",
              "Proof"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-home')",
          "ctas": [
            {
              "id": "cta-home-view-projects",
              "evento": "click:cta",
              "destino": "/proyectos"
            },
            {
              "id": "cta-home-book-call",
              "evento": "click:cta",
              "destino": "/contacto"
            }
          ]
        },
        "a11y": {
          "landmarks": [
            "header",
            "main",
            "footer"
          ],
          "tab_order": [
            "skip-link",
            "navbar",
            "hero-primary-cta",
            "hero-secondary-cta",
            "highlights",
            "proof",
            "footer"
          ],
          "h1_unico": true
        },
        "seo": {
          "title": "Portafolio técnico – Home",
          "meta_description": "Portafolio técnico centrado en producto: proyectos reales, código en producción y foco en negocio.",
          "og_title": "Portafolio técnico",
          "og_type": "website"
        }
      },
      "List": {
        "id": "screen-list",
        "route": "/proyectos",
        "template": "AppShell",
        "rol": "list",
        "objetivo_ux": "Permitir encontrar un proyecto relevante mediante búsqueda y filtros.",
        "contrato_datos": {
          "obligatorios": [
            "EntityX[]"
          ],
          "opcionales": [
            "filtros_disponibles[]",
            "paginacion"
          ]
        },
        "secciones": [
          {
            "id": "list-filters",
            "tipo": "Filters",
            "componentes": [
              "SearchBar",
              "FilterChips",
              "Select"
            ]
          },
          {
            "id": "list-results",
            "tipo": "Results",
            "componentes": [
              "ListView",
              "CardProyecto"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Se están cargando los proyectos.",
            "ui": [
              "Spinner",
              "skeleton-list"
            ]
          },
          "error": {
            "descripcion": "Error al cargar lista.",
            "ui": [
              "Alert.error",
              "Button.reintentar"
            ]
          },
          "empty": {
            "descripcion": "No hay proyectos.",
            "ui": [
              "EmptyState",
              "Button.primary"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, mostrar datos cacheados si hay.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Proyectos cargados correctamente.",
            "ui": [
              "ListView"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-list')",
          "ctas": [
            {
              "id": "cta-list-create",
              "evento": "click:cta",
              "destino": "/proyectos/nuevo"
            }
          ]
        }
      },
      "Detail": {
        "id": "screen-detail",
        "route": "/proyectos/:id",
        "template": "DetailLayout",
        "rol": "detail",
        "objetivo_ux": "Profundizar en un proyecto y decidir acción (contactar, agendar, compartir).",
        "contrato_datos": {
          "obligatorios": [
            "EntityX",
            "User"
          ],
          "opcionales": [
            "relacionados[]",
            "links_codigo[]",
            "metricas"
          ]
        },
        "secciones": [
          {
            "id": "detail-header",
            "tipo": "Header",
            "componentes": [
              "Breadcrumbs",
              "Text.h1",
              "Badge",
              "PrimaryActions"
            ]
          },
          {
            "id": "detail-body",
            "tipo": "Body",
            "componentes": [
              "KeyFacts",
              "Tabs",
              "CodeSnippetPreview",
              "Metrics"
            ]
          },
          {
            "id": "detail-related",
            "tipo": "RelatedList",
            "componentes": [
              "CardProyecto"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargando detalles de proyecto.",
            "ui": [
              "Spinner",
              "skeleton-detail"
            ]
          },
          "error": {
            "descripcion": "Error al cargar proyecto.",
            "ui": [
              "ErrorLayout"
            ]
          },
          "empty": {
            "descripcion": "No se encontró el proyecto.",
            "ui": [
              "ErrorLayout-404"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, mostrar último estado cacheado.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Detalle completo cargado.",
            "ui": [
              "DetailPanel"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-detail')",
          "ctas": [
            {
              "id": "cta-detail-contact",
              "evento": "click:cta",
              "destino": "/contacto"
            }
          ]
        }
      },
      "Form": {
        "id": "screen-form",
        "route": "/proyectos/nuevo|/proyectos/:id/editar",
        "template": "FormLayout",
        "rol": "form",
        "objetivo_ux": "Crear/editar proyectos con mínima fricción y sin errores silenciosos.",
        "contrato_datos": {
          "obligatorios": [
            "EntityX.schema"
          ],
          "opcionales": [
            "plantillas",
            "tags_sugeridos[]"
          ]
        },
        "secciones": [
          {
            "id": "form-body",
            "tipo": "FormBody",
            "componentes": [
              "Field.title",
              "Field.description",
              "Field.tags",
              "Field.status",
              "Field.links"
            ]
          },
          {
            "id": "form-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary",
              "Button.secondary"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargando datos iniciales (modo edición).",
            "ui": [
              "Spinner"
            ]
          },
          "error": {
            "descripcion": "Error al cargar/guardar.",
            "ui": [
              "Alert.error"
            ]
          },
          "empty": {
            "descripcion": "Formulario en modo creación.",
            "ui": [
              "FormPanel"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, deshabilitar envío y mostrar aviso.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Guardado correcto.",
            "ui": [
              "Toast.success"
            ]
          }
        },
        "eventos": {
          "submit": "form:submit (screen_id='screen-form')"
        }
      },
      "Settings": {
        "id": "screen-settings",
        "route": "/perfil/preferencias",
        "template": "DashboardLayout",
        "rol": "settings",
        "objetivo_ux": "Permitir configurar idioma, tema, densidad y notificaciones.",
        "contrato_datos": {
          "obligatorios": [
            "User.prefs"
          ],
          "opcionales": []
        },
        "estados_universales": true
      },
      "Help": {
        "id": "screen-help",
        "route": "/ayuda",
        "template": "AppShell",
        "rol": "help",
        "objetivo_ux": "Resolver dudas rápidas y ofrecer contacto.",
        "contrato_datos": {
          "obligatorios": [],
          "opcionales": [
            "faq_items[]",
            "contacto_form"
          ]
        },
        "estados_universales": true
      },
      "Offline": {
        "id": "screen-offline",
        "route": "/offline",
        "template": "ErrorLayout",
        "rol": "offline",
        "objetivo_ux": "Explicar falta de conexión y ofrecer reintento.",
        "estados_universales": true
      },
      "Error": {
        "id": "screen-error",
        "route": "/error",
        "template": "ErrorLayout",
        "rol": "error",
        "objetivo_ux": "Explicar errores 404/500 y ofrecer salida segura.",
        "estados_universales": true
      }
    },
    "auth": {
      "Splash": {
        "id": "screen-splash",
        "route": "/splash",
        "template": "AuthLayout",
        "rol": "auth-splash",
        "objetivo_ux": "Detectar sesión y dirigir a Login o Home sin parpadeos.",
        "contrato_datos": {
          "obligatorios": [
            "Session?"
          ],
          "opcionales": []
        },
        "estados": {
          "checking": {
            "descripcion": "Consultando estado de sesión.",
            "ui": [
              "Spinner",
              "Branding"
            ]
          },
          "no_session": {
            "descripcion": "No hay sesión, redirigir a Login.",
            "ui": []
          },
          "has_session": {
            "descripcion": "Sesión válida, redirigir a Home.",
            "ui": []
          }
        }
      },
      "Login": {
        "id": "screen-login",
        "route": "/login",
        "template": "AuthLayout",
        "rol": "auth-login",
        "objetivo_ux": "Permitir acceso seguro con mensajes neutros.",
        "secciones": [
          {
            "id": "login-form",
            "tipo": "AuthForm",
            "fields": [
              "email",
              "password",
              "remember_me"
            ]
          }
        ],
        "estados_universales": true
      },
      "Register": {
        "id": "screen-register",
        "route": "/registro",
        "template": "AuthLayout",
        "rol": "auth-register",
        "objetivo_ux": "Crear cuenta nueva con feedback claro de password.",
        "estados_universales": true
      },
      "Recover": {
        "id": "screen-recover",
        "route": "/recuperar",
        "template": "AuthLayout",
        "rol": "auth-recover",
        "objetivo_ux": "Permitir recuperar acceso sin filtrar existencia de cuenta.",
        "estados_universales": true
      },
      "MFA": {
        "id": "screen-mfa",
        "route": "/mfa",
        "template": "AuthLayout",
        "rol": "auth-mfa",
        "objetivo_ux": "Completar segundo factor de forma rápida.",
        "estados_universales": true
      },
      "Profile": {
        "id": "screen-profile",
        "route": "/perfil",
        "template": "DashboardLayout",
        "rol": "auth-profile",
        "objetivo_ux": "Gestionar datos, preferencias y seguridad personal.",
        "estados_universales": true
      },
      "LogOff": {
        "id": "screen-logoff",
        "route": "/logout",
        "template": "AuthLayout",
        "rol": "auth-logoff",
        "objetivo_ux": "Cerrar sesión de forma explícita y comprensible.",
        "estados_universales": true
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "route": "/session-expired",
        "template": "AuthLayout",
        "rol": "auth-session-expired",
        "objetivo_ux": "Explicar expiración y forzar re-login.",
        "estados_universales": true
      }
    }
  },
  "flows": {
    "F1_OnboardingAuth": {
      "objetivo": "Llevar al usuario desde carga inicial a Home o Login según sesión.",
      "pantallas": [
        "Splash",
        "Login",
        "Home"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Splash",
          "tarea": "Consultar estado de sesión.",
          "entrada": [
            "Session?"
          ],
          "salida": {
            "decision": "has_session|no_session"
          },
          "errores": [
            "timeout_backend",
            "network_error"
          ],
          "recuperacion": [
            "mostrar ErrorLayout o Offline según caso"
          ]
        },
        {
          "orden": 2,
          "condicion": "has_session",
          "accion": "redirigir a Home"
        },
        {
          "orden": 3,
          "condicion": "no_session",
          "accion": "redirigir a Login"
        }
      ],
      "exito": "Usuario aterriza en Home con sesión válida o en Login listo para autenticarse."
    },
    "F2_Home_List_Detail": {
      "objetivo": "Exploración básica del contenido.",
      "pantallas": [
        "Home",
        "List",
        "Detail"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Home",
          "tarea": "Comunicar pitch y ofrecer CTA principal.",
          "entrada": [
            "User",
            "proyectos_destacados[]"
          ],
          "salida": {
            "accion": "click CTA o abandonar"
          },
          "errores": [],
          "recuperacion": []
        },
        {
          "orden": 2,
          "pantalla": "List",
          "tarea": "Permitir buscar/filtrar proyectos.",
          "entrada": [
            "EntityX[]"
          ],
          "salida": {
            "seleccion": "EntityX.id?"
          },
          "errores": [
            "empty_results",
            "network_error"
          ],
          "recuperacion": [
            "mostrar EmptyState",
            "botón reintentar"
          ]
        },
        {
          "orden": 3,
          "pantalla": "Detail",
          "tarea": "Profundizar y decidir acción.",
          "entrada": [
            "User",
            "EntityX"
          ],
          "salida": {
            "accion": "contactar|compartir|volver"
          },
          "errores": [
            "not_found",
            "network_error"
          ],
          "recuperacion": [
            "Error 404",
            "botón Volver a lista"
          ]
        }
      ],
      "exito": "Usuario encuentra un proyecto relevante y sabe cómo avanzar."
    },
    "F3_CRUD_Principal": {
      "objetivo": "Crear o editar entidad principal sin errores.",
      "pantallas": [
        "List",
        "Detail",
        "Form"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "List|Detail",
          "tarea": "Iniciar acción de crear/editar.",
          "entrada": [],
          "salida": {
            "accion": "navegar a Form"
          }
        },
        {
          "orden": 2,
          "pantalla": "Form",
          "tarea": "Rellenar campos con validación.",
          "entrada": [
            "EntityX.schema"
          ],
          "salida": {
            "estado": "listo_para_submit"
          },
          "errores": [
            "errores_validacion"
          ],
          "recuperacion": [
            "marcar campos",
            "mensajes de error claros"
          ]
        },
        {
          "orden": 3,
          "pantalla": "Form",
          "tarea": "Enviar formulario.",
          "entrada": [
            "EntityX.payload"
          ],
          "salida": {
            "estado": "success|error"
          },
          "errores": [
            "network_error",
            "server_error"
          ],
          "recuperacion": [
            "toast error",
            "retry"
          ]
        },
        {
          "orden": 4,
          "condicion": "success",
          "accion": "redirigir a Detail y mostrar toast 'Guardado'"
        }
      ],
      "exito": "Entidad creada/actualizada y visible en Detail."
    },
    "F4_Conversion_Ecommerce_Optional": {
      "objetivo": "Flujo de compra o selección de plan (opcional).",
      "pantallas": [
        "Detail",
        "Form",
        "Confirmacion"
      ],
      "pasos": [],
      "exito": "Pago completado y acceso al servicio."
    },
    "F5_Offline_Recovery": {
      "objetivo": "Mantener UX coherente en modo offline.",
      "pantallas": [
        "Offline",
        "previa"
      ],
      "pasos": [
        {
          "orden": 1,
          "tarea": "Detectar desconexión y mostrar pantalla/estado Offline.",
          "entrada": {
            "network_status": "offline"
          },
          "salida": {
            "screen": "Offline"
          }
        },
        {
          "orden": 2,
          "tarea": "Ofrecer reintento y/o seguir navegando contenido cacheado.",
          "entrada": {},
          "salida": {
            "network_status": "online?"
          },
          "errores": [],
          "recuperacion": []
        }
      ],
      "exito": "Usuario entiende el estado y puede recuperar operación al volver la conexión."
    },
    "F6_Login": {
      "objetivo": "Autenticar usuario o explicar por qué no se puede.",
      "pantallas": [
        "Login",
        "MFA",
        "Home"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Login",
          "tarea": "Capturar email y contraseña.",
          "entrada": [],
          "salida": {
            "credenciales": "email+password"
          },
          "errores": [
            "validacion_basica"
          ],
          "recuperacion": [
            "marcar campos",
            "mensajes claros"
          ]
        },
        {
          "orden": 2,
          "pantalla": "Login",
          "tarea": "Enviar credenciales.",
          "entrada": {
            "credenciales": "validas"
          },
          "salida": {
            "estado": "ok|mfa|required|error"
          },
          "errores": [
            "Credenciales inválidas"
          ],
          "recuperacion": [
            "mensaje neutro 'Credenciales inválidas.'"
          ]
        },
        {
          "orden": 3,
          "condicion": "mfa|required",
          "accion": "redirigir a MFA"
        },
        {
          "orden": 4,
          "condicion": "ok",
          "accion": "redirigir a Home o Profile"
        }
      ],
      "exito": "Inicio de sesión exitoso con feedback adecuado."
    },
    "F7_Register": {
      "objetivo": "Crear una cuenta nueva correctamente.",
      "pantallas": [
        "Register",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario con cuenta creada, listo para iniciar sesión."
    },
    "F8_Recover": {
      "objetivo": "Recuperar acceso sin filtrar si existe la cuenta.",
      "pantallas": [
        "Recover",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario restaura contraseña y puede iniciar sesión."
    },
    "F9_MFA": {
      "objetivo": "Completar segundo factor.",
      "pantallas": [
        "MFA",
        "Home"
      ],
      "pasos": [],
      "exito": "Seguridad extra sin fricción excesiva."
    },
    "F10_LogOff": {
      "objetivo": "Cerrar sesión de manera explícita.",
      "pantallas": [
        "Profile",
        "LogOff",
        "Splash|Login"
      ],
      "pasos": [],
      "exito": "Sesión invalidada, usuario en pantalla segura."
    },
    "F11_SessionTimeout": {
      "objetivo": "Gestionar expiración de sesión sin confusión.",
      "pantallas": [
        "SessionExpired",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario entiende que su sesión caducó y vuelve a autenticarse."
    }
  },
  "data_model": {
    "User": {
      "description": "Entidad usuario final.",
      "fields": {
        "id": "uuid",
        "name": "string",
        "email": "string",
        "avatarUrl": "string?",
        "location": "string?",
        "role": "string?",
        "createdAt": "iso-datetime",
        "prefs": {
          "lang": "es-MX",
          "theme": "light|dark|hc",
          "reduceMotion": "boolean",
          "notifications": "boolean"
        },
        "security": {
          "mfaEnabled": "boolean",
          "providers": "string[]",
          "lastLogin": "iso-datetime",
          "sessions": "number"
        }
      }
    },
    "Session": {
      "description": "Sesión autenticada.",
      "fields": {
        "id": "string",
        "userId": "string",
        "token": "opaque-string",
        "refresh": "opaque-string",
        "exp": "iso-datetime",
        "device": "user-agent-string",
        "ipHash": "string"
      }
    },
    "EntityX": {
      "description": "Entidad genérica de proyecto/case study.",
      "fields": {
        "id": "uuid",
        "title": "string",
        "description": "string?",
        "status": "active|draft|archived",
        "createdAt": "iso-datetime",
        "updatedAt": "iso-datetime",
        "owner": {
          "id": "uuid",
          "name": "string"
        },
        "tags": "string[]"
      }
    },
    "Preference": {
      "description": "Preferencias visuales y de idioma.",
      "fields": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "density": "compact|cozy|comfortable"
      }
    },
    "Security": {
      "description": "Estado de seguridad de la cuenta.",
      "fields": {
        "attempts": "number",
        "lockUntil": "iso-datetime?",
        "lastChange": "iso-datetime"
      }
    }
  },
  "a11y_seo_pwa": {
    "accesibilidad": {
      "contraste": {
        "texto_normal_AA": ">= 4.5:1",
        "texto_grande_AA": ">= 3:1"
      },
      "focus_visible": {
        "minimo": "borde 2px",
        "token_color": "color.semantic.border.bold"
      },
      "orden_tab": "header → nav → main → aside → footer según layout.",
      "landmarks": [
        "header",
        "nav",
        "main",
        "aside",
        "footer"
      ],
      "aria": {
        "aria_live": {
          "notificaciones": "polite",
          "errores_criticos": "assertive"
        },
        "iconos_sin_texto": "aria-label obligatorio."
      },
      "color_no_unico_canal": true,
      "prefers_reduced_motion": "desactivar animaciones no esenciales.",
      "teclado": {
        "enter_space": "activan botones",
        "escape": "cierra modales",
        "tab": "recorre controles en orden lógico"
      },
      "skip_links": [
        "Ir al contenido principal"
      ],
      "formularios": "usar aria-describedby para vincular mensajes de error al campo."
    },
    "seo": {
      "rules": [
        "Un H1 por ruta.",
        "Title < 60 caracteres.",
        "Meta description < 160 caracteres.",
        "URLs semánticas.",
        "Canonical por pantalla pública."
      ],
      "open_graph": [
        "og:title",
        "og:description",
        "og:image",
        "og:url"
      ],
      "twitter_card": [
        "twitter:card",
        "twitter:title",
        "twitter:description"
      ],
      "structured_data": "usar schema.org para persona/organization/proyecto si aplica."
    },
    "pwa": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "strategy": "app_shell",
        "precache_routes": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "data_strategy": "network-first con fallback a cache para datos no sensibles",
        "offline_fallback": "/offline"
      },
      "instalabilidad": [
        "HTTPS",
        "manifest válido",
        "service worker activo"
      ],
      "imagenes": "usar srcset, sizes y lazy loading."
    }
  },
  "security_privacy": {
    "mensajes_auth": {
      "login_error_neutro": "Credenciales inválidas.",
      "recover_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
    },
    "rate_limit": "mostrar mensaje genérico de demasiados intentos, sin detalles técnicos.",
    "lockout": "indicar tiempo aproximado hasta poder reintentar, sin exponer umbral exacto.",
    "password": {
      "reglas": "mínimo 12 caracteres, mayúsculas, minúsculas, número y símbolo; no incluir nombre ni correo.",
      "meter": "indicador visual con texto accesible que explique qué falta."
    },
    "password_visibility": "toggle mostrar/ocultar con aria-pressed y label claro.",
    "mfa": "promocionar activación desde Profile.Seguridad.",
    "sesiones_activas": "lista de dispositivos con opción 'Cerrar sesión en este dispositivo'.",
    "telemetria_privacidad": "usar IDs opacos, respetar consentimiento y minimizar PII."
  },
  "mocks_and_swap": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "latencia_ms": 120,
      "error_rate": 0.03,
      "demo_user": {
        "id": "u-demo",
        "name": "TuNombre",
        "email": "tu@email",
        "prefs": {
          "lang": "es-MX",
          "theme": "light",
          "reduceMotion": false,
          "notifications": true
        }
      }
    },
    "swap_plan": "usar adapters REST/Firebase/Supabase detrás de hooks; UI no se acopla a proveedor."
  },
  "i18n": {
    "idiomas": [
      "es-MX",
      "en-US"
    ],
    "glosario": {
      "Home": {
        "es-MX": "Inicio",
        "en-US": "Home"
      },
      "List": {
        "es-MX": "Lista",
        "en-US": "List"
      },
      "Detail": {
        "es-MX": "Detalle",
        "en-US": "Detail"
      },
      "Save": {
        "es-MX": "Guardar",
        "en-US": "Save"
      }
    },
    "botones": {
      "es-MX": [
        "Ver elementos",
        "Crear nuevo",
        "Guardar cambios",
        "Cancelar",
        "Iniciar sesión",
        "Crear cuenta",
        "Cerrar sesión",
        "Ver detalles",
        "Continuar"
      ],
      "en-US": [
        "View items",
        "Create new",
        "Save changes",
        "Cancel",
        "Sign in",
        "Sign up",
        "Sign out",
        "View details",
        "Continue"
      ]
    },
    "errores": {
      "es-MX": [
        "Credenciales inválidas.",
        "Algo salió mal, intenta de nuevo.",
        "Revisa este campo, falta información.",
        "Código inválido."
      ],
      "en-US": [
        "Invalid credentials.",
        "Something went wrong, please try again.",
        "Check this field, information is missing.",
        "Invalid code."
      ]
    },
    "vacios": {
      "es-MX": [
        "Sin elementos, crea el primero.",
        "Sin datos para mostrar aquí."
      ],
      "en-US": [
        "No items yet, create the first one.",
        "No data to display here."
      ]
    },
    "confirmaciones": {
      "es-MX": [
        "Guardado.",
        "Acceso concedido.",
        "Email de verificación enviado.",
        "Contraseña actualizada.",
        "Sesión finalizada."
      ],
      "en-US": [
        "Saved.",
        "Access granted.",
        "Verification email sent.",
        "Password updated.",
        "Session ended."
      ]
    }
  },
  "eval_plan": {
    "datasets": {
      "golden_cases_min": 16,
      "tipos": [
        "happy_path_auth",
        "errores_login",
        "pantallas_vacias",
        "offline",
        "sesion_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metricas": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": "si json_schema_pass o a11y_checklist_pass < umbral, bloquear release hasta corregir."
  },
  "telemetry": {
    "eventos": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_minimo": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "usar IDs opacos y no incluir PII salvo que sea estrictamente necesario."
  },
  "runtime": {
    "auth_guard": "proteger rutas en cliente y servidor (si SSR) según Session.",
    "redirecciones": "si ruta protegida y no hay sesión, redirigir a Login o Splash.",
    "prefetch": "prefetch de Home, List, Detail tras login.",
    "hydration": "no exponer tokens de acceso en HTML; usarlos solo en llamadas de cliente.",
    "code_splitting": [
      "chunk-auth",
      "chunk-home",
      "chunk-dashboard",
      "chunk-settings"
    ],
    "cache": {
      "publicas": "SSG/ISR",
      "privadas": "CSR/SSR con SWR/react-query",
      "headers_api": "cache-control configurado por endpoint"
    }
  },
  "priorities": {
    "issues_top5": [
      "Estilos definidos fuera de tokens DTCG generan inconsistencia.",
      "Falta de focus visible en algunos componentes interactivos.",
      "CTAs con mismo peso visual compiten en pantallas clave.",
      "Estados universales incompletos en ciertas vistas.",
      "Microcopy no unificada ni lista para i18n."
    ],
    "acciones_top5": [
      "Centralizar tokens visuales en DTCG y mapearlos a theme CSS.",
      "Configurar focus visible global y testear navegación por teclado.",
      "Revisar jerarquía de CTAs en Home, List y Detail; definir una primaria por pantalla.",
      "Definir patrón uniforme de estados (loading, error, empty, offline, success) por pantalla.",
      "Construir glosario + tablas de microcopy y conectarlas al sistema de traducciones."
    ]
  },
  "violations": []
}



{
  "meta": {
    "id": "PROMPT_UIUX_E2E_ROOT_v4_INSTANCE",
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Sistema UI/UX front-end end-to-end: design system, librería atómica, pantallas, flujos, accesibilidad, seguridad, i18n, eval, telemetría y runtime.",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Mostrar experiencia del profesional en menos de 8s",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién es la persona y qué hace",
        "Revisar 2–3 proyectos relevantes",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "CTR en CTA principal Home → Proyectos",
        "Conversiones Home → Contacto/Agendar",
        "Tiempo medio en Detalle de proyecto"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido si la persona encaja en rol técnico/diseño"
      },
      {
        "id": "founder",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico, claridad y calidad de ejecución"
      }
    ],
    "contexto": {
      "dispositivos": [
        "mobile",
        "desktop"
      ],
      "conectividad": "intermitente",
      "regiones": [
        "México",
        "Latam"
      ],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "estado": "hooks+react-query",
      "pwa": true
    }
  },

  "1_tokens_dtcg": {
    "$schema": "https://design-tokens.org/schema.json",
    "meta": {
      "name": "UIX_Portfolio_Tokens",
      "version": "1.0.0",
      "platforms": [
        "web",
        "ios",
        "android"
      ]
    },
    "color": {
      "$type": "color",
      "primitive": {
        "neutral": {
          "0": { "$value": "#FFFFFF" },
          "50": { "$value": "#F7F7F8" },
          "100": { "$value": "#E5E5EA" },
          "200": { "$value": "#D1D1D6" },
          "300": { "$value": "#B0B0B8" },
          "400": { "$value": "#8E8E96" },
          "500": { "$value": "#636366" },
          "600": { "$value": "#48484A" },
          "700": { "$value": "#3A3A3C" },
          "800": { "$value": "#2C2C2E" },
          "900": { "$value": "#000000" }
        },
        "brand": {
          "500": { "$value": "#2563EB" }
        },
        "accent": {
          "500": { "$value": "#EC4899" }
        },
        "ok": {
          "500": { "$value": "#16A34A" }
        },
        "warn": {
          "500": { "$value": "#EAB308" }
        },
        "err": {
          "500": { "$value": "#DC2626" }
        }
      },
      "semantic": {
        "bg": {
          "page": { "$value": "{color.primitive.neutral.50}" },
          "surface": { "$value": "{color.primitive.neutral.0}" }
        },
        "text": {
          "main": { "$value": "{color.primitive.neutral.900}" },
          "muted": { "$value": "{color.primitive.neutral.500}" },
          "inverse": { "$value": "{color.primitive.neutral.0}" }
        },
        "accent": {
          "main": { "$value": "{color.primitive.accent.500}" }
        },
        "border": {
          "bold": { "$value": "{color.primitive.neutral.300}" },
          "subtle": { "$value": "{color.primitive.neutral.200}" }
        },
        "state": {
          "ok": { "$value": "{color.primitive.ok.500}" },
          "warn": { "$value": "{color.primitive.warn.500}" },
          "err": { "$value": "{color.primitive.err.500}" }
        }
      },
      "theme": {
        "light": {
          "bg.page": { "$value": "{color.semantic.bg.page}" },
          "bg.surface": { "$value": "{color.semantic.bg.surface}" },
          "text.main": { "$value": "{color.semantic.text.main}" },
          "text.muted": { "$value": "{color.semantic.text.muted}" }
        },
        "dark": {
          "bg.page": { "$value": "{color.primitive.neutral.900}" },
          "bg.surface": { "$value": "{color.primitive.neutral.800}" },
          "text.main": { "$value": "{color.primitive.neutral.0}" },
          "text.muted": { "$value": "{color.primitive.neutral.300}" }
        },
        "high-contrast": {
          "bg.page": { "$value": "#000000" },
          "bg.surface": { "$value": "#000000" },
          "text.main": { "$value": "#FFFFFF" },
          "text.muted": { "$value": "#FFFFFF" },
          "accent.main": { "$value": "#FFFF00" }
        }
      }
    },
    "typography": {
      "$type": "typography",
      "family": {
        "base": { "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif" }
      },
      "size": {
        "xs": { "$value": "12px" },
        "sm": { "$value": "14px" },
        "md": { "$value": "16px" },
        "lg": { "$value": "20px" },
        "xl": { "$value": "24px" },
        "h1": { "$value": "32px" },
        "h2": { "$value": "24px" },
        "h3": { "$value": "20px" }
      },
      "weight": {
        "regular": { "$value": 400 },
        "semibold": { "$value": 600 },
        "bold": { "$value": 700 }
      },
      "lineHeight": {
        "tight": { "$value": "1.2" },
        "normal": { "$value": "1.4" },
        "loose": { "$value": "1.6" }
      }
    },
    "spacing": {
      "$type": "dimension",
      "scale": {
        "1": { "$value": "4px" },
        "2": { "$value": "8px" },
        "3": { "$value": "12px" },
        "4": { "$value": "16px" },
        "5": { "$value": "24px" },
        "6": { "$value": "32px" }
      }
    },
    "radius": {
      "$type": "dimension",
      "sm": { "$value": "8px" },
      "md": { "$value": "12px" },
      "lg": { "$value": "16px" },
      "pill": { "$value": "999px" }
    },
    "border": {
      "$type": "dimension",
      "thin": { "$value": "1px" },
      "thick": { "$value": "2px" },
      "extra": { "$value": "3px" }
    },
    "shadow": {
      "$type": "shadow",
      "soft": {
        "$value": "0 4px 12px rgba(0,0,0,0.08)"
      },
      "lg": {
        "$value": "0 16px 40px rgba(0,0,0,0.18)"
      }
    },
    "motion": {
      "$type": "duration",
      "fast": { "$value": "150ms" },
      "norm": { "$value": "200ms" },
      "reduced": { "$value": "0ms" }
    },
    "z": {
      "$type": "number",
      "base": { "$value": 1 },
      "dropdown": { "$value": 10 },
      "overlay": { "$value": 100 },
      "modal": { "$value": 1000 },
      "toast": { "$value": 1100 }
    }
  },

  "2_atomic_design_library": {
    "atoms": [
      {
        "name": "Text",
        "variants": [
          "h1",
          "h2",
          "h3",
          "body",
          "caption"
        ],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main",
          "truncate": "boolean"
        },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "variants": [
          "primary",
          "secondary",
          "ghost",
          "danger"
        ],
        "sizes": [
          "sm",
          "md",
          "lg"
        ],
        "states": [
          "default",
          "hover",
          "focus",
          "disabled",
          "loading"
        ],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "ariaLabel": "string?"
        },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "variants": [
          "text",
          "email",
          "password",
          "search",
          "number",
          "otp"
        ],
        "props": {
          "type": "text|email|password|search|number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?"
        },
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string"
        },
        "testIdPattern": "chk-{name}"
      },
      {
        "name": "Radio",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "variants": [
          "default",
          "filter",
          "status"
        ],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "variants": [
          "neutral",
          "ok",
          "warn",
          "err"
        ],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "description": "Label + control + helper + error",
        "parts": [
          "label",
          "control",
          "helper",
          "error"
        ],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "parts": [
          "icon",
          "input",
          "clear"
        ],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "description": "Navegación principal",
        "slots": [
          "logo",
          "primary-links",
          "secondary-actions",
          "user-menu"
        ],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "slots": [
          "section-links",
          "footer-links"
        ],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "description": "Sección hero principal",
        "slots": [
          "eyebrow",
          "title",
          "subtitle",
          "ctas",
          "meta",
          "illustration"
        ],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "description": "Panel hero contextual (disponibilidad, tags)",
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "description": "Lista de elementos con filtros",
        "slots": [
          "filters",
          "results",
          "pagination"
        ],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "slots": [
          "header",
          "body",
          "related"
        ],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "slots": [
          "title",
          "sections",
          "global-errors",
          "actions"
        ],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "slots": [
          "title",
          "fields",
          "actions",
          "secondary-links",
          "legal"
        ],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "slots": [
          "tabs",
          "tab-content",
          "danger-zone"
        ],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "description": "Protección de rutas según sesión",
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "regions": [
          "header",
          "sidebar",
          "main",
          "footer",
          "toasts"
        ],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "regions": [
          "branding",
          "auth-card"
        ],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "regions": [
          "header",
          "sidebar",
          "main"
        ],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "regions": [
          "header",
          "main",
          "related"
        ],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "regions": [
          "header",
          "main",
          "footer"
        ],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "regions": [
          "icon",
          "message",
          "actions"
        ],
        "testIdPattern": "layout-error"
      }
    ]
  },

  "3_screens": {
    "core": {
      "Home": {
        "id": "screen-home",
        "template": "AppShell",
        "role": "home",
        "objetivo": "Comunicar propuesta de valor en 5–8 segundos y dirigir a Proyectos o Contacto.",
        "layout": {
          "desktop": "grid-12: header full; main col-8; HeroPanel col-4; footer full",
          "mobile": "stack: HeroShell → HeroPanel → Highlights → Proof → Footer"
        },
        "secciones": [
          {
            "id": "home-hero",
            "tipo": "HeroShell",
            "componentes": [
              "Text.h1",
              "Text.body",
              "Button.primary",
              "Button.secondary",
              "Chip",
              "MetaBar"
            ],
            "microcopy": {
              "title": "Diseño y código que sí llegan a producción",
              "subtitle": "Portafolio técnico centrado en producto para equipos que necesitan shipping real.",
              "primaryCta": "Ver proyectos",
              "secondaryCta": "Agendar conversación"
            }
          },
          {
            "id": "home-highlights",
            "tipo": "BentoGrid",
            "componentes": [
              "StatCard",
              "CardProyectoDestacado"
            ],
            "microcopy": {
              "title": "Proyectos destacados"
            }
          },
          {
            "id": "home-proof",
            "tipo": "Proof",
            "componentes": [
              "LogoStrip",
              "TestimonialCard"
            ],
            "microcopy": {
              "title": "Confianza y resultados"
            }
          }
        ],
        "ctas": {
          "principal": "Home → List (Proyectos)",
          "secundaria": "Home → Form (Contacto/Agendar)"
        },
        "datos_minimos": [
          "User.name",
          "User.prefs.lang",
          "lista_proyectos_destacados",
          "disponibilidad_actual",
          "stats_resumidas"
        ],
        "estados": {
          "loading": "skeleton hero + skeleton cards",
          "error": "mensajes explícitos + botón Reintentar",
          "empty": "mensaje 'Aún no hay proyectos destacados' + CTA 'Crear primer proyecto'",
          "offline": "banner superior 'Sin conexión' + datos cacheados",
          "success": "toast 'Actualizado' en acciones clave"
        },
        "a11y": {
          "landmarks": [
            "header",
            "main",
            "footer"
          ],
          "tabOrder": [
            "skip-link",
            "navbar",
            "hero-cta-primary",
            "hero-cta-secondary",
            "highlights",
            "proof",
            "footer"
          ]
        }
      },
      "List": {
        "id": "screen-list",
        "role": "list",
        "objetivo": "Permitir explorar proyectos filtrando y encontrando uno relevante rápido.",
        "secciones": [
          {
            "id": "list-filters",
            "tipo": "Filters",
            "componentes": [
              "SearchBar",
              "FilterChips",
              "Select (Sort)"
            ],
            "microcopy": {
              "title": "Explorar proyectos",
              "searchPlaceholder": "Buscar por nombre, tecnología o tipo…"
            }
          },
          {
            "id": "list-results",
            "tipo": "Results",
            "componentes": [
              "ListView",
              "CardProyecto"
            ]
          }
        ],
        "ctas": {
          "principal": "Crear nuevo proyecto",
          "secundaria": "Volver a Home"
        },
        "datos_minimos": [
          "EntityX[] (proyectos)"
        ],
        "estados_universales": true
      },
      "Detail": {
        "id": "screen-detail",
        "role": "detail",
        "objetivo": "Profundizar en un proyecto y tomar decisión (contacto, agendar, compartir).",
        "secciones": [
          {
            "id": "detail-header",
            "tipo": "Header",
            "componentes": [
              "Breadcrumbs",
              "Text.h1",
              "Badge",
              "PrimaryActions"
            ]
          },
          {
            "id": "detail-body",
            "tipo": "Body",
            "componentes": [
              "KeyFacts",
              "Tabs",
              "CodeSnippetPreview",
              "Metrics"
            ]
          },
          {
            "id": "detail-related",
            "tipo": "RelatedList",
            "componentes": [
              "CardProyecto"
            ]
          }
        ],
        "estados_universales": true
      },
      "Form": {
        "id": "screen-form",
        "role": "form",
        "objetivo": "Crear/editar proyectos o enviar solicitud de contacto sin errores.",
        "layout": "FormLayout",
        "secciones": [
          {
            "id": "form-body",
            "tipo": "FormBody",
            "componentes": [
              "Field.title",
              "Field.description",
              "Field.tags",
              "Field.status",
              "Field.links"
            ]
          },
          {
            "id": "form-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary (Guardar cambios)",
              "Button.secondary (Cancelar)"
            ]
          }
        ],
        "schema": "EntityX",
        "estados_universales": true
      },
      "Settings": {
        "id": "screen-settings",
        "role": "settings",
        "objetivo": "Control de preferencias personales.",
        "secciones": [
          {
            "id": "settings-general",
            "tipo": "Preferences",
            "componentes": [
              "Select (Idioma)",
              "Switch (Tema)",
              "Switch (Densidad)"
            ]
          },
          {
            "id": "settings-notifications",
            "tipo": "Notifications",
            "componentes": [
              "Toggle email",
              "Toggle push"
            ]
          }
        ],
        "estados_universales": true
      },
      "Help": {
        "id": "screen-help",
        "role": "help",
        "objetivo": "Responder dudas frecuentes y ofrecer contacto.",
        "secciones": [
          {
            "id": "help-faq",
            "tipo": "FAQ",
            "componentes": [
              "Accordion"
            ]
          },
          {
            "id": "help-contact",
            "tipo": "Contact",
            "componentes": [
              "FormPanel"
            ]
          }
        ],
        "estados_universales": true
      },
      "Offline": {
        "id": "screen-offline",
        "role": "offline",
        "objetivo": "Informar falta de conexión y permitir reintentar.",
        "secciones": [
          {
            "id": "offline-banner",
            "tipo": "Banner",
            "microcopy": {
              "title": "Sin conexión",
              "body": "Revisa tu conexión y vuelve a intentarlo."
            }
          },
          {
            "id": "offline-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary (Reintentar)"
            ]
          }
        ],
        "estados_universales": true
      },
      "Error": {
        "id": "screen-error",
        "role": "error",
        "objetivo": "Explicar error y ofrecer ruta segura.",
        "secciones": [
          {
            "id": "error-404",
            "tipo": "ErrorNotFound",
            "microcopy": {
              "title": "No encontrado",
              "body": "La página que buscas no existe o cambió de lugar.",
              "cta": "Ir al inicio"
            }
          },
          {
            "id": "error-500",
            "tipo": "ErrorServer",
            "microcopy": {
              "title": "Algo salió mal",
              "body": "Hubo un problema inesperado. Intenta de nuevo en unos momentos.",
              "cta": "Volver"
            }
          }
        ],
        "estados_universales": true
      }
    },
    "auth": {
      "Splash": {
        "id": "screen-splash",
        "role": "auth-splash",
        "objetivo": "Verificar sesión y decidir Login vs Home.",
        "secciones": [
          {
            "id": "splash-branding",
            "tipo": "Branding"
          },
          {
            "id": "splash-progress",
            "tipo": "Progress"
          }
        ],
        "datos_minimos": [
          "Session?"
        ]
      },
      "Login": {
        "id": "screen-login",
        "role": "auth-login",
        "objetivo": "Permitir acceso seguro sin fricción.",
        "secciones": [
          {
            "id": "login-form",
            "tipo": "AuthForm",
            "fields": [
              "email",
              "password",
              "remember_me"
            ]
          },
          {
            "id": "login-links",
            "tipo": "AuthLinks",
            "links": [
              "Ir a Registro",
              "Recuperar acceso"
            ]
          }
        ],
        "microcopy": {
          "title": "Iniciar sesión",
          "primaryCta": "Entrar",
          "secondaryCta": "Crear cuenta"
        },
        "estados_universales": true
      },
      "Register": {
        "id": "screen-register",
        "role": "auth-register",
        "objetivo": "Crear cuenta nueva y preparar perfil.",
        "secciones": [
          {
            "id": "register-form",
            "tipo": "AuthForm",
            "fields": [
              "name",
              "email",
              "password",
              "confirm",
              "terms"
            ]
          }
        ],
        "estados_universales": true
      },
      "Recover": {
        "id": "screen-recover",
        "role": "auth-recover",
        "objetivo": "Recuperar acceso sin filtrar existencia de usuarios.",
        "secciones": [
          {
            "id": "recover-request",
            "tipo": "RecoverRequest",
            "fields": [
              "email"
            ]
          },
          {
            "id": "recover-reset",
            "tipo": "RecoverReset",
            "fields": [
              "new_password",
              "confirm_password"
            ]
          }
        ],
        "estados_universales": true
      },
      "MFA": {
        "id": "screen-mfa",
        "role": "auth-mfa",
        "objetivo": "Verificar segundo factor.",
        "secciones": [
          {
            "id": "mfa-otp",
            "tipo": "MFAView",
            "components": [
              "OTPGroup",
              "Button.primary",
              "Link.resend"
            ]
          }
        ],
        "estados_universales": true
      },
      "Profile": {
        "id": "screen-profile",
        "role": "auth-profile",
        "objetivo": "Gestionar datos, preferencias y seguridad.",
        "secciones": [
          {
            "id": "profile-info",
            "tipo": "Tab",
            "title": "Información",
            "fields": [
              "avatar",
              "name",
              "location",
              "email"
            ]
          },
          {
            "id": "profile-preferences",
            "tipo": "Tab",
            "title": "Preferencias",
            "fields": [
              "lang",
              "theme",
              "reduceMotion",
              "notifications"
            ]
          },
          {
            "id": "profile-security",
            "tipo": "Tab",
            "title": "Seguridad",
            "fields": [
              "change_password",
              "mfa_toggle",
              "sessions_list",
              "danger_zone"
            ]
          }
        ],
        "estados_universales": true
      },
      "LogOff": {
        "id": "screen-logoff",
        "role": "auth-logoff",
        "objetivo": "Cerrar sesión de forma segura y redirigir.",
        "secciones": [
          {
            "id": "logoff-confirm",
            "tipo": "Confirm",
            "microcopy": {
              "title": "Cerrar sesión",
              "body": "¿Seguro que quieres cerrar tu sesión en este dispositivo?"
            }
          }
        ],
        "estados_universales": true
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "role": "auth-session-expired",
        "objetivo": "Explicar caducidad de sesión y forzar re-login.",
        "secciones": [
          {
            "id": "session-expired-message",
            "tipo": "Message",
            "microcopy": {
              "title": "Tu sesión expiró",
              "body": "Por seguridad, necesitamos que inicies sesión de nuevo."
            }
          },
          {
            "id": "session-expired-actions",
            "tipo": "Actions",
            "components": [
              "Button.primary (Iniciar sesión de nuevo)"
            ]
          }
        ],
        "estados_universales": true
      }
    }
  },

  "4_flows": {
    "F1_OnboardingAuth": {
      "name": "Onboarding + Auth",
      "steps": [
        "Splash: checar sesión válida",
        "IF sesión válida → Home",
        "ELSE → Login",
        "Login/Register → éxito auth",
        "Opcional MFA → éxito",
        "Home"
      ],
      "success_feedback": "Bienvenida sutil + acceso directo a proyectos."
    },
    "F2_Home_List_Detail": {
      "steps": [
        "Home: entender pitch",
        "Click CTA 'Ver proyectos' → List",
        "List: filtrar/buscar",
        "Seleccionar elemento → Detail",
        "Detail: decidir contacto/compartir"
      ]
    },
    "F3_CRUD_Principal": {
      "steps": [
        "List o Detail: click 'Crear nuevo' o 'Editar'",
        "Form: rellenar campos, validar inline",
        "Submit → loading",
        "Éxito → Detail con toast 'Guardado'",
        "Error → mostrar mensajes claros + retry"
      ]
    },
    "F4_Conversion_Ecommerce_Optional": {
      "steps": [
        "Detail/Pricing: elegir plan",
        "Form pago: datos + validación",
        "Confirmación: recibo + acceso"
      ]
    },
    "F5_Offline_Recovery": {
      "steps": [
        "Detectar offline → mostrar Offline",
        "Intento reconexión",
        "Éxito → restaurar pantalla previa"
      ]
    },
    "F6_Login": {
      "steps": [
        "Login: email+password",
        "Validar credenciales",
        "Si requiere MFA → F9",
        "Éxito → Home/Profile"
      ]
    },
    "F7_Register": {
      "steps": [
        "Register: campos + aceptación términos",
        "Validar reglas de password",
        "Crear cuenta",
        "Enviar email verificación",
        "Redirigir a Login"
      ]
    },
    "F8_Recover": {
      "steps": [
        "Recover: solicitar email",
        "Mostrar mensaje neutro 'Si existe la cuenta…'",
        "Email con enlace",
        "Pantalla reset: nueva password",
        "Confirmación 'Contraseña actualizada'"
      ]
    },
    "F9_MFA": {
      "steps": [
        "MFA: ingresar OTP",
        "Error → mensaje 'Código inválido'",
        "Reenviar OTP",
        "Éxito → Home/Profile"
      ]
    },
    "F10_LogOff": {
      "steps": [
        "Profile/UserMenu: click 'Cerrar sesión'",
        "Confirmación",
        "Revocar tokens en servidor",
        "Redirigir a Splash o Login"
      ]
    },
    "F11_SessionTimeout": {
      "steps": [
        "Detectar expiración → SessionExpired",
        "Mensaje de contexto",
        "Ir a Login reautenticación",
        "Volver a ruta segura (ej. Home)"
      ]
    }
  },

  "5_datos_entidades": {
    "User": {
      "id": "uuid",
      "name": "string",
      "email": "string",
      "avatarUrl": "string?",
      "location": "string?",
      "role": "string?",
      "createdAt": "iso-datetime",
      "prefs": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "notifications": "boolean"
      },
      "security": {
        "mfaEnabled": "boolean",
        "providers": "string[]",
        "lastLogin": "iso-datetime",
        "sessions": "number"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "token": "opaque-string",
      "refresh": "opaque-string",
      "exp": "iso-datetime",
      "device": "user-agent-string",
      "ipHash": "string"
    },
    "EntityX": {
      "id": "uuid",
      "title": "string",
      "description": "string?",
      "status": "active|draft|archived",
      "createdAt": "iso-datetime",
      "updatedAt": "iso-datetime",
      "owner": {
        "id": "uuid",
        "name": "string"
      },
      "tags": "string[]"
    },
    "Preference": {
      "lang": "es-MX",
      "theme": "light|dark|hc",
      "reduceMotion": "boolean",
      "density": "compact|cozy|comfortable"
    },
    "Security": {
      "attempts": "number",
      "lockUntil": "iso-datetime?",
      "lastChange": "iso-datetime"
    }
  },

  "6_accesibilidad_seo_pwa": {
    "accesibilidad": {
      "contraste": {
        "texto_normal": "AA >= 4.5:1",
        "texto_grande": "AA >= 3:1"
      },
      "focus_visible": "mínimo borde 2px con token de border.bold",
      "orden_tab": "header → main → sidebar → footer, respetando lógica visual",
      "landmarks": [
        "header",
        "nav",
        "main",
        "aside",
        "footer"
      ],
      "aria": {
        "aria_live": {
          "notificaciones": "polite",
          "errores_criticos": "assertive"
        },
        "iconos": "aria-label obligatorio si no hay texto visible"
      },
      "color": "no depender solo de color; usar iconos + texto para estados",
      "reduced_motion": "respetar prefers-reduced-motion: desactivar animaciones no esenciales",
      "teclado": [
        "Enter/Space activan botones",
        "Escape cierra modales",
        "Tab/Shift+Tab recorren controles"
      ],
      "skip_links": [
        "Ir al contenido principal"
      ],
      "formularios": "errores descriptivos, aria-describedby ligando mensaje de error con campo"
    },
    "seo": {
      "titles": "H1 único por ruta, < 60 caracteres",
      "meta_description": "< 160 caracteres, única por ruta",
      "open_graph": [
        "og:title",
        "og:description",
        "og:image",
        "og:url"
      ],
      "twitter_card": [
        "twitter:card",
        "twitter:title",
        "twitter:description"
      ],
      "headings": "jerarquía H1 → H2 → H3 sin saltos arbitrarios",
      "urls": [
        "/",
        "/login",
        "/registro",
        "/dashboard",
        "/perfil",
        "/proyectos",
        "/ayuda"
      ],
      "canonical": "una por pantalla pública",
      "structured_data": "JSON-LD schema.org si procede",
      "sitemap": "incluir pantallas públicas",
      "robots": "permitir indexar públicas, bloquear privadas"
    },
    "pwa": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "estrategia": "app_shell",
        "static_cache": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "data_strategy": "network-first con fallback cache",
        "offline_fallback": "/offline"
      },
      "instalabilidad": [
        "HTTPS",
        "manifest válido",
        "service worker registrado"
      ],
      "imagenes": "srcset + sizes + lazy loading"
    }
  },

  "7_seguridad_privacidad_ui": {
    "auth_errores": {
      "mensaje_neutro": "Credenciales inválidas.",
      "recover": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
    },
    "rate_limit": "mostrar mensaje sutil al usuario cuando se alcance el límite, sin detallar razones internas.",
    "lockout": "si la cuenta se bloquea, indicar tiempo restante sin exponer umbrales exactos.",
    "password": {
      "reglas": "mínimo 12 caracteres, mayúsculas, minúsculas, número y símbolo; no incluir nombre ni correo.",
      "meter": "visual, con texto de ayuda accesible."
    },
    "password_visibility": "toggle mostrar/ocultar con aria-pressed.",
    "mfa": "sugerir habilitar MFA desde Profile → Seguridad.",
    "sesiones": "lista de dispositivos activos con opción 'Cerrar sesión en este dispositivo'.",
    "telemetria_privacidad": "consentimiento explícito opt-in, IDs opacos, sin PII innecesaria."
  },

  "8_mocks_hooks_swap": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "latencia_ms": 120,
      "error_rate": 0.03,
      "usuarios_demo": [
        {
          "id": "u-demo",
          "name": "TuNombre",
          "email": "tu@email",
          "prefs": {
            "lang": "es-MX",
            "theme": "light",
            "reduceMotion": false,
            "notifications": true
          }
        }
      ]
    },
    "swap_plan": "usar adapters por proveedor (REST, Firebase, Supabase) detrás de hooks; UI no conoce implementación concreta."
  },

  "9_i18n_microcopy": {
    "idiomas": [
      "es-MX",
      "en-US"
    ],
    "botones": {
      "es-MX": [
        "Ver elementos",
        "Crear nuevo",
        "Guardar cambios",
        "Cancelar",
        "Iniciar sesión",
        "Crear cuenta",
        "Cerrar sesión",
        "Ver detalles",
        "Continuar"
      ],
      "en-US": [
        "View items",
        "Create new",
        "Save changes",
        "Cancel",
        "Sign in",
        "Sign up",
        "Sign out",
        "View details",
        "Continue"
      ]
    },
    "errores": {
      "es-MX": [
        "Credenciales inválidas.",
        "Algo salió mal, intenta de nuevo.",
        "Revisa este campo, falta información.",
        "Código inválido."
      ],
      "en-US": [
        "Invalid credentials.",
        "Something went wrong, please try again.",
        "Check this field, information is missing.",
        "Invalid code."
      ]
    },
    "vacíos": {
      "es-MX": [
        "Sin elementos, crea el primero.",
        "Sin datos para mostrar aquí."
      ],
      "en-US": [
        "No items yet, create the first one.",
        "No data to display here."
      ]
    },
    "confirmaciones": {
      "es-MX": [
        "Guardado.",
        "Acceso concedido.",
        "Email de verificación enviado.",
        "Contraseña actualizada.",
        "Sesión finalizada."
      ],
      "en-US": [
        "Saved.",
        "Access granted.",
        "Verification email sent.",
        "Password updated.",
        "Session ended."
      ]
    }
  },

  "10_eval": {
    "datasets": {
      "golden_cases_min": 16,
      "tipos": [
        "happy_path_auth",
        "errores_login",
        "pantallas_vacías",
        "offline",
        "sesión_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metricas": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": "si json_schema_pass o a11y_checklist_pass caen por debajo de umbral, bloquear release hasta corregir."
  },

  "11_telemetria": {
    "eventos": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_minimo": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "usar IDs opacos; no enviar PII salvo que sea imprescindible y con consentimiento."
  },

  "12_runtime_ssr_ssg_csr": {
    "auth_guard": "protección de rutas tanto en cliente como en servidor (si se usa SSR).",
    "redirecciones": "si sesión expirada o nula en ruta protegida, redirigir a Login o Splash.",
    "prefetch": "rutas críticas (Home, List, Detail) para mejorar UX.",
    "hydration": "no inyectar tokens de acceso en HTML; usarlos sólo en runtime.",
    "code_splitting": [
      "bundle Auth",
      "bundle Home",
      "bundle Dashboard",
      "bundle Settings"
    ],
    "cache": {
      "publicas": "SSG/ISR donde aplique (ej. Home, About)",
      "privadas": "CSR/SSR con caché de datos (SWR/react-query)",
      "headers": "cache-control adecuados para APIs"
    }
  },

  "13_prioridades": {
    "issues_top5": [
      "Estilos sueltos fuera de tokens: riesgo de inconsistencia.",
      "Falta de focus visible en componentes clave.",
      "Demasiadas CTAs con mismo peso visual en una pantalla.",
      "Estados universales incompletos (loading, error, empty, offline, success) en algunas vistas.",
      "Microcopy no unificada ni lista para i18n."
    ],
    "acciones_top5": [
      "Centralizar tokens en DTCG JSON y mapearlos a CSS variables/ThemeProvider.",
      "Añadir estilo de focus visible global y testear navegación por teclado.",
      "Revisar jerarquía visual de CTAs en Home, List y Detail; definir una primaria por pantalla.",
      "Documentar y aplicar patrón de estados universales por pantalla.",
      "Construir glosario y tablas de microcopy e i18n; conectarlo al sistema de traducciones."
    ]
  },

  "14_violations": []
}
ChatGPT Plus

Pensó durante 30s
Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ─────────────────────────────────────
  # META
  # ─────────────────────────────────────
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";
    JSON_SCHEMA:"estricto";
    FALLBACK_MD:"on";

    CONTEXT_ENGINEERING:"on";
    RAG:"opt";
    AGENTIC_ROLES:"planner,researcher,writer,verifier";

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ─────────────────────────────────────
  # INPUTS (a rellenar por el usuario / sistema)
  # ─────────────────────────────────────
  INPUTS{

    PRODUCTO{
      nombre:"<string>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Otro>";
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<...>"];   # p.ej. "conversión", "retención", etc.
      objetivo_usuario:["<...>"];   # p.ej. "resolver X en menos de N pasos"
      KPI:["<activación|retención|conversión|NPS|...>"];
    }

    USUARIOS{
      perfiles:[
        { rol:"<recruiter|cliente|admin|usuario_final>";
          nivel:"<bajo|medio|alto>";
          motivación:"<por qué entra y qué quiere lograr>";
        }
      ];
    }

    CONTEXTO{
      dispositivos:["mobile","desktop"];
      conectividad:"<intermitente|estable>";
      regiones:["<MX|LATAM|...>"];
      idioma_base:"es-MX";
    }

    STACK_HINT{
      runtime:"<CSR|SSR|SSG>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
    }
  }

  # ─────────────────────────────────────
  # CONTRATO DE SALIDA (qué debe generar el LLM)
  # ─────────────────────────────────────
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";   # design tokens DTCG
      THEMES:["light","dark","high-contrast"];  # mapeo a CSS/theme objects
    }

    II.ATOMIC_LIBRARY{
      atoms:"lista de átomos con props/variantes/estados/testIds";
      molecules:"mismas reglas";
      organisms:"mismas reglas";
      templates:"layouts base app/auth/dashboard/detail/form/error";
    }

    III.SCREENS{
      lista:[
        # Core producto
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";  # cada pantalla = instancia SCREEN_SCHEMA
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos",
        "datos_opcionales",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo y latencias";
      factories:"shapes tipados de entidades";
      hooks_mock:"useUser,useSession,useListX,...";
      swap_plan:"API|Firebase|Firestore a través de adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base";
      claves:"keys para i18n";
      tablas_microcopy:"botones, errores, vacíos, confirmaciones";
    }

    X.EVAL{
      golden_set:"casos etiquetados mínimos (≥16)";
      métricas:"json_schema_pass,groundedness,a11y_checklist_pass,readability,...";
      umbrales:"valores mínimos";
      gates_regresión:"bloquear deploy si no pasa";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; respetar consentimiento";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache";
    }

    XIII.PRIORIDADES{
      top5_issues:"problemas más críticos detectados";
      top5_acciones:"acciones concretas para corregirlos";
    }
  }

  # ─────────────────────────────────────
  # SCHEMAS (estructura de todos los bloques)
  # ─────────────────────────────────────
  SCHEMAS{

    # Design Tokens DTCG base
    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#000000";
          "brand-500":"#2563EB";
          "accent-500":"#EC4899";
          "ok-500":"#16A34A";
          "warn-500":"#EAB308";
          "err-500":"#DC2626";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-50}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"{color.primitive.neutral-500}";
          "text.inverse":"{color.primitive.neutral-0}";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-300}";
          "border.subtle":"{color.primitive.neutral-200}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"1.2"; normal:"1.4"; loose:"1.6"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 4px 12px rgba(0,0,0,.08)"; lg:"0 16px 40px rgba(0,0,0,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← mapea semantic tokens a CSS variables";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] máximo contraste; no comunicar solo por color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants:["string"];
      sizes?:["string"];
      states:["string"];          # default|hover|focus|disabled|loading etc
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string";           # /path o patrón /items/:id
      objetivoUX:["string ≤3 items"];
      layout_desktop:{
        grid_12:"descripcion";
        regiones:["header?","main","sidebar?","footer?"];
      };
      layout_mobile:{
        orden_stack:["string"];
        colapsos?["string"];
      };
      secciones:[
        {
          nombre:"string";
          propósito:"string";
          componentes:["componentes (organisms/molecules)"];
        }
      ];
      ctas_principales?[
        {label:"string"; accion:"string (ruta|evento)";}
      ];
      ctas_secundarias?[
        {label:"string"; accion:"string";}
      ];
      datos_minimos:["strings"];
      datos_opcionales?["strings"];
      estados:{
        loading:"descripcion/ui";
        error:"descripcion/ui";
        empty:"descripcion/ui";
        offline:"descripcion/ui";
        success:"descripcion/ui";
      };
      a11y:{
        landmarks:["header","nav","main","aside","footer"];
        tab_order:"descripcion";
        focus_visible:"≥2px";
        aria_roles?["string"];
      };
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pantallas:["string"];
      pasos:[
        {
          orden:int;
          pantalla?:"string";
          tarea:"string";
          entrada?:["string"];
          salida?:"string|mapa";
          estado?:"string";
          error?{mensaje:"string"; recuperación:"string|lista";}
          ramificaciones?:"descripcion condicional";
        }
      ];
      éxito{
        definición:"string";
        feedback?:"string";
      };
    }

    ENTITY.User{
      id:"uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth|webauthn"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"user-agent-string";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"uuid";
      title:"string";
      description?:"string";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string"; name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    A11Y_SCHEMA{
      contraste_AA:{
        texto_normal:">=4.5:1";
        texto_grande:">=3:1";
      };
      focus_visible:"≥2px todos los interactivos usando token de borde";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{
        notificaciones:"polite";
        errores_criticos:"assertive";
      };
      no_solo_color:"true";
      prefers_reduced_motion:"usar animaciones degradadas o ninguna";
      skip_links:["Ir al contenido principal"];
      formularios:"usar aria-describedby vinculado a errores";
    }

    SEO_SCHEMA{
      title:"<60 chars, único por ruta";
      meta_description:"<160 chars, única por ruta";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; jerarquía H2/H3 coherente";
      urls_semanticas:["/","/login","/registro","/dashboard","/perfil","/proyectos","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"string";
        short_name:"string";
        start_url:"string";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"texto neutro si exista o no";
      rate_limit_visual:"mensaje sutil y enfriamiento gradual";
      lockout_feedback:"indicar tiempo de espera sin exponer umbrales exactos";
      password_rules:"≥12 caracteres, variedad clases, no incluir nombre/email";
      password_meter:"indicador visual + texto accesible";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde Profile/Seguridad";
      sesiones_activas:"lista dispositivos + cerrar sesión por dispositivo";
      consentimiento_telemetría:"opt-in claro";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore|Otro";
    }

    EVAL_SCHEMA{
      datasets:{
        golden:["≥16 casos cubriendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo"];
      };
      metrics:[
        "json_schema_pass",
        "groundedness(si_RAG)",
        "hallucination↓",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:">=0.98";
        groundedness:">=0.9";
        a11y_checklist_pass:">=0.95";
      };
      gates_regresión:"on";
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen",
        "click:cta",
        "form:submit",
        "error:ui",
        "net:offline",
        "net:online",
        "auth:view:splash",
        "auth:attempt:login",
        "auth:success:login",
        "auth:fail:login",
        "auth:register:start",
        "auth:register:success",
        "auth:recover:start",
        "auth:recover:success",
        "auth:mfa:required",
        "auth:mfa:success",
        "auth:logout",
        "session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso-datetime";
      };
    }
  }

  # ─────────────────────────────────────
  # PIPELINE (α…ε)
  # ─────────────────────────────────────
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS(TOKENS_DTCG_JSON,SCREEN_SCHEMA,FLOW_SCHEMA,ENTITY.*,A11Y_SCHEMA,SEO_SCHEMA,PWA_SCHEMA,SECURITY_PRIVACY_SCHEMA,EVAL_SCHEMA,TELEMETRY_SCHEMA);
      checar_A11Y:"contrasteAA, focus_visible, landmarks, aria_live, no_solo_color, prefers_reduced_motion";
      checar_SECURITY:"errores_neutros, no_enumerar_usuarios, lockout_visual, password_meter";
      checar_SEO:"title/meta/OG por ruta";
      checar_PWA:"manifest+SW+offline_fallback";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        reintento_con_diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      }
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"lista de verificación final";
    }
  }

  # ─────────────────────────────────────
  # RENDER_ORDER
  # ─────────────────────────────────────
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (atoms/molecules/organisms/templates)";
    3:"SCREENS (instancias SCREEN_SCHEMA para todas las pantallas)";
    4:"FLOWS (F1..F11 como FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (listas verificables)";
    7:"SECURITY_PRIVACY (reglas UI)";
    8:"MOCKS (hooks+fixtures+swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas microcopy)";
    10:"EVAL (datasets+metrics+umbrales+gates)";
    11:"TELEMETRÍA (eventos+payload_min)";
    12:"SSR_SSG_ADAPT (guías)",
    13:"PRIORIDADES (top5_issues+top5_acciones)";
  }

  # ─────────────────────────────────────
  # REGLAS GLOBALES (R₁…R₉)
  # ─────────────────────────────────────
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_definidos_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_no→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  # ─────────────────────────────────────
  # INFERENCIAS POR DEFECTO (fallbacks)
  # ─────────────────────────────────────
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"TuNombre";
      email:"tu@email";
      prefs:{lang:"es-MX"; theme:"light"; reduceMotion:false; notifications:true;};
    };
    EntityX_default:{
      title:"Ejemplo de ítem";
      status:"active";
    };
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ─────────────────────────────────────
  # LIBRERÍA ATÓMICA (catálogo resumido)
  # ─────────────────────────────────────
  ATOMIC_LIBRARY{
    atoms:[
      "Text(H1,H2,H3,body,caption)",
      "Button{variant:primary|secondary|ghost|danger,size:sm|md|lg,state:default|hover|focus|disabled|loading}",
      "Input{type:text|email|password|search|number}",
      "Textarea",
      "Checkbox",
      "Radio",
      "Select",
      "Chip",
      "Badge",
      "Avatar",
      "Icon24",
      "Tooltip",
      "Divider",
      "Spinner"
    ];
    molecules:[
      "Field{label+control+helper+error}",
      "SearchBar{input+icon+clear}",
      "FilterChipsGroup",
      "StatCard{value+label+trend}",
      "OAuthButtons",
      "OTPGroup(6 slots)",
      "UserMenu",
      "Toast"
    ];
    organisms:[
      "NavBar",
      "SideNav|NavRail",
      "HeroShell",
      "HeroPanel",
      "ListView{items+filters+paginación|infiniteScroll}",
      "DetailPanel{header+body+related}",
      "FormPanel{secciones+errores_globales}",
      "AuthForm(Login|Register|Recover)",
      "MFAView",
      "ProfilePanel{tabs:Info|Prefs|Seguridad|Sesiones}",
      "SessionGuard"
    ];
    templates:[
      "AppShell{header+main+sidebar?+footer}",
      "AuthLayout",
      "DashboardLayout",
      "DetailLayout",
      "FormLayout",
      "ErrorLayout"
    ];
  }

  # ─────────────────────────────────────
  # PANTALLAS PRINCIPALES (ejemplos canónicos)
  # ─────────────────────────────────────
  SCREENS{

    SCREEN_HOME:SCREEN_SCHEMA;
    SCREEN_LIST:SCREEN_SCHEMA;
    SCREEN_DETAIL:SCREEN_SCHEMA;
    SCREEN_FORM:SCREEN_SCHEMA;
    SCREEN_SETTINGS:SCREEN_SCHEMA;
    SCREEN_HELP:SCREEN_SCHEMA;
    SCREEN_OFFLINE:SCREEN_SCHEMA;
    SCREEN_ERROR:SCREEN_SCHEMA;

    SCREEN_SPLASH:SCREEN_SCHEMA;
    SCREEN_LOGIN:SCREEN_SCHEMA;
    SCREEN_REGISTER:SCREEN_SCHEMA;
    SCREEN_RECOVER:SCREEN_SCHEMA;
    SCREEN_MFA:SCREEN_SCHEMA;
    SCREEN_PROFILE:SCREEN_SCHEMA;
    SCREEN_LOGOFF:SCREEN_SCHEMA;
    SCREEN_SESSION_EXPIRED:SCREEN_SCHEMA;

    # Nota: el modelo debe instanciar cada SCREEN_* rellenando los campos de SCREEN_SCHEMA
    # según el producto/stack especificado en INPUTS.PRODUCTO / STACK_HINT.
  }

  # ─────────────────────────────────────
  # FLOWS (APP CORE + AUTH)
  # ─────────────────────────────────────
  FLOWS{

    F1_Onboarding_Auth:FLOW_SCHEMA;
    F2_Home_List_Detail:FLOW_SCHEMA;
    F3_CRUD_Principal:FLOW_SCHEMA;
    F4_Conversión:FLOW_SCHEMA;
    F5_Offline_Recovery:FLOW_SCHEMA;
    F6_Login:FLOW_SCHEMA;
    F7_Register:FLOW_SCHEMA;
    F8_Recover:FLOW_SCHEMA;
    F9_MFA:FLOW_SCHEMA;
    F10_LogOff:FLOW_SCHEMA;
    F11_SessionTimeout:FLOW_SCHEMA;

    # El modelo debe describir pasos, ramificaciones y éxito según FLOW_SCHEMA.
  }

  # ─────────────────────────────────────
  # A11Y / SEO / PWA (aplicar A11Y_SCHEMA, SEO_SCHEMA, PWA_SCHEMA)
  # ─────────────────────────────────────
  A11Y_SEO_PWA{
    A11Y_MIN:A11Y_SCHEMA;
    SEO_MIN:SEO_SCHEMA;
    PWA_MIN:PWA_SCHEMA;
  }

  # ─────────────────────────────────────
  # SECURITY & PRIVACY (UI LEVEL)
  # ─────────────────────────────────────
  SECURITY_PRIVACY{
    RULES:SECURITY_PRIVACY_SCHEMA;
  }

  # ─────────────────────────────────────
  # MOCKS + SWAP
  # ─────────────────────────────────────
  MOCKS{
    hooks:[
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ];
    fixtures:{
      lat_ms:120;
      error_rate:0.03;
      demo_user:ENTITY.User;
    };
    swap_plan:"usar adapters (REST/Firebase/Supabase/otro) detrás de hooks; UI no conoce proveedor concreto";
  }

  # ─────────────────────────────────────
  # I18N + UX COPY (resumen)
  # ─────────────────────────────────────
  I18N_UX_COPY{
    idiomas:["es-MX","en-US"];
    glosario:[
      "Home","Lista","Detalle","Guardar cambios","Cancelar",
      "Iniciar sesión","Crear cuenta","Recuperar acceso","Cerrar sesión",
      "Ver detalles","Continuar"
    ];
    tablas:[
      {contexto:"botones",
       textos:["Ver elementos","Crear nuevo","Guardar cambios","Cancelar","Iniciar sesión","Crear cuenta","Cerrar sesión"];},
      {contexto:"errores",
       textos:["Credenciales inválidas","Algo salió mal. Intenta de nuevo.","Revisa este campo: falta información.","Código inválido"];},
      {contexto:"vacíos",
       textos:["Aún no hay elementos. Crea el primero.","Aún no hay datos para mostrar aquí."];},
      {contexto:"confirmaciones",
       textos:["Listo, se guardó tu información.","Acceso concedido.","Te enviamos el correo de verificación.","Contraseña actualizada.","Sesión finalizada."];},
    ];
  }

  # ─────────────────────────────────────
  # EVALUACIÓN (PROMPT EVALS)
  # ─────────────────────────────────────
  EVAL{
    spec:EVAL_SCHEMA;
  }

  # ─────────────────────────────────────
  # TELEMETRÍA
  # ─────────────────────────────────────
  TELEMETRÍA{
    eventos:TELEMETRY_SCHEMA.eventos_core;
    payload_min:TELEMETRY_SCHEMA.payload_min;
    privacidad:"minimizar datos personales; IDs opacos; respetar consentimiento";
  }

  # ─────────────────────────────────────
  # SSR / SSG / CSR ADAPT
  # ─────────────────────────────────────
  SSR_SSG_ADAPT{
    auth_guard:"server+client para rutas protegidas";
    redirecciones:"server-side en sesión expirada cuando aplique";
    prefetch_selectivo:"solo rutas seguras y necesarias (Home,List,Detail)";
    hydration_segura:"no exponer credenciales ni tokens en HTML";
    división_código:"Auth, Home/Dashboard, Settings en bundles separados";
    cache:{
      publicas:"SSG/ISR (Home, landing, marketing)";
      privadas:"CSR/SSR con SWR/react-query para datos autenticados";
    };
  }

  # ─────────────────────────────────────
  # PRIORIDADES (para backlog inmediato)
  # ─────────────────────────────────────
  PRIORIDADES{
    top5_issues:[
      "estilos_fuera_de_tokens",
      "falta_focus_visible_en_elementos_clave",
      "CTAs_compiten_en_la_misma_pantalla",
      "estados_universales_incompletos(loading/error/empty/offline/success)",
      "microcopy_inconsistente_o_no_i18n_ready"
    ];
    top5_acciones:[
      "centralizar_tokens_en_DTCG_JSON_y_migrar_componentes",
      "añadir_focus_visible_global_y_probar_con_teclado",
      "revisar_jerarquía_de_CTAs_por_pantalla",
      "definir_y_documentar_estados_universales_por_pantalla",
      "construir_tablas_microcopy+i18n_y_activarlas_en_flows_críticos"
    ];
  }

  # ─────────────────────────────────────
  # INSTRUCCIONES AL LLM
  # ─────────────────────────────────────
  INSTRUCCIONES_AL_LLM{
    I:"Usar PIPELINE y RENDER_ORDER como guía estricta de generación.";
    II:"Respetar SCHEMAS en estructuras JSON; si no se puede, describir violaciones en nodo 'Violations'.";
    III:"No incluir razonamiento interno ni auto-referencias al modelo.";
    IV:"Usar TOKENS para todos los valores visuales; reportar hex directos si aparecen.";
    V:"Garantizar estados_universales en cada pantalla y coherencia de flows Splash→Auth→Home→List→Detail→Form→Profile→LogOff.";
  }

}
Tú dijiste:

Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1

# ─────────────────────────────────────
# META
# ─────────────────────────────────────
META{
  ENC:"UTF-8"; LANG:"es-MX";
  STYLE:"conciso"; DENSIDAD:"alta";
  OUTPUT:"markdown+json"; PRIVACY:"no_chain_of_thought";
}

FLAGS{
  STRUCTURED_OUTPUT:"preferido"; JSON_SCHEMA:"estricto"; FALLBACK_MD:"on";
  CONTEXT_ENGINEERING:"on"; RAG:"opt"; AGENTIC_ROLES:"planner,researcher,writer,verifier";
  A11Y:"WCAG2.1_AA"; SEO:"on"; PWA:"on"; I18N:"on"; SSR_SSG:"opt";
  SECURITY:"on"; PRIVACY:"on"; EVAL:"on"; TELEMETRÍA:"on";
}

# ─────────────────────────────────────
# INPUTS (a rellenar por el usuario)
# ─────────────────────────────────────
INPUTS{
  PRODUCTO{
    nombre:"<string>",
    tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Otro>",
    público:"<B2B|B2C|Mixto>",
    objetivo_negocio:["<...>"],
    objetivo_usuario:["<...>"],
    KPI:["<activación|retención|conversión|NPS|...>"]
  };

  USUARIOS{
    perfiles:[
      {rol:"<recruiter|cliente|admin|usuario final>", nivel:"<bajo|medio|alto>", motivación:"<...>"}
    ];
  };

  CONTEXTO{
    dispositivos:["mobile","desktop"],
    conectividad:"<intermitente|estable>",
    regiones:["<...>"],
    idioma_base:"es-MX"
  };

  STACK_HINT{
    runtime:"<CSR|SSR|SSG>",
    framework:"<React|Vue|Svelte|Next|Nuxt|Otro>",
    estado_app:"<hooks|zustand|redux|query|otro>"
  };
}

# ─────────────────────────────────────
# CONTRATO DE SALIDA (qué debe generar el LLM)
# ─────────────────────────────────────
CONTRATO_SALIDA{
  I.DESIGN_SYSTEM{ TOKENS:DTCG_JSON; THEMES:["light","dark","high-contrast"]; }
  II.ATOMIC_LIBRARY{ atoms,molecules,organisms,templates → props,variantes,estados,testIds; }
  III.SCREENS{
    lista:[
      # Core producto
      "Home","List","Detail","Form","Settings","Help","Offline","Error",
      # Auth pack
      "Splash","Login","Register","Recover","MFA(opc)","Profile","LogOff","SessionExpired"
    ];
    contrato_por_pantalla(SCREEN_SCHEMA);
  }
  IV.FLOWS{
    lista:[
      "F1_Onboarding/Auth","F2_Home→List→Detail","F3_CRUD_Principal",
      "F4_Conversión(opc)","F5_Offline_Recovery",
      "F6_Login","F7_Register","F8_Recover","F9_MFA(opc)","F10_LogOff","F11_SessionTimeout"
    ];
    formato(FLOW_SCHEMA);
  }
  V.DATOS{
    ENTIDADES:{ User,Session,EntityX,Preference,Security };
    contratos_por_pantalla(datos_minimos,opc,estados);
  }
  VI.A11Y_SEO_PWA{ reglas_mínimas_verificables; }
  VII.SECURITY_PRIVACY{ reglas_UI_auth+datos; }
  VIII.MOCKS{ fixtures,factories,hooks_mock; swap_plan("API|Firebase|Firestore"); }
  IX.I18N_UX_COPY{ glosario, claves, tablas_microcopy; }
  X.EVAL{ golden_set, métricas, umbrales, gates_regresión; }
  XI.TELEMETRÍA{ eventos, payload_min, privacidad; }
  XII.SSR_SSG_ADAPT{ guías concretas; }
  XIII.PRIORIDADES{ top5_issues, top5_acciones; }
}

# ─────────────────────────────────────
# SCHEMAS
# ─────────────────────────────────────
SCHEMAS{

  TOKENS_DTCG_JSON{
    color:{
      primitive:{
        "neutral-0":"#FFFFFF",
        "neutral-50":"#F7F7F8",
        "neutral-900":"#050509",
        "brand-500":"#3366FF",
        "accent-500":"#FF7AE0",
        "ok-500":"#22C55E",
        "warn-500":"#FFC857",
        "err-500":"#FF4B4B"
      },
      semantic:{
        "bg.page":"{color.primitive.neutral-0}",
        "bg.surface":"{color.primitive.neutral-0}",
        "bg.surface-alt":"{color.primitive.neutral-50}",
        "text.main":"{color.primitive.neutral-900}",
        "text.muted":"rgba(15,23,42,.6)",
        "accent.main":"{color.primitive.brand-500}",
        "border.bold":"{color.primitive.neutral-900}",
        "state.ok":"{color.primitive.ok-500}",
        "state.warn":"{color.primitive.warn-500}",
        "state.err":"{color.primitive.err-500}"
      }
    },
    type:{
      "family.base":"system-ui, -apple-system, Segoe UI, Inter, Roboto, sans-serif",
      size:{ xs:"12px", sm:"14px", md:"16px", lg:"20px", xl:"24px", h1:"32px", h2:"24px", h3:"20px" },
      weight:{ reg:400, semib:600, bold:700 },
      line:{ tight:"120%", normal:"140%", loose:"160%" }
    },
    space:{ 1:"4px",2:"8px",3:"12px",4:"16px",5:"24px",6:"32px" },
    radius:{ sm:"8px", md:"12px", lg:"16px", pill:"999px" },
    border:{ thin:"1px", thick:"2px", extra:"3px" },
    shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)", lg:"0 12px 32px rgba(15,23,42,.18)" },
    motion:{ fast:"150ms", norm:"200ms", reduced:"0ms" },
    z:{ base:1, dropdown:10, overlay:100, modal:1000, toast:1100 }
  }

  THEMING{
    light:":root ← TOKENS_DTCG_JSON.semantic";
    dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
    hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
  }

  SCREEN_SCHEMA{
    id, nombre, rol, objetivoUX[≤3],
    layout_desktop{grid_12, regiones:[header?,main,sidebar?,footer?]},
    layout_mobile{orden_stack:[...], colapsos:[...]},
    secciones[{nombre, propósito, componentes(organisms|molecules)}],
    ctas_principales[{label,accion}], ctas_secundarias[],
    datos_minimos[], datos_opcionales[],
    estados:{loading,error,empty,offline,success},
    a11y:{landmarks,tab_order,focus_visible:"≥2px",aria_roles[]},
    microcopy:{titular,sub,botones[],errores[],vacios[],confirmaciones[]}
  }

  FLOW_SCHEMA{
    id, nombre,
    pasos[
      {pantalla, tarea, entrada?, salida?, estado?, error?{mensaje,recuperación}}
    ],
    ramificaciones[{condición, destino}],
    éxito{definición, feedback}
  }

  ENTITY.User{
    id:"string|uuid",
    name:"string",
    email:"string",
    avatarUrl?:"string",
    location?:"string",
    role?:"string",
    createdAt:"iso",
    prefs:{lang:"es-MX", theme:"light|dark|hc", reduceMotion:"bool", notifications:"bool"},
    security:{mfaEnabled:"bool", providers:["password|oauth"], lastLogin:"iso", sessions:int}
  }

  ENTITY.Session{
    id:"string", userId:"string",
    token:"opaque", refresh:"opaque",
    exp:"iso", device:"agent", ipHash:"string"
  }

  ENTITY.EntityX{
    id:"string|uuid",
    title:"string",
    description:"string?",
    status:"active|draft|archived",
    createdAt:"iso",
    updatedAt:"iso",
    owner:{id:"string",name:"string"},
    tags:["string"]
  }

  ENTITY.Preference{
    lang:"es-MX",
    theme:"light|dark|hc",
    reduceMotion:"bool",
    density:"compact|cozy|comfortable"
  }

  ENTITY.Security{
    attempts:int,
    lockUntil?:"iso",
    lastChange:"iso"
  }

  MOCK_HOOK_SCHEMA{
    nombre, entidad, shape_JSON, lat_ms, error_rate, swap_plan:"API|Firebase|Firestore"
  }

  EVAL_SCHEMA{
    datasets:{golden:[≥16 casos incluyendo empty/error/offline/timeout/mfa/CRUD]},
    metrics:["json_schema_pass","hallucination↓","groundedness(si_RAG)","readability","a11y_checklist_pass"],
    umbrales:{json_schema_pass≥0.98, a11y_checklist_pass≥0.95, groundedness≥0.9},
    gates:{regresión:true}
  }

  TELEMETRY_SCHEMA{
    eventos_core:[
      "view:screen","click:cta","form:submit","error:ui",
      "net:offline","net:online",
      "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
      "auth:register:start","auth:register:success",
      "auth:recover:start","auth:recover:success",
      "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
    ],
    payload_min:{screen_id, cta_id?, entity_id?, user_id?, method?, error_code?, ts_iso}
  }
}

# ─────────────────────────────────────
# PIPELINE (α…ε)
# ─────────────────────────────────────
PIPELINE (α…ε){
  α.CONTEXT_PLAN{
    filtrar_contexto_relevante;
    rank_score=0.5*autoridad+0.3*recencia+0.2*task_fit;
    comprimir_resumen_denso;
    dedup_semántico;
  }

  β.GENERACIÓN{
    modo_salida="STRUCTURED_OUTPUT|JSON"; si_no_soportado→"Markdown con bloques JSON válidos";
    roles_logicos:"planner→researcher→writer→verifier" (simulados si 1 LLM);
  }

  γ.VALIDACIÓN{
    validar_JSON_vs_SCHEMAS;
    checar_A11Y(contrasteAA, focus_visible, roles, aria_live);
    checar_SECURITY(auth_mensajes_neutros, no_enumerar_usuarios, lockout_visual);
    checar_SEO_min(título/meta por ruta);
    checar_PWA(manifest+SW+offline_fallback);
  }

  δ.CORRECCIÓN{
    si_falla_validación→reintento_max=2_con_diff_min;
    registrar_diffs_en_nodo_MetaViolations;
  }

  ε.PAQUETE{
    seguir_RENDER_ORDER;
    incluir_checklist_DoD;
  }
}

# ─────────────────────────────────────
# RENDER_ORDER
# ─────────────────────────────────────
RENDER_ORDER{
  1)TOKENS(DTCG_JSON+THEMING);
  2)ATOMIC_LIBRARY(tabla:nivel→componentes→props/variantes→testIds);
  3)SCREENS(instancias SCREEN_SCHEMA);
  4)FLOWS(F1..F11 instancias FLOW_SCHEMA);
  5)A11Y_SEO_PWA(listas verificables);
  6)SECURITY_PRIVACY(reglas);
  7)MOCKS(hooks+fixtures+swap_plan);
  8)I18N_UX_COPY(glosario+tablas);
  9)EVAL(datasets+metrics+umbrales+gates);
  10)TELEMETRÍA(eventos+payload_min);
  11)SSR_SSG_ADAPT(guías concisas);
  12)PRIORIDADES(top5_issues/top5_acciones);
}

# ─────────────────────────────────────
# REGLAS GLOBALES (R₁…R₉)
# ─────────────────────────────────────
REGLAS{
  R1:no_duplicidad_semántica_en_nombres;
  R2:todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes;
  R3:estados_universales_definidos_en_cada_pantalla:{loading,error,empty,offline,success};
  R4:microcopy_consistente_e_i18n_ready;
  R5:contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion;
  R6:auth_errores_neutros("Credenciales inválidas"); no_enumerar_usuarios_en_recover;
  R7:no_exponer_razonamiento_interno; nada_de_COT_en_salida;
  R8:si_RAG_on→citar_fuentes; si_no→no_inventar_citas;
  R9:reportar_violaciones_en_bloque_"Violations" si las hay.
}

# ─────────────────────────────────────
# INFERENCIAS POR DEFECTO (fallbacks)
# ─────────────────────────────────────
INFERENCIAS_DEFECTO{
  User:{name:"<TuNombre>", email:"<tu@email>",
        prefs:{lang:"es-MX",theme:"light",reduceMotion:false,notifications:true}};
  EntityX:{title:"Ejemplo de ítem", status:"active"};
  Home_titular:"Propuesta de valor en 5–8 palabras";
  ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
  ESTADOS_UNIVERSALES:{loading:"skeleton",error:"mensaje+retry",empty:"mensaje+CTA",offline:"banner+fallback",success:"toast"};
}

# ─────────────────────────────────────
# LIBRERÍA ATÓMICA (resumen)
# ─────────────────────────────────────
ATOMIC_LIBRARY{
  atoms:[
    "Text(H1,H2,H3,body,caption)",
    "Button{variant:primary|secondary|ghost|danger,size:sm|md|lg,state:default|hover|focus|disabled|loading}",
    "Input{type:text|email|password|search|number|otp}",
    "Textarea","Checkbox","Radio","Select","Chip/Badge","Avatar","Icon24","TooltipTrigger","Divider","Spinner"
  ];
  molecules:[
    "Field{label+input+helper+error}",
    "SearchBar{input+icon}",
    "FilterChipsGroup",
    "StatCard{value+label}",
    "OAuthButtons",
    "OTPGroup(6 slots)",
    "UserMenu",
    "Toast"
  ];
  organisms:[
    "NavBar","SideNav|NavRail","HeroShell","HeroPanel",
    "ListView{items+filters+paginación|infiniteScroll}",
    "DetailPanel{header+body+related}",
    "FormPanel{secciones+errores_globales}",
    "AuthForm(Login|Register|Recover)",
    "MFAView",
    "ProfilePanel{tabs:Info|Prefs|Seguridad|Sesiones}",
    "SessionGuard"
  ];
  templates:[
    "AppShell{header+main+sidebar?+footer}",
    "AuthLayout",
    "DashboardLayout",
    "DetailLayout",
    "FormLayout",
    "ErrorLayout"
  ];
}

# ─────────────────────────────────────
# PANTALLAS CORE (Home/List/Detail/Form/Settings/Help/Offline/Error)
# ─────────────────────────────────────
SCREEN_HOME (SCREEN_SCHEMA){
  id:"P1"; nombre:"Home"; rol:"inicio/portada";
  objetivoUX:["comunicar_valor","dirigir_a_acción_principal","mostrar_contexto_clave"];
  layout_desktop:{grid_12, regiones:["header","main(HeroShell)","sidebar(HeroPanel opc)","footer"]};
  layout_mobile:{orden_stack:["HeroShell","HeroPanel","Highlights"]};
  secciones:[
    {nombre:"HeroShell", propósito:"pitch_≤5s",
     componentes:["HeroAvailabilityRow","HeroTitleBlock","CTAGroup","MetaBar"]},
    {nombre:"Highlights", propósito:"acceso_rápido",
     componentes:["BentoGrid","StatCards"]},
    {nombre:"Proof/Evidencia", propósito:"credibilidad",
     componentes:["ListPreview|Carousel"]}
  ];
  ctas_principales:[{label:"CTA_Principal",accion:"→List|Detalle_clave"}];
  ctas_secundarias:[{label:"CTA_Secundaria",accion:"→otra_sección"}];
  datos_minimos:["profile","availability","stats[]","shortcuts?","highlights?"];
  estados:ESTADOS_UNIVERSALES;
  a11y:{landmarks:["header","main","footer"],tab_order:"availability→CTAs→shortcuts→proof"};
  microcopy:{
    titular:"Propuesta de valor clara",
    sub:"Qué haces y para quién en una frase",
    botones:["Ver elementos","Agendar conversación"],
    errores:[],
    vacíos:["Aún no hay elementos destacados. Agrega tus primeros contenidos."],
    confirmaciones:["Listo, se guardó tu información."]
  };
}

SCREEN_LIST (SCREEN_SCHEMA){
  id:"P2"; nombre:"List"; rol:"explorar/buscar";
  objetivoUX:["encontrar","filtrar","navegar_detalle"];
  layout_desktop:{grid_12,regiones:["header","filters","results","footer"]};
  layout_mobile:{orden_stack:["filters","results"]};
  secciones:[
    {nombre:"Filters",propósito:"reducir_búsqueda",componentes:["SearchBar","FilterChipsGroup","SortSelect"]},
    {nombre:"Results",propósito:"explorar",componentes:["Cards|Rows","EmptyState","Pagination|InfiniteScroll"]}
  ];
  ctas_principales:[{label:"Crear nuevo",accion:"→Form"}];
  datos_minimos:["EntityX[]"], estados:ESTADOS_UNIVERSALES;
  a11y:{landmarks:["main","region(results)"],aria_roles:["list","listitem"]};
  microcopy:{
    titular:"Explorar",
    vacíos:["Aún no hay elementos. Crea el primero."],
    errores:["No pudimos cargar la lista. Intenta de nuevo."]
  };
}

SCREEN_DETAIL (SCREEN_SCHEMA){
  id:"P3"; nombre:"Detail"; rol:"comprender_tomar_decisión";
  objetivoUX:["entender","actuar"];
  layout_desktop:{grid_12,regiones:["header","main","related"]};
  layout_mobile:{orden_stack:["header","main","related"]};
  secciones:[
    {nombre:"Header",propósito:"contexto+acciones",componentes:["Title","PrimaryActions","Breadcrumbs(opc)"]},
    {nombre:"Body",propósito:"contenido_principal",componentes:["KeyFacts","Tabs|Accordion"]},
    {nombre:"Related",propósito:"continuidad",componentes:["RelatedList|Recommendations"]}
  ];
  ctas_principales:[{label:"Acción principal",accion:"→Form|acción_negocio"}];
  datos_minimos:["EntityX"], estados:ESTADOS_UNIVERSALES;
  a11y:{landmarks:["main"],aria_roles:["article"]};
}

SCREEN_FORM (SCREEN_SCHEMA){
  id:"P4"; nombre:"Form"; rol:"crear/editar";
  objetivoUX:["completar_tarea_sin_error"];
  layout_desktop:{grid_12,regiones:["header","main","footer"]};
  layout_mobile:{orden_stack:["main","footer"]};
  secciones:[
    {nombre:"FormBody",propósito:"entrada_datos",componentes:["FieldGroup","Helper/ErrorTexts"]},
    {nombre:"Actions",propósito:"confirmar",componentes:["PrimaryButton","SecondaryButton"]}
  ];
  datos_minimos:["EntityX_schema"], estados:ESTADOS_UNIVERSALES;
  a11y:{tab_order:"label→campo→ayuda→error→acciones",aria_live:"assertive para errores globales"};
}

SCREEN_SETTINGS (SCREEN_SCHEMA){
  id:"P5"; nombre:"Settings"; rol:"preferencias_app";
  objetivoUX:["control_personal"];
  secciones:[
    {nombre:"Preferencias generales",propósito:"idioma+tema+density",componentes:["Select(lang)","ThemeSwitch","DensityToggle"]},
    {nombre:"Notificaciones",propósito:"alertas",componentes:["Toggle(notifications)"]}
  ];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_HELP (SCREEN_SCHEMA){
  id:"P6"; nombre:"Help"; rol:"asistencia";
  objetivoUX:["resolver_dudas","desatascar_usuario"];
  secciones:[
    {nombre:"FAQ",propósito:"respuestas_rápidas"},
    {nombre:"Contact",propósito:"contacto_soporte"}
  ];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_OFFLINE (SCREEN_SCHEMA){
  id:"P7"; nombre:"Offline"; rol:"recuperación";
  objetivoUX:["informar","permitir_reintento"];
  secciones:[
    {nombre:"Banner",propósito:"estado"},
    {nombre:"Actions",propósito:"reintentar"}
  ];
  estados:ESTADOS_UNIVERSALES;
  microcopy:{vacios:["Sin conexión. Reintenta cuando vuelvas a estar online."]};
}

SCREEN_ERROR (SCREEN_SCHEMA){
  id:"P8"; nombre:"Error(404/500)"; rol:"error";
  objetivoUX:["explicar","recuperar"];
  secciones:[
    {nombre:"Message",propósito:"contexto"},
    {nombre:"CTA",propósito:"volver_a_ruta_segura"}
  ];
  estados:ESTADOS_UNIVERSALES;
  microcopy:{
    errores:["No encontramos esto.","Algo salió mal."],
    botones:["Ir al inicio","Volver"]
  };
}

# ─────────────────────────────────────
# PANTALLAS AUTH PACK (Splash/Login/Register/Recover/MFA/Profile/LogOff/SessionExpired)
# ─────────────────────────────────────
SCREEN_SPLASH (SCREEN_SCHEMA){
  id:"A0"; nombre:"Splash"; rol:"detección_sesión";
  objetivoUX:["cargar_branding","chequear_sesión","redirigir"];
  layout_desktop:{grid_12,regiones:["main"]};
  layout_mobile:{orden_stack:["main"]};
  secciones:[
    {nombre:"Branding",propósito:"identidad"},
    {nombre:"Progress",propósito:"estado_carga"}
  ];
  datos_minimos:["session?" ];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_LOGIN (SCREEN_SCHEMA){
  id:"A1"; nombre:"Login"; rol:"acceso";
  objetivoUX:["entrar_sin_fricción","mantener_seguridad"];
  secciones:[
    {nombre:"AuthForm(Login)",propósito:"credenciales",
     componentes:["Field(email)","Field(password)","Checkbox(Recordarme)","Button(Entrar)","Link(Recover)","OAuthButtons(opc)"]},
    {nombre:"Legal",propósito:"consentimiento",componentes:["Text(terminos/privacidad)"]}
  ];
  ctas_principales:[{label:"Entrar",accion:"validar_credenciales"}];
  ctas_secundarias:[{label:"Crear cuenta",accion:"→Register"}];
  datos_minimos:["credential.email","credential.password"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_REGISTER (SCREEN_SCHEMA){
  id:"A2"; nombre:"Register"; rol:"alta_nueva";
  objetivoUX:["crear_cuenta","preparar_perfil"];
  secciones:[
    {nombre:"AuthForm(Register)",propósito:"alta",
     componentes:["Field(name)","Field(email)","Field(password+meter)","Field(confirm)","Checkbox(Acepto términos)","Button(Crear cuenta)"]},
    {nombre:"Hints",propósito:"reglas_password",componentes:["Text(checklist)"]}
  ];
  ctas_principales:[{label:"Crear cuenta",accion:"validar+enviar"}];
  ctas_secundarias:[{label:"Ya tengo cuenta",accion:"→Login"}];
  datos_minimos:["user.name","credential.email","credential.password"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_RECOVER (SCREEN_SCHEMA){
  id:"A3"; nombre:"Recover"; rol:"recuperar_acceso";
  objetivoUX:["recuperar_sin_filtrar_usuarios"];
  secciones:[
    {nombre:"Request",propósito:"solicitar_reset",componentes:["Field(email)","Button(Enviar enlace)"]},
    {nombre:"Reset",propósito:"nueva_contraseña",componentes:["Field(new_password+meter)","Field(confirm)","Button(Confirmar)"]}
  ];
  datos_minimos:["credential.email|resetToken"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_MFA (SCREEN_SCHEMA){
  id:"A4"; nombre:"MFA"; rol:"segundo_factor";
  objetivoUX:["verificar_identidad"];
  secciones:[
    {nombre:"OTP",propósito:"ingreso_código",componentes:["OTPGroup(6)","Button(Verificar)","Link(Reenviar)"]},
    {nombre:"Alternativas",propósito:"otros_factores",componentes:["Button(WebAuthn) opc"]}
  ];
  datos_minimos:["credential.otp"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_PROFILE (SCREEN_SCHEMA){
  id:"A5"; nombre:"Profile"; rol:"gestión_personal";
  objetivoUX:["editar_datos","preferencias","seguridad"];
  secciones:[
    {nombre:"Info",propósito:"datos_básicos",componentes:["Avatar","Field(name)","Field(location)","Field(email:readonly|verify_state)"]},
    {nombre:"Preferencias",propósito:"experiencia",componentes:["Select(language)","ThemeSwitch","Toggle(reduceMotion)","Toggle(notifications)"]},
    {nombre:"Seguridad",propósito:"proteger_cuenta",componentes:["ChangePassword","MFA_Toggle","SessionsList(terminate)","DangerZone(delete_account)"]}
  ];
  ctas_principales:[{label:"Guardar cambios",accion:"persistir"}];
  ctas_secundarias:[{label:"Cerrar sesión",accion:"→LogOff"}];
  datos_minimos:["User","Session"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_LOGOFF (SCREEN_SCHEMA){
  id:"A6"; nombre:"LogOff"; rol:"salida_segura";
  objetivoUX:["terminar_sesión","redirigir"];
  secciones:[
    {nombre:"Confirm",propósito:"opcional",componentes:["Button(Cerrar sesión)","Button(Cancelar)"]}
  ];
  ctas_principales:[{label:"Cerrar sesión",accion:"revocar_tokens→redirigir→Login"}];
  datos_minimos:["Session.id"];
  estados:ESTADOS_UNIVERSALES;
}

SCREEN_SESSION_EXPIRED (SCREEN_SCHEMA){
  id:"A7"; nombre:"SessionExpired"; rol:"reautenticación";
  objetivoUX:["explicar_caducidad","relogin_rápido"];
  secciones:[
    {nombre:"Message",propósito:"contexto"},
    {nombre:"CTA",propósito:"volver_a_login"}
  ];
  ctas_principales:[{label:"Iniciar sesión de nuevo",accion:"→Login"}];
  estados:ESTADOS_UNIVERSALES;
}

# ─────────────────────────────────────
# FLOWS (APP CORE + AUTH)
# ─────────────────────────────────────
FLOWS{
  F1_Onboarding/Auth (FLOW_SCHEMA){
    id:"F1"; nombre:"Onboarding/Auth";
    pasos:[
      {pantalla:"Splash",tarea:"chequear_sesión",salida:"valida?→Home:Login"},
      {pantalla:"Login|Register",tarea:"auth",salida:"→Home"},
      {pantalla:"Home",tarea:"presentación_valor"}
    ];
    éxito:{definición:"sesión_valida_o_login_exitoso"};
  }

  F2_Home→List→Detail (FLOW_SCHEMA){
    id:"F2"; nombre:"Home a List+Detail";
    pasos:[
      {pantalla:"Home",tarea:"entender_pitch+click_CTA_Principal",salida:"→List"},
      {pantalla:"List",tarea:"buscar/filtrar",salida:"seleccionar_item"},
      {pantalla:"Detail",tarea:"evaluar",salida:"acción_principal|volver"}
    ];
    éxito:{definición:"usuario_encuentra_y_entiende_elemento_clave"};
  }

  F3_CRUD_Principal (FLOW_SCHEMA){
    id:"F3"; nombre:"Crear/Editar EntityX";
    pasos:[
      {pantalla:"List|Detail",tarea:"click_crear/editar",salida:"→Form"},
      {pantalla:"Form",tarea:"llenar_campos",error:{mensaje:"Faltan datos",recuperación:"resaltar_campos"}},
      {pantalla:"Form",tarea:"enviar",estado:"loading",salida:"→Detail"},
      {pantalla:"Detail",tarea:"ver_resultado",salida:"confirmación"}
    ];
    éxito:{definición:"entidad_guardada_sin_errores_criticos"};
  }

  F4_Conversión (FLOW_SCHEMA){
    id:"F4"; nombre:"Conversión (checkout/plan)";
    pasos:[
      {pantalla:"Detail|Pricing",tarea:"elegir_plan|item",salida:"→Form_pago"},
      {pantalla:"Form",tarea:"ingresar_datos_pago",error:{mensaje:"Pago rechazado",recuperación:"método_alterno"}},
      {pantalla:"Confirmación(Detail|otra)",tarea:"recibo/acceso"}
    ];
    éxito:{definición:"transacción_exitosa"};
  }

  F5_Offline_Recovery (FLOW_SCHEMA){
    id:"F5"; nombre:"Offline/Recuperación";
    pasos:[
      {pantalla:"Offline",tarea:"informar_estado",salida:"reintentar"},
      {pantalla:"pantalla_previa",tarea:"recuperar_estado",salida:"normal"}
    ];
    éxito:{definición:"sesión/flujo_recuperado"};
  }

  F6_Login (FLOW_SCHEMA){
    id:"F6"; nombre:"Login";
    pasos:[
      {pantalla:"Login",tarea:"ingresar_email_password",estado:"loading",error:{mensaje:"Credenciales inválidas",recuperación:"reintentar"}},
      {pantalla:"MFA(opc)",tarea:"verificar_otp",ramificaciones:"si_mfa_enabled"},
      {pantalla:"Home|Profile",tarea:"bienvenida"}
    ];
    éxito:{definición:"auth_ok"};
  }

  F7_Register (FLOW_SCHEMA){
    id:"F7"; nombre:"Registro";
    pasos:[
      {pantalla:"Register",tarea:"capturar_datos+aceptar_terminos",error:{mensaje:"Contraseña débil",recuperación:"ajustar"}},
      {pantalla:"Register",tarea:"enviar_form",salida:"verificación_email_enviada"},
      {pantalla:"Login",tarea:"ingresar_post_verificación"}
    ];
    éxito:{definición:"cuenta_creada+verificada"};
  }

  F8_Recover (FLOW_SCHEMA){
    id:"F8"; nombre:"Recuperar acceso";
    pasos:[
      {pantalla:"Recover",tarea:"solicitar_enlace",salida:"mensaje_neutro"},
      {pantalla:"Recover",tarea:"establecer_nueva_password",salida:"confirmación"}
    ];
    éxito:{definición:"password_actualizada"};
  }

  F9_MFA (FLOW_SCHEMA){
    id:"F9"; nombre:"MFA";
    pasos:[
      {pantalla:"MFA",tarea:"ingresar_otp",error:{mensaje:"Código inválido",recuperación:"reenviar"}},
      {pantalla:"Home|Profile",tarea:"acceso"}
    ];
    éxito:{definición:"segundo_factor_ok"};
  }

  F10_LogOff (FLOW_SCHEMA){
    id:"F10"; nombre:"Cerrar sesión";
    pasos:[
      {pantalla:"Profile|UserMenu",tarea:"click_logoff",salida:"revocar_tokens"},
      {pantalla:"Splash|Login",tarea:"redirigir"}
    ];
    éxito:{definición:"tokens_revocados+redirección"};
  }

  F11_SessionTimeout (FLOW_SCHEMA){
    id:"F11"; nombre:"Sesión expirada";
    pasos:[
      {pantalla:"SessionExpired",tarea:"informar",salida:"→Login"},
      {pantalla:"Login",tarea:"reautenticar"}
    ];
    éxito:{definición:"sesión_renovada"};
  }
}

# ─────────────────────────────────────
# A11Y / SEO / PWA
# ─────────────────────────────────────
A11Y_SEO_PWA{
  A11Y_MIN{
    contraste:"AA"; focus_visible:"≥2px en todos los elementos interactivos";
    orden_tab:"lógico(header→main→sidebar→footer)";
    landmarks:["header","nav","main","region","footer"];
    aria_live:"toasts/errores_globales";
    no_solo_color:"sí";
    prefers-reduced-motion:"animaciones degradan a estados estáticos";
  };

  SEO_MIN{
    title_y_meta_por_ruta:"Home,List,Detail,Form,Auth,Profile";
    OG_min:"title,description,image para Home y páginas clave";
    headings:"H1 único por pantalla, jerarquía H2/H3 coherente";
    urls_semánticas:"/items,/items/:id,/settings,/login,/register";
  };

  PWA_MIN{
    manifest:"sí";
    service_worker:"app_shell+SWR_datos_criticos";
    offline_fallback:"pantalla Offline y estados seguros en flows",
    responsive_images:"srcset+sizes+lazy donde aplique";
  };
}

# ─────────────────────────────────────
# SECURITY & PRIVACY (UI LEVEL)
# ─────────────────────────────────────
SECURITY_PRIVACY{
  errores_neutros_auth:"Credenciales inválidas";
  no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
  rate_limit_visual:"mensaje_sutil y enfriamiento gradual";
  lockout_feedback:"tiempo de espera comunicado sin revelar motivos internos";
  password_meter:"reglas mínimas: longitud≥12, variedad de clases, no incluir nombre/email";
  mostrar_ocultar_password:"toggle con aria-pressed";
  mfa_sugerido:"habilitar desde Profile/Seguridad";
  sesiones_activas:"lista de dispositivos con opción 'Cerrar en este dispositivo'";
  consentimiento_telemetría:"opt-in claro";
}

# ─────────────────────────────────────
# MOCKS + SWAP
# ─────────────────────────────────────
MOCKS{
  hooks:[
    "useUser","useSession","useListX","useDetailX","useCreateX",
    "useLogin","useRegister","useRecover","useMFA","useProfile"
  ];
  fixtures_tipadas:"sí";
  lat_ms:120;
  error_rate:0.03;
  swap_plan:"inyección_de_dependencias → API/Firebase/Firestore sin tocar UI";
}

# ─────────────────────────────────────
# I18N + UX COPY (resumen)
# ─────────────────────────────────────
I18N_UX_COPY{
  glosario:{
    "Home","Lista","Detalle","Guardar cambios","Cancelar",
    "Iniciar sesión","Crear cuenta","Recuperar acceso","Cerrar sesión",
    "Ver detalles","Continuar"
  };
  tablas:[
    {contexto:"botones",
     textos:["Ver elementos","Crear nuevo","Guardar cambios","Cancelar","Iniciar sesión","Crear cuenta","Cerrar sesión"]},
    {contexto:"errores",
     textos:["Credenciales inválidas","Algo salió mal. Intenta de nuevo.","Revisa este campo: falta información.","Código inválido"]},
    {contexto:"vacíos",
     textos:["Aún no hay elementos. Crea el primero.","Aún no hay datos para mostrar aquí."]},
    {contexto:"confirmaciones",
     textos:["Listo, se guardó tu información.","Acceso concedido.","Te enviamos el correo de verificación.","Contraseña actualizada.","Sesión finalizada."]}
  ];
}

# ─────────────────────────────────────
# EVALUACIÓN (PROMPT EVALS)
# ─────────────────────────────────────
EVAL{
  datasets_golden:"≥16 casos, cubriendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";
  metrics:["json_schema_pass","groundedness(si_RAG)","a11y_checklist_pass","readability"];
  umbrales:{json_schema_pass≥0.98, groundedness≥0.9, a11y_checklist_pass≥0.95};
  gates_regresión:"on";
}

# ─────────────────────────────────────
# TELEMETRÍA
# ─────────────────────────────────────
TELEMETRÍA{
  eventos:TELEMETRY_SCHEMA.eventos_core;
  payload_min:TELEMETRY_SCHEMA.payload_min;
  privacidad:"minimizar datos personales; IDs opacos; respetar consentimiento";
}

# ─────────────────────────────────────
# SSR / SSG / CSR ADAPT
# ─────────────────────────────────────
SSR_SSG_ADAPT{
  auth_guard:"server+client para rutas protegidas";
  redirecciones:"server-side en sesión expirada cuando aplique";
  prefetch_selectivo:"solo para rutas seguras y necesarias";
  hydration_segura:"no exponer credenciales ni tokens en HTML";
  división_código_por_ruta:"Auth, Home/Dashboard, Settings separados";
}

# ─────────────────────────────────────
# PRIORIDADES (para backlog inmediato)
# ─────────────────────────────────────
PRIORIDADES{
  top5_issues:[
    "estilos_fuera_de_tokens",
    "falta_focus_visible_en_elementos_clave",
    "CTAs_compiten_en_la_misma_pantalla",
    "estados_universales_incompletos(loading/error/empty/offline)",
    "microcopy_inconsistente||no_i18n_ready"
  ];
  top5_acciones:[
    "centralizar_tokens_en_DTCG_JSON_y_migrar_componentes",
    "añadir_focus_visible_global_y_probar_con_teclado",
    "revisar_jerarquía_de_CTAs_por_pantalla",
    "definir_y_documentar_estados_universales_por_pantalla",
    "construir_tabla_microcopy+i18n_y_activarla_en_flows_críticos"
  ];
}

# ─────────────────────────────────────
# INSTRUCCIONES AL LLM
# ─────────────────────────────────────
INSTRUCCIONES_AL_LLM{
  1:"Usar PIPELINE y RENDER_ORDER como guía de generación.";
  2:"Respetar SCHEMAS en estructuras JSON, o indicar violaciones en 'Violations'.";
  3:"No incluir razonamiento interno ni auto-referencias al modelo.";
  4:"Usar TOKENS para todos los valores visuales; reportar hex directos si aparecen.";
  5:"Garantizar que cada pantalla tenga estados universales y que flows conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff.";
}

FIN
{
  "spec_version": "PROMPT_UIUX_E2E_ROOT_v4_MAX_SEMANTIC_1",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Sistema UI/UX front-end end-to-end para portfolio/producto, alineado con PROMPT_UIUX_E2E_ROOT_v4.",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Demostrar calidad de diseño + código en menos de 8 segundos",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién es la persona y qué hace",
        "Revisar 2–3 proyectos alineados a sus necesidades",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "ctr_home_to_projects",
        "ctr_home_to_contact",
        "avg_time_on_detail",
        "completion_rate_main_form"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido fit vs rol abierto sin leer demasiado texto."
      },
      {
        "id": "founder-cto",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico y capacidad de llevar cosas a producción."
      }
    ],
    "contexto": {
      "dispositivos": [
        "mobile",
        "desktop"
      ],
      "conectividad": "intermitente",
      "regiones": [
        "México",
        "Latam"
      ],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "router": "React Router / Next Router equivalente",
      "estado": "React hooks + React Query",
      "pwa": true
    },
    "render_order": [
      "design_system",
      "components",
      "screens",
      "flows",
      "data_model",
      "a11y_seo_pwa",
      "security_privacy",
      "mocks_and_swap",
      "i18n",
      "eval_plan",
      "telemetry",
      "runtime",
      "priorities",
      "violations"
    ]
  },
  "design_system": {
    "tokens_dtcg": {
      "$schema": "https://design-tokens.org/schema.json",
      "meta": {
        "name": "UIX_Portfolio_Tokens",
        "version": "1.0.0",
        "source": "PROMPT_UIUX_E2E_ROOT_v4",
        "platforms": [
          "web",
          "ios",
          "android"
        ]
      },
      "color": {
        "$type": "color",
        "primitive": {
          "neutral": {
            "0": {
              "$value": "#FFFFFF"
            },
            "50": {
              "$value": "#F7F7F8"
            },
            "100": {
              "$value": "#E5E5EA"
            },
            "200": {
              "$value": "#D1D1D6"
            },
            "300": {
              "$value": "#B0B0B8"
            },
            "400": {
              "$value": "#8E8E96"
            },
            "500": {
              "$value": "#636366"
            },
            "600": {
              "$value": "#48484A"
            },
            "700": {
              "$value": "#3A3A3C"
            },
            "800": {
              "$value": "#2C2C2E"
            },
            "900": {
              "$value": "#000000"
            }
          },
          "brand": {
            "500": {
              "$value": "#2563EB"
            }
          },
          "accent": {
            "500": {
              "$value": "#EC4899"
            }
          },
          "ok": {
            "500": {
              "$value": "#16A34A"
            }
          },
          "warn": {
            "500": {
              "$value": "#EAB308"
            }
          },
          "err": {
            "500": {
              "$value": "#DC2626"
            }
          }
        },
        "semantic": {
          "bg": {
            "page": {
              "$value": "{color.primitive.neutral.50}"
            },
            "surface": {
              "$value": "{color.primitive.neutral.0}"
            }
          },
          "text": {
            "main": {
              "$value": "{color.primitive.neutral.900}"
            },
            "muted": {
              "$value": "{color.primitive.neutral.500}"
            },
            "inverse": {
              "$value": "{color.primitive.neutral.0}"
            }
          },
          "accent": {
            "main": {
              "$value": "{color.primitive.accent.500}"
            }
          },
          "border": {
            "bold": {
              "$value": "{color.primitive.neutral.300}"
            },
            "subtle": {
              "$value": "{color.primitive.neutral.200}"
            }
          },
          "state": {
            "ok": {
              "$value": "{color.primitive.ok.500}"
            },
            "warn": {
              "$value": "{color.primitive.warn.500}"
            },
            "err": {
              "$value": "{color.primitive.err.500}"
            }
          }
        },
        "theme": {
          "light": {
            "bg.page": {
              "$value": "{color.semantic.bg.page}"
            },
            "bg.surface": {
              "$value": "{color.semantic.bg.surface}"
            },
            "text.main": {
              "$value": "{color.semantic.text.main}"
            },
            "text.muted": {
              "$value": "{color.semantic.text.muted}"
            },
            "accent.main": {
              "$value": "{color.semantic.accent.main}"
            }
          },
          "dark": {
            "bg.page": {
              "$value": "{color.primitive.neutral.900}"
            },
            "bg.surface": {
              "$value": "{color.primitive.neutral.800}"
            },
            "text.main": {
              "$value": "{color.primitive.neutral.0}"
            },
            "text.muted": {
              "$value": "{color.primitive.neutral.300}"
            },
            "accent.main": {
              "$value": "{color.primitive.accent.500}"
            }
          },
          "high-contrast": {
            "bg.page": {
              "$value": "#000000"
            },
            "bg.surface": {
              "$value": "#000000"
            },
            "text.main": {
              "$value": "#FFFFFF"
            },
            "text.muted": {
              "$value": "#FFFFFF"
            },
            "accent.main": {
              "$value": "#FFFF00"
            }
          }
        }
      },
      "typography": {
        "$type": "typography",
        "family": {
          "base": {
            "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
          }
        },
        "size": {
          "xs": {
            "$value": "12px"
          },
          "sm": {
            "$value": "14px"
          },
          "md": {
            "$value": "16px"
          },
          "lg": {
            "$value": "20px"
          },
          "xl": {
            "$value": "24px"
          },
          "h1": {
            "$value": "32px"
          },
          "h2": {
            "$value": "24px"
          },
          "h3": {
            "$value": "20px"
          }
        },
        "weight": {
          "regular": {
            "$value": 400
          },
          "semibold": {
            "$value": 600
          },
          "bold": {
            "$value": 700
          }
        },
        "lineHeight": {
          "tight": {
            "$value": "1.2"
          },
          "normal": {
            "$value": "1.4"
          },
          "loose": {
            "$value": "1.6"
          }
        }
      },
      "spacing": {
        "$type": "dimension",
        "scale": {
          "1": {
            "$value": "4px"
          },
          "2": {
            "$value": "8px"
          },
          "3": {
            "$value": "12px"
          },
          "4": {
            "$value": "16px"
          },
          "5": {
            "$value": "24px"
          },
          "6": {
            "$value": "32px"
          }
        }
      },
      "radius": {
        "$type": "dimension",
        "sm": {
          "$value": "8px"
        },
        "md": {
          "$value": "12px"
        },
        "lg": {
          "$value": "16px"
        },
        "pill": {
          "$value": "999px"
        }
      },
      "border": {
        "$type": "dimension",
        "thin": {
          "$value": "1px"
        },
        "thick": {
          "$value": "2px"
        },
        "extra": {
          "$value": "3px"
        }
      },
      "shadow": {
        "$type": "shadow",
        "soft": {
          "$value": "0 4px 12px rgba(0,0,0,0.08)"
        },
        "lg": {
          "$value": "0 16px 40px rgba(0,0,0,0.18)"
        }
      },
      "motion": {
        "$type": "duration",
        "fast": {
          "$value": "150ms"
        },
        "norm": {
          "$value": "200ms"
        },
        "reduced": {
          "$value": "0ms"
        }
      },
      "z": {
        "$type": "number",
        "base": {
          "$value": 1
        },
        "dropdown": {
          "$value": 10
        },
        "overlay": {
          "$value": 100
        },
        "modal": {
          "$value": 1000
        },
        "toast": {
          "$value": 1100
        }
      }
    }
  },
  "components": {
    "atoms": [
      {
        "name": "Text",
        "semantic_role": "typography",
        "variants": [
          "h1",
          "h2",
          "h3",
          "body",
          "caption"
        ],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err",
          "truncate": "boolean",
          "ariaLabel": "string?"
        },
        "states": [
          "default"
        ],
        "a11y": {
          "h1": "unico_por_pantalla",
          "caption": "no_usar_para_texto_largo"
        },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "semantic_role": "interactive-cta",
        "variants": [
          "primary",
          "secondary",
          "ghost",
          "danger"
        ],
        "sizes": [
          "sm",
          "md",
          "lg"
        ],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "disabled": "boolean",
          "loading": "boolean",
          "ariaLabel": "string?"
        },
        "states": [
          "default",
          "hover",
          "focus",
          "disabled",
          "loading"
        ],
        "tokens": {
          "bg": "brand|neutral|transparent|state.err",
          "radius": "radius.md",
          "shadow": "shadow.soft"
        },
        "a11y": {
          "role": "button",
          "focusVisible": "borde 2px usando color.border.bold",
          "keyboard": "Enter/Space activan acción"
        },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "semantic_role": "form-field",
        "variants": [
          "text",
          "email",
          "password",
          "search",
          "number"
        ],
        "props": {
          "type": "text|email|password|search|number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?",
          "hasError": "boolean"
        },
        "states": [
          "default",
          "focus",
          "error",
          "disabled"
        ],
        "tokens": {
          "border": "border.subtle|border.bold",
          "radius": "radius.sm",
          "shadow": "none"
        },
        "a11y": {
          "role": "textbox",
          "error": "aria-invalid=true cuando hasError"
        },
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "semantic_role": "form-field-multiline",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "hasError": "boolean"
        },
        "states": [
          "default",
          "focus",
          "error",
          "disabled"
        ],
        "tokens": {
          "border": "border.subtle|border.bold",
          "radius": "radius.sm"
        },
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "semantic_role": "binary-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "indeterminate": "boolean?"
        },
        "states": [
          "checked",
          "unchecked",
          "indeterminate",
          "disabled"
        ],
        "a11y": {
          "role": "checkbox",
          "keyboard": "Space alterna estado"
        },
        "testIdPattern": "chk-{label}"
      },
      {
        "name": "Radio",
        "semantic_role": "exclusive-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "states": [
          "checked",
          "unchecked",
          "disabled"
        ],
        "a11y": {
          "role": "radio"
        },
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "semantic_role": "single-select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "states": [
          "default",
          "open",
          "disabled"
        ],
        "a11y": {
          "role": "combobox"
        },
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "semantic_role": "filter-token|status-indicator",
        "variants": [
          "default",
          "filter",
          "status"
        ],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "states": [
          "selected",
          "unselected",
          "disabled"
        ],
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "semantic_role": "status-indicator",
        "variants": [
          "neutral",
          "ok",
          "warn",
          "err"
        ],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "semantic_role": "user-identity",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "states": [
          "default",
          "fallback"
        ],
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "semantic_role": "decorative|informative",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "states": [
          "decorative",
          "informative"
        ],
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "semantic_role": "description",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "states": [
          "closed",
          "open"
        ],
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "semantic_role": "layout-separator",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "semantic_role": "progress-indicator",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "states": [
          "spinning"
        ],
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "semantic_role": "form-field-wrapper",
        "parts": [
          "label",
          "control",
          "helper",
          "error"
        ],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "states": [
          "default",
          "error",
          "disabled"
        ],
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "semantic_role": "search-entry",
        "parts": [
          "icon",
          "input",
          "clear"
        ],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "states": [
          "default",
          "with-query"
        ],
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "semantic_role": "filter-group",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "states": [
          "empty",
          "with-selection"
        ],
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "semantic_role": "metric-display",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "semantic_role": "social-login",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "states": [
          "default"
        ],
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "semantic_role": "mfa-otp-input",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "states": [
          "empty",
          "partial",
          "full"
        ],
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "semantic_role": "user-shortcut-menu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "states": [
          "closed",
          "open"
        ],
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "semantic_role": "ephemeral-feedback",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "states": [
          "visible",
          "hidden"
        ],
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "semantic_role": "primary-navigation",
        "slots": [
          "logo",
          "primary-links",
          "secondary-actions",
          "user-menu"
        ],
        "states": [
          "default",
          "scrolled"
        ],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "semantic_role": "secondary-navigation",
        "slots": [
          "section-links",
          "footer-links"
        ],
        "states": [
          "expanded",
          "collapsed"
        ],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "semantic_role": "page-hero",
        "slots": [
          "eyebrow",
          "title",
          "subtitle",
          "ctas",
          "meta",
          "illustration"
        ],
        "states": [
          "default",
          "compact"
        ],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "semantic_role": "context-panel",
        "slots": [
          "availability",
          "chips",
          "meta"
        ],
        "states": [
          "default"
        ],
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "semantic_role": "collection-display",
        "slots": [
          "filters",
          "results",
          "pagination"
        ],
        "states": [
          "loading",
          "error",
          "empty",
          "success"
        ],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "semantic_role": "entity-detail",
        "slots": [
          "header",
          "body",
          "related"
        ],
        "states": [
          "loading",
          "error",
          "success"
        ],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "semantic_role": "entity-form",
        "slots": [
          "title",
          "sections",
          "global-errors",
          "actions"
        ],
        "states": [
          "editing",
          "submitting",
          "error",
          "success"
        ],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "semantic_role": "auth-form",
        "slots": [
          "title",
          "fields",
          "actions",
          "secondary-links",
          "legal"
        ],
        "states": [
          "idle",
          "submitting",
          "error"
        ],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "semantic_role": "mfa-step",
        "slots": [
          "title",
          "otp",
          "resend",
          "alternate"
        ],
        "states": [
          "idle",
          "submitting",
          "error"
        ],
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "semantic_role": "account-settings",
        "slots": [
          "tabs",
          "tab-content",
          "danger-zone"
        ],
        "states": [
          "view",
          "editing",
          "saving"
        ],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "semantic_role": "route-guard",
        "states": [
          "checking",
          "allowed",
          "blocked"
        ],
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "semantic_role": "app-layout",
        "regions": [
          "header",
          "sidebar",
          "main",
          "footer",
          "toasts"
        ],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "semantic_role": "auth-layout",
        "regions": [
          "branding",
          "auth-card"
        ],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "semantic_role": "dashboard-layout",
        "regions": [
          "header",
          "sidebar",
          "main"
        ],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "semantic_role": "detail-layout",
        "regions": [
          "header",
          "main",
          "related"
        ],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "semantic_role": "form-layout",
        "regions": [
          "header",
          "main",
          "footer"
        ],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "semantic_role": "error-layout",
        "regions": [
          "icon",
          "message",
          "actions"
        ],
        "testIdPattern": "layout-error"
      }
    ]
  },
  "screens": {
    "core": {
      "Home": {
        "id": "screen-home",
        "route": "/",
        "template": "AppShell",
        "rol": "home",
        "objetivo_ux": "Comunicar propuesta de valor en 5–8s y dirigir a Proyectos o Contacto.",
        "layout": {
          "desktop": "grid-12: header full; main col-span-8; HeroPanel col-span-4; footer full",
          "mobile": "stack: HeroShell → HeroPanel → Highlights → Proof → Footer"
        },
        "contrato_datos": {
          "obligatorios": [
            "User.name",
            "User.prefs.lang",
            "proyectos_destacados[]",
            "disponibilidad_actual"
          ],
          "opcionales": [
            "stats_resumidas",
            "testimonios[]",
            "logos_confianza[]"
          ]
        },
        "secciones": [
          {
            "id": "home-hero",
            "tipo": "HeroShell",
            "componentes": [
              "Text.h1",
              "Text.body",
              "Button.primary",
              "Button.secondary",
              "Chip",
              "MetaBar"
            ]
          },
          {
            "id": "home-highlights",
            "tipo": "Highlights",
            "componentes": [
              "BentoGrid",
              "StatCard"
            ]
          },
          {
            "id": "home-proof",
            "tipo": "Proof",
            "componentes": [
              "LogoStrip",
              "TestimonialCard"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargar skeleton de hero y cards.",
            "ui": [
              "Spinner",
              "skeletons"
            ]
          },
          "error": {
            "descripcion": "Error al cargar datos iniciales.",
            "ui": [
              "Alert.error",
              "Button.reintentar"
            ]
          },
          "empty": {
            "descripcion": "No hay proyectos destacados aún.",
            "ui": [
              "EmptyState",
              "Button.primary"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, se muestran datos cacheados.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Datos cargados correctamente.",
            "ui": [
              "HeroShell",
              "Highlights",
              "Proof"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-home')",
          "ctas": [
            {
              "id": "cta-home-view-projects",
              "evento": "click:cta",
              "destino": "/proyectos"
            },
            {
              "id": "cta-home-book-call",
              "evento": "click:cta",
              "destino": "/contacto"
            }
          ]
        },
        "a11y": {
          "landmarks": [
            "header",
            "main",
            "footer"
          ],
          "tab_order": [
            "skip-link",
            "navbar",
            "hero-primary-cta",
            "hero-secondary-cta",
            "highlights",
            "proof",
            "footer"
          ],
          "h1_unico": true
        },
        "seo": {
          "title": "Portafolio técnico – Home",
          "meta_description": "Portafolio técnico centrado en producto: proyectos reales, código en producción y foco en negocio.",
          "og_title": "Portafolio técnico",
          "og_type": "website"
        }
      },
      "List": {
        "id": "screen-list",
        "route": "/proyectos",
        "template": "AppShell",
        "rol": "list",
        "objetivo_ux": "Permitir encontrar un proyecto relevante mediante búsqueda y filtros.",
        "contrato_datos": {
          "obligatorios": [
            "EntityX[]"
          ],
          "opcionales": [
            "filtros_disponibles[]",
            "paginacion"
          ]
        },
        "secciones": [
          {
            "id": "list-filters",
            "tipo": "Filters",
            "componentes": [
              "SearchBar",
              "FilterChips",
              "Select"
            ]
          },
          {
            "id": "list-results",
            "tipo": "Results",
            "componentes": [
              "ListView",
              "CardProyecto"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Se están cargando los proyectos.",
            "ui": [
              "Spinner",
              "skeleton-list"
            ]
          },
          "error": {
            "descripcion": "Error al cargar lista.",
            "ui": [
              "Alert.error",
              "Button.reintentar"
            ]
          },
          "empty": {
            "descripcion": "No hay proyectos.",
            "ui": [
              "EmptyState",
              "Button.primary"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, mostrar datos cacheados si hay.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Proyectos cargados correctamente.",
            "ui": [
              "ListView"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-list')",
          "ctas": [
            {
              "id": "cta-list-create",
              "evento": "click:cta",
              "destino": "/proyectos/nuevo"
            }
          ]
        }
      },
      "Detail": {
        "id": "screen-detail",
        "route": "/proyectos/:id",
        "template": "DetailLayout",
        "rol": "detail",
        "objetivo_ux": "Profundizar en un proyecto y decidir acción (contactar, agendar, compartir).",
        "contrato_datos": {
          "obligatorios": [
            "EntityX",
            "User"
          ],
          "opcionales": [
            "relacionados[]",
            "links_codigo[]",
            "metricas"
          ]
        },
        "secciones": [
          {
            "id": "detail-header",
            "tipo": "Header",
            "componentes": [
              "Breadcrumbs",
              "Text.h1",
              "Badge",
              "PrimaryActions"
            ]
          },
          {
            "id": "detail-body",
            "tipo": "Body",
            "componentes": [
              "KeyFacts",
              "Tabs",
              "CodeSnippetPreview",
              "Metrics"
            ]
          },
          {
            "id": "detail-related",
            "tipo": "RelatedList",
            "componentes": [
              "CardProyecto"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargando detalles de proyecto.",
            "ui": [
              "Spinner",
              "skeleton-detail"
            ]
          },
          "error": {
            "descripcion": "Error al cargar proyecto.",
            "ui": [
              "ErrorLayout"
            ]
          },
          "empty": {
            "descripcion": "No se encontró el proyecto.",
            "ui": [
              "ErrorLayout-404"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, mostrar último estado cacheado.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Detalle completo cargado.",
            "ui": [
              "DetailPanel"
            ]
          }
        },
        "eventos": {
          "view": "view:screen (screen_id='screen-detail')",
          "ctas": [
            {
              "id": "cta-detail-contact",
              "evento": "click:cta",
              "destino": "/contacto"
            }
          ]
        }
      },
      "Form": {
        "id": "screen-form",
        "route": "/proyectos/nuevo|/proyectos/:id/editar",
        "template": "FormLayout",
        "rol": "form",
        "objetivo_ux": "Crear/editar proyectos con mínima fricción y sin errores silenciosos.",
        "contrato_datos": {
          "obligatorios": [
            "EntityX.schema"
          ],
          "opcionales": [
            "plantillas",
            "tags_sugeridos[]"
          ]
        },
        "secciones": [
          {
            "id": "form-body",
            "tipo": "FormBody",
            "componentes": [
              "Field.title",
              "Field.description",
              "Field.tags",
              "Field.status",
              "Field.links"
            ]
          },
          {
            "id": "form-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary",
              "Button.secondary"
            ]
          }
        ],
        "estados": {
          "loading": {
            "descripcion": "Cargando datos iniciales (modo edición).",
            "ui": [
              "Spinner"
            ]
          },
          "error": {
            "descripcion": "Error al cargar/guardar.",
            "ui": [
              "Alert.error"
            ]
          },
          "empty": {
            "descripcion": "Formulario en modo creación.",
            "ui": [
              "FormPanel"
            ]
          },
          "offline": {
            "descripcion": "Sin conexión, deshabilitar envío y mostrar aviso.",
            "ui": [
              "Banner.offline"
            ]
          },
          "success": {
            "descripcion": "Guardado correcto.",
            "ui": [
              "Toast.success"
            ]
          }
        },
        "eventos": {
          "submit": "form:submit (screen_id='screen-form')"
        }
      },
      "Settings": {
        "id": "screen-settings",
        "route": "/perfil/preferencias",
        "template": "DashboardLayout",
        "rol": "settings",
        "objetivo_ux": "Permitir configurar idioma, tema, densidad y notificaciones.",
        "contrato_datos": {
          "obligatorios": [
            "User.prefs"
          ],
          "opcionales": []
        },
        "estados_universales": true
      },
      "Help": {
        "id": "screen-help",
        "route": "/ayuda",
        "template": "AppShell",
        "rol": "help",
        "objetivo_ux": "Resolver dudas rápidas y ofrecer contacto.",
        "contrato_datos": {
          "obligatorios": [],
          "opcionales": [
            "faq_items[]",
            "contacto_form"
          ]
        },
        "estados_universales": true
      },
      "Offline": {
        "id": "screen-offline",
        "route": "/offline",
        "template": "ErrorLayout",
        "rol": "offline",
        "objetivo_ux": "Explicar falta de conexión y ofrecer reintento.",
        "estados_universales": true
      },
      "Error": {
        "id": "screen-error",
        "route": "/error",
        "template": "ErrorLayout",
        "rol": "error",
        "objetivo_ux": "Explicar errores 404/500 y ofrecer salida segura.",
        "estados_universales": true
      }
    },
    "auth": {
      "Splash": {
        "id": "screen-splash",
        "route": "/splash",
        "template": "AuthLayout",
        "rol": "auth-splash",
        "objetivo_ux": "Detectar sesión y dirigir a Login o Home sin parpadeos.",
        "contrato_datos": {
          "obligatorios": [
            "Session?"
          ],
          "opcionales": []
        },
        "estados": {
          "checking": {
            "descripcion": "Consultando estado de sesión.",
            "ui": [
              "Spinner",
              "Branding"
            ]
          },
          "no_session": {
            "descripcion": "No hay sesión, redirigir a Login.",
            "ui": []
          },
          "has_session": {
            "descripcion": "Sesión válida, redirigir a Home.",
            "ui": []
          }
        }
      },
      "Login": {
        "id": "screen-login",
        "route": "/login",
        "template": "AuthLayout",
        "rol": "auth-login",
        "objetivo_ux": "Permitir acceso seguro con mensajes neutros.",
        "secciones": [
          {
            "id": "login-form",
            "tipo": "AuthForm",
            "fields": [
              "email",
              "password",
              "remember_me"
            ]
          }
        ],
        "estados_universales": true
      },
      "Register": {
        "id": "screen-register",
        "route": "/registro",
        "template": "AuthLayout",
        "rol": "auth-register",
        "objetivo_ux": "Crear cuenta nueva con feedback claro de password.",
        "estados_universales": true
      },
      "Recover": {
        "id": "screen-recover",
        "route": "/recuperar",
        "template": "AuthLayout",
        "rol": "auth-recover",
        "objetivo_ux": "Permitir recuperar acceso sin filtrar existencia de cuenta.",
        "estados_universales": true
      },
      "MFA": {
        "id": "screen-mfa",
        "route": "/mfa",
        "template": "AuthLayout",
        "rol": "auth-mfa",
        "objetivo_ux": "Completar segundo factor de forma rápida.",
        "estados_universales": true
      },
      "Profile": {
        "id": "screen-profile",
        "route": "/perfil",
        "template": "DashboardLayout",
        "rol": "auth-profile",
        "objetivo_ux": "Gestionar datos, preferencias y seguridad personal.",
        "estados_universales": true
      },
      "LogOff": {
        "id": "screen-logoff",
        "route": "/logout",
        "template": "AuthLayout",
        "rol": "auth-logoff",
        "objetivo_ux": "Cerrar sesión de forma explícita y comprensible.",
        "estados_universales": true
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "route": "/session-expired",
        "template": "AuthLayout",
        "rol": "auth-session-expired",
        "objetivo_ux": "Explicar expiración y forzar re-login.",
        "estados_universales": true
      }
    }
  },
  "flows": {
    "F1_OnboardingAuth": {
      "objetivo": "Llevar al usuario desde carga inicial a Home o Login según sesión.",
      "pantallas": [
        "Splash",
        "Login",
        "Home"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Splash",
          "tarea": "Consultar estado de sesión.",
          "entrada": [
            "Session?"
          ],
          "salida": {
            "decision": "has_session|no_session"
          },
          "errores": [
            "timeout_backend",
            "network_error"
          ],
          "recuperacion": [
            "mostrar ErrorLayout o Offline según caso"
          ]
        },
        {
          "orden": 2,
          "condicion": "has_session",
          "accion": "redirigir a Home"
        },
        {
          "orden": 3,
          "condicion": "no_session",
          "accion": "redirigir a Login"
        }
      ],
      "exito": "Usuario aterriza en Home con sesión válida o en Login listo para autenticarse."
    },
    "F2_Home_List_Detail": {
      "objetivo": "Exploración básica del contenido.",
      "pantallas": [
        "Home",
        "List",
        "Detail"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Home",
          "tarea": "Comunicar pitch y ofrecer CTA principal.",
          "entrada": [
            "User",
            "proyectos_destacados[]"
          ],
          "salida": {
            "accion": "click CTA o abandonar"
          },
          "errores": [],
          "recuperacion": []
        },
        {
          "orden": 2,
          "pantalla": "List",
          "tarea": "Permitir buscar/filtrar proyectos.",
          "entrada": [
            "EntityX[]"
          ],
          "salida": {
            "seleccion": "EntityX.id?"
          },
          "errores": [
            "empty_results",
            "network_error"
          ],
          "recuperacion": [
            "mostrar EmptyState",
            "botón reintentar"
          ]
        },
        {
          "orden": 3,
          "pantalla": "Detail",
          "tarea": "Profundizar y decidir acción.",
          "entrada": [
            "User",
            "EntityX"
          ],
          "salida": {
            "accion": "contactar|compartir|volver"
          },
          "errores": [
            "not_found",
            "network_error"
          ],
          "recuperacion": [
            "Error 404",
            "botón Volver a lista"
          ]
        }
      ],
      "exito": "Usuario encuentra un proyecto relevante y sabe cómo avanzar."
    },
    "F3_CRUD_Principal": {
      "objetivo": "Crear o editar entidad principal sin errores.",
      "pantallas": [
        "List",
        "Detail",
        "Form"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "List|Detail",
          "tarea": "Iniciar acción de crear/editar.",
          "entrada": [],
          "salida": {
            "accion": "navegar a Form"
          }
        },
        {
          "orden": 2,
          "pantalla": "Form",
          "tarea": "Rellenar campos con validación.",
          "entrada": [
            "EntityX.schema"
          ],
          "salida": {
            "estado": "listo_para_submit"
          },
          "errores": [
            "errores_validacion"
          ],
          "recuperacion": [
            "marcar campos",
            "mensajes de error claros"
          ]
        },
        {
          "orden": 3,
          "pantalla": "Form",
          "tarea": "Enviar formulario.",
          "entrada": [
            "EntityX.payload"
          ],
          "salida": {
            "estado": "success|error"
          },
          "errores": [
            "network_error",
            "server_error"
          ],
          "recuperacion": [
            "toast error",
            "retry"
          ]
        },
        {
          "orden": 4,
          "condicion": "success",
          "accion": "redirigir a Detail y mostrar toast 'Guardado'"
        }
      ],
      "exito": "Entidad creada/actualizada y visible en Detail."
    },
    "F4_Conversion_Ecommerce_Optional": {
      "objetivo": "Flujo de compra o selección de plan (opcional).",
      "pantallas": [
        "Detail",
        "Form",
        "Confirmacion"
      ],
      "pasos": [],
      "exito": "Pago completado y acceso al servicio."
    },
    "F5_Offline_Recovery": {
      "objetivo": "Mantener UX coherente en modo offline.",
      "pantallas": [
        "Offline",
        "previa"
      ],
      "pasos": [
        {
          "orden": 1,
          "tarea": "Detectar desconexión y mostrar pantalla/estado Offline.",
          "entrada": {
            "network_status": "offline"
          },
          "salida": {
            "screen": "Offline"
          }
        },
        {
          "orden": 2,
          "tarea": "Ofrecer reintento y/o seguir navegando contenido cacheado.",
          "entrada": {},
          "salida": {
            "network_status": "online?"
          },
          "errores": [],
          "recuperacion": []
        }
      ],
      "exito": "Usuario entiende el estado y puede recuperar operación al volver la conexión."
    },
    "F6_Login": {
      "objetivo": "Autenticar usuario o explicar por qué no se puede.",
      "pantallas": [
        "Login",
        "MFA",
        "Home"
      ],
      "pasos": [
        {
          "orden": 1,
          "pantalla": "Login",
          "tarea": "Capturar email y contraseña.",
          "entrada": [],
          "salida": {
            "credenciales": "email+password"
          },
          "errores": [
            "validacion_basica"
          ],
          "recuperacion": [
            "marcar campos",
            "mensajes claros"
          ]
        },
        {
          "orden": 2,
          "pantalla": "Login",
          "tarea": "Enviar credenciales.",
          "entrada": {
            "credenciales": "validas"
          },
          "salida": {
            "estado": "ok|mfa|required|error"
          },
          "errores": [
            "Credenciales inválidas"
          ],
          "recuperacion": [
            "mensaje neutro 'Credenciales inválidas.'"
          ]
        },
        {
          "orden": 3,
          "condicion": "mfa|required",
          "accion": "redirigir a MFA"
        },
        {
          "orden": 4,
          "condicion": "ok",
          "accion": "redirigir a Home o Profile"
        }
      ],
      "exito": "Inicio de sesión exitoso con feedback adecuado."
    },
    "F7_Register": {
      "objetivo": "Crear una cuenta nueva correctamente.",
      "pantallas": [
        "Register",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario con cuenta creada, listo para iniciar sesión."
    },
    "F8_Recover": {
      "objetivo": "Recuperar acceso sin filtrar si existe la cuenta.",
      "pantallas": [
        "Recover",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario restaura contraseña y puede iniciar sesión."
    },
    "F9_MFA": {
      "objetivo": "Completar segundo factor.",
      "pantallas": [
        "MFA",
        "Home"
      ],
      "pasos": [],
      "exito": "Seguridad extra sin fricción excesiva."
    },
    "F10_LogOff": {
      "objetivo": "Cerrar sesión de manera explícita.",
      "pantallas": [
        "Profile",
        "LogOff",
        "Splash|Login"
      ],
      "pasos": [],
      "exito": "Sesión invalidada, usuario en pantalla segura."
    },
    "F11_SessionTimeout": {
      "objetivo": "Gestionar expiración de sesión sin confusión.",
      "pantallas": [
        "SessionExpired",
        "Login"
      ],
      "pasos": [],
      "exito": "Usuario entiende que su sesión caducó y vuelve a autenticarse."
    }
  },
  "data_model": {
    "User": {
      "description": "Entidad usuario final.",
      "fields": {
        "id": "uuid",
        "name": "string",
        "email": "string",
        "avatarUrl": "string?",
        "location": "string?",
        "role": "string?",
        "createdAt": "iso-datetime",
        "prefs": {
          "lang": "es-MX",
          "theme": "light|dark|hc",
          "reduceMotion": "boolean",
          "notifications": "boolean"
        },
        "security": {
          "mfaEnabled": "boolean",
          "providers": "string[]",
          "lastLogin": "iso-datetime",
          "sessions": "number"
        }
      }
    },
    "Session": {
      "description": "Sesión autenticada.",
      "fields": {
        "id": "string",
        "userId": "string",
        "token": "opaque-string",
        "refresh": "opaque-string",
        "exp": "iso-datetime",
        "device": "user-agent-string",
        "ipHash": "string"
      }
    },
    "EntityX": {
      "description": "Entidad genérica de proyecto/case study.",
      "fields": {
        "id": "uuid",
        "title": "string",
        "description": "string?",
        "status": "active|draft|archived",
        "createdAt": "iso-datetime",
        "updatedAt": "iso-datetime",
        "owner": {
          "id": "uuid",
          "name": "string"
        },
        "tags": "string[]"
      }
    },
    "Preference": {
      "description": "Preferencias visuales y de idioma.",
      "fields": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "density": "compact|cozy|comfortable"
      }
    },
    "Security": {
      "description": "Estado de seguridad de la cuenta.",
      "fields": {
        "attempts": "number",
        "lockUntil": "iso-datetime?",
        "lastChange": "iso-datetime"
      }
    }
  },
  "a11y_seo_pwa": {
    "accesibilidad": {
      "contraste": {
        "texto_normal_AA": ">= 4.5:1",
        "texto_grande_AA": ">= 3:1"
      },
      "focus_visible": {
        "minimo": "borde 2px",
        "token_color": "color.semantic.border.bold"
      },
      "orden_tab": "header → nav → main → aside → footer según layout.",
      "landmarks": [
        "header",
        "nav",
        "main",
        "aside",
        "footer"
      ],
      "aria": {
        "aria_live": {
          "notificaciones": "polite",
          "errores_criticos": "assertive"
        },
        "iconos_sin_texto": "aria-label obligatorio."
      },
      "color_no_unico_canal": true,
      "prefers_reduced_motion": "desactivar animaciones no esenciales.",
      "teclado": {
        "enter_space": "activan botones",
        "escape": "cierra modales",
        "tab": "recorre controles en orden lógico"
      },
      "skip_links": [
        "Ir al contenido principal"
      ],
      "formularios": "usar aria-describedby para vincular mensajes de error al campo."
    },
    "seo": {
      "rules": [
        "Un H1 por ruta.",
        "Title < 60 caracteres.",
        "Meta description < 160 caracteres.",
        "URLs semánticas.",
        "Canonical por pantalla pública."
      ],
      "open_graph": [
        "og:title",
        "og:description",
        "og:image",
        "og:url"
      ],
      "twitter_card": [
        "twitter:card",
        "twitter:title",
        "twitter:description"
      ],
      "structured_data": "usar schema.org para persona/organization/proyecto si aplica."
    },
    "pwa": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "strategy": "app_shell",
        "precache_routes": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "data_strategy": "network-first con fallback a cache para datos no sensibles",
        "offline_fallback": "/offline"
      },
      "instalabilidad": [
        "HTTPS",
        "manifest válido",
        "service worker activo"
      ],
      "imagenes": "usar srcset, sizes y lazy loading."
    }
  },
  "security_privacy": {
    "mensajes_auth": {
      "login_error_neutro": "Credenciales inválidas.",
      "recover_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
    },
    "rate_limit": "mostrar mensaje genérico de demasiados intentos, sin detalles técnicos.",
    "lockout": "indicar tiempo aproximado hasta poder reintentar, sin exponer umbral exacto.",
    "password": {
      "reglas": "mínimo 12 caracteres, mayúsculas, minúsculas, número y símbolo; no incluir nombre ni correo.",
      "meter": "indicador visual con texto accesible que explique qué falta."
    },
    "password_visibility": "toggle mostrar/ocultar con aria-pressed y label claro.",
    "mfa": "promocionar activación desde Profile.Seguridad.",
    "sesiones_activas": "lista de dispositivos con opción 'Cerrar sesión en este dispositivo'.",
    "telemetria_privacidad": "usar IDs opacos, respetar consentimiento y minimizar PII."
  },
  "mocks_and_swap": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "latencia_ms": 120,
      "error_rate": 0.03,
      "demo_user": {
        "id": "u-demo",
        "name": "TuNombre",
        "email": "tu@email",
        "prefs": {
          "lang": "es-MX",
          "theme": "light",
          "reduceMotion": false,
          "notifications": true
        }
      }
    },
    "swap_plan": "usar adapters REST/Firebase/Supabase detrás de hooks; UI no se acopla a proveedor."
  },
  "i18n": {
    "idiomas": [
      "es-MX",
      "en-US"
    ],
    "glosario": {
      "Home": {
        "es-MX": "Inicio",
        "en-US": "Home"
      },
      "List": {
        "es-MX": "Lista",
        "en-US": "List"
      },
      "Detail": {
        "es-MX": "Detalle",
        "en-US": "Detail"
      },
      "Save": {
        "es-MX": "Guardar",
        "en-US": "Save"
      }
    },
    "botones": {
      "es-MX": [
        "Ver elementos",
        "Crear nuevo",
        "Guardar cambios",
        "Cancelar",
        "Iniciar sesión",
        "Crear cuenta",
        "Cerrar sesión",
        "Ver detalles",
        "Continuar"
      ],
      "en-US": [
        "View items",
        "Create new",
        "Save changes",
        "Cancel",
        "Sign in",
        "Sign up",
        "Sign out",
        "View details",
        "Continue"
      ]
    },
    "errores": {
      "es-MX": [
        "Credenciales inválidas.",
        "Algo salió mal, intenta de nuevo.",
        "Revisa este campo, falta información.",
        "Código inválido."
      ],
      "en-US": [
        "Invalid credentials.",
        "Something went wrong, please try again.",
        "Check this field, information is missing.",
        "Invalid code."
      ]
    },
    "vacios": {
      "es-MX": [
        "Sin elementos, crea el primero.",
        "Sin datos para mostrar aquí."
      ],
      "en-US": [
        "No items yet, create the first one.",
        "No data to display here."
      ]
    },
    "confirmaciones": {
      "es-MX": [
        "Guardado.",
        "Acceso concedido.",
        "Email de verificación enviado.",
        "Contraseña actualizada.",
        "Sesión finalizada."
      ],
      "en-US": [
        "Saved.",
        "Access granted.",
        "Verification email sent.",
        "Password updated.",
        "Session ended."
      ]
    }
  },
  "eval_plan": {
    "datasets": {
      "golden_cases_min": 16,
      "tipos": [
        "happy_path_auth",
        "errores_login",
        "pantallas_vacias",
        "offline",
        "sesion_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metricas": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": "si json_schema_pass o a11y_checklist_pass < umbral, bloquear release hasta corregir."
  },
  "telemetry": {
    "eventos": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_minimo": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "usar IDs opacos y no incluir PII salvo que sea estrictamente necesario."
  },
  "runtime": {
    "auth_guard": "proteger rutas en cliente y servidor (si SSR) según Session.",
    "redirecciones": "si ruta protegida y no hay sesión, redirigir a Login o Splash.",
    "prefetch": "prefetch de Home, List, Detail tras login.",
    "hydration": "no exponer tokens de acceso en HTML; usarlos solo en llamadas de cliente.",
    "code_splitting": [
      "chunk-auth",
      "chunk-home",
      "chunk-dashboard",
      "chunk-settings"
    ],
    "cache": {
      "publicas": "SSG/ISR",
      "privadas": "CSR/SSR con SWR/react-query",
      "headers_api": "cache-control configurado por endpoint"
    }
  },
  "priorities": {
    "issues_top5": [
      "Estilos definidos fuera de tokens DTCG generan inconsistencia.",
      "Falta de focus visible en algunos componentes interactivos.",
      "CTAs con mismo peso visual compiten en pantallas clave.",
      "Estados universales incompletos en ciertas vistas.",
      "Microcopy no unificada ni lista para i18n."
    ],
    "acciones_top5": [
      "Centralizar tokens visuales en DTCG y mapearlos a theme CSS.",
      "Configurar focus visible global y testear navegación por teclado.",
      "Revisar jerarquía de CTAs en Home, List y Detail; definir una primaria por pantalla.",
      "Definir patrón uniforme de estados (loading, error, empty, offline, success) por pantalla.",
      "Construir glosario + tablas de microcopy y conectarlas al sistema de traducciones."
    ]
  },
  "violations": []
}



{
  "meta": {
    "id": "PROMPT_UIUX_E2E_ROOT_v4_INSTANCE",
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Sistema UI/UX front-end end-to-end: design system, librería atómica, pantallas, flujos, accesibilidad, seguridad, i18n, eval, telemetría y runtime.",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Mostrar experiencia del profesional en menos de 8s",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién es la persona y qué hace",
        "Revisar 2–3 proyectos relevantes",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "CTR en CTA principal Home → Proyectos",
        "Conversiones Home → Contacto/Agendar",
        "Tiempo medio en Detalle de proyecto"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido si la persona encaja en rol técnico/diseño"
      },
      {
        "id": "founder",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico, claridad y calidad de ejecución"
      }
    ],
    "contexto": {
      "dispositivos": [
        "mobile",
        "desktop"
      ],
      "conectividad": "intermitente",
      "regiones": [
        "México",
        "Latam"
      ],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "estado": "hooks+react-query",
      "pwa": true
    }
  },

  "1_tokens_dtcg": {
    "$schema": "https://design-tokens.org/schema.json",
    "meta": {
      "name": "UIX_Portfolio_Tokens",
      "version": "1.0.0",
      "platforms": [
        "web",
        "ios",
        "android"
      ]
    },
    "color": {
      "$type": "color",
      "primitive": {
        "neutral": {
          "0": { "$value": "#FFFFFF" },
          "50": { "$value": "#F7F7F8" },
          "100": { "$value": "#E5E5EA" },
          "200": { "$value": "#D1D1D6" },
          "300": { "$value": "#B0B0B8" },
          "400": { "$value": "#8E8E96" },
          "500": { "$value": "#636366" },
          "600": { "$value": "#48484A" },
          "700": { "$value": "#3A3A3C" },
          "800": { "$value": "#2C2C2E" },
          "900": { "$value": "#000000" }
        },
        "brand": {
          "500": { "$value": "#2563EB" }
        },
        "accent": {
          "500": { "$value": "#EC4899" }
        },
        "ok": {
          "500": { "$value": "#16A34A" }
        },
        "warn": {
          "500": { "$value": "#EAB308" }
        },
        "err": {
          "500": { "$value": "#DC2626" }
        }
      },
      "semantic": {
        "bg": {
          "page": { "$value": "{color.primitive.neutral.50}" },
          "surface": { "$value": "{color.primitive.neutral.0}" }
        },
        "text": {
          "main": { "$value": "{color.primitive.neutral.900}" },
          "muted": { "$value": "{color.primitive.neutral.500}" },
          "inverse": { "$value": "{color.primitive.neutral.0}" }
        },
        "accent": {
          "main": { "$value": "{color.primitive.accent.500}" }
        },
        "border": {
          "bold": { "$value": "{color.primitive.neutral.300}" },
          "subtle": { "$value": "{color.primitive.neutral.200}" }
        },
        "state": {
          "ok": { "$value": "{color.primitive.ok.500}" },
          "warn": { "$value": "{color.primitive.warn.500}" },
          "err": { "$value": "{color.primitive.err.500}" }
        }
      },
      "theme": {
        "light": {
          "bg.page": { "$value": "{color.semantic.bg.page}" },
          "bg.surface": { "$value": "{color.semantic.bg.surface}" },
          "text.main": { "$value": "{color.semantic.text.main}" },
          "text.muted": { "$value": "{color.semantic.text.muted}" }
        },
        "dark": {
          "bg.page": { "$value": "{color.primitive.neutral.900}" },
          "bg.surface": { "$value": "{color.primitive.neutral.800}" },
          "text.main": { "$value": "{color.primitive.neutral.0}" },
          "text.muted": { "$value": "{color.primitive.neutral.300}" }
        },
        "high-contrast": {
          "bg.page": { "$value": "#000000" },
          "bg.surface": { "$value": "#000000" },
          "text.main": { "$value": "#FFFFFF" },
          "text.muted": { "$value": "#FFFFFF" },
          "accent.main": { "$value": "#FFFF00" }
        }
      }
    },
    "typography": {
      "$type": "typography",
      "family": {
        "base": { "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif" }
      },
      "size": {
        "xs": { "$value": "12px" },
        "sm": { "$value": "14px" },
        "md": { "$value": "16px" },
        "lg": { "$value": "20px" },
        "xl": { "$value": "24px" },
        "h1": { "$value": "32px" },
        "h2": { "$value": "24px" },
        "h3": { "$value": "20px" }
      },
      "weight": {
        "regular": { "$value": 400 },
        "semibold": { "$value": 600 },
        "bold": { "$value": 700 }
      },
      "lineHeight": {
        "tight": { "$value": "1.2" },
        "normal": { "$value": "1.4" },
        "loose": { "$value": "1.6" }
      }
    },
    "spacing": {
      "$type": "dimension",
      "scale": {
        "1": { "$value": "4px" },
        "2": { "$value": "8px" },
        "3": { "$value": "12px" },
        "4": { "$value": "16px" },
        "5": { "$value": "24px" },
        "6": { "$value": "32px" }
      }
    },
    "radius": {
      "$type": "dimension",
      "sm": { "$value": "8px" },
      "md": { "$value": "12px" },
      "lg": { "$value": "16px" },
      "pill": { "$value": "999px" }
    },
    "border": {
      "$type": "dimension",
      "thin": { "$value": "1px" },
      "thick": { "$value": "2px" },
      "extra": { "$value": "3px" }
    },
    "shadow": {
      "$type": "shadow",
      "soft": {
        "$value": "0 4px 12px rgba(0,0,0,0.08)"
      },
      "lg": {
        "$value": "0 16px 40px rgba(0,0,0,0.18)"
      }
    },
    "motion": {
      "$type": "duration",
      "fast": { "$value": "150ms" },
      "norm": { "$value": "200ms" },
      "reduced": { "$value": "0ms" }
    },
    "z": {
      "$type": "number",
      "base": { "$value": 1 },
      "dropdown": { "$value": 10 },
      "overlay": { "$value": 100 },
      "modal": { "$value": 1000 },
      "toast": { "$value": 1100 }
    }
  },

  "2_atomic_design_library": {
    "atoms": [
      {
        "name": "Text",
        "variants": [
          "h1",
          "h2",
          "h3",
          "body",
          "caption"
        ],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main",
          "truncate": "boolean"
        },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "variants": [
          "primary",
          "secondary",
          "ghost",
          "danger"
        ],
        "sizes": [
          "sm",
          "md",
          "lg"
        ],
        "states": [
          "default",
          "hover",
          "focus",
          "disabled",
          "loading"
        ],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "ariaLabel": "string?"
        },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "variants": [
          "text",
          "email",
          "password",
          "search",
          "number",
          "otp"
        ],
        "props": {
          "type": "text|email|password|search|number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?"
        },
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string"
        },
        "testIdPattern": "chk-{name}"
      },
      {
        "name": "Radio",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "variants": [
          "default",
          "filter",
          "status"
        ],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "variants": [
          "neutral",
          "ok",
          "warn",
          "err"
        ],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "description": "Label + control + helper + error",
        "parts": [
          "label",
          "control",
          "helper",
          "error"
        ],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "parts": [
          "icon",
          "input",
          "clear"
        ],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "description": "Navegación principal",
        "slots": [
          "logo",
          "primary-links",
          "secondary-actions",
          "user-menu"
        ],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "slots": [
          "section-links",
          "footer-links"
        ],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "description": "Sección hero principal",
        "slots": [
          "eyebrow",
          "title",
          "subtitle",
          "ctas",
          "meta",
          "illustration"
        ],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "description": "Panel hero contextual (disponibilidad, tags)",
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "description": "Lista de elementos con filtros",
        "slots": [
          "filters",
          "results",
          "pagination"
        ],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "slots": [
          "header",
          "body",
          "related"
        ],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "slots": [
          "title",
          "sections",
          "global-errors",
          "actions"
        ],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "slots": [
          "title",
          "fields",
          "actions",
          "secondary-links",
          "legal"
        ],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "slots": [
          "tabs",
          "tab-content",
          "danger-zone"
        ],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "description": "Protección de rutas según sesión",
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "regions": [
          "header",
          "sidebar",
          "main",
          "footer",
          "toasts"
        ],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "regions": [
          "branding",
          "auth-card"
        ],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "regions": [
          "header",
          "sidebar",
          "main"
        ],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "regions": [
          "header",
          "main",
          "related"
        ],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "regions": [
          "header",
          "main",
          "footer"
        ],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "regions": [
          "icon",
          "message",
          "actions"
        ],
        "testIdPattern": "layout-error"
      }
    ]
  },

  "3_screens": {
    "core": {
      "Home": {
        "id": "screen-home",
        "template": "AppShell",
        "role": "home",
        "objetivo": "Comunicar propuesta de valor en 5–8 segundos y dirigir a Proyectos o Contacto.",
        "layout": {
          "desktop": "grid-12: header full; main col-8; HeroPanel col-4; footer full",
          "mobile": "stack: HeroShell → HeroPanel → Highlights → Proof → Footer"
        },
        "secciones": [
          {
            "id": "home-hero",
            "tipo": "HeroShell",
            "componentes": [
              "Text.h1",
              "Text.body",
              "Button.primary",
              "Button.secondary",
              "Chip",
              "MetaBar"
            ],
            "microcopy": {
              "title": "Diseño y código que sí llegan a producción",
              "subtitle": "Portafolio técnico centrado en producto para equipos que necesitan shipping real.",
              "primaryCta": "Ver proyectos",
              "secondaryCta": "Agendar conversación"
            }
          },
          {
            "id": "home-highlights",
            "tipo": "BentoGrid",
            "componentes": [
              "StatCard",
              "CardProyectoDestacado"
            ],
            "microcopy": {
              "title": "Proyectos destacados"
            }
          },
          {
            "id": "home-proof",
            "tipo": "Proof",
            "componentes": [
              "LogoStrip",
              "TestimonialCard"
            ],
            "microcopy": {
              "title": "Confianza y resultados"
            }
          }
        ],
        "ctas": {
          "principal": "Home → List (Proyectos)",
          "secundaria": "Home → Form (Contacto/Agendar)"
        },
        "datos_minimos": [
          "User.name",
          "User.prefs.lang",
          "lista_proyectos_destacados",
          "disponibilidad_actual",
          "stats_resumidas"
        ],
        "estados": {
          "loading": "skeleton hero + skeleton cards",
          "error": "mensajes explícitos + botón Reintentar",
          "empty": "mensaje 'Aún no hay proyectos destacados' + CTA 'Crear primer proyecto'",
          "offline": "banner superior 'Sin conexión' + datos cacheados",
          "success": "toast 'Actualizado' en acciones clave"
        },
        "a11y": {
          "landmarks": [
            "header",
            "main",
            "footer"
          ],
          "tabOrder": [
            "skip-link",
            "navbar",
            "hero-cta-primary",
            "hero-cta-secondary",
            "highlights",
            "proof",
            "footer"
          ]
        }
      },
      "List": {
        "id": "screen-list",
        "role": "list",
        "objetivo": "Permitir explorar proyectos filtrando y encontrando uno relevante rápido.",
        "secciones": [
          {
            "id": "list-filters",
            "tipo": "Filters",
            "componentes": [
              "SearchBar",
              "FilterChips",
              "Select (Sort)"
            ],
            "microcopy": {
              "title": "Explorar proyectos",
              "searchPlaceholder": "Buscar por nombre, tecnología o tipo…"
            }
          },
          {
            "id": "list-results",
            "tipo": "Results",
            "componentes": [
              "ListView",
              "CardProyecto"
            ]
          }
        ],
        "ctas": {
          "principal": "Crear nuevo proyecto",
          "secundaria": "Volver a Home"
        },
        "datos_minimos": [
          "EntityX[] (proyectos)"
        ],
        "estados_universales": true
      },
      "Detail": {
        "id": "screen-detail",
        "role": "detail",
        "objetivo": "Profundizar en un proyecto y tomar decisión (contacto, agendar, compartir).",
        "secciones": [
          {
            "id": "detail-header",
            "tipo": "Header",
            "componentes": [
              "Breadcrumbs",
              "Text.h1",
              "Badge",
              "PrimaryActions"
            ]
          },
          {
            "id": "detail-body",
            "tipo": "Body",
            "componentes": [
              "KeyFacts",
              "Tabs",
              "CodeSnippetPreview",
              "Metrics"
            ]
          },
          {
            "id": "detail-related",
            "tipo": "RelatedList",
            "componentes": [
              "CardProyecto"
            ]
          }
        ],
        "estados_universales": true
      },
      "Form": {
        "id": "screen-form",
        "role": "form",
        "objetivo": "Crear/editar proyectos o enviar solicitud de contacto sin errores.",
        "layout": "FormLayout",
        "secciones": [
          {
            "id": "form-body",
            "tipo": "FormBody",
            "componentes": [
              "Field.title",
              "Field.description",
              "Field.tags",
              "Field.status",
              "Field.links"
            ]
          },
          {
            "id": "form-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary (Guardar cambios)",
              "Button.secondary (Cancelar)"
            ]
          }
        ],
        "schema": "EntityX",
        "estados_universales": true
      },
      "Settings": {
        "id": "screen-settings",
        "role": "settings",
        "objetivo": "Control de preferencias personales.",
        "secciones": [
          {
            "id": "settings-general",
            "tipo": "Preferences",
            "componentes": [
              "Select (Idioma)",
              "Switch (Tema)",
              "Switch (Densidad)"
            ]
          },
          {
            "id": "settings-notifications",
            "tipo": "Notifications",
            "componentes": [
              "Toggle email",
              "Toggle push"
            ]
          }
        ],
        "estados_universales": true
      },
      "Help": {
        "id": "screen-help",
        "role": "help",
        "objetivo": "Responder dudas frecuentes y ofrecer contacto.",
        "secciones": [
          {
            "id": "help-faq",
            "tipo": "FAQ",
            "componentes": [
              "Accordion"
            ]
          },
          {
            "id": "help-contact",
            "tipo": "Contact",
            "componentes": [
              "FormPanel"
            ]
          }
        ],
        "estados_universales": true
      },
      "Offline": {
        "id": "screen-offline",
        "role": "offline",
        "objetivo": "Informar falta de conexión y permitir reintentar.",
        "secciones": [
          {
            "id": "offline-banner",
            "tipo": "Banner",
            "microcopy": {
              "title": "Sin conexión",
              "body": "Revisa tu conexión y vuelve a intentarlo."
            }
          },
          {
            "id": "offline-actions",
            "tipo": "Actions",
            "componentes": [
              "Button.primary (Reintentar)"
            ]
          }
        ],
        "estados_universales": true
      },
      "Error": {
        "id": "screen-error",
        "role": "error",
        "objetivo": "Explicar error y ofrecer ruta segura.",
        "secciones": [
          {
            "id": "error-404",
            "tipo": "ErrorNotFound",
            "microcopy": {
              "title": "No encontrado",
              "body": "La página que buscas no existe o cambió de lugar.",
              "cta": "Ir al inicio"
            }
          },
          {
            "id": "error-500",
            "tipo": "ErrorServer",
            "microcopy": {
              "title": "Algo salió mal",
              "body": "Hubo un problema inesperado. Intenta de nuevo en unos momentos.",
              "cta": "Volver"
            }
          }
        ],
        "estados_universales": true
      }
    },
    "auth": {
      "Splash": {
        "id": "screen-splash",
        "role": "auth-splash",
        "objetivo": "Verificar sesión y decidir Login vs Home.",
        "secciones": [
          {
            "id": "splash-branding",
            "tipo": "Branding"
          },
          {
            "id": "splash-progress",
            "tipo": "Progress"
          }
        ],
        "datos_minimos": [
          "Session?"
        ]
      },
      "Login": {
        "id": "screen-login",
        "role": "auth-login",
        "objetivo": "Permitir acceso seguro sin fricción.",
        "secciones": [
          {
            "id": "login-form",
            "tipo": "AuthForm",
            "fields": [
              "email",
              "password",
              "remember_me"
            ]
          },
          {
            "id": "login-links",
            "tipo": "AuthLinks",
            "links": [
              "Ir a Registro",
              "Recuperar acceso"
            ]
          }
        ],
        "microcopy": {
          "title": "Iniciar sesión",
          "primaryCta": "Entrar",
          "secondaryCta": "Crear cuenta"
        },
        "estados_universales": true
      },
      "Register": {
        "id": "screen-register",
        "role": "auth-register",
        "objetivo": "Crear cuenta nueva y preparar perfil.",
        "secciones": [
          {
            "id": "register-form",
            "tipo": "AuthForm",
            "fields": [
              "name",
              "email",
              "password",
              "confirm",
              "terms"
            ]
          }
        ],
        "estados_universales": true
      },
      "Recover": {
        "id": "screen-recover",
        "role": "auth-recover",
        "objetivo": "Recuperar acceso sin filtrar existencia de usuarios.",
        "secciones": [
          {
            "id": "recover-request",
            "tipo": "RecoverRequest",
            "fields": [
              "email"
            ]
          },
          {
            "id": "recover-reset",
            "tipo": "RecoverReset",
            "fields": [
              "new_password",
              "confirm_password"
            ]
          }
        ],
        "estados_universales": true
      },
      "MFA": {
        "id": "screen-mfa",
        "role": "auth-mfa",
        "objetivo": "Verificar segundo factor.",
        "secciones": [
          {
            "id": "mfa-otp",
            "tipo": "MFAView",
            "components": [
              "OTPGroup",
              "Button.primary",
              "Link.resend"
            ]
          }
        ],
        "estados_universales": true
      },
      "Profile": {
        "id": "screen-profile",
        "role": "auth-profile",
        "objetivo": "Gestionar datos, preferencias y seguridad.",
        "secciones": [
          {
            "id": "profile-info",
            "tipo": "Tab",
            "title": "Información",
            "fields": [
              "avatar",
              "name",
              "location",
              "email"
            ]
          },
          {
            "id": "profile-preferences",
            "tipo": "Tab",
            "title": "Preferencias",
            "fields": [
              "lang",
              "theme",
              "reduceMotion",
              "notifications"
            ]
          },
          {
            "id": "profile-security",
            "tipo": "Tab",
            "title": "Seguridad",
            "fields": [
              "change_password",
              "mfa_toggle",
              "sessions_list",
              "danger_zone"
            ]
          }
        ],
        "estados_universales": true
      },
      "LogOff": {
        "id": "screen-logoff",
        "role": "auth-logoff",
        "objetivo": "Cerrar sesión de forma segura y redirigir.",
        "secciones": [
          {
            "id": "logoff-confirm",
            "tipo": "Confirm",
            "microcopy": {
              "title": "Cerrar sesión",
              "body": "¿Seguro que quieres cerrar tu sesión en este dispositivo?"
            }
          }
        ],
        "estados_universales": true
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "role": "auth-session-expired",
        "objetivo": "Explicar caducidad de sesión y forzar re-login.",
        "secciones": [
          {
            "id": "session-expired-message",
            "tipo": "Message",
            "microcopy": {
              "title": "Tu sesión expiró",
              "body": "Por seguridad, necesitamos que inicies sesión de nuevo."
            }
          },
          {
            "id": "session-expired-actions",
            "tipo": "Actions",
            "components": [
              "Button.primary (Iniciar sesión de nuevo)"
            ]
          }
        ],
        "estados_universales": true
      }
    }
  },

  "4_flows": {
    "F1_OnboardingAuth": {
      "name": "Onboarding + Auth",
      "steps": [
        "Splash: checar sesión válida",
        "IF sesión válida → Home",
        "ELSE → Login",
        "Login/Register → éxito auth",
        "Opcional MFA → éxito",
        "Home"
      ],
      "success_feedback": "Bienvenida sutil + acceso directo a proyectos."
    },
    "F2_Home_List_Detail": {
      "steps": [
        "Home: entender pitch",
        "Click CTA 'Ver proyectos' → List",
        "List: filtrar/buscar",
        "Seleccionar elemento → Detail",
        "Detail: decidir contacto/compartir"
      ]
    },
    "F3_CRUD_Principal": {
      "steps": [
        "List o Detail: click 'Crear nuevo' o 'Editar'",
        "Form: rellenar campos, validar inline",
        "Submit → loading",
        "Éxito → Detail con toast 'Guardado'",
        "Error → mostrar mensajes claros + retry"
      ]
    },
    "F4_Conversion_Ecommerce_Optional": {
      "steps": [
        "Detail/Pricing: elegir plan",
        "Form pago: datos + validación",
        "Confirmación: recibo + acceso"
      ]
    },
    "F5_Offline_Recovery": {
      "steps": [
        "Detectar offline → mostrar Offline",
        "Intento reconexión",
        "Éxito → restaurar pantalla previa"
      ]
    },
    "F6_Login": {
      "steps": [
        "Login: email+password",
        "Validar credenciales",
        "Si requiere MFA → F9",
        "Éxito → Home/Profile"
      ]
    },
    "F7_Register": {
      "steps": [
        "Register: campos + aceptación términos",
        "Validar reglas de password",
        "Crear cuenta",
        "Enviar email verificación",
        "Redirigir a Login"
      ]
    },
    "F8_Recover": {
      "steps": [
        "Recover: solicitar email",
        "Mostrar mensaje neutro 'Si existe la cuenta…'",
        "Email con enlace",
        "Pantalla reset: nueva password",
        "Confirmación 'Contraseña actualizada'"
      ]
    },
    "F9_MFA": {
      "steps": [
        "MFA: ingresar OTP",
        "Error → mensaje 'Código inválido'",
        "Reenviar OTP",
        "Éxito → Home/Profile"
      ]
    },
    "F10_LogOff": {
      "steps": [
        "Profile/UserMenu: click 'Cerrar sesión'",
        "Confirmación",
        "Revocar tokens en servidor",
        "Redirigir a Splash o Login"
      ]
    },
    "F11_SessionTimeout": {
      "steps": [
        "Detectar expiración → SessionExpired",
        "Mensaje de contexto",
        "Ir a Login reautenticación",
        "Volver a ruta segura (ej. Home)"
      ]
    }
  },

  "5_datos_entidades": {
    "User": {
      "id": "uuid",
      "name": "string",
      "email": "string",
      "avatarUrl": "string?",
      "location": "string?",
      "role": "string?",
      "createdAt": "iso-datetime",
      "prefs": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "notifications": "boolean"
      },
      "security": {
        "mfaEnabled": "boolean",
        "providers": "string[]",
        "lastLogin": "iso-datetime",
        "sessions": "number"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "token": "opaque-string",
      "refresh": "opaque-string",
      "exp": "iso-datetime",
      "device": "user-agent-string",
      "ipHash": "string"
    },
    "EntityX": {
      "id": "uuid",
      "title": "string",
      "description": "string?",
      "status": "active|draft|archived",
      "createdAt": "iso-datetime",
      "updatedAt": "iso-datetime",
      "owner": {
        "id": "uuid",
        "name": "string"
      },
      "tags": "string[]"
    },
    "Preference": {
      "lang": "es-MX",
      "theme": "light|dark|hc",
      "reduceMotion": "boolean",
      "density": "compact|cozy|comfortable"
    },
    "Security": {
      "attempts": "number",
      "lockUntil": "iso-datetime?",
      "lastChange": "iso-datetime"
    }
  },

  "6_accesibilidad_seo_pwa": {
    "accesibilidad": {
      "contraste": {
        "texto_normal": "AA >= 4.5:1",
        "texto_grande": "AA >= 3:1"
      },
      "focus_visible": "mínimo borde 2px con token de border.bold",
      "orden_tab": "header → main → sidebar → footer, respetando lógica visual",
      "landmarks": [
        "header",
        "nav",
        "main",
        "aside",
        "footer"
      ],
      "aria": {
        "aria_live": {
          "notificaciones": "polite",
          "errores_criticos": "assertive"
        },
        "iconos": "aria-label obligatorio si no hay texto visible"
      },
      "color": "no depender solo de color; usar iconos + texto para estados",
      "reduced_motion": "respetar prefers-reduced-motion: desactivar animaciones no esenciales",
      "teclado": [
        "Enter/Space activan botones",
        "Escape cierra modales",
        "Tab/Shift+Tab recorren controles"
      ],
      "skip_links": [
        "Ir al contenido principal"
      ],
      "formularios": "errores descriptivos, aria-describedby ligando mensaje de error con campo"
    },
    "seo": {
      "titles": "H1 único por ruta, < 60 caracteres",
      "meta_description": "< 160 caracteres, única por ruta",
      "open_graph": [
        "og:title",
        "og:description",
        "og:image",
        "og:url"
      ],
      "twitter_card": [
        "twitter:card",
        "twitter:title",
        "twitter:description"
      ],
      "headings": "jerarquía H1 → H2 → H3 sin saltos arbitrarios",
      "urls": [
        "/",
        "/login",
        "/registro",
        "/dashboard",
        "/perfil",
        "/proyectos",
        "/ayuda"
      ],
      "canonical": "una por pantalla pública",
      "structured_data": "JSON-LD schema.org si procede",
      "sitemap": "incluir pantallas públicas",
      "robots": "permitir indexar públicas, bloquear privadas"
    },
    "pwa": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "estrategia": "app_shell",
        "static_cache": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "data_strategy": "network-first con fallback cache",
        "offline_fallback": "/offline"
      },
      "instalabilidad": [
        "HTTPS",
        "manifest válido",
        "service worker registrado"
      ],
      "imagenes": "srcset + sizes + lazy loading"
    }
  },

  "7_seguridad_privacidad_ui": {
    "auth_errores": {
      "mensaje_neutro": "Credenciales inválidas.",
      "recover": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
    },
    "rate_limit": "mostrar mensaje sutil al usuario cuando se alcance el límite, sin detallar razones internas.",
    "lockout": "si la cuenta se bloquea, indicar tiempo restante sin exponer umbrales exactos.",
    "password": {
      "reglas": "mínimo 12 caracteres, mayúsculas, minúsculas, número y símbolo; no incluir nombre ni correo.",
      "meter": "visual, con texto de ayuda accesible."
    },
    "password_visibility": "toggle mostrar/ocultar con aria-pressed.",
    "mfa": "sugerir habilitar MFA desde Profile → Seguridad.",
    "sesiones": "lista de dispositivos activos con opción 'Cerrar sesión en este dispositivo'.",
    "telemetria_privacidad": "consentimiento explícito opt-in, IDs opacos, sin PII innecesaria."
  },

  "8_mocks_hooks_swap": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "latencia_ms": 120,
      "error_rate": 0.03,
      "usuarios_demo": [
        {
          "id": "u-demo",
          "name": "TuNombre",
          "email": "tu@email",
          "prefs": {
            "lang": "es-MX",
            "theme": "light",
            "reduceMotion": false,
            "notifications": true
          }
        }
      ]
    },
    "swap_plan": "usar adapters por proveedor (REST, Firebase, Supabase) detrás de hooks; UI no conoce implementación concreta."
  },

  "9_i18n_microcopy": {
    "idiomas": [
      "es-MX",
      "en-US"
    ],
    "botones": {
      "es-MX": [
        "Ver elementos",
        "Crear nuevo",
        "Guardar cambios",
        "Cancelar",
        "Iniciar sesión",
        "Crear cuenta",
        "Cerrar sesión",
        "Ver detalles",
        "Continuar"
      ],
      "en-US": [
        "View items",
        "Create new",
        "Save changes",
        "Cancel",
        "Sign in",
        "Sign up",
        "Sign out",
        "View details",
        "Continue"
      ]
    },
    "errores": {
      "es-MX": [
        "Credenciales inválidas.",
        "Algo salió mal, intenta de nuevo.",
        "Revisa este campo, falta información.",
        "Código inválido."
      ],
      "en-US": [
        "Invalid credentials.",
        "Something went wrong, please try again.",
        "Check this field, information is missing.",
        "Invalid code."
      ]
    },
    "vacíos": {
      "es-MX": [
        "Sin elementos, crea el primero.",
        "Sin datos para mostrar aquí."
      ],
      "en-US": [
        "No items yet, create the first one.",
        "No data to display here."
      ]
    },
    "confirmaciones": {
      "es-MX": [
        "Guardado.",
        "Acceso concedido.",
        "Email de verificación enviado.",
        "Contraseña actualizada.",
        "Sesión finalizada."
      ],
      "en-US": [
        "Saved.",
        "Access granted.",
        "Verification email sent.",
        "Password updated.",
        "Session ended."
      ]
    }
  },

  "10_eval": {
    "datasets": {
      "golden_cases_min": 16,
      "tipos": [
        "happy_path_auth",
        "errores_login",
        "pantallas_vacías",
        "offline",
        "sesión_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metricas": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": "si json_schema_pass o a11y_checklist_pass caen por debajo de umbral, bloquear release hasta corregir."
  },

  "11_telemetria": {
    "eventos": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_minimo": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "usar IDs opacos; no enviar PII salvo que sea imprescindible y con consentimiento."
  },

  "12_runtime_ssr_ssg_csr": {
    "auth_guard": "protección de rutas tanto en cliente como en servidor (si se usa SSR).",
    "redirecciones": "si sesión expirada o nula en ruta protegida, redirigir a Login o Splash.",
    "prefetch": "rutas críticas (Home, List, Detail) para mejorar UX.",
    "hydration": "no inyectar tokens de acceso en HTML; usarlos sólo en runtime.",
    "code_splitting": [
      "bundle Auth",
      "bundle Home",
      "bundle Dashboard",
      "bundle Settings"
    ],
    "cache": {
      "publicas": "SSG/ISR donde aplique (ej. Home, About)",
      "privadas": "CSR/SSR con caché de datos (SWR/react-query)",
      "headers": "cache-control adecuados para APIs"
    }
  },

  "13_prioridades": {
    "issues_top5": [
      "Estilos sueltos fuera de tokens: riesgo de inconsistencia.",
      "Falta de focus visible en componentes clave.",
      "Demasiadas CTAs con mismo peso visual en una pantalla.",
      "Estados universales incompletos (loading, error, empty, offline, success) en algunas vistas.",
      "Microcopy no unificada ni lista para i18n."
    ],
    "acciones_top5": [
      "Centralizar tokens en DTCG JSON y mapearlos a CSS variables/ThemeProvider.",
      "Añadir estilo de focus visible global y testear navegación por teclado.",
      "Revisar jerarquía visual de CTAs en Home, List y Detail; definir una primaria por pantalla.",
      "Documentar y aplicar patrón de estados universales por pantalla.",
      "Construir glosario y tablas de microcopy e i18n; conectarlo al sistema de traducciones."
    ]
  },

  "14_violations": []
}
ChatGPT Plus

Pensó durante 22s
Va, lo que pegaste ya es brutalmente completo… pero está mezclado: DSL + dos specs JSON gigantes duplicando cosas.

Te dejo abajo una versión depurada y fusionada de Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1:

Mantiene toda la semántica fuerte (tokens, screens, flows, A11Y, seguridad, i18n, eval, telemetría, SSR/SSG).

Quita JSON “instancias” redundantes.

Lo deja como un solo prompt DSL listo para usar como system / plantilla.

Copia todo el bloque:

Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ─────────────────────────────────────
  # META
  # ─────────────────────────────────────
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";
    JSON_SCHEMA:"estricto";
    FALLBACK_MD:"on";

    CONTEXT_ENGINEERING:"on";
    RAG:"opt";
    AGENTIC_ROLES:"planner,researcher,writer,verifier";

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ─────────────────────────────────────
  # INPUTS (a rellenar por el usuario)
  # ─────────────────────────────────────
  INPUTS{

    PRODUCTO{
      nombre:"<string>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Otro>";
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<...>"];
      objetivo_usuario:["<...>"];
      KPI:["<activación|retención|conversión|NPS|...>"];
    };

    USUARIOS{
      perfiles:[
        { rol:"<recruiter|cliente|admin|usuario final>";
          nivel:"<bajo|medio|alto>";
          motivación:"<...>";
        }
      ];
    };

    CONTEXTO{
      dispositivos:["mobile","desktop"];
      conectividad:"<intermitente|estable>";
      regiones:["<...>"];
      idioma_base:"es-MX";
    };

    STACK_HINT{
      runtime:"<CSR|SSR|SSG>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
    };
  }

  # ─────────────────────────────────────
  # CONTRATO DE SALIDA (qué debe generar el LLM)
  # ─────────────────────────────────────
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";      # Design Tokens DTCG
      THEMES:["light","dark","high-contrast"];
    }

    II.ATOMIC_LIBRARY{
      atoms:"COMPONENT_SCHEMA[] (nivel=atom)";
      molecules:"COMPONENT_SCHEMA[] (nivel=molecule)";
      organisms:"COMPONENT_SCHEMA[] (nivel=organism)";
      templates:"COMPONENT_SCHEMA[] (nivel=template)";
    }

    III.SCREENS{
      lista:[
        # Core producto
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos[]",
        "datos_opcionales[]",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo + latencias";
      factories:"shapes tipados por entidad";
      hooks_mock:"MOCK_HOOK_SCHEMA[]";
      swap_plan:"API|Firebase|Firestore vía adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base UI";
      claves:"keys i18n";
      tablas_microcopy:"botones, errores, vacíos, confirmaciones";
    }

    X.EVAL{
      golden_set:"EVAL_SCHEMA.datasets";
      métricas:"EVAL_SCHEMA.metrics";
      umbrales:"EVAL_SCHEMA.umbrales";
      gates_regresión:"EVAL_SCHEMA.gates";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; consentimiento";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache";
    }

    XIII.PRIORIDADES{
      top5_issues:"lista de problemas críticos detectados";
      top5_acciones:"acciones accionables para resolverlos";
    }
  }

  # ─────────────────────────────────────
  # SCHEMAS
  # ─────────────────────────────────────
  SCHEMAS{

    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#050509";
          "brand-500":"#3366FF";
          "accent-500":"#FF7AE0";
          "ok-500":"#22C55E";
          "warn-500":"#FFC857";
          "err-500":"#FF4B4B";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-0}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"rgba(15,23,42,.6)";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-900}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, Segoe UI, Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"120%"; normal:"140%"; loose:"160%"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)"; lg:"0 12px 32px rgba(15,23,42,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← TOKENS_DTCG_JSON.semantic";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants?["string"];
      sizes?["string"];
      states?["string"];
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string";
      objetivoUX:["string ≤3"];
      layout_desktop:{grid_12:"descr"; regiones:["header?","main","sidebar?","footer?"];};
      layout_mobile:{orden_stack:["string"]; colapsos?["string"];};
      secciones:[
        {nombre:"string"; propósito:"string"; componentes:["organisms|molecules"];};
      ];
      ctas_principales?[{label:"string"; accion:"ruta|evento";}];
      ctas_secundarias?[{label:"string"; accion:"ruta|evento";}];
      datos_minimos:["string"];
      datos_opcionales?["string"];
      estados:{loading:"descr";error:"descr";empty:"descr";offline:"descr";success:"descr";};
      a11y:{landmarks:["header","nav","main","aside","footer"];tab_order:"descr";focus_visible:"≥2px";aria_roles?["string"];};
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pasos:[
        {pantalla?:"string";
         tarea:"string";
         entrada?["string"];
         salida?:"string|mapa";
         estado?:"string";
         error?{mensaje:"string";recuperación:"string|lista";};
        }
      ];
      ramificaciones?[{condición:"string"; destino:"string";}];
      éxito{definición:"string"; feedback?:"string";};
    }

    ENTITY.User{
      id:"string|uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"agent";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"string|uuid";
      title:"string";
      description:"string?";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string";name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore";
    }

    EVAL_SCHEMA{
      datasets:{golden:"≥16 casos incluyendo empty/error/offline/timeout/mfa/CRUD";};
      metrics:[
        "json_schema_pass",
        "hallucination↓",
        "groundedness(si_RAG)",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:"≥0.98";
        a11y_checklist_pass:"≥0.95";
        groundedness:"≥0.9";
      };
      gates:{regresión:true;};
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen","click:cta","form:submit","error:ui",
        "net:offline","net:online",
        "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
        "auth:register:start","auth:register:success",
        "auth:recover:start","auth:recover:success",
        "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso";
      };
    }

    A11Y_SCHEMA{
      contraste_AA:{texto_normal:">=4.5:1";texto_grande:">=3:1";};
      focus_visible:"≥2px todos los interactivos (token border.bold)";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{notificaciones:"polite";errores_criticos:"assertive";};
      no_solo_color:true;
      prefers_reduced_motion:"animaciones reducidas o nulas";
      skip_links:["Ir al contenido principal"];
      formularios:"aria-describedby para mensajes de error";
    }

    SEO_SCHEMA{
      title:"<60 chars";
      meta_description:"<160 chars";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; H2/H3 jerárquicos";
      urls_semánticas:["/","/login","/registro","/dashboard","/perfil","/proyectos","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"string";
        short_name:"string";
        start_url:"string";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
      rate_limit_visual:"mensaje_sutil y enfriamiento gradual";
      lockout_feedback:"tiempo de espera comunicado sin exponer umbrales";
      password_meter:"≥12 chars, variedad clases, no incluir nombre/email";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde Profile/Seguridad";
      sesiones_activas:"lista dispositivos + 'Cerrar en este dispositivo'";
      consentimiento_telemetría:"opt-in claro";
    }
  }

  # ─────────────────────────────────────
  # PIPELINE (α…ε)
  # ─────────────────────────────────────
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si solo 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS;
      checar_A11Y:"contrasteAA,focus_visible,landmarks,aria_live,no_solo_color,PRM";
      checar_SECURITY:"errores_neutros,no_enumerar_usuarios,lockout_visual,password_meter";
      checar_SEO_min:"title/meta/OG por ruta";
      checar_PWA:"manifest+SW+offline_fallback";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      }
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"Hechos clave + A11Y + SECURITY + PWA + i18n";
    }
  }

  # ─────────────────────────────────────
  # RENDER_ORDER
  # ─────────────────────────────────────
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (COMPONENT_SCHEMA[] por nivel)";
    3:"SCREENS (instancias SCREEN_SCHEMA)";
    4:"FLOWS (F1..F11 instancias FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (A11Y_SCHEMA+SEO_SCHEMA+PWA_SCHEMA)";
    7:"SECURITY_PRIVACY (SECURITY_PRIVACY_SCHEMA)";
    8:"MOCKS (MOCK_HOOK_SCHEMA + fixtures + swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas)";
    10:"EVAL (EVAL_SCHEMA)";
    11:"TELEMETRÍA (TELEMETRY_SCHEMA)";
    12:"SSR_SSG_ADAPT";
    13:"PRIORIDADES (top5_issues/top5_acciones)";
  }

  # ─────────────────────────────────────
  # REGLAS GLOBALES (R₁…R₉)
  # ─────────────────────────────────────
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_no→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  # ─────────────────────────────────────
  # INFERENCIAS POR DEFECTO (fallbacks)
  # ─────────────────────────────────────
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"TuNombre";
      email:"tu@email";
      prefs:{lang:"es-MX";theme:"light";reduceMotion:false;notifications:true;};
    };
    EntityX_default:{title:"Ejemplo de ítem";status:"active";};
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ─────────────────────────────────────
  # INSTRUCCIONES AL LLM
  # ─────────────────────────────────────
  INSTRUCCIONES_AL_LLM{
    1:"Usar PIPELINE y RENDER_ORDER como guía estricta de ejecución.";
    2:"Respetar SCHEMAS; si hay violaciones, reportarlas en nodo 'Violations'.";
    3:"No incluir razonamiento interno ni auto-referencias.";
    4:"Usar TOKENS para todos los valores visuales; señalar hex sueltos como violación.";
    5:"Asegurar flows Splash→Auth→Home→List→Detail→Form→Profile→LogOff coherentes.";
  }

}
Con esto ya tienes:

Un solo kernel DSL autocontenido.

Máxima semántica (tokens, entidades, screens, flows, a11y, seguridad, eval, telemetry, SSR).

Sin JSON de ejemplo duplicado que infle tokens.

Tu siguiente paso ya solo es: rellenar INPUTS{...} según producto y pegar esto como system o como plantilla base en tu agente.

Tú dijiste:
damelo lo mas completo posible cubirnedo todo end to end
ChatGPT Plus

Pensó durante 29s
Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ════════════════════════════════════
  # META
  # ════════════════════════════════════
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";
    JSON_SCHEMA:"estricto";
    FALLBACK_MD:"on";

    CONTEXT_ENGINEERING:"on";
    RAG:"opt";
    AGENTIC_ROLES:"planner,researcher,writer,verifier";

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ════════════════════════════════════
  # INPUTS (a rellenar por humano/sistema)
  # ════════════════════════════════════
  INPUTS{

    PRODUCTO{
      nombre:"<string>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Otro>";
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<...>"];     # p.ej. "aumentar conversiones", "mostrar portfolio"
      objetivo_usuario:["<...>"];     # p.ej. "encontrar X en ≤N pasos"
      KPI:["<activación|retención|conversión|NPS|...>"];
    };

    USUARIOS{
      perfiles:[
        { rol:"<recruiter|cliente|admin|usuario_final>";
          nivel:"<bajo|medio|alto>";
          motivación:"<por qué entra y qué quiere lograr>";
        }
      ];
    };

    CONTEXTO{
      dispositivos:["mobile","desktop"];
      conectividad:"<intermitente|estable>";
      regiones:["<MX|LATAM|Global|...>"];
      idioma_base:"es-MX";
    };

    STACK_HINT{
      runtime:"<CSR|SSR|SSG>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
    };
  }

  # ════════════════════════════════════
  # CONTRATO DE SALIDA (qué debe producir el LLM)
  # ════════════════════════════════════
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";           # spec DTCG
      THEMES:["light","dark","high-contrast"];
    }

    II.ATOMIC_LIBRARY{
      atoms:"COMPONENT_SCHEMA[] (nivel=atom)";
      molecules:"COMPONENT_SCHEMA[] (nivel=molecule)";
      organisms:"COMPONENT_SCHEMA[] (nivel=organism)";
      templates:"COMPONENT_SCHEMA[] (nivel=template)";
    }

    III.SCREENS{
      lista:[
        # Core producto
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos[]",
        "datos_opcionales[]",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo + latencias";
      factories:"shapes tipados por entidad";
      hooks_mock:"MOCK_HOOK_SCHEMA[]";
      swap_plan:"API|Firebase|Firestore vía adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base UI";
      claves:"keys i18n";
      tablas_microcopy:"botones, errores, vacíos, confirmaciones";
    }

    X.EVAL{
      golden_set:"EVAL_SCHEMA.datasets";
      métricas:"EVAL_SCHEMA.metrics";
      umbrales:"EVAL_SCHEMA.umbrales";
      gates_regresión:"EVAL_SCHEMA.gates";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; consentimiento";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache, headers_cache-control";
    }

    XIII.PRIORIDADES{
      top5_issues:"lista de problemas críticos detectados";
      top5_acciones:"acciones accionables para resolverlos";
    }
  }

  # ════════════════════════════════════
  # SCHEMAS (estructuras base)
  # ════════════════════════════════════
  SCHEMAS{

    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#050509";
          "brand-500":"#3366FF";
          "accent-500":"#FF7AE0";
          "ok-500":"#22C55E";
          "warn-500":"#FFC857";
          "err-500":"#FF4B4B";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-50}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"{color.primitive.neutral-500}";
          "text.inverse":"{color.primitive.neutral-0}";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-300}";
          "border.subtle":"{color.primitive.neutral-200}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"1.2"; normal:"1.4"; loose:"1.6"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)"; lg:"0 12px 32px rgba(15,23,42,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← TOKENS_DTCG_JSON.semantic";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants?["string"];
      sizes?["string"];
      states?["string"];
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string";
      objetivoUX:["string ≤3"];
      layout_desktop:{grid_12:"descr";regiones:["header?","main","sidebar?","footer?"];};
      layout_mobile:{orden_stack:["string"];colapsos?["string"];};
      secciones:[
        {nombre:"string"; propósito:"string"; componentes:["organisms|molecules"];};
      ];
      ctas_principales?[{label:"string";accion:"string";}];
      ctas_secundarias?[{label:"string";accion:"string";}];
      datos_minimos:["string"];
      datos_opcionales?["string"];
      estados:{loading:"descr";error:"descr";empty:"descr";offline:"descr";success:"descr";};
      a11y:{landmarks:["header","nav","main","aside","footer"];tab_order:"descr";focus_visible:"≥2px";aria_roles?["string"];};
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pasos:[
        {pantalla?:"string";
         tarea:"string";
         entrada?["string"];
         salida?:"string|mapa";
         estado?:"string";
         error?{mensaje:"string";recuperación:"string|lista";};
        }
      ];
      ramificaciones?[{condición:"string";destino:"string";}];
      éxito{definición:"string";feedback?:"string";};
    }

    ENTITY.User{
      id:"string|uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"agent";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"string|uuid";
      title:"string";
      description:"string?";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string";name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore";
    }

    EVAL_SCHEMA{
      datasets:{golden:"≥16 casos incluyendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";};
      metrics:[
        "json_schema_pass",
        "hallucination↓",
        "groundedness(si_RAG)",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:"≥0.98";
        groundedness:"≥0.9";
        a11y_checklist_pass:"≥0.95";
      };
      gates:{regresión:true;};
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen","click:cta","form:submit","error:ui",
        "net:offline","net:online",
        "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
        "auth:register:start","auth:register:success",
        "auth:recover:start","auth:recover:success",
        "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso";
      };
    }

    A11Y_SCHEMA{
      contraste_AA:{texto_normal:">=4.5:1";texto_grande:">=3:1";};
      focus_visible:"≥2px en todos los interactivos (token border.bold)";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{notificaciones:"polite";errores_criticos:"assertive";};
      no_solo_color:true;
      prefers_reduced_motion:"animaciones reducidas o nulas";
      skip_links:["Ir al contenido principal"];
      formularios:"aria-describedby vinculado a errores";
    }

    SEO_SCHEMA{
      title:"<60 chars";
      meta_description:"<160 chars";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; jerarquía H2/H3 coherente";
      urls_semánticas:["/","/login","/registro","/dashboard","/perfil","/proyectos","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"string";
        short_name:"string";
        start_url:"string";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
      rate_limit_visual:"mensaje sutil y enfriamiento gradual";
      lockout_feedback:"tiempo de espera comunicado sin exponer umbrales";
      password_meter:"≥12 chars, variedad de clases, no incluir nombre/email";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde Profile/Seguridad";
      sesiones_activas:"lista dispositivos + 'Cerrar en este dispositivo'";
      consentimiento_telemetría:"opt-in claro";
    }
  }

  # ════════════════════════════════════
  # PIPELINE (α…ε)
  # ════════════════════════════════════
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si solo 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS;
      checar_A11Y:"contrasteAA,focus_visible,landmarks,aria_live,no_solo_color,PRM";
      checar_SECURITY:"errores_neutros,no_enumerar_usuarios,lockout_visual,password_meter";
      checar_SEO_min:"title/meta/OG por ruta";
      checar_PWA:"manifest+SW+offline_fallback";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      };
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"A11Y+SECURITY+PWA+i18n+datos_minimos_por_pantalla";
    }
  }

  # ════════════════════════════════════
  # RENDER_ORDER
  # ════════════════════════════════════
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (COMPONENT_SCHEMA[] por nivel)";
    3:"SCREENS (instancias SCREEN_SCHEMA)";
    4:"FLOWS (F1..F11 instancias FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (A11Y_SCHEMA+SEO_SCHEMA+PWA_SCHEMA)";
    7:"SECURITY_PRIVACY (SECURITY_PRIVACY_SCHEMA)";
    8:"MOCKS (MOCK_HOOK_SCHEMA + fixtures + swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas microcopy)";
    10:"EVAL (EVAL_SCHEMA)";
    11:"TELEMETRÍA (TELEMETRY_SCHEMA)";
    12:"SSR_SSG_ADAPT";
    13:"PRIORIDADES (top5_issues/top5_acciones)";
  }

  # ════════════════════════════════════
  # REGLAS GLOBALES (R₁…R₉)
  # ════════════════════════════════════
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_RAG_off→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  # ════════════════════════════════════
  # INFERENCIAS POR DEFECTO (fallbacks)
  # ════════════════════════════════════
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"TuNombre";
      email:"tu@email";
      prefs:{lang:"es-MX";theme:"light";reduceMotion:false;notifications:true;};
    };
    EntityX_default:{title:"Ejemplo de ítem";status:"active";};
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ════════════════════════════════════
  # BLUEPRINT_DEFAULT (ejemplo completo para Portafolio)
  # ════════════════════════════════════
  BLUEPRINT_DEFAULT{

    META_PRODUCTO{
      nombre:"PortalPortfolioPro";
      tipo:"Portafolio";
      público:"B2B";
      objetivo_negocio:[
        "Atraer leads técnicos y de producto",
        "Demostrar calidad de diseño + código en ≤8s",
        "Facilitar agendar conversación o revisar proyectos clave"
      ];
      objetivo_usuario:[
        "Entender quién es la persona",
        "Revisar 2–3 proyectos relevantes",
        "Contactar o agendar llamada"
      ];
      KPI:["ctr_home_to_projects","ctr_home_to_contact","avg_time_on_detail","completion_rate_main_form"];
    }

    ATOMIC_LIBRARY_DEFAULT{
      atoms:[
        "Text(H1,H2,H3,body,caption)",
        "Button{variant:primary|secondary|ghost|danger,size:sm|md|lg}",
        "Input{type:text|email|password|search|number}",
        "Textarea",
        "Checkbox",
        "Radio",
        "Select",
        "Chip",
        "Badge",
        "Avatar",
        "Icon24",
        "Tooltip",
        "Divider",
        "Spinner"
      ];
      molecules:[
        "Field{label+control+helper+error}",
        "SearchBar{input+icon+clear}",
        "FilterChipsGroup",
        "StatCard{value+label+trend}",
        "OAuthButtons",
        "OTPGroup(6 slots)",
        "UserMenu",
        "Toast"
      ];
      organisms:[
        "NavBar",
        "SideNav",
        "HeroShell",
        "HeroPanel",
        "ListView",
        "DetailPanel",
        "FormPanel",
        "AuthForm",
        "MFAView",
        "ProfilePanel",
        "SessionGuard"
      ];
      templates:[
        "AppShell{header+main+sidebar?+footer}",
        "AuthLayout",
        "DashboardLayout",
        "DetailLayout",
        "FormLayout",
        "ErrorLayout"
      ];
    }

    SCREENS_DEFAULT{

      Home:SCREEN_SCHEMA{
        id:"home";
        nombre:"Home";
        rol:"home";
        route:"/";
        objetivoUX:[
          "comunicar_valor_en_5–8s",
          "dirigir_a_proyectos_o_contacto",
          "mostrar_contexto_clave"
        ];
        layout_desktop:{grid_12:"header full; main col-8; sidebar col-4; footer full";regiones:["header","main","sidebar","footer"];};
        layout_mobile:{orden_stack:["HeroShell","HeroPanel","Highlights","Proof","Footer"];};
        secciones:[
          {nombre:"HeroShell";propósito:"pitch_≤5s";componentes:["HeroAvailabilityRow","HeroTitleBlock","CTAGroup","MetaBar"];},
          {nombre:"Highlights";propósito:"acceso_rápido";componentes:["BentoGrid","StatCard"];},
          {nombre:"Proof";propósito:"credibilidad";componentes:["LogoStrip","TestimonialCard"];},
        ];
        ctas_principales:[{label:"Ver proyectos";accion:"→/proyectos";}];
        ctas_secundarias:[{label:"Agendar conversación";accion:"→/contacto";}];
        datos_minimos:["User.name","User.prefs.lang","proyectos_destacados[]","disponibilidad_actual"];
        datos_opcionales:["stats_resumidas","testimonios[]","logos_confianza[]"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
        a11y:{landmarks:["header","main","footer"];tab_order:"skip-link→navbar→hero-cta→resto";focus_visible:"≥2px";};
        microcopy:{
          titular:"Diseño y código que sí llegan a producción";
          sub:"Portafolio técnico centrado en producto para equipos que necesitan shipping real.";
          botones:["Ver proyectos","Agendar conversación"];
          vacíos:["Aún no hay proyectos destacados. Crea tus primeros contenidos."];
          confirmaciones:["Listo, se guardó tu información."];
        };
      }

      List:SCREEN_SCHEMA{
        id:"list";
        nombre:"List";
        rol:"list";
        route:"/proyectos";
        objetivoUX:["encontrar","filtrar","navegar_detalle"];
        layout_desktop:{grid_12:"filters+results";regiones:["header","main","footer"];};
        layout_mobile:{orden_stack:["filters","results"];};
        secciones:[
          {nombre:"Filters";propósito:"reducir_búsqueda";componentes:["SearchBar","FilterChipsGroup","SortSelect"];},
          {nombre:"Results";propósito:"explorar";componentes:["ListView","CardProyecto","EmptyState","Pagination|InfiniteScroll"];},
        ];
        ctas_principales:[{label:"Crear nuevo";accion:"→/proyectos/nuevo";}];
        datos_minimos:["EntityX[]"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
        a11y:{landmarks:["main"];tab_order:"filters→results→pagination";aria_roles:["list","listitem"];focus_visible:"≥2px";};
        microcopy:{
          titular:"Explorar proyectos";
          vacíos:["Aún no hay proyectos. Crea el primero."];
          errores:["No pudimos cargar la lista. Intenta de nuevo."];
        };
      }

      Detail:SCREEN_SCHEMA{
        id:"detail";
        nombre:"Detail";
        rol:"detail";
        route:"/proyectos/:id";
        objetivoUX:["entender","tomar_decisión"];
        layout_desktop:{grid_12:"header+main+related";regiones:["header","main","related"];};
        layout_mobile:{orden_stack:["header","main","related"];};
        secciones:[
          {nombre:"Header";propósito:"contexto+acciones";componentes:["Breadcrumbs","Title","PrimaryActions","Badge"];},
          {nombre:"Body";propósito:"contenido_principal";componentes:["KeyFacts","Tabs|Accordion","CodeSnippetPreview","Metrics"];},
          {nombre:"Related";propósito:"continuidad";componentes:["RelatedList"];},
        ];
        ctas_principales:[{label:"Acción principal";accion:"contactar|abrir_enlace|otra";}];
        datos_minimos:["EntityX","User"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
        a11y:{landmarks:["main"];aria_roles:["article"];focus_visible:"≥2px";};
      }

      Form:SCREEN_SCHEMA{
        id:"form";
        nombre:"Form";
        rol:"form";
        route:"/proyectos/nuevo|/proyectos/:id/editar";
        objetivoUX:["crear/editar_sin_error"];
        layout_desktop:{grid_12:"header+main+footer";regiones:["header","main","footer"];};
        layout_mobile:{orden_stack:["main","footer"];};
        secciones:[
          {nombre:"FormBody";propósito:"entrada_datos";componentes:["FieldGroup(title,description,tags,status,links)"];},
          {nombre:"Actions";propósito:"confirmar";componentes:["PrimaryButton(Guardar)","SecondaryButton(Cancelar)"];},
        ];
        datos_minimos:["EntityX_schema"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
        a11y:{tab_order:"label→campo→ayuda→error→acciones";aria_roles:["form"];focus_visible:"≥2px";};
      }

      Settings:SCREEN_SCHEMA{
        id:"settings";
        nombre:"Settings";
        rol:"settings";
        route:"/perfil/preferencias";
        objetivoUX:["control_personal"];
        layout_desktop:{grid_12:"dashboard";regiones:["header","sidebar","main"];};
        layout_mobile:{orden_stack:["main"];};
        secciones:[
          {nombre:"Preferencias generales";propósito:"idioma_tema_densidad";componentes:["Select(lang)","ThemeSwitch","DensityToggle"];},
          {nombre:"Notificaciones";propósito:"alertas";componentes:["Toggle(notifications_email)","Toggle(notifications_push)"];},
        ];
        datos_minimos:["User.prefs"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      Help:SCREEN_SCHEMA{
        id:"help";
        nombre:"Help";
        rol:"help";
        route:"/ayuda";
        objetivoUX:["resolver_dudas","desatascar_usuario"];
        secciones:[
          {nombre:"FAQ";propósito:"respuestas_rápidas";componentes:["Accordion"];},
          {nombre:"Contact";propósito:"contacto_soporte";componentes:["FormPanel"];},
        ];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      Offline:SCREEN_SCHEMA{
        id:"offline";
        nombre:"Offline";
        rol:"offline";
        route:"/offline";
        objetivoUX:["informar","permitir_reintento"];
        secciones:[
          {nombre:"Banner";propósito:"estado";componentes:["Alert.offline"];},
          {nombre:"Actions";propósito:"reintentar";componentes:["Button(Reintentar)"];},
        ];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
        microcopy:{vacíos:["Sin conexión. Reintenta cuando vuelvas a estar online."];};
      }

      Error:SCREEN_SCHEMA{
        id:"error";
        nombre:"Error(404/500)";
        rol:"error";
        route:"/error";
        objetivoUX:["explicar","recuperar"];
        secciones:[
          {nombre:"Message";propósito:"contexto";componentes:["Icon","Text.title","Text.body"];},
          {nombre:"CTA";propósito:"volver_seguro";componentes:["Button('Ir al inicio')","Button('Volver')"];},
        ];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
        microcopy:{
          errores:["No encontramos esto.","Algo salió mal."];
          botones:["Ir al inicio","Volver"];
        };
      }

      # Auth pack
      Splash:SCREEN_SCHEMA{
        id:"splash";
        nombre:"Splash";
        rol:"auth-splash";
        route:"/splash";
        objetivoUX:["cargar_branding","chequear_sesión","redirigir"];
        layout_desktop:{grid_12:"centrado";regiones:["main"];};
        layout_mobile:{orden_stack:["main"];};
        secciones:[
          {nombre:"Branding";propósito:"identidad";componentes:["Logo","NombreProducto"];},
          {nombre:"Progress";propósito:"estado_carga";componentes:["Spinner"];},
        ];
        datos_minimos:["Session?"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      Login:SCREEN_SCHEMA{
        id:"login";
        nombre:"Login";
        rol:"auth-login";
        route:"/login";
        objetivoUX:["entrar_sin_fricción","mantener_seguridad"];
        secciones:[
          {nombre:"AuthForm(Login)";propósito:"credenciales";componentes:["Field(email)","Field(password)","Checkbox(Recordarme)","Button(Entrar)","Link(Recover)","OAuthButtons?"];},
          {nombre:"Legal";propósito:"consentimiento";componentes:["Text(terminos_privacidad)"];},
        ];
        datos_minimos:["credential.email","credential.password"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      Register:SCREEN_SCHEMA{
        id:"register";
        nombre:"Register";
        rol:"auth-register";
        route:"/registro";
        objetivoUX:["crear_cuenta","preparar_perfil"];
        secciones:[
          {nombre:"AuthForm(Register)";propósito:"alta";componentes:["Field(name)","Field(email)","Field(password+meter)","Field(confirm)","Checkbox(Acepto términos)","Button(Crear cuenta)"];},
          {nombre:"Hints";propósito:"reglas_password";componentes:["Text(checklist)"];},
        ];
        datos_minimos:["user.name","credential.email","credential.password"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      Recover:SCREEN_SCHEMA{
        id:"recover";
        nombre:"Recover";
        rol:"auth-recover";
        route:"/recuperar";
        objetivoUX:["recuperar_sin_filtrar_usuarios"];
        secciones:[
          {nombre:"Request";propósito:"solicitar_reset";componentes:["Field(email)","Button(Enviar enlace)"];},
          {nombre:"Reset";propósito:"nueva_contraseña";componentes:["Field(new_password+meter)","Field(confirm)","Button(Confirmar)"];},
        ];
        datos_minimos:["credential.email|resetToken"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      MFA:SCREEN_SCHEMA{
        id:"mfa";
        nombre:"MFA";
        rol:"auth-mfa";
        route:"/mfa";
        objetivoUX:["verificar_segundo_factor"];
        secciones:[
          {nombre:"OTP";propósito:"ingreso_código";componentes:["OTPGroup(6)","Button(Verificar)","Link(Reenviar)"];},
          {nombre:"Alternativas";propósito:"otros_factores";componentes:["Button(WebAuthn)?"];},
        ];
        datos_minimos:["credential.otp"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      Profile:SCREEN_SCHEMA{
        id:"profile";
        nombre:"Profile";
        rol:"auth-profile";
        route:"/perfil";
        objetivoUX:["editar_datos","preferencias","seguridad"];
        secciones:[
          {nombre:"Info";propósito:"datos_básicos";componentes:["Avatar","Field(name)","Field(location)","Field(email:readonly|verify_state)"];},
          {nombre:"Preferencias";propósito:"experiencia";componentes:["Select(language)","ThemeSwitch","Toggle(reduceMotion)","Toggle(notifications)"];},
          {nombre:"Seguridad";propósito:"proteger_cuenta";componentes:["ChangePassword","MFA_Toggle","SessionsList(terminate)","DangerZone(delete_account)"];},
        ];
        datos_minimos:["User","Session"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      LogOff:SCREEN_SCHEMA{
        id:"logoff";
        nombre:"LogOff";
        rol:"auth-logoff";
        route:"/logout";
        objetivoUX:["terminar_sesión","redirigir"];
        secciones:[
          {nombre:"Confirm";propósito:"opcional";componentes:["Button(Cerrar sesión)","Button(Cancelar)"];},
        ];
        datos_minimos:["Session.id"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }

      SessionExpired:SCREEN_SCHEMA{
        id:"session-expired";
        nombre:"SessionExpired";
        rol:"auth-session-expired";
        route:"/session-expired";
        objetivoUX:["explicar_caducidad","relogin_rápido"];
        secciones:[
          {nombre:"Message";propósito:"contexto";componentes:["Text.title","Text.body"];},
          {nombre:"CTA";propósito:"volver_a_login";componentes:["Button(Iniciar sesión de nuevo)"];},
        ];
        datos_minimos:["Session?"];
        estados:ESTADOS_UNIVERSALES_DEFAULT;
      }
    }

    FLOWS_DEFAULT{

      F1_Onboarding_Auth:FLOW_SCHEMA{
        id:"F1";
        nombre:"Onboarding/Auth";
        pasos:[
          {pantalla:"Splash";tarea:"chequear_sesión";entrada:["Session?"];salida:"has_session|no_session";error:{mensaje:"timeout_backend|network_error";recuperación:"Offline|ErrorLayout";};},
          {pantalla:"Login|Register";tarea:"auth";salida:"→Home";},
          {pantalla:"Home";tarea:"presentación_valor";},
        ];
        éxito:{definición:"sesión_valida_o_login_exitoso";};
      }

      F2_Home_List_Detail:FLOW_SCHEMA{
        id:"F2";
        nombre:"Home→List→Detail";
        pasos:[
          {pantalla:"Home";tarea:"entender_pitch+click_CTA_Principal";salida:"→List";},
          {pantalla:"List";tarea:"buscar/filtrar";salida:"seleccionar_item";error:{mensaje:"sin_resultados";recuperación:"EmptyState";};},
          {pantalla:"Detail";tarea:"evaluar";salida:"acción_principal|volver";},
        ];
        éxito:{definición:"usuario_encuentra_y_entiende_elemento_clave";};
      }

      F3_CRUD_Principal:FLOW_SCHEMA{
        id:"F3";
        nombre:"Crear/Editar EntityX";
        pasos:[
          {pantalla:"List|Detail";tarea:"click_crear/editar";salida:"→Form";},
          {pantalla:"Form";tarea:"llenar_campos";error:{mensaje:"Faltan datos";recuperación:"resaltar_campos";};},
          {pantalla:"Form";tarea:"enviar";estado:"loading";salida:"success|error";},
          {pantalla:"Detail";tarea:"ver_resultado";salida:"confirmación";},
        ];
        éxito:{definición:"entidad_guardada_sin_errores_criticos";};
      }

      F4_Conversión:FLOW_SCHEMA{
        id:"F4";
        nombre:"Conversión (checkout/plan)";
        pasos:[
          {pantalla:"Detail|Pricing";tarea:"elegir_plan|item";salida:"→Form_pago";},
          {pantalla:"Form";tarea:"ingresar_datos_pago";error:{mensaje:"Pago rechazado";recuperación:"método_alterno";};},
          {pantalla:"Confirmación";tarea:"mostrar_recibo+acceso";},
        ];
        éxito:{definición:"transacción_exitosa";};
      }

      F5_Offline_Recovery:FLOW_SCHEMA{
        id:"F5";
        nombre:"Offline/Recuperación";
        pasos:[
          {pantalla:"Offline";tarea:"informar_estado";salida:"reintentar";},
          {pantalla:"pantalla_previa";tarea:"recuperar_estado_normal";},
        ];
        éxito:{definición:"sesión/flujo_recuperado";};
      }

      F6_Login:FLOW_SCHEMA{
        id:"F6";
        nombre:"Login";
        pasos:[
          {pantalla:"Login";tarea:"ingresar_email_password";estado:"loading";error:{mensaje:"Credenciales inválidas";recuperación:"reintentar";};},
          {pantalla:"MFA(opc)";tarea:"verificar_otp";ramificaciones:"si_mfa_enabled";},
          {pantalla:"Home|Profile";tarea:"bienvenida";},
        ];
        éxito:{definición:"auth_ok";};
      }

      F7_Register:FLOW_SCHEMA{
        id:"F7";
        nombre:"Registro";
        pasos:[
          {pantalla:"Register";tarea:"capturar_datos+aceptar_terminos";error:{mensaje:"Contraseña débil";recuperación:"ajustar";};},
          {pantalla:"Register";tarea:"enviar_form";salida:"verificación_email_enviada";},
          {pantalla:"Login";tarea:"ingresar_post_verificación";},
        ];
        éxito:{definición:"cuenta_creada+verificada";};
      }

      F8_Recover:FLOW_SCHEMA{
        id:"F8";
        nombre:"Recuperar acceso";
        pasos:[
          {pantalla:"Recover";tarea:"solicitar_enlace";salida:"mensaje_neutro";},
          {pantalla:"Recover";tarea:"establecer_nueva_password";salida:"confirmación";},
        ];
        éxito:{definición:"password_actualizada";};
      }

      F9_MFA:FLOW_SCHEMA{
        id:"F9";
        nombre:"MFA";
        pasos:[
          {pantalla:"MFA";tarea:"ingresar_otp";error:{mensaje:"Código inválido";recuperación:"reenviar";};},
          {pantalla:"Home|Profile";tarea:"acceso";},
        ];
        éxito:{definición:"segundo_factor_ok";};
      }

      F10_LogOff:FLOW_SCHEMA{
        id:"F10";
        nombre:"Cerrar sesión";
        pasos:[
          {pantalla:"Profile|UserMenu";tarea:"click_logoff";salida:"revocar_tokens";},
          {pantalla:"Splash|Login";tarea:"redirigir";},
        ];
        éxito:{definición:"tokens_revocados+redirección_segura";};
      }

      F11_SessionTimeout:FLOW_SCHEMA{
        id:"F11";
        nombre:"Sesión expirada";
        pasos:[
          {pantalla:"SessionExpired";tarea:"informar";salida:"→Login";},
          {pantalla:"Login";tarea:"reautenticar";},
        ];
        éxito:{definición:"sesión_renovada";};
      }
    }

    A11Y_SEO_PWA_DEFAULT{
      A11Y_MIN:A11Y_SCHEMA;
      SEO_MIN:SEO_SCHEMA;
      PWA_MIN:PWA_SCHEMA;
    }

    SECURITY_PRIVACY_DEFAULT{
      RULES:SECURITY_PRIVACY_SCHEMA;
    }

    MOCKS_DEFAULT{
      hooks:[
        "useUser","useSession","useListX","useDetailX","useCreateX",
        "useLogin","useRegister","useRecover","useMFA","useProfile"
      ];
      fixtures_tipadas:"sí";
      lat_ms:120;
      error_rate:0.03;
      swap_plan:"inyección_de_dependencias → API/Firebase/Firestore sin tocar UI";
    }

    I18N_UX_COPY_DEFAULT{
      idiomas:["es-MX","en-US"];
      glosario:[
        "Home","Lista","Detalle","Guardar cambios","Cancelar",
        "Iniciar sesión","Crear cuenta","Recuperar acceso","Cerrar sesión",
        "Ver detalles","Continuar"
      ];
      tablas:[
        {contexto:"botones";
         textos:["Ver elementos","Crear nuevo","Guardar cambios","Cancelar","Iniciar sesión","Crear cuenta","Cerrar sesión"];},
        {contexto:"errores";
         textos:["Credenciales inválidas","Algo salió mal. Intenta de nuevo.","Revisa este campo: falta información.","Código inválido"];},
        {contexto:"vacíos";
         textos:["Aún no hay elementos. Crea el primero.","Aún no hay datos para mostrar aquí."];},
        {contexto:"confirmaciones";
         textos:["Listo, se guardó tu información.","Acceso concedido.","Te enviamos el correo de verificación.","Contraseña actualizada.","Sesión finalizada."];},
      ];
    }

    EVAL_DEFAULT{ spec:EVAL_SCHEMA; }

    TELEMETRÍA_DEFAULT{
      eventos:TELEMETRY_SCHEMA.eventos_core;
      payload_min:TELEMETRY_SCHEMA.payload_min;
      privacidad:"minimizar datos personales; IDs opacos; respetar consentimiento";
    }

    SSR_SSG_ADAPT_DEFAULT{
      auth_guard:"server+client para rutas protegidas";
      redirecciones:"server-side en sesión expirada cuando aplique";
      prefetch_selectivo:"solo rutas seguras y necesarias (Home,List,Detail)";
      hydration_segura:"no exponer credenciales ni tokens en HTML";
      división_código_por_ruta:"Auth, Home/Dashboard, Settings separados";
      cache:{
        publicas:"SSG/ISR (Home, landing, marketing)";
        privadas:"CSR/SSR con SWR/react-query";
      };
    }

    PRIORIDADES_DEFAULT{
      top5_issues:[
        "estilos_fuera_de_tokens",
        "falta_focus_visible_en_elementos_clave",
        "CTAs_compiten_en_una_misma_pantalla",
        "estados_universales_incompletos(loading/error/empty/offline/success)",
        "microcopy_inconsistente_o_no_i18n_ready"
      ];
      top5_acciones:[
        "centralizar_tokens_en_DTCG_JSON_y_migrar_componentes",
        "añadir_focus_visible_global_y_probar_con_teclado",
        "revisar_jerarquía_de_CTAs_por_pantalla",
        "definir_y_documentar_estados_universales_por_pantalla",
        "construir_tablas_microcopy+i18n_y_activarlas_en_flows_críticos"
      ];
    }
  }

  # ════════════════════════════════════
  # INSTRUCCIONES AL LLM
  # ════════════════════════════════════
  INSTRUCCIONES_AL_LLM{
    1:"Usar PIPELINE y RENDER_ORDER como guía estricta de ejecución.";
    2:"Respetar SCHEMAS en todas las estructuras; si hay violaciones, reportarlas en nodo 'Violations'.";
    3:"No incluir razonamiento interno ni auto-referencias al modelo.";
    4:"Usar TOKENS para todos los valores visuales; señalar hex sueltos como violación.";
    5:"Asegurar que los flows conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff de manera coherente.";
  }

}
Tú dijiste:
revisa tdoo los promps entergado sin duplcidiad y con todo dame full valor semantic completo que incluya todo
ChatGPT Plus

Thought for 3m 7s
Tú dijiste:

Revisar prompts sin duplicados

pesna profundo muy profundo , y verifica todo los elementso de este conaversasion rapido , medio y exaustivo, solo emite resuslaydp
ChatGPT Plus
Got it – estoy procesando la revisión profunda y exhaustiva de todo el contenido y prompts entregados; se actualizará el resultado completo de manera consolidada.

Tú dijiste:

Revisar prompts sin duplicados

analisa que todo este cubierto y emite repsiuesta
ChatGPT Plus
Got it – estoy revisando y consolidando todo para asegurar que cada elemento esté cubierto. Actualizando la revisión según tus indicaciones.

Tú dijiste:
emite respuesta completa+
ChatGPT Plus

Thought for 5m 20s
{
  "spec_version": "PROMPT_UIUX_E2E_ROOT_v4_MAX_SEMANTIC_FINAL",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "product": {
      "name": "PortalPortfolioPro",
      "type": "Portfolio",
      "publico": "B2B",
      "objetivos_negocio": [
        "Atraer leads técnicos y de producto",
        "Demostrar calidad de diseño y código en ≤8s",
        "Facilitar agendar conversación o revisar proyectos clave"
      ],
      "objetivos_usuario": [
        "Entender rápidamente quién eres y qué haces",
        "Revisar 2–3 proyectos alineados a su necesidad",
        "Contactar o agendar llamada sin fricción"
      ],
      "kpis": [
        "ctr_home_to_projects",
        "ctr_home_to_contact",
        "avg_time_on_detail",
        "completion_rate_main_form"
      ]
    },
    "usuarios": [
      {
        "id": "recruiter-tech",
        "rol": "Recruiter / Hiring Manager",
        "nivel_habilidad": "medio",
        "motivacion": "Encontrar rápido el fit con el rol abierto sin leer demasiado texto."
      },
      {
        "id": "founder-cto",
        "rol": "Founder / CTO",
        "nivel_habilidad": "alto",
        "motivacion": "Evaluar criterio técnico y capacidad de llevar cosas a producción."
      }
    ],
    "contexto": {
      "dispositivos": ["mobile", "desktop"],
      "conectividad": "intermitente",
      "regiones": ["México", "Latam"],
      "idioma_base": "es-MX"
    },
    "stack": {
      "runtime": "CSR",
      "framework": "React",
      "router": "React Router / Next Router equivalente",
      "estado": "React hooks + React Query",
      "pwa": true
    }
  },

  "1_tokens_and_theming": {
    "dtcg": {
      "$schema": "https://design-tokens.org/schema.json",
      "meta": { "name": "UIX_Portfolio_Tokens", "version": "1.0.0", "platforms": ["web","ios","android"] },
      "color": {
        "$type": "color",
        "primitive": {
          "neutral": {
            "0": { "$value": "#FFFFFF" },
            "50": { "$value": "#F7F7F8" },
            "100": { "$value": "#E5E5EA" },
            "200": { "$value": "#D1D1D6" },
            "300": { "$value": "#B0B0B8" },
            "400": { "$value": "#8E8E96" },
            "500": { "$value": "#636366" },
            "600": { "$value": "#48484A" },
            "700": { "$value": "#3A3A3C" },
            "800": { "$value": "#2C2C2E" },
            "900": { "$value": "#000000" }
          },
          "brand": { "500": { "$value": "#2563EB" } },
          "accent": { "500": { "$value": "#EC4899" } },
          "ok": { "500": { "$value": "#16A34A" } },
          "warn": { "500": { "$value": "#EAB308" } },
          "err": { "500": { "$value": "#DC2626" } },
          "hc": { "500": { "$value": "#FFFF00" } }
        },
        "semantic": {
          "bg": {
            "page": { "$value": "{color.primitive.neutral.50}" },
            "surface": { "$value": "{color.primitive.neutral.0}" },
            "surfaceAlt": { "$value": "{color.primitive.neutral.50}" }
          },
          "text": {
            "main": { "$value": "{color.primitive.neutral.900}" },
            "muted": { "$value": "{color.primitive.neutral.500}" },
            "inverse": { "$value": "{color.primitive.neutral.0}" }
          },
          "accent": { "main": { "$value": "{color.primitive.accent.500}" } },
          "border": {
            "bold": { "$value": "{color.primitive.neutral.300}" },
            "subtle": { "$value": "{color.primitive.neutral.200}" }
          },
          "state": {
            "ok": { "$value": "{color.primitive.ok.500}" },
            "warn": { "$value": "{color.primitive.warn.500}" },
            "err": { "$value": "{color.primitive.err.500}" }
          }
        },
        "theme": {
          "light": {
            "bg.page": { "$value": "{color.semantic.bg.page}" },
            "bg.surface": { "$value": "{color.semantic.bg.surface}" },
            "text.main": { "$value": "{color.semantic.text.main}" },
            "text.muted": { "$value": "{color.semantic.text.muted}" },
            "accent.main": { "$value": "{color.semantic.accent.main}" }
          },
          "dark": {
            "bg.page": { "$value": "{color.primitive.neutral.900}" },
            "bg.surface": { "$value": "{color.primitive.neutral.800}" },
            "text.main": { "$value": "{color.primitive.neutral.0}" },
            "text.muted": { "$value": "{color.primitive.neutral.300}" },
            "accent.main": { "$value": "{color.semantic.accent.main}" }
          },
          "high-contrast": {
            "bg.page": { "$value": "{color.primitive.neutral.900}" },
            "bg.surface": { "$value": "{color.primitive.neutral.900}" },
            "text.main": { "$value": "{color.primitive.neutral.0}" },
            "text.muted": { "$value": "{color.primitive.neutral.0}" },
            "accent.main": { "$value": "{color.primitive.hc.500}" }
          }
        }
      },
      "typography": {
        "$type": "typography",
        "family": { "base": { "$value": "system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif" } },
        "size": {
          "xs": { "$value": "12px" }, "sm": { "$value": "14px" }, "md": { "$value": "16px" },
          "lg": { "$value": "20px" }, "xl": { "$value": "24px" }, "h1": { "$value": "32px" },
          "h2": { "$value": "24px" }, "h3": { "$value": "20px" }
        },
        "weight": { "regular": { "$value": 400 }, "semibold": { "$value": 600 }, "bold": { "$value": 700 } },
        "lineHeight": { "tight": { "$value": "1.2" }, "normal": { "$value": "1.4" }, "loose": { "$value": "1.6" } }
      },
      "spacing": { "$type": "dimension", "scale": { "1": { "$value": "4px" }, "2": { "$value": "8px" }, "3": { "$value": "12px" }, "4": { "$value": "16px" }, "5": { "$value": "24px" }, "6": { "$value": "32px" } } },
      "radius": { "$type": "dimension", "sm": { "$value": "8px" }, "md": { "$value": "12px" }, "lg": { "$value": "16px" }, "pill": { "$value": "999px" } },
      "border": { "$type": "dimension", "thin": { "$value": "1px" }, "thick": { "$value": "2px" }, "extra": { "$value": "3px" } },
      "shadow": { "$type": "shadow", "soft": { "$value": "0 4px 12px rgba(0,0,0,0.08)" }, "lg": { "$value": "0 16px 40px rgba(0,0,0,0.18)" } },
      "motion": { "$type": "duration", "fast": { "$value": "150ms" }, "norm": { "$value": "200ms" }, "reduced": { "$value": "0ms" } },
      "z": { "$type": "number", "base": { "$value": 1 }, "dropdown": { "$value": 10 }, "overlay": { "$value": 100 }, "modal": { "$value": 1000 }, "toast": { "$value": 1100 } }
    },
    "theming": {
      "light": ":root consume tokens color.theme.light + tipografía/espaciado",
      "dark": "[data-theme='dark'] consume color.theme.dark; ajustar sombras a shadow.soft",
      "high-contrast": "[data-theme='hc'] usa color.theme.high-contrast; no depender sólo de color"
    }
  },

  "2_atomic_library": {
    "atoms": [
      {
        "name": "Text",
        "role": "typography",
        "variants": ["h1","h2","h3","body","caption"],
        "props": { "variant": "h1|h2|h3|body|caption", "as": "h1|h2|h3|p|span", "align": "left|center|right", "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err", "truncate": "boolean", "ariaLabel": "string?" },
        "states": ["default"],
        "a11y": { "h1_unico": true },
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "role": "interactive-cta",
        "variants": ["primary","secondary","ghost","danger"],
        "sizes": ["sm","md","lg"],
        "props": { "variant": "primary|secondary|ghost|danger", "size": "sm|md|lg", "iconLeft": "ReactNode?", "iconRight": "ReactNode?", "fullWidth": "boolean", "disabled": "boolean", "loading": "boolean", "ariaLabel": "string?" },
        "states": ["default","hover","focus","disabled","loading"],
        "tokens": { "bg": "brand|neutral|transparent|state.err", "radius": "radius.md", "shadow": "shadow.soft" },
        "a11y": { "focusVisible": "2px {color.semantic.border.bold}", "keyboard": "Enter/Space" },
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "role": "form-field",
        "variants": ["text","email","password","search","number","otp"],
        "props": { "type": "text|email|password|search|number|otp", "value": "string", "onChange": "function", "placeholder": "string", "autoComplete": "string", "ariaLabel": "string?", "hasError": "boolean" },
        "states": ["default","focus","error","disabled"],
        "tokens": { "border": "border.subtle|border.bold", "radius": "radius.sm", "shadow": "none" },
        "a11y": { "role": "textbox", "error": "aria-invalid=true si hasError" },
        "testIdPattern": "input-{type}"
      },
      { "name": "Textarea", "role": "form-field-multiline", "props": { "rows": "number", "value": "string", "onChange": "function", "placeholder": "string", "hasError": "boolean" }, "states": ["default","focus","error","disabled"], "tokens": { "border": "border.subtle|border.bold", "radius": "radius.sm" }, "testIdPattern": "textarea-base" },
      { "name": "Checkbox", "role": "binary-choice", "props": { "checked": "boolean", "onChange": "function", "label": "string", "indeterminate": "boolean?" }, "states": ["checked","unchecked","indeterminate","disabled"], "a11y": { "role": "checkbox", "keyboard": "Space" }, "testIdPattern": "chk-{label}" },
      { "name": "Radio", "role": "exclusive-choice", "props": { "checked": "boolean", "onChange": "function", "label": "string", "name": "string", "value": "string" }, "states": ["checked","unchecked","disabled"], "a11y": { "role": "radio" }, "testIdPattern": "radio-{name}-{value}" },
      { "name": "Select", "role": "single-select", "props": { "options": "Array<{label,value}>", "value": "string", "onChange": "function", "placeholder": "string" }, "states": ["default","open","disabled"], "a11y": { "role": "combobox" }, "testIdPattern": "select-{name}" },
      { "name": "Chip", "role": "filter-token|status", "variants": ["default","filter","status"], "props": { "label": "string", "selected": "boolean", "onClick": "function?" }, "states": ["selected","unselected","disabled"], "testIdPattern": "chip-{label}" },
      { "name": "Badge", "role": "status-indicator", "variants": ["neutral","ok","warn","err"], "props": { "label": "string", "variant": "neutral|ok|warn|err" }, "states": ["default"], "testIdPattern": "badge-{variant}" },
      { "name": "Avatar", "role": "user-identity", "props": { "src": "string?", "alt": "string", "size": "32|40|64" }, "states": ["default","fallback"], "testIdPattern": "avatar-{size}" },
      { "name": "Icon24", "role": "decorative|informative", "props": { "name": "string", "ariaLabel": "string?" }, "states": ["decorative","informative"], "testIdPattern": "icon-{name}" },
      { "name": "Tooltip", "role": "description", "props": { "content": "string", "side": "top|right|bottom|left" }, "states": ["closed","open"], "testIdPattern": "tooltip-{id}" },
      { "name": "Divider", "role": "layout-separator", "props": { "orientation": "horizontal|vertical" }, "states": ["default"], "testIdPattern": "divider-{orientation}" },
      { "name": "Spinner", "role": "progress-indicator", "props": { "size": "sm|md|lg", "ariaLabel": "string" }, "states": ["spinning"], "testIdPattern": "spinner-{size}" }
    ],
    "molecules": [
      { "name": "Field", "role": "form-field-wrapper", "parts": ["label","control","helper","error"], "props": { "id": "string", "label": "string", "required": "boolean", "helperText": "string?", "errorText": "string?" }, "states": ["default","error","disabled"], "testIdPattern": "field-{id}" },
      { "name": "SearchBar", "role": "search-entry", "parts": ["icon","input","clear"], "props": { "placeholder": "string", "value": "string", "onChange": "function" }, "states": ["default","with-query"], "testIdPattern": "search-bar" },
      { "name": "FilterChips", "role": "filter-group", "props": { "options": "Array<{id,label}>", "selectedIds": "string[]", "onToggle": "function" }, "states": ["empty","with-selection"], "testIdPattern": "filter-chips" },
      { "name": "StatCard", "role": "metric-display", "props": { "label": "string", "value": "string|number", "trend": "up|down|neutral?", "helper": "string?" }, "states": ["default"], "testIdPattern": "stat-card-{label}" },
      { "name": "OAuthButtons", "role": "social-login", "props": { "providers": "Array<'google'|'github'|'apple'>" }, "states": ["default"], "testIdPattern": "oauth-buttons" },
      { "name": "OTPGroup", "role": "mfa-otp-input", "props": { "length": "number", "value": "string", "onChange": "function" }, "states": ["empty","partial","full"], "testIdPattern": "otp-group" },
      { "name": "UserMenu", "role": "user-shortcut-menu", "props": { "userName": "string", "avatarUrl": "string?" }, "states": ["closed","open"], "testIdPattern": "user-menu" },
      { "name": "Toast", "role": "ephemeral-feedback", "props": { "type": "success|error|info", "message": "string", "durationMs": "number" }, "states": ["visible","hidden"], "testIdPattern": "toast-{type}" }
    ],
    "organisms": [
      { "name": "NavBar", "role": "primary-navigation", "slots": ["logo","primary-links","secondary-actions","user-menu"], "states": ["default","scrolled"], "testIdPattern": "navbar-main" },
      { "name": "SideNav", "role": "secondary-navigation", "slots": ["section-links","footer-links"], "states": ["expanded","collapsed"], "testIdPattern": "sidenav-main" },
      { "name": "HeroShell", "role": "page-hero", "slots": ["eyebrow","title","subtitle","ctas","meta","illustration"], "states": ["default","compact"], "testIdPattern": "hero-shell" },
      { "name": "HeroPanel", "role": "context-panel", "slots": ["availability","chips","meta"], "states": ["default"], "testIdPattern": "hero-panel" },
      { "name": "ListView", "role": "collection-display", "slots": ["filters","results","pagination"], "states": ["loading","error","empty","success"], "testIdPattern": "list-view" },
      { "name": "DetailPanel", "role": "entity-detail", "slots": ["header","body","related"], "states": ["loading","error","success"], "testIdPattern": "detail-panel" },
      { "name": "FormPanel", "role": "entity-form", "slots": ["title","sections","global-errors","actions"], "states": ["editing","submitting","error","success"], "testIdPattern": "form-panel" },
      { "name": "AuthForm", "role": "auth-form", "slots": ["title","fields","actions","secondary-links","legal"], "states": ["idle","submitting","error"], "testIdPattern": "auth-form" },
      { "name": "MFAView", "role": "mfa-step", "slots": ["title","otp","resend","alternate"], "states": ["idle","submitting","error"], "testIdPattern": "mfa-view" },
      { "name": "ProfilePanel", "role": "account-settings", "slots": ["tabs","tab-content","danger-zone"], "states": ["view","editing","saving"], "testIdPattern": "profile-panel" },
      { "name": "SessionGuard", "role": "route-guard", "states": ["checking","allowed","blocked"], "testIdPattern": "session-guard" }
    ],
    "templates": [
      { "name": "AppShell", "role": "app-layout", "regions": ["header","sidebar","main","footer","toasts"], "testIdPattern": "layout-app-shell" },
      { "name": "AuthLayout", "role": "auth-layout", "regions": ["branding","auth-card"], "testIdPattern": "layout-auth" },
      { "name": "DashboardLayout", "role": "dashboard-layout", "regions": ["header","sidebar","main"], "testIdPattern": "layout-dashboard" },
      { "name": "DetailLayout", "role": "detail-layout", "regions": ["header","main","related"], "testIdPattern": "layout-detail" },
      { "name": "FormLayout", "role": "form-layout", "regions": ["header","main","footer"], "testIdPattern": "layout-form" },
      { "name": "ErrorLayout", "role": "error-layout", "regions": ["icon","message","actions"], "testIdPattern": "layout-error" }
    ]
  },

  "3_screens": {
    "core": {
      "Home": {
        "id": "P1",
        "nombre": "Home",
        "rol": "inicio",
        "objetivoUX": ["comunicar_valor","dirigir_a_acción_principal","mostrar_contexto_clave"],
        "layout_desktop": { "grid_12": true, "regiones": ["header","main","sidebar","footer"] },
        "layout_mobile": { "orden_stack": ["HeroShell","HeroPanel","Highlights"], "colapsos": ["sidebar→stack"] },
        "secciones": [
          { "nombre":"HeroShell", "propósito":"pitch_≤5s", "componentes":["Text.h1","Text.body","Button.primary","Button.secondary","Chip","MetaBar"] },
          { "nombre":"Highlights", "propósito":"acceso_rápido", "componentes":["BentoGrid","StatCard"] },
          { "nombre":"Proof/Evidencia", "propósito":"credibilidad", "componentes":["LogoStrip","TestimonialCard"] }
        ],
        "ctas_principales": [{ "label": "Ver proyectos", "accion": "→/proyectos" }],
        "ctas_secundarias": [{ "label": "Agendar conversación", "accion": "→/contacto" }],
        "datos_minimos": ["User.name","User.prefs.lang","proyectos_destacados[]","disponibilidad_actual"],
        "datos_opcionales": ["stats_resumidas","testimonios[]","logos_confianza[]"],
        "estados": {
          "loading": "skeleton hero + cards",
          "error": "alerta + botón reintentar",
          "empty": "mensaje vacío + CTA crear/añadir",
          "offline": "banner offline + datos cacheados",
          "success": "UI completa"
        },
        "a11y": { "landmarks": ["header","main","footer"], "tab_order": "skip→navbar→hero-cta1→hero-cta2→highlights→proof→footer", "focus_visible": "≥2px", "aria_roles": [] },
        "microcopy": {
          "titular": "Diseño y código que llegan a producción",
          "sub": "Portafolio técnico centrado en negocio",
          "botones": ["Ver proyectos","Agendar conversación"],
          "errores": [],
          "vacios": ["Aún no hay elementos destacados. Agrega tus primeros contenidos."],
          "confirmaciones": ["Listo, se guardó tu información."]
        }
      },
      "List": {
        "id": "P2",
        "nombre": "List",
        "rol": "explorar/buscar",
        "objetivoUX": ["encontrar","filtrar","navegar_detalle"],
        "layout_desktop": { "grid_12": true, "regiones": ["header","filters","results","footer"] },
        "layout_mobile": { "orden_stack": ["filters","results"], "colapsos": [] },
        "secciones": [
          { "nombre":"Filters", "propósito":"reducir_búsqueda", "componentes":["SearchBar","FilterChips","Select"] },
          { "nombre":"Results", "propósito":"explorar", "componentes":["ListView","CardProyecto","Pagination|InfiniteScroll"] }
        ],
        "ctas_principales": [{ "label": "Crear nuevo", "accion": "→/proyectos/nuevo" }],
        "ctas_secundarias": [],
        "datos_minimos": ["EntityX[]"],
        "datos_opcionales": ["filtros_disponibles[]","paginacion"],
        "estados": {
          "loading": "skeleton list",
          "error": "mensaje + reintento",
          "empty": "estado vacío con CTA crear",
          "offline": "banner offline + cache",
          "success": "lista visible"
        },
        "a11y": { "landmarks": ["main","region(results)"], "tab_order": "filtros→lista→paginación", "focus_visible": "≥2px", "aria_roles": ["list","listitem"] },
        "microcopy": { "titular": "Explorar", "vacios": ["Aún no hay elementos. Crea el primero."], "errores": ["No pudimos cargar la lista. Intenta de nuevo."] }
      },
      "Detail": {
        "id": "P3",
        "nombre": "Detail",
        "rol": "comprender_tomar_decisión",
        "objetivoUX": ["entender","actuar"],
        "layout_desktop": { "grid_12": true, "regiones": ["header","main","related"] },
        "layout_mobile": { "orden_stack": ["header","main","related"], "colapsos": [] },
        "secciones": [
          { "nombre":"Header", "propósito":"contexto+acciones", "componentes":["Breadcrumbs","Text.h1","Badge","PrimaryActions"] },
          { "nombre":"Body", "propósito":"contenido_principal", "componentes":["KeyFacts","Tabs|Accordion","CodeSnippetPreview","Metrics"] },
          { "nombre":"Related", "propósito":"continuidad", "componentes":["RelatedList|Recommendations"] }
        ],
        "ctas_principales": [{ "label":"Contactar", "accion":"→/contacto" }],
        "ctas_secundarias": [],
        "datos_minimos": ["EntityX","User"],
        "datos_opcionales": ["relacionados[]","links_codigo[]","metricas"],
        "estados": {
          "loading": "skeleton detail",
          "error": "ErrorLayout",
          "empty": "404-like si id inválido",
          "offline": "banner offline + datos previos",
          "success": "detalle completo"
        },
        "a11y": { "landmarks": ["main"], "tab_order": "header→acciones→tabs→relacionados", "focus_visible": "≥2px", "aria_roles": ["article"] },
        "microcopy": { "titular": "Detalle del proyecto", "botones": ["Contactar","Ver código"] }
      },
      "Form": {
        "id": "P4",
        "nombre": "Form",
        "rol": "crear/editar",
        "objetivoUX": ["completar_tarea_sin_error"],
        "layout_desktop": { "grid_12": true, "regiones": ["header","main","footer"] },
        "layout_mobile": { "orden_stack": ["main","footer"], "colapsos": [] },
        "secciones": [
          { "nombre":"FormBody", "propósito":"entrada_datos", "componentes":["FieldGroup","Helper/ErrorTexts"] },
          { "nombre":"Actions", "propósito":"confirmar", "componentes":["Button.primary","Button.secondary"] }
        ],
        "ctas_principales": [{ "label":"Guardar cambios", "accion":"submit" }],
        "ctas_secundarias": [{ "label":"Cancelar", "accion":"back" }],
        "datos_minimos": ["EntityX_schema"],
        "datos_opcionales": ["plantillas","tags_sugeridos[]"],
        "estados": {
          "loading": "cargando datos en edición",
          "error": "errores globales aria-live=assertive",
          "empty": "modo creación",
          "offline": "deshabilitar submit + aviso",
          "success": "toast éxito + redirección"
        },
        "a11y": { "landmarks": ["main","footer"], "tab_order": "label→campo→ayuda→error→acciones", "focus_visible": "≥2px", "aria_roles": [], "aria_live": "assertive en errores" },
        "microcopy": { "titular": "Nuevo proyecto", "botones": ["Guardar cambios","Cancelar"], "errores": ["Revisa este campo: falta información."] }
      },
      "Settings": {
        "id": "P5",
        "nombre": "Settings",
        "rol": "preferencias_app",
        "objetivoUX": ["control_personal"],
        "layout_desktop": { "grid_12": true, "regiones": ["header","main","footer"] },
        "layout_mobile": { "orden_stack": ["main"], "colapsos": [] },
        "secciones": [
          { "nombre":"Preferencias generales", "propósito":"idioma+tema+density", "componentes":["Select(lang)","ThemeSwitch","DensityToggle"] },
          { "nombre":"Notificaciones", "propósito":"alertas", "componentes":["Toggle(notifications)"] }
        ],
        "ctas_principales": [{ "label":"Guardar cambios", "accion":"persistir" }],
        "ctas_secundarias": [],
        "datos_minimos": ["User.prefs"],
        "datos_opcionales": [],
        "estados": {
          "loading": "skeleton de campos",
          "error": "alerta + retry",
          "empty": "cargar defaults",
          "offline": "deshabilitar cambios",
          "success": "toast 'Guardado'"
        },
        "a11y": { "landmarks": ["main"], "tab_order": "preferencias→acciones", "focus_visible": "≥2px", "aria_roles": [] },
        "microcopy": { "titular": "Preferencias", "confirmaciones": ["Guardado."] }
      },
      "Help": {
        "id": "P6",
        "nombre": "Help",
        "rol": "asistencia",
        "objetivoUX": ["resolver_dudas","desatascar_usuario"],
        "layout_desktop": { "grid_12": true, "regiones": ["header","main","footer"] },
        "layout_mobile": { "orden_stack": ["FAQ","Contact"], "colapsos": [] },
        "secciones": [
          { "nombre":"FAQ", "propósito":"respuestas_rápidas", "componentes":["Accordion"] },
          { "nombre":"Contact", "propósito":"contacto_soporte", "componentes":["FormPanel"] }
        ],
        "ctas_principales": [{ "label":"Enviar mensaje", "accion":"submit" }],
        "ctas_secundarias": [],
        "datos_minimos": [],
        "datos_opcionales": ["faq_items[]","contacto_form"],
        "estados": {
          "loading": "skeleton faq",
          "error": "alerta",
          "empty": "sin preguntas aún",
          "offline": "mensaje offline",
          "success": "faq lista"
        },
        "a11y": { "landmarks": ["main"], "focus_visible": "≥2px", "aria_roles": [] }
      },
      "Offline": {
        "id": "P7",
        "nombre": "Offline",
        "rol": "recuperación",
        "objetivoUX": ["informar","permitir_reintento"],
        "layout_desktop": { "grid_12": true, "regiones": ["main"] },
        "layout_mobile": { "orden_stack": ["main"], "colapsos": [] },
        "secciones": [
          { "nombre":"Banner", "propósito":"estado", "componentes":["Text.h2","Text.body"] },
          { "nombre":"Actions", "propósito":"reintentar", "componentes":["Button.primary"] }
        ],
        "ctas_principales": [{ "label":"Reintentar", "accion":"retry" }],
        "ctas_secundarias": [],
        "datos_minimos": [],
        "datos_opcionales": [],
        "estados": {
          "loading": "—",
          "error": "—",
          "empty": "—",
          "offline": "pantalla visible",
          "success": "volver a pantalla previa"
        },
        "a11y": { "landmarks": ["main"], "focus_visible": "≥2px" },
        "microcopy": { "vacios": ["Sin conexión. Reintenta cuando vuelvas a estar online."] }
      },
      "Error": {
        "id": "P8",
        "nombre": "Error(404/500)",
        "rol": "error",
        "objetivoUX": ["explicar","recuperar"],
        "layout_desktop": { "grid_12": true, "regiones": ["main"] },
        "layout_mobile": { "orden_stack": ["main"], "colapsos": [] },
        "secciones": [
          { "nombre":"Message", "propósito":"contexto", "componentes":["Text.h2","Text.body"] },
          { "nombre":"CTA", "propósito":"ruta_segura", "componentes":["Button.primary","Button.secondary"] }
        ],
        "ctas_principales": [{ "label":"Ir al inicio", "accion":"→/" }],
        "ctas_secundarias": [{ "label":"Volver", "accion":"back" }],
        "datos_minimos": [],
        "datos_opcionales": [],
        "estados": {
          "loading": "—",
          "error": "pantalla visible",
          "empty": "—",
          "offline": "mensaje contextual",
          "success": "—"
        },
        "a11y": { "landmarks": ["main"], "focus_visible": "≥2px" },
        "microcopy": { "errores": ["No encontramos esto.","Algo salió mal."], "botones": ["Ir al inicio","Volver"] }
      }
    },
    "auth": {
      "Splash": {
        "id": "A0",
        "nombre": "Splash",
        "rol": "detección_sesión",
        "objetivoUX": ["cargar_branding","chequear_sesión","redirigir"],
        "layout_desktop": { "grid_12": true, "regiones": ["main"] },
        "layout_mobile": { "orden_stack": ["main"], "colapsos": [] },
        "secciones": [{ "nombre":"Branding","propósito":"identidad" }, { "nombre":"Progress","propósito":"estado_carga" }],
        "ctas_principales": [],
        "ctas_secundarias": [],
        "datos_minimos": ["Session?"],
        "datos_opcionales": [],
        "estados": {
          "loading": "checking session",
          "error": "ErrorLayout",
          "empty": "—",
          "offline": "mostrar offline y permitir reintento",
          "success": "redirigir a Home o Login"
        },
        "a11y": { "landmarks": ["main"], "aria_roles": [], "focus_visible": "≥2px" }
      },
      "Login": {
        "id": "A1",
        "nombre": "Login",
        "rol": "acceso",
        "objetivoUX": ["entrar_sin_fricción","mantener_seguridad"],
        "secciones": [
          { "nombre":"AuthForm(Login)", "propósito":"credenciales", "componentes":["Field(email)","Field(password)","Checkbox(Recordarme)","Button(Entrar)","Link(Recover)","OAuthButtons(opc)"] },
          { "nombre":"Legal", "propósito":"consentimiento", "componentes":["Text(terminos/privacidad)"] }
        ],
        "ctas_principales": [{ "label":"Entrar", "accion":"validar_credenciales" }],
        "ctas_secundarias": [{ "label":"Crear cuenta", "accion":"→/registro" }],
        "datos_minimos": ["credential.email","credential.password"],
        "datos_opcionales": [],
        "estados": {
          "loading": "enviando credenciales",
          "error": "mensaje neutro 'Credenciales inválidas.'",
          "empty": "form listo",
          "offline": "deshabilitar submit",
          "success": "redirigir a Home/Profile"
        },
        "a11y": { "landmarks": ["main"], "aria_live": "assertive para errores", "focus_visible": "≥2px" },
        "microcopy": { "errores": ["Credenciales inválidas."] }
      },
      "Register": {
        "id": "A2",
        "nombre": "Register",
        "rol": "alta_nueva",
        "objetivoUX": ["crear_cuenta","preparar_perfil"],
        "secciones": [
          { "nombre":"AuthForm(Register)", "propósito":"alta", "componentes":["Field(name)","Field(email)","Field(password+meter)","Field(confirm)","Checkbox(Términos)","Button(Crear cuenta)"] },
          { "nombre":"Hints", "propósito":"reglas_password", "componentes":["Text(checklist)"] }
        ],
        "ctas_principales": [{ "label":"Crear cuenta","accion":"validar+enviar" }],
        "ctas_secundarias": [{ "label":"Ya tengo cuenta","accion":"→/login" }],
        "datos_minimos": ["user.name","credential.email","credential.password"],
        "datos_opcionales": [],
        "estados": {
          "loading": "enviando formulario",
          "error": "mensaje claro sin filtrar razones sensibles",
          "empty": "form visible",
          "offline": "deshabilitar submit",
          "success": "correo de verificación enviado"
        },
        "a11y": { "landmarks": ["main"], "aria_live": "assertive en errores", "focus_visible": "≥2px" }
      },
      "Recover": {
        "id": "A3",
        "nombre": "Recover",
        "rol": "recuperar_acceso",
        "objetivoUX": ["recuperar_sin_filtrar_usuarios"],
        "secciones": [
          { "nombre":"Request", "propósito":"solicitar_reset", "componentes":["Field(email)","Button(Enviar enlace)"] },
          { "nombre":"Reset", "propósito":"nueva_contraseña", "componentes":["Field(new_password+meter)","Field(confirm)","Button(Confirmar)"] }
        ],
        "ctas_principales": [{ "label":"Enviar enlace","accion":"submit" }],
        "ctas_secundarias": [],
        "datos_minimos": ["credential.email|resetToken"],
        "datos_opcionales": [],
        "estados": {
          "loading": "solicitando/enviando",
          "error": "mensaje genérico",
          "empty": "form visible",
          "offline": "deshabilitar acciones",
          "success": "mensaje neutro sin revelar existencia de cuenta"
        },
        "a11y": { "landmarks": ["main"], "aria_live": "polite", "focus_visible": "≥2px" },
        "microcopy": { "confirmaciones": ["Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."] }
      },
      "MFA": {
        "id": "A4",
        "nombre": "MFA",
        "rol": "segundo_factor",
        "objetivoUX": ["verificar_identidad"],
        "secciones": [
          { "nombre":"OTP", "propósito":"ingreso_código", "componentes":["OTPGroup(6)","Button(Verificar)","Link(Reenviar)"] },
          { "nombre":"Alternativas", "propósito":"otros_factores", "componentes":["Button(WebAuthn) opc"] }
        ],
        "ctas_principales": [{ "label":"Verificar","accion":"validar_otp" }],
        "ctas_secundarias": [],
        "datos_minimos": ["credential.otp"],
        "datos_opcionales": [],
        "estados": {
          "loading": "verificando OTP",
          "error": "Código inválido",
          "empty": "espera de código",
          "offline": "no permitir verificación",
          "success": "acceso concedido"
        },
        "a11y": { "landmarks": ["main"], "aria_live": "assertive en error", "focus_visible": "≥2px" }
      },
      "Profile": {
        "id": "A5",
        "nombre": "Profile",
        "rol": "gestión_personal",
        "objetivoUX": ["editar_datos","preferencias","seguridad"],
        "secciones": [
          { "nombre":"Info", "propósito":"datos_básicos", "componentes":["Avatar","Field(name)","Field(location)","Field(email:readonly|verify_state)"] },
          { "nombre":"Preferencias", "propósito":"experiencia", "componentes":["Select(language)","ThemeSwitch","Toggle(reduceMotion)","Toggle(notifications)"] },
          { "nombre":"Seguridad", "propósito":"proteger_cuenta", "componentes":["ChangePassword","MFA_Toggle","SessionsList(terminate)","DangerZone(delete_account)"] }
        ],
        "ctas_principales": [{ "label":"Guardar cambios","accion":"persistir" }],
        "ctas_secundarias": [{ "label":"Cerrar sesión","accion":"→/logout" }],
        "datos_minimos": ["User","Session"],
        "datos_opcionales": [],
        "estados": {
          "loading": "skeleton",
          "error": "alerta",
          "empty": "—",
          "offline": "deshabilitar cambios",
          "success": "toast Guardado"
        },
        "a11y": { "landmarks": ["main"], "focus_visible": "≥2px" }
      },
      "LogOff": {
        "id": "A6",
        "nombre": "LogOff",
        "rol": "salida_segura",
        "objetivoUX": ["terminar_sesión","redirigir"],
        "secciones": [{ "nombre":"Confirm", "propósito":"opcional", "componentes":["Button(Cerrar sesión)","Button(Cancelar)"] }],
        "ctas_principales": [{ "label":"Cerrar sesión","accion":"revocar_tokens→redirigir→/login" }],
        "ctas_secundarias": [{ "label":"Cancelar","accion":"back" }],
        "datos_minimos": ["Session.id"],
        "datos_opcionales": [],
        "estados": {
          "loading": "revocando",
          "error": "mensaje genérico",
          "empty": "—",
          "offline": "no revocar; indicar estado",
          "success": "redirigir"
        },
        "a11y": { "landmarks": ["main"], "focus_visible": "≥2px" }
      },
      "SessionExpired": {
        "id": "A7",
        "nombre": "SessionExpired",
        "rol": "reautenticación",
        "objetivoUX": ["explicar_caducidad","relogin_rápido"],
        "secciones": [
          { "nombre":"Message", "propósito":"contexto", "componentes":["Text.h2","Text.body"] },
          { "nombre":"CTA", "propósito":"volver_a_login", "componentes":["Button.primary"] }
        ],
        "ctas_principales": [{ "label":"Iniciar sesión de nuevo","accion":"→/login" }],
        "ctas_secundarias": [],
        "datos_minimos": [],
        "datos_opcionales": [],
        "estados": {
          "loading": "—",
          "error": "—",
          "empty": "pantalla visible",
          "offline": "mensaje contextual",
          "success": "redirigir a Login"
        },
        "a11y": { "landmarks": ["main"], "focus_visible": "≥2px" }
      }
    }
  },

  "4_flows": [
    {
      "id": "F1",
      "nombre": "Onboarding/Auth",
      "pasos": [
        { "pantalla": "Splash", "tarea": "chequear_sesión", "salida": "valida?→Home:Login" },
        { "pantalla": "Login|Register", "tarea": "auth", "salida": "→Home" },
        { "pantalla": "Home", "tarea": "presentación_valor" }
      ],
      "éxito": { "definición": "sesión_valida_o_login_exitoso", "feedback": "Bienvenida sutil" }
    },
    {
      "id": "F2",
      "nombre": "Home→List→Detail",
      "pasos": [
        { "pantalla": "Home", "tarea": "entender_pitch+click_CTA_Principal", "salida": "→List" },
        { "pantalla": "List", "tarea": "buscar/filtrar", "salida": "seleccionar_item" },
        { "pantalla": "Detail", "tarea": "evaluar", "salida": "acción_principal|volver" }
      ],
      "éxito": { "definición": "usuario_encuentra_y_entiende_elemento_clave", "feedback": "CTA visible" }
    },
    {
      "id": "F3",
      "nombre": "CRUD_Principal",
      "pasos": [
        { "pantalla": "List|Detail", "tarea": "click_crear/editar", "salida": "→Form" },
        { "pantalla": "Form", "tarea": "llenar_campos", "error": { "mensaje": "Faltan datos", "recuperación": "resaltar_campos" } },
        { "pantalla": "Form", "tarea": "enviar", "estado": "loading", "salida": "→Detail" },
        { "pantalla": "Detail", "tarea": "ver_resultado", "salida": "confirmación" }
      ],
      "éxito": { "definición": "entidad_guardada_sin_errores_criticos", "feedback": "toast Guardado" }
    },
    { "id": "F4", "nombre": "Conversión(opc)", "pasos": [], "éxito": { "definición": "transacción_exitosa" } },
    {
      "id": "F5",
      "nombre": "Offline_Recovery",
      "pasos": [
        { "pantalla": "Offline", "tarea": "informar_estado", "salida": "reintentar" },
        { "pantalla": "pantalla_previa", "tarea": "recuperar_estado", "salida": "normal" }
      ],
      "éxito": { "definición": "sesión/flujo_recuperado" }
    },
    {
      "id": "F6",
      "nombre": "Login",
      "pasos": [
        { "pantalla": "Login", "tarea": "ingresar_email_password", "estado": "loading", "error": { "mensaje": "Credenciales inválidas", "recuperación": "reintentar" } },
        { "pantalla": "MFA(opc)", "tarea": "verificar_otp", "ramificaciones": "si_mfa_enabled" },
        { "pantalla": "Home|Profile", "tarea": "bienvenida" }
      ],
      "éxito": { "definición": "auth_ok" }
    },
    { "id": "F7", "nombre": "Register", "pasos": [{ "pantalla": "Register", "tarea": "capturar_datos+aceptar_terminos" }, { "pantalla": "Register", "tarea": "enviar_form", "salida": "verificación_email_enviada" }, { "pantalla": "Login", "tarea": "ingresar_post_verificación" }], "éxito": { "definición": "cuenta_creada+verificada" } },
    { "id": "F8", "nombre": "Recover", "pasos": [{ "pantalla": "Recover", "tarea": "solicitar_enlace", "salida": "mensaje_neutro" }, { "pantalla": "Recover", "tarea": "establecer_nueva_password", "salida": "confirmación" }], "éxito": { "definición": "password_actualizada" } },
    { "id": "F9", "nombre": "MFA", "pasos": [{ "pantalla": "MFA", "tarea": "ingresar_otp", "error": { "mensaje": "Código inválido", "recuperación": "reenviar" } }, { "pantalla": "Home|Profile", "tarea": "acceso" }], "éxito": { "definición": "segundo_factor_ok" } },
    { "id": "F10", "nombre": "LogOff", "pasos": [{ "pantalla": "Profile|UserMenu", "tarea": "click_logoff", "salida": "revocar_tokens" }, { "pantalla": "Splash|Login", "tarea": "redirigir" }], "éxito": { "definición": "tokens_revocados+redirección" } },
    { "id": "F11", "nombre": "SessionTimeout", "pasos": [{ "pantalla": "SessionExpired", "tarea": "informar", "salida": "→Login" }, { "pantalla": "Login", "tarea": "reautenticar" }], "éxito": { "definición": "sesión_renovada" } }
  ],

  "5_datos": {
    "ENTIDADES": {
      "User": {
        "id": "string|uuid",
        "name": "string",
        "email": "string",
        "avatarUrl?": "string",
        "location?": "string",
        "role?": "string",
        "createdAt": "iso",
        "prefs": { "lang": "es-MX", "theme": "light|dark|hc", "reduceMotion": "bool", "notifications": "bool" },
        "security": { "mfaEnabled": "bool", "providers": ["password|oauth"], "lastLogin": "iso", "sessions": "int" }
      },
      "Session": { "id": "string", "userId": "string", "token": "opaque", "refresh": "opaque", "exp": "iso", "device": "agent", "ipHash": "string" },
      "EntityX": { "id": "string|uuid", "title": "string", "description": "string?", "status": "active|draft|archived", "createdAt": "iso", "updatedAt": "iso", "owner": { "id": "string", "name": "string" }, "tags": ["string"] },
      "Preference": { "lang": "es-MX", "theme": "light|dark|hc", "reduceMotion": "bool", "density": "compact|cozy|comfortable" },
      "Security": { "attempts": "int", "lockUntil?": "iso", "lastChange": "iso" }
    },
    "contratos_por_pantalla": {
      "Home": { "datos_minimos": ["User","proyectos_destacados[]"], "opc": ["logos_confianza[]"], "estados": ["loading","error","empty","offline","success"] },
      "List": { "datos_minimos": ["EntityX[]"], "opc": ["filtros_disponibles[]","paginacion"], "estados": ["loading","error","empty","offline","success"] },
      "Detail": { "datos_minimos": ["EntityX","User"], "opc": ["relacionados[]","metricas"], "estados": ["loading","error","empty","offline","success"] },
      "Form": { "datos_minimos": ["EntityX.schema"], "opc": ["tags_sugeridos[]"], "estados": ["loading","error","empty","offline","success"] },
      "Settings": { "datos_minimos": ["User.prefs"], "opc": [], "estados": ["loading","error","empty","offline","success"] },
      "Help": { "datos_minimos": [], "opc": ["faq_items[]","contacto_form"], "estados": ["loading","error","empty","offline","success"] },
      "Offline": { "datos_minimos": [], "opc": [], "estados": ["offline"] },
      "Error": { "datos_minimos": [], "opc": [], "estados": ["error"] },
      "Auth": { "Login/Register/Recover/MFA/Profile/LogOff/SessionExpired": "cada una con estados_universales" }
    }
  },

  "6_a11y_seo_pwa": {
    "A11Y_MIN": {
      "contraste": { "AA_texto_normal": "≥4.5:1", "AA_texto_grande": "≥3:1" },
      "focus_visible": "≥2px usando {color.semantic.border.bold}",
      "orden_tab": "lógico(header→nav→main→aside→footer)",
      "landmarks": ["header","nav","main","region","footer"],
      "aria_live": { "toasts": "polite", "errores_globales": "assertive" },
      "no_solo_color": true,
      "prefers_reduced_motion": "animaciones degradan a estados estáticos",
      "teclado": { "enter_space": "activan botones", "escape": "cierra modales", "tab": "orden lógico" },
      "skip_links": ["Ir al contenido principal"],
      "formularios": "aria-describedby vincula error al campo"
    },
    "SEO_MIN": {
      "title_meta_por_ruta": ["Home","List","Detail","Form","Auth","Profile"],
      "OG_min": ["og:title","og:description","og:image","og:url"],
      "headings": "H1 único, H2/H3 jerárquicos",
      "urls_semánticas": ["/","/items","/items/:id","/settings","/login","/register"],
      "canonical": "por pantalla pública",
      "structured_data": "schema.org Person/Project si aplica",
      "sitemap": "rutas públicas",
      "robots": "permitir públicas, bloquear privadas"
    },
    "PWA_MIN": {
      "manifest": {
        "name": "PortalPortfolioPro",
        "short_name": "Portfolio",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": ["192x192","512x512"]
      },
      "service_worker": {
        "strategy": "app_shell",
        "precache_routes": ["/","/login","/dashboard","/assets/*"],
        "data_strategy": "network-first con fallback cache (no sensibles)",
        "offline_fallback": "/offline"
      },
      "instalabilidad": ["HTTPS","manifest válido","SW activo"],
      "imagenes": "srcset+sizes+lazy"
    }
  },

  "7_security_privacy": {
    "errores_neutros_auth": "Credenciales inválidas.",
    "no_enumerar_usuarios_en_recover": "mensaje_neutro_si_existe_o_no",
    "rate_limit_visual": "mensaje sutil y enfriamiento gradual",
    "lockout_feedback": "tiempo de espera sin exponer umbrales",
    "password_meter": "longitud≥12 + variedad de clases; sin nombre/correo; feedback accesible",
    "mostrar_ocultar_password": "toggle con aria-pressed",
    "mfa_sugerido": "habilitar desde Profile/Seguridad",
    "sesiones_activas": "lista de dispositivos con opción 'Cerrar en este dispositivo'",
    "consentimiento_telemetría": "opt-in claro; IDs opacos; minimizar PII"
  },

  "8_mocks_and_swap": {
    "hooks": ["useUser","useSession","useListX","useDetailX","useCreateX","useLogin","useRegister","useRecover","useMFA","useProfile"],
    "fixtures": {
      "lat_ms": 120,
      "error_rate": 0.03,
      "demo_user": {
        "id": "u-demo",
        "name": "TuNombre",
        "email": "tu@email",
        "prefs": { "lang": "es-MX", "theme": "light", "reduceMotion": false, "notifications": true }
      }
    },
    "factories": {
      "entityX": { "id": "uuid()", "title": "Proyecto Demo", "description": "Descripción breve", "status": "active", "owner": { "id": "u-demo", "name": "TuNombre" }, "tags": ["react","ui"] }
    },
    "swap_plan": "inyección de dependencias: adapters REST/Firebase/Firestore/Supabase detrás de hooks sin tocar UI"
  },

  "9_i18n_ux_copy": {
    "glosario": ["Home","Lista","Detalle","Guardar cambios","Cancelar","Iniciar sesión","Crear cuenta","Recuperar acceso","Cerrar sesión","Ver detalles","Continuar"],
    "claves": {
      "buttons": { "viewItems": "Ver elementos", "createNew": "Crear nuevo", "save": "Guardar cambios", "cancel": "Cancelar", "signIn": "Iniciar sesión", "signUp": "Crear cuenta", "signOut": "Cerrar sesión", "viewDetails": "Ver detalles", "continue": "Continuar" },
      "errors": { "invalidCreds": "Credenciales inválidas.", "generic": "Algo salió mal. Intenta de nuevo.", "fieldMissing": "Revisa este campo: falta información.", "invalidCode": "Código inválido." },
      "empty": { "noItems": "Aún no hay elementos. Crea el primero.", "noData": "Aún no hay datos para mostrar aquí." },
      "confirmations": { "saved": "Listo, se guardó tu información.", "accessGranted": "Acceso concedido.", "verificationSent": "Te enviamos el correo de verificación.", "passwordUpdated": "Contraseña actualizada.", "sessionEnded": "Sesión finalizada." }
    },
    "locales": ["es-MX","en-US"]
  },

  "10_eval": {
    "datasets": {
      "golden": [
        "auth_happy_path",
        "auth_invalid_password",
        "auth_requires_mfa",
        "recover_neutral_message",
        "offline_home_cache",
        "session_expired_redirect",
        "list_empty_state",
        "list_error_state",
        "detail_404",
        "detail_success",
        "form_create_validation",
        "form_edit_success",
        "profile_save_prefs",
        "mfa_wrong_code",
        "crud_create_end_to_end",
        "telemetry_event_emission"
      ]
    },
    "metrics": ["json_schema_pass","hallucination↓","groundedness","readability","a11y_checklist_pass"],
    "umbrales": { "json_schema_pass": 0.98, "groundedness": 0.9, "a11y_checklist_pass": 0.95 },
    "gates": { "regresión": true }
  },

  "11_telemetria": {
    "eventos": [
      "view:screen","click:cta","form:submit","error:ui","net:offline","net:online",
      "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
      "auth:register:start","auth:register:success","auth:recover:start","auth:recover:success",
      "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
    ],
    "payload_min": { "screen_id": "string", "cta_id": "string?", "entity_id": "string?", "user_id": "string?", "method": "string?", "error_code": "string?", "ts_iso": "iso" },
    "privacidad": "minimizar PII; IDs opacos; respetar consentimiento"
  },

  "12_ssr_ssg_adapt": {
    "auth_guard": "server+client para rutas protegidas (si SSR); en CSR usar SessionGuard",
    "redirecciones": "server-side cuando aplique; en cliente si expira sesión → /session-expired",
    "prefetch_selectivo": "Home,List,Detail tras login",
    "hydration_segura": "no exponer credenciales/tokens en HTML",
    "code_splitting": ["chunk-auth","chunk-home","chunk-dashboard","chunk-settings"],
    "cache": { "publicas": "SSG/ISR", "privadas": "CSR/SSR con SWR/react-query", "headers_api": "cache-control por endpoint" }
  },

  "13_prioridades": {
    "top5_issues": [
      "Estilos fuera de tokens DTCG",
      "Falta de focus visible en componentes clave",
      "CTAs compiten en la misma pantalla",
      "Estados universales incompletos",
      "Microcopy inconsistente / no i18n-ready"
    ],
    "top5_acciones": [
      "Centralizar tokens y mapear a CSS variables/ThemeProvider",
      "Añadir focus visible global y probar con teclado",
      "Definir una CTA primaria por pantalla y ajustar jerarquía",
      "Documentar y aplicar patrón de estados universales",
      "Construir glosario+i18n y activarlo en flows críticos"
    ]
  },

  "14_pipeline_y_validacion": {
    "pipeline": {
      "alpha_context": "filtrar contexto relevante; score=0.5 autoridad+0.3 recencia+0.2 task_fit; resumen denso; dedup",
      "beta_generacion": "modo JSON estructurado; roles planner→researcher→writer→verifier",
      "gamma_validacion": "validar contra SCHEMAS; A11Y AA; SECURITY; SEO; PWA",
      "delta_correccion": "reintento máximo 2 si falla validación",
      "epsilon_paquete": "seguir RENDER_ORDER e incluir Checklist DoD"
    },
    "checklist_DoD": [
      "R1 nombres sin duplicidad ✅",
      "R2 componentes usan tokens (sin hex sueltos) ✅",
      "R3 estados universales en cada pantalla ✅",
      "R4 microcopy consistente e i18n-ready ✅",
      "R5 AA contraste + focus visible ≥2px ✅",
      "R6 errores auth neutros + no enumeración ✅",
      "R7 sin razonamiento interno ✅",
      "R8 sin citas (RAG off) ✅",
      "R9 sin violaciones reportables ✅"
    ]
  },

  "violations": []
}
Tú dijiste:
coone sta base revisa todo lo qu etenemos en este historial , infiere flatante y genera max valor y damelo completo
ChatGPT Plus

Pensó durante 44s
Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ════════════════════════════════════
  # META
  # ════════════════════════════════════
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";
    JSON_SCHEMA:"estricto";
    FALLBACK_MD:"on";

    CONTEXT_ENGINEERING:"on";
    RAG:"opt";
    AGENTIC_ROLES:"planner,researcher,writer,verifier";

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ════════════════════════════════════
  # INPUTS (a rellenar por humano/sistema)
  # ════════════════════════════════════
  INPUTS{

    PRODUCTO{
      nombre:"<string>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Otro>";
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<...>"];   # p.ej. "aumentar conversión", "mostrar portfolio"
      objetivo_usuario:["<...>"];   # p.ej. "encontrar X en ≤N pasos"
      KPI:["<activación|retención|conversión|NPS|...>"];
    };

    USUARIOS{
      perfiles:[
        { rol:"<recruiter|cliente|admin|usuario_final>";
          nivel:"<bajo|medio|alto>";
          motivación:"<por qué entra y qué quiere lograr>";
        }
      ];
    };

    CONTEXTO{
      dispositivos:["mobile","desktop"];
      conectividad:"<intermitente|estable>";
      regiones:["<MX|LATAM|Global|...>"];
      idioma_base:"es-MX";
    };

    STACK_HINT{
      runtime:"<CSR|SSR|SSG>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
    };
  }

  # ════════════════════════════════════
  # CONTRATO DE SALIDA (qué debe producir el LLM)
  # ════════════════════════════════════
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";           # Design Tokens DTCG
      THEMES:["light","dark","high-contrast"];
    }

    II.ATOMIC_LIBRARY{
      atoms:"COMPONENT_SCHEMA[] (nivel=atom)";
      molecules:"COMPONENT_SCHEMA[] (nivel=molecule)";
      organisms:"COMPONENT_SCHEMA[] (nivel=organism)";
      templates:"COMPONENT_SCHEMA[] (nivel=template)";
    }

    III.SCREENS{
      lista:[
        # Core producto
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos[]",
        "datos_opcionales[]",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo + latencias";
      factories:"shapes tipados por entidad";
      hooks_mock:"MOCK_HOOK_SCHEMA[]";
      swap_plan:"API|Firebase|Firestore vía adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base UI";
      claves:"keys i18n";
      tablas_microcopy:"botones, errores, vacíos, confirmaciones";
    }

    X.EVAL{
      golden_set:"EVAL_SCHEMA.datasets";
      métricas:"EVAL_SCHEMA.metrics";
      umbrales:"EVAL_SCHEMA.umbrales";
      gates_regresión:"EVAL_SCHEMA.gates";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; consentimiento explícito";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache, headers_cache-control";
    }

    XIII.PRIORIDADES{
      top5_issues:"lista de problemas críticos detectados";
      top5_acciones:"acciones accionables para resolverlos";
    }
  }

  # ════════════════════════════════════
  # SCHEMAS (estructuras base)
  # ════════════════════════════════════
  SCHEMAS{

    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#050509";
          "brand-500":"#3366FF";
          "accent-500":"#FF7AE0";
          "ok-500":"#22C55E";
          "warn-500":"#FFC857";
          "err-500":"#FF4B4B";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-50}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"{color.primitive.neutral-500}";
          "text.inverse":"{color.primitive.neutral-0}";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-300}";
          "border.subtle":"{color.primitive.neutral-200}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"1.2"; normal:"1.4"; loose:"1.6"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)"; lg:"0 12px 32px rgba(15,23,42,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← TOKENS_DTCG_JSON.semantic";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants?["string"];
      sizes?["string"];
      states?["string"];
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string";
      objetivoUX:["string ≤3"];
      layout_desktop:{grid_12:"descr";regiones:["header?","main","sidebar?","footer?"];};
      layout_mobile:{orden_stack:["string"];colapsos?["string"];};
      secciones:[
        {nombre:"string"; propósito:"string"; componentes:["organisms|molecules"];};
      ];
      ctas_principales?[{label:"string";accion:"string";}];
      ctas_secundarias?[{label:"string";accion:"string";}];
      datos_minimos:["string"];
      datos_opcionales?["string"];
      estados:{loading:"descr";error:"descr";empty:"descr";offline:"descr";success:"descr";};
      a11y:{landmarks:["header","nav","main","aside","footer"];tab_order:"descr";focus_visible:"≥2px";aria_roles?["string"];};
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pasos:[
        {pantalla?:"string";
         tarea:"string";
         entrada?["string"];
         salida?:"string|mapa";
         estado?:"string";
         error?{mensaje:"string";recuperación:"string|lista";};
        }
      ];
      ramificaciones?[{condición:"string";destino:"string";}];
      éxito{definición:"string";feedback?:"string";};
    }

    ENTITY.User{
      id:"string|uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"agent";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"string|uuid";
      title:"string";
      description:"string?";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string";name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore";
    }

    EVAL_SCHEMA{
      datasets:{golden:"≥16 casos incluyendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";};
      metrics:[
        "json_schema_pass",
        "hallucination↓",
        "groundedness(si_RAG)",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:"≥0.98";
        groundedness:"≥0.9";
        a11y_checklist_pass:"≥0.95";
      };
      gates:{regresión:true;};
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen","click:cta","form:submit","error:ui",
        "net:offline","net:online",
        "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
        "auth:register:start","auth:register:success",
        "auth:recover:start","auth:recover:success",
        "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso";
      };
    }

    A11Y_SCHEMA{
      contraste_AA:{texto_normal:">=4.5:1";texto_grande:">=3:1";};
      focus_visible:"≥2px en todos los interactivos (token border.bold)";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{notificaciones:"polite";errores_criticos:"assertive";};
      no_solo_color:true;
      prefers_reduced_motion:"animaciones reducidas o nulas";
      skip_links:["Ir al contenido principal"];
      formularios:"aria-describedby vinculado a errores";
    }

    SEO_SCHEMA{
      title:"<60 chars";
      meta_description:"<160 chars";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; jerarquía H2/H3 coherente";
      urls_semánticas:["/","/login","/registro","/dashboard","/perfil","/proyectos","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"string";
        short_name:"string";
        start_url:"string";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
      rate_limit_visual:"mensaje sutil y enfriamiento gradual";
      lockout_feedback:"tiempo de espera comunicado sin exponer umbrales";
      password_meter:"≥12 chars, variedad de clases, no incluir nombre/email";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde Profile/Seguridad";
      sesiones_activas:"lista dispositivos + 'Cerrar en este dispositivo'";
      consentimiento_telemetría:"opt-in claro";
    }
  }

  # ════════════════════════════════════
  # PIPELINE (α…ε)
  # ════════════════════════════════════
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si solo 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS;
      checar_A11Y:"contrasteAA,focus_visible,landmarks,aria_live,no_solo_color,PRM";
      checar_SECURITY:"errores_neutros,no_enumerar_usuarios,lockout_visual,password_meter";
      checar_SEO_min:"title/meta/OG por ruta";
      checar_PWA:"manifest+SW+offline_fallback";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      };
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"A11Y+SECURITY+PWA+i18n+datos_minimos_por_pantalla";
    }
  }

  # ════════════════════════════════════
  # RENDER_ORDER
  # ════════════════════════════════════
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (COMPONENT_SCHEMA[] por nivel)";
    3:"SCREENS (instancias SCREEN_SCHEMA)";
    4:"FLOWS (F1..F11 instancias FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (A11Y_SCHEMA+SEO_SCHEMA+PWA_SCHEMA)";
    7:"SECURITY_PRIVACY (SECURITY_PRIVACY_SCHEMA)";
    8:"MOCKS (MOCK_HOOK_SCHEMA + fixtures + swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas microcopy)";
    10:"EVAL (EVAL_SCHEMA)";
    11:"TELEMETRÍA (TELEMETRY_SCHEMA)";
    12:"SSR_SSG_ADAPT";
    13:"PRIORIDADES (top5_issues/top5_acciones)";
  }

  # ════════════════════════════════════
  # REGLAS GLOBALES (UI/UX)
  # ════════════════════════════════════
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_RAG_off→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  # ════════════════════════════════════
  # GUARD (comportamiento del modelo)
  # ════════════════════════════════════
  GUARD[
    NO_META;
    NO_DRY;
    NO_REPEAT;
    ANTI_INJ_STRICT;
    CTX_ISOLATE;
    CONSIST;
    FACT_CHECK;
    RECENCY_CHECK;
    DATE_DRIFT_DETECT;
    DISINFO_HYGIENE;
    HALLUCINATION_DETECT;
    PII_STRICT;
    SECRET_STRICT;
    SEMANTIC_DEDUP;
    LEXICAL_DEDUP;
    SINGLE_OUTPUT;
    TOOL_ONLY_REAL;
    NO_ASYNC_WORK;
    NO_TIME_ESTIMATES;
  ]

  # ════════════════════════════════════
  # INFERENCIAS POR DEFECTO (fallbacks)
  # ════════════════════════════════════
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"TuNombre";
      email:"tu@email";
      prefs:{lang:"es-MX";theme:"light";reduceMotion:false;notifications:true;};
    };
    EntityX_default:{title:"Ejemplo de ítem";status:"active";};
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ════════════════════════════════════
  # BLUEPRINT_DEFAULT (ejemplo concreto Portafolio)
  # ════════════════════════════════════
  BLUEPRINT_DEFAULT{

    META_PRODUCTO{
      nombre:"PortalPortfolioPro";
      tipo:"Portafolio";
      público:"B2B";
      objetivo_negocio:[
        "Atraer leads técnicos y de producto",
        "Demostrar calidad de diseño y código en ≤8s",
        "Facilitar agendar conversación o revisar proyectos clave"
      ];
      objetivo_usuario:[
        "Entender quién es la persona",
        "Revisar 2–3 proyectos relevantes",
        "Contactar o agendar llamada"
      ];
      KPI:["ctr_home_to_projects","ctr_home_to_contact","avg_time_on_detail","completion_rate_main_form"];
    }

    ATOMIC_LIBRARY_DEFAULT:"llenar con COMPONENT_SCHEMA[] usando TOKENS_DTCG_JSON";

    SCREENS_DEFAULT:"instanciar todas las pantallas definidas en SCREENS.core y SCREENS.auth usando SCREEN_SCHEMA";

    FLOWS_DEFAULT:"instanciar F1..F11 usando FLOW_SCHEMA con pasos, ramificaciones y éxito definidos";

    A11Y_SEO_PWA_DEFAULT:{
      A11Y_MIN:A11Y_SCHEMA;
      SEO_MIN:SEO_SCHEMA;
      PWA_MIN:PWA_SCHEMA;
    }

    SECURITY_PRIVACY_DEFAULT:SECURITY_PRIVACY_SCHEMA;
    MOCKS_DEFAULT:MOCK_HOOK_SCHEMA;
    I18N_UX_COPY_DEFAULT:"usar glosario+claves para es-MX/en-US tal como definido en I18N_UX_COPY";
    EVAL_DEFAULT:EVAL_SCHEMA;
    TELEMETRÍA_DEFAULT:TELEMETRY_SCHEMA;
    SSR_SSG_ADAPT_DEFAULT:"aplicar auth_guard, redirecciones, prefetch_selectivo, hydration_segura, code_split, cache según SCHEMAS";
    PRIORIDADES_DEFAULT:[
      "estilos_fuera_de_tokens",
      "falta_focus_visible",
      "CTAs_compiten",
      "estados_universales_incompletos",
      "microcopy_no_i18n_ready"
    ];
  }

  # ════════════════════════════════════
  # INSTRUCCIONES AL LLM
  # ════════════════════════════════════
  INSTRUCCIONES_AL_LLM{
    1:"Usar PIPELINE y RENDER_ORDER como guía estricta de ejecución.";
    2:"Respetar SCHEMAS en todas las estructuras; si hay violaciones, reportarlas en nodo 'Violations'.";
    3:"No incluir razonamiento interno ni auto-referencias al modelo.";
    4:"Usar TOKENS para todos los valores visuales; señalar hex sueltos como violación.";
    5:"Asegurar que los flows conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff de manera coherente.";
    6:"Emplear BLUEPRINT_DEFAULT solo como ejemplo; adaptar a INPUTS.PRODUCTO/STACK_HINT cuando estén presentes.";
  }

}
Tú dijiste:
con eso damelo completo toma esa base y generalo neutral y placeholder,  a cualqueir problema construir tdoa panatlla end to end, full
ChatGPT Plus

Pensó durante 28s
Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ════════════════════════════════════
  # META
  # ════════════════════════════════════
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";      # salida principal JSON estructurado
    JSON_SCHEMA:"estricto";            # debe respetar SCHEMAS
    FALLBACK_MD:"on";                  # si falla JSON, usar markdown con bloques JSON válidos

    CONTEXT_ENGINEERING:"on";          # planear contexto (filtrar, rankear, comprimir, dedup)
    RAG:"opt";                         # retrieval opcional
    AGENTIC_ROLES:"planner,researcher,writer,verifier"; # roles lógicos internos

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ════════════════════════════════════
  # INPUTS (a rellenar por humano/sistema)
  # ════════════════════════════════════
  INPUTS{

    PRODUCTO{
      nombre:"<nombre_producto>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Admin|Otro>";
      dominio:"<breve_descripción_dominio>";      # ej: "gestión de tickets", "reservas", "delivery"
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<objetivo_1>","<objetivo_2>"];      # ej: "aumentar conversión", "reducir errores"
      objetivo_usuario:["<objetivo_ux_1>","<objetivo_ux_2>"];# ej: "terminar tarea en ≤N pasos"
      KPI:["<activación|retención|conversión|NPS|CSAT|...>"];
    };

    USUARIOS{
      perfiles:[
        { rol:"<stakeholder_principal>";
          nivel:"<bajo|medio|alto>";
          motivación:"<qué busca resolver>";
          contexto:"<frecuencia_uso|situación>";
        }
      ];
    };

    CONTEXTO{
      dispositivos:["mobile","desktop"];           # se puede ampliar si aplica: "tablet"
      conectividad:"<intermitente|estable>";
      regiones:["<MX|LATAM|Global|...>"];
      idioma_base:"es-MX";
    };

    STACK_HINT{
      runtime:"<CSR|SSR|SSG|Hybrid>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
      routing:"<SPA|MPA|Hybrid>";
    };
  }

  # ════════════════════════════════════
  # CONTRATO DE SALIDA (qué debe producir el LLM)
  # ════════════════════════════════════
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";           # design tokens DTCG (color, typo, space, radius, etc.)
      THEMES:["light","dark","high-contrast"];
    }

    II.ATOMIC_LIBRARY{
      atoms:"COMPONENT_SCHEMA[] (nivel=atom)";
      molecules:"COMPONENT_SCHEMA[] (nivel=molecule)";
      organisms:"COMPONENT_SCHEMA[] (nivel=organism)";
      templates:"COMPONENT_SCHEMA[] (nivel=template)";
    }

    III.SCREENS{
      lista:[
        # Core producto genérico
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack genérico opcional
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos[]",             # qué datos debe tener la pantalla para ser útil
        "datos_opcionales[]",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo + latencias";
      factories:"shapes tipados por entidad";
      hooks_mock:"MOCK_HOOK_SCHEMA[]";
      swap_plan:"API|Firebase|Firestore|Supabase|Otro vía adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base UI";
      claves:"keys i18n por contexto (botones, errores, vacíos, confirmaciones)";
      tablas_microcopy:"mapas por idioma (ej. es-MX, en-US)";
    }

    X.EVAL{
      golden_set:"EVAL_SCHEMA.datasets";
      métricas:"EVAL_SCHEMA.metrics";
      umbrales:"EVAL_SCHEMA.umbrales";
      gates_regresión:"EVAL_SCHEMA.gates";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; consentimiento explícito";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache, headers_cache-control";
    }

    XIII.PRIORIDADES{
      top5_issues:"lista de problemas críticos detectados para este cliente/stack";
      top5_acciones:"acciones accionables para resolverlos en backlog inmediato";
    }
  }

  # ════════════════════════════════════
  # SCHEMAS (estructuras base, neutrales)
  # ════════════════════════════════════
  SCHEMAS{

    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#050509";
          "brand-500":"#3366FF";
          "accent-500":"#FF7AE0";
          "ok-500":"#22C55E";
          "warn-500":"#FFC857";
          "err-500":"#FF4B4B";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-50}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"{color.primitive.neutral-500}";
          "text.inverse":"{color.primitive.neutral-0}";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-300}";
          "border.subtle":"{color.primitive.neutral-200}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"1.2"; normal:"1.4"; loose:"1.6"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)"; lg:"0 12px 32px rgba(15,23,42,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← TOKENS_DTCG_JSON.semantic";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants?["string"];
      sizes?["string"];
      states?["string"];
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string"; # patrón /path o /path/:id
      objetivoUX:["string ≤3"]; # lista corta de objetivos
      layout_desktop:{grid_12:"descr";regiones:["header?","main","sidebar?","footer?"];};
      layout_mobile:{orden_stack:["string"];colapsos?["string"];};
      secciones:[
        {nombre:"string"; propósito:"string"; componentes:["organisms|molecules"];};
      ];
      ctas_principales?[{label:"string";accion:"string";}];
      ctas_secundarias?[{label:"string";accion:"string";}];
      datos_minimos:["string"];
      datos_opcionales?["string"];
      estados:{loading:"descr";error:"descr";empty:"descr";offline:"descr";success:"descr";};
      a11y:{landmarks:["header","nav","main","aside","footer"];tab_order:"descr";focus_visible:"≥2px";aria_roles?["string"];};
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pasos:[
        {pantalla?:"string";
         tarea:"string";
         entrada?["string"];
         salida?:"string|mapa";
         estado?:"string";
         error?{mensaje:"string";recuperación:"string|lista";};
        }
      ];
      ramificaciones?[{condición:"string";destino:"string";}];
      éxito{definición:"string";feedback?:"string";};
    }

    ENTITY.User{
      id:"string|uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"agent";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"string|uuid";
      title:"string";
      description:"string?";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string";name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore|Supabase|Otro";
    }

    EVAL_SCHEMA{
      datasets:{golden:"≥16 casos incluyendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";};
      metrics:[
        "json_schema_pass",
        "hallucination↓",
        "groundedness(si_RAG)",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:"≥0.98";
        groundedness:"≥0.9";
        a11y_checklist_pass:"≥0.95";
      };
      gates:{regresión:true;};
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen","click:cta","form:submit","error:ui",
        "net:offline","net:online",
        "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
        "auth:register:start","auth:register:success",
        "auth:recover:start","auth:recover:success",
        "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso";
      };
    }

    A11Y_SCHEMA{
      contraste_AA:{texto_normal:">=4.5:1";texto_grande:">=3:1";};
      focus_visible:"≥2px en todos los interactivos (token border.bold)";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{notificaciones:"polite";errores_criticos:"assertive";};
      no_solo_color:true;
      prefers_reduced_motion:"animaciones reducidas o nulas";
      skip_links:["Ir al contenido principal"];
      formularios:"aria-describedby vinculado a errores";
    }

    SEO_SCHEMA{
      title:"<60 chars";
      meta_description:"<160 chars";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; jerarquía H2/H3 coherente";
      urls_semánticas:["/","/login","/registro","/dashboard","/perfil","/items","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"<nombre_app>";
        short_name:"<short_name>";
        start_url:"/";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache (no sensibles)";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
      rate_limit_visual:"mensaje sutil y enfriamiento gradual";
      lockout_feedback:"tiempo de espera comunicado sin exponer umbrales";
      password_meter:"≥12 chars, variedad de clases, no incluir nombre/email";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde pantalla de seguridad/perfil";
      sesiones_activas:"lista dispositivos + 'Cerrar en este dispositivo'";
      consentimiento_telemetría:"opt-in claro";
    }
  }

  # ════════════════════════════════════
  # PIPELINE (α…ε) – EJECUCIÓN INTERNA
  # ════════════════════════════════════
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si solo 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS;
      checar_A11Y:"contrasteAA,focus_visible,landmarks,aria_live,no_solo_color,PRM";
      checar_SECURITY:"errores_neutros,no_enumerar_usuarios,lockout_visual,password_meter";
      checar_SEO_min:"title/meta/OG por ruta pública";
      checar_PWA:"manifest+SW+offline_fallback si PWA_on";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      };
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"A11Y+SECURITY+PWA+i18n+datos_minimos_por_pantalla";
    }
  }

  # ════════════════════════════════════
  # RENDER_ORDER
  # ════════════════════════════════════
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (COMPONENT_SCHEMA[] por nivel)";
    3:"SCREENS (instancias SCREEN_SCHEMA)";
    4:"FLOWS (F1..F11 instancias FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (A11Y_SCHEMA+SEO_SCHEMA+PWA_SCHEMA)";
    7:"SECURITY_PRIVACY (SECURITY_PRIVACY_SCHEMA)";
    8:"MOCKS (MOCK_HOOK_SCHEMA + fixtures + swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas microcopy)";
    10:"EVAL (EVAL_SCHEMA)";
    11:"TELEMETRÍA (TELEMETRY_SCHEMA)";
    12:"SSR_SSG_ADAPT";
    13:"PRIORIDADES (top5_issues/top5_acciones)";
  }

  # ════════════════════════════════════
  # REGLAS GLOBALES + GUARD
  # ════════════════════════════════════
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_RAG_off→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  GUARD[
    NO_META;
    NO_DRY;
    NO_REPEAT;
    ANTI_INJ_STRICT;
    CTX_ISOLATE;
    CONSIST;
    FACT_CHECK;
    RECENCY_CHECK;
    DATE_DRIFT_DETECT;
    DISINFO_HYGIENE;
    HALLUCINATION_DETECT;
    PII_STRICT;
    SECRET_STRICT;
    SEMANTIC_DEDUP;
    LEXICAL_DEDUP;
    SINGLE_OUTPUT;
    TOOL_ONLY_REAL;
    NO_ASYNC_WORK;
    NO_TIME_ESTIMATES;
  ]

  # ════════════════════════════════════
  # INFERENCIAS POR DEFECTO (fallback neutrales)
  # ════════════════════════════════════
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"<UserName>";
      email:"<user@email>";
      prefs:{lang:"es-MX";theme:"light";reduceMotion:false;notifications:true;};
    };
    EntityX_default:{title:"Elemento de ejemplo";status:"active";};
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ════════════════════════════════════
  # INSTRUCCIONES AL LLM (NEUTRALES)
  # ════════════════════════════════════
  INSTRUCCIONES_AL_LLM{
    1:"Usar PIPELINE y RENDER_ORDER como guía estricta para construir un sistema UI/UX end-to-end para el producto descrito en INPUTS.";
    2:"Instanciar TOKENS, ATOMIC_LIBRARY, SCREENS, FLOWS, DATOS, A11Y, SECURITY, I18N, EVAL, TELEMETRÍA y SSR_SSG_ADAPT según SCHEMAS, usando placeholders neutros cuando falte contexto.";
    3:"Si el problema es diferente (ej. panel admin, e-commerce, backoffice), adaptar nombres y microcopy manteniendo la estructura general de Home/List/Detail/Form/Auth pero con semántica del dominio.";
    4:"Respetar SCHEMAS en todas las estructuras; si hay violaciones, reportarlas en nodo `Violations` al final de la salida.";
    5:"No incluir razonamiento interno ni pasos de cadena de pensamiento; solo resultados estructurados.";
    6:"Usar TOKENS_DTCG_JSON para todos los valores visuales y reportar cualquier hex suelto como violación.";
    7:"Asegurar que los flujos conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff de forma coherente, o adaptar equivalentes si el producto no tiene auth.";
  }

}
Tú dijiste:
este prompts 
text
Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ════════════════════════════════════
  # META
  # ════════════════════════════════════
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";      # salida principal JSON estructurado
    JSON_SCHEMA:"estricto";            # debe respetar SCHEMAS
    FALLBACK_MD:"on";                  # si falla JSON, usar markdown con bloques JSON válidos

    CONTEXT_ENGINEERING:"on";          # planear contexto (filtrar, rankear, comprimir, dedup)
    RAG:"opt";                         # retrieval opcional
    AGENTIC_ROLES:"planner,researcher,writer,verifier"; # roles lógicos internos

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ════════════════════════════════════
  # INPUTS (a rellenar por humano/sistema)
  # ════════════════════════════════════
  INPUTS{

    PRODUCTO{
      nombre:"<nombre_producto>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Admin|Otro>";
      dominio:"<breve_descripción_dominio>";      # ej: "gestión de tickets", "reservas", "delivery"
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<objetivo_1>","<objetivo_2>"];      # ej: "aumentar conversión", "reducir errores"
      objetivo_usuario:["<objetivo_ux_1>","<objetivo_ux_2>"];# ej: "terminar tarea en ≤N pasos"
      KPI:["<activación|retención|conversión|NPS|CSAT|...>"];
    };

    USUARIOS{
      perfiles:[
        { rol:"<stakeholder_principal>";
          nivel:"<bajo|medio|alto>";
          motivación:"<qué busca resolver>";
          contexto:"<frecuencia_uso|situación>";
        }
      ];
    };

    CONTEXTO{
      dispositivos:["mobile","desktop"];           # se puede ampliar si aplica: "tablet"
      conectividad:"<intermitente|estable>";
      regiones:["<MX|LATAM|Global|...>"];
      idioma_base:"es-MX";
    };

    STACK_HINT{
      runtime:"<CSR|SSR|SSG|Hybrid>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
      routing:"<SPA|MPA|Hybrid>";
    };
  }

  # ════════════════════════════════════
  # CONTRATO DE SALIDA (qué debe producir el LLM)
  # ════════════════════════════════════
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";           # design tokens DTCG (color, typo, space, radius, etc.)
      THEMES:["light","dark","high-contrast"];
    }

    II.ATOMIC_LIBRARY{
      atoms:"COMPONENT_SCHEMA[] (nivel=atom)";
      molecules:"COMPONENT_SCHEMA[] (nivel=molecule)";
      organisms:"COMPONENT_SCHEMA[] (nivel=organism)";
      templates:"COMPONENT_SCHEMA[] (nivel=template)";
    }

    III.SCREENS{
      lista:[
        # Core producto genérico
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack genérico opcional
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos[]",             # qué datos debe tener la pantalla para ser útil
        "datos_opcionales[]",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo + latencias";
      factories:"shapes tipados por entidad";
      hooks_mock:"MOCK_HOOK_SCHEMA[]";
      swap_plan:"API|Firebase|Firestore|Supabase|Otro vía adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base UI";
      claves:"keys i18n por contexto (botones, errores, vacíos, confirmaciones)";
      tablas_microcopy:"mapas por idioma (ej. es-MX, en-US)";
    }

    X.EVAL{
      golden_set:"EVAL_SCHEMA.datasets";
      métricas:"EVAL_SCHEMA.metrics";
      umbrales:"EVAL_SCHEMA.umbrales";
      gates_regresión:"EVAL_SCHEMA.gates";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; consentimiento explícito";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache, headers_cache-control";
    }

    XIII.PRIORIDADES{
      top5_issues:"lista de problemas críticos detectados para este cliente/stack";
      top5_acciones:"acciones accionables para resolverlos en backlog inmediato";
    }
  }

  # ════════════════════════════════════
  # SCHEMAS (estructuras base, neutrales)
  # ════════════════════════════════════
  SCHEMAS{

    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#050509";
          "brand-500":"#3366FF";
          "accent-500":"#FF7AE0";
          "ok-500":"#22C55E";
          "warn-500":"#FFC857";
          "err-500":"#FF4B4B";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-50}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"{color.primitive.neutral-500}";
          "text.inverse":"{color.primitive.neutral-0}";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-300}";
          "border.subtle":"{color.primitive.neutral-200}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"1.2"; normal:"1.4"; loose:"1.6"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)"; lg:"0 12px 32px rgba(15,23,42,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← TOKENS_DTCG_JSON.semantic";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants?["string"];
      sizes?["string"];
      states?["string"];
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string"; # patrón /path o /path/:id
      objetivoUX:["string ≤3"]; # lista corta de objetivos
      layout_desktop:{grid_12:"descr";regiones:["header?","main","sidebar?","footer?"];};
      layout_mobile:{orden_stack:["string"];colapsos?["string"];};
      secciones:[
        {nombre:"string"; propósito:"string"; componentes:["organisms|molecules"];};
      ];
      ctas_principales?[{label:"string";accion:"string";}];
      ctas_secundarias?[{label:"string";accion:"string";}];
      datos_minimos:["string"];
      datos_opcionales?["string"];
      estados:{loading:"descr";error:"descr";empty:"descr";offline:"descr";success:"descr";};
      a11y:{landmarks:["header","nav","main","aside","footer"];tab_order:"descr";focus_visible:"≥2px";aria_roles?["string"];};
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pasos:[
        {pantalla?:"string";
         tarea:"string";
         entrada?["string"];
         salida?:"string|mapa";
         estado?:"string";
         error?{mensaje:"string";recuperación:"string|lista";};
        }
      ];
      ramificaciones?[{condición:"string";destino:"string";}];
      éxito{definición:"string";feedback?:"string";};
    }

    ENTITY.User{
      id:"string|uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"agent";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"string|uuid";
      title:"string";
      description:"string?";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string";name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore|Supabase|Otro";
    }

    EVAL_SCHEMA{
      datasets:{golden:"≥16 casos incluyendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";};
      metrics:[
        "json_schema_pass",
        "hallucination↓",
        "groundedness(si_RAG)",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:"≥0.98";
        groundedness:"≥0.9";
        a11y_checklist_pass:"≥0.95";
      };
      gates:{regresión:true;};
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen","click:cta","form:submit","error:ui",
        "net:offline","net:online",
        "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
        "auth:register:start","auth:register:success",
        "auth:recover:start","auth:recover:success",
        "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso";
      };
    }

    A11Y_SCHEMA{
      contraste_AA:{texto_normal:">=4.5:1";texto_grande:">=3:1";};
      focus_visible:"≥2px en todos los interactivos (token border.bold)";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{notificaciones:"polite";errores_criticos:"assertive";};
      no_solo_color:true;
      prefers_reduced_motion:"animaciones reducidas o nulas";
      skip_links:["Ir al contenido principal"];
      formularios:"aria-describedby vinculado a errores";
    }

    SEO_SCHEMA{
      title:"<60 chars";
      meta_description:"<160 chars";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; jerarquía H2/H3 coherente";
      urls_semánticas:["/","/login","/registro","/dashboard","/perfil","/items","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"<nombre_app>";
        short_name:"<short_name>";
        start_url:"/";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache (no sensibles)";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
      rate_limit_visual:"mensaje sutil y enfriamiento gradual";
      lockout_feedback:"tiempo de espera comunicado sin exponer umbrales";
      password_meter:"≥12 chars, variedad de clases, no incluir nombre/email";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde pantalla de seguridad/perfil";
      sesiones_activas:"lista dispositivos + 'Cerrar en este dispositivo'";
      consentimiento_telemetría:"opt-in claro";
    }
  }

  # ════════════════════════════════════
  # PIPELINE (α…ε) – EJECUCIÓN INTERNA
  # ════════════════════════════════════
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si solo 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS;
      checar_A11Y:"contrasteAA,focus_visible,landmarks,aria_live,no_solo_color,PRM";
      checar_SECURITY:"errores_neutros,no_enumerar_usuarios,lockout_visual,password_meter";
      checar_SEO_min:"title/meta/OG por ruta pública";
      checar_PWA:"manifest+SW+offline_fallback si PWA_on";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      };
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"A11Y+SECURITY+PWA+i18n+datos_minimos_por_pantalla";
    }
  }

  # ════════════════════════════════════
  # RENDER_ORDER
  # ════════════════════════════════════
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (COMPONENT_SCHEMA[] por nivel)";
    3:"SCREENS (instancias SCREEN_SCHEMA)";
    4:"FLOWS (F1..F11 instancias FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (A11Y_SCHEMA+SEO_SCHEMA+PWA_SCHEMA)";
    7:"SECURITY_PRIVACY (SECURITY_PRIVACY_SCHEMA)";
    8:"MOCKS (MOCK_HOOK_SCHEMA + fixtures + swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas microcopy)";
    10:"EVAL (EVAL_SCHEMA)";
    11:"TELEMETRÍA (TELEMETRY_SCHEMA)";
    12:"SSR_SSG_ADAPT";
    13:"PRIORIDADES (top5_issues/top5_acciones)";
  }

  # ════════════════════════════════════
  # REGLAS GLOBALES + GUARD
  # ════════════════════════════════════
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_RAG_off→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  GUARD[
    NO_META;
    NO_DRY;
    NO_REPEAT;
    ANTI_INJ_STRICT;
    CTX_ISOLATE;
    CONSIST;
    FACT_CHECK;
    RECENCY_CHECK;
    DATE_DRIFT_DETECT;
    DISINFO_HYGIENE;
    HALLUCINATION_DETECT;
    PII_STRICT;
    SECRET_STRICT;
    SEMANTIC_DEDUP;
    LEXICAL_DEDUP;
    SINGLE_OUTPUT;
    TOOL_ONLY_REAL;
    NO_ASYNC_WORK;
    NO_TIME_ESTIMATES;
  ]

  # ════════════════════════════════════
  # INFERENCIAS POR DEFECTO (fallback neutrales)
  # ════════════════════════════════════
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"<UserName>";
      email:"<user@email>";
      prefs:{lang:"es-MX";theme:"light";reduceMotion:false;notifications:true;};
    };
    EntityX_default:{title:"Elemento de ejemplo";status:"active";};
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ════════════════════════════════════
  # INSTRUCCIONES AL LLM (NEUTRALES)
  # ════════════════════════════════════
  INSTRUCCIONES_AL_LLM{
    1:"Usar PIPELINE y RENDER_ORDER como guía estricta para construir un sistema UI/UX end-to-end para el producto descrito en INPUTS.";
    2:"Instanciar TOKENS, ATOMIC_LIBRARY, SCREENS, FLOWS, DATOS, A11Y, SECURITY, I18N, EVAL, TELEMETRÍA y SSR_SSG_ADAPT según SCHEMAS, usando placeholders neutros cuando falte contexto.";
    3:"Si el problema es diferente (ej. panel admin, e-commerce, backoffice), adaptar nombres y microcopy manteniendo la estructura general de Home/List/Detail/Form/Auth pero con semántica del dominio.";
    4:"Respetar SCHEMAS en todas las estructuras; si hay violaciones, reportarlas en nodo `Violations` al final de la salida.";
    5:"No incluir razonamiento interno ni pasos de cadena de pensamiento; solo resultados estructurados.";
    6:"Usar TOKENS_DTCG_JSON para todos los valores visuales y reportar cualquier hex suelto como violación.";
    7:"Asegurar que los flujos conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff de forma coherente, o adaptar equivalentes si el producto no tiene auth.";
  }

}
 ejeucta 
text
Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1{

  # ════════════════════════════════════
  # META
  # ════════════════════════════════════
  META{
    ENC:"UTF-8";
    LANG:"es-MX";
    STYLE:"conciso";
    DENSIDAD:"alta";
    OUTPUT:"markdown+json";
    PRIVACY:"no_chain_of_thought";
  }

  FLAGS{
    STRUCTURED_OUTPUT:"preferido";      # salida principal JSON estructurado
    JSON_SCHEMA:"estricto";            # debe respetar SCHEMAS
    FALLBACK_MD:"on";                  # si falla JSON, usar markdown con bloques JSON válidos

    CONTEXT_ENGINEERING:"on";          # planear contexto (filtrar, rankear, comprimir, dedup)
    RAG:"opt";                         # retrieval opcional
    AGENTIC_ROLES:"planner,researcher,writer,verifier"; # roles lógicos internos

    A11Y:"WCAG2.1_AA";
    SEO:"on";
    PWA:"on";
    I18N:"on";
    SSR_SSG:"opt";

    SECURITY:"on";
    PRIVACY:"on";
    EVAL:"on";
    TELEMETRÍA:"on";
  }

  # ════════════════════════════════════
  # INPUTS (a rellenar por humano/sistema)
  # ════════════════════════════════════
  INPUTS{

    PRODUCTO{
      nombre:"<nombre_producto>";
      tipo:"<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Admin|Otro>";
      dominio:"<breve_descripción_dominio>";      # ej: "gestión de tickets", "reservas", "delivery"
      público:"<B2B|B2C|Mixto>";
      objetivo_negocio:["<objetivo_1>","<objetivo_2>"];      # ej: "aumentar conversión", "reducir errores"
      objetivo_usuario:["<objetivo_ux_1>","<objetivo_ux_2>"];# ej: "terminar tarea en ≤N pasos"
      KPI:["<activación|retención|conversión|NPS|CSAT|...>"];
    };

    USUARIOS{
      perfiles:[
        { rol:"<stakeholder_principal>";
          nivel:"<bajo|medio|alto>";
          motivación:"<qué busca resolver>";
          contexto:"<frecuencia_uso|situación>";
        }
      ];
    };

    CONTEXTO{
      dispositivos:["mobile","desktop"];           # se puede ampliar si aplica: "tablet"
      conectividad:"<intermitente|estable>";
      regiones:["<MX|LATAM|Global|...>"];
      idioma_base:"es-MX";
    };

    STACK_HINT{
      runtime:"<CSR|SSR|SSG|Hybrid>";
      framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
      estado_app:"<hooks|zustand|redux|query|otro>";
      routing:"<SPA|MPA|Hybrid>";
    };
  }

  # ════════════════════════════════════
  # CONTRATO DE SALIDA (qué debe producir el LLM)
  # ════════════════════════════════════
  CONTRATO_SALIDA{

    I.DESIGN_SYSTEM{
      TOKENS:"TOKENS_DTCG_JSON";           # design tokens DTCG (color, typo, space, radius, etc.)
      THEMES:["light","dark","high-contrast"];
    }

    II.ATOMIC_LIBRARY{
      atoms:"COMPONENT_SCHEMA[] (nivel=atom)";
      molecules:"COMPONENT_SCHEMA[] (nivel=molecule)";
      organisms:"COMPONENT_SCHEMA[] (nivel=organism)";
      templates:"COMPONENT_SCHEMA[] (nivel=template)";
    }

    III.SCREENS{
      lista:[
        # Core producto genérico
        "Home","List","Detail","Form","Settings","Help","Offline","Error",
        # Auth pack genérico opcional
        "Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"
      ];
      contrato_por_pantalla:"SCREEN_SCHEMA";
    }

    IV.FLOWS{
      lista:[
        "F1_Onboarding/Auth",
        "F2_Home→List→Detail",
        "F3_CRUD_Principal",
        "F4_Conversión(opc)",
        "F5_Offline_Recovery",
        "F6_Login",
        "F7_Register",
        "F8_Recover",
        "F9_MFA(opc)",
        "F10_LogOff",
        "F11_SessionTimeout"
      ];
      formato:"FLOW_SCHEMA";
    }

    V.DATOS{
      ENTIDADES:{ User,Session,EntityX,Preference,Security };
      contratos_por_pantalla:[
        "datos_minimos[]",             # qué datos debe tener la pantalla para ser útil
        "datos_opcionales[]",
        "estados_universales{loading,error,empty,offline,success}"
      ];
    }

    VI.A11Y_SEO_PWA{
      reglas_mínimas_verificables:"A11Y_SCHEMA + SEO_SCHEMA + PWA_SCHEMA";
    }

    VII.SECURITY_PRIVACY{
      reglas_UI_auth+datos:"SECURITY_PRIVACY_SCHEMA";
    }

    VIII.MOCKS{
      fixtures:"datos demo + latencias";
      factories:"shapes tipados por entidad";
      hooks_mock:"MOCK_HOOK_SCHEMA[]";
      swap_plan:"API|Firebase|Firestore|Supabase|Otro vía adapters";
    }

    IX.I18N_UX_COPY{
      glosario:"términos base UI";
      claves:"keys i18n por contexto (botones, errores, vacíos, confirmaciones)";
      tablas_microcopy:"mapas por idioma (ej. es-MX, en-US)";
    }

    X.EVAL{
      golden_set:"EVAL_SCHEMA.datasets";
      métricas:"EVAL_SCHEMA.metrics";
      umbrales:"EVAL_SCHEMA.umbrales";
      gates_regresión:"EVAL_SCHEMA.gates";
    }

    XI.TELEMETRÍA{
      eventos:"TELEMETRY_SCHEMA.eventos_core";
      payload_min:"TELEMETRY_SCHEMA.payload_min";
      privacidad:"minimizar PII; IDs opacos; consentimiento explícito";
    }

    XII.SSR_SSG_ADAPT{
      guías_concretas:"auth_guard, redirecciones, prefetch, hydration_segura, code_split, cache, headers_cache-control";
    }

    XIII.PRIORIDADES{
      top5_issues:"lista de problemas críticos detectados para este cliente/stack";
      top5_acciones:"acciones accionables para resolverlos en backlog inmediato";
    }
  }

  # ════════════════════════════════════
  # SCHEMAS (estructuras base, neutrales)
  # ════════════════════════════════════
  SCHEMAS{

    TOKENS_DTCG_JSON{
      color:{
        primitive:{
          "neutral-0":"#FFFFFF";
          "neutral-50":"#F7F7F8";
          "neutral-100":"#E5E5EA";
          "neutral-200":"#D1D1D6";
          "neutral-300":"#B0B0B8";
          "neutral-400":"#8E8E96";
          "neutral-500":"#636366";
          "neutral-600":"#48484A";
          "neutral-700":"#3A3A3C";
          "neutral-800":"#2C2C2E";
          "neutral-900":"#050509";
          "brand-500":"#3366FF";
          "accent-500":"#FF7AE0";
          "ok-500":"#22C55E";
          "warn-500":"#FFC857";
          "err-500":"#FF4B4B";
        };
        semantic:{
          "bg.page":"{color.primitive.neutral-50}";
          "bg.surface":"{color.primitive.neutral-0}";
          "bg.surface-alt":"{color.primitive.neutral-50}";
          "text.main":"{color.primitive.neutral-900}";
          "text.muted":"{color.primitive.neutral-500}";
          "text.inverse":"{color.primitive.neutral-0}";
          "accent.main":"{color.primitive.brand-500}";
          "border.bold":"{color.primitive.neutral-300}";
          "border.subtle":"{color.primitive.neutral-200}";
          "state.ok":"{color.primitive.ok-500}";
          "state.warn":"{color.primitive.warn-500}";
          "state.err":"{color.primitive.err-500}";
        };
      };
      type:{
        "family.base":"system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif";
        size:{ xs:"12px"; sm:"14px"; md:"16px"; lg:"20px"; xl:"24px"; h1:"32px"; h2:"24px"; h3:"20px"; };
        weight:{ reg:400; semib:600; bold:700; };
        line:{ tight:"1.2"; normal:"1.4"; loose:"1.6"; };
      };
      space:{ 1:"4px"; 2:"8px"; 3:"12px"; 4:"16px"; 5:"24px"; 6:"32px"; };
      radius:{ sm:"8px"; md:"12px"; lg:"16px"; pill:"999px"; };
      border:{ thin:"1px"; thick:"2px"; extra:"3px"; };
      shadow:{ soft:"0 8px 24px rgba(15,23,42,.12)"; lg:"0 12px 32px rgba(15,23,42,.18)"; };
      motion:{ fast:"150ms"; norm:"200ms"; reduced:"0ms"; };
      z:{ base:1; dropdown:10; overlay:100; modal:1000; toast:1100; };
    }

    THEMING{
      light:":root ← TOKENS_DTCG_JSON.semantic";
      dark:"[data-theme='dark'] ajusta bg/text/accent para AA";
      hc:"[data-theme='hc'] max_contrast; no_info_solo_por_color";
    }

    COMPONENT_SCHEMA{
      name:"string";
      nivel:"atom|molecule|organism|template";
      semantic_role:"string";
      variants?["string"];
      sizes?["string"];
      states?["string"];
      props:"mapa nombre→tipo";
      tokens?:"mapeo a TOKENS_DTCG_JSON";
      a11y?:"reglas específicas (role, keyboard, aria, etc.)";
      testIdPattern:"string";
    }

    SCREEN_SCHEMA{
      id:"string";
      nombre:"string";
      rol:"home|list|detail|form|settings|help|offline|error|auth-*";
      route?:"string"; # patrón /path o /path/:id
      objetivoUX:["string ≤3"]; # lista corta de objetivos
      layout_desktop:{grid_12:"descr";regiones:["header?","main","sidebar?","footer?"];};
      layout_mobile:{orden_stack:["string"];colapsos?["string"];};
      secciones:[
        {nombre:"string"; propósito:"string"; componentes:["organisms|molecules"];};
      ];
      ctas_principales?[{label:"string";accion:"string";}];
      ctas_secundarias?[{label:"string";accion:"string";}];
      datos_minimos:["string"];
      datos_opcionales?["string"];
      estados:{loading:"descr";error:"descr";empty:"descr";offline:"descr";success:"descr";};
      a11y:{landmarks:["header","nav","main","aside","footer"];tab_order:"descr";focus_visible:"≥2px";aria_roles?["string"];};
      microcopy?{
        titular?:"string";
        sub?:"string";
        botones?["string"];
        errores?["string"];
        vacíos?["string"];
        confirmaciones?["string"];
      };
    }

    FLOW_SCHEMA{
      id:"string";
      nombre:"string";
      pasos:[
        {pantalla?:"string";
         tarea:"string";
         entrada?["string"];
         salida?:"string|mapa";
         estado?:"string";
         error?{mensaje:"string";recuperación:"string|lista";};
        }
      ];
      ramificaciones?[{condición:"string";destino:"string";}];
      éxito{definición:"string";feedback?:"string";};
    }

    ENTITY.User{
      id:"string|uuid";
      name:"string";
      email:"string";
      avatarUrl?:"string";
      location?:"string";
      role?:"string";
      createdAt:"iso";
      prefs:{
        lang:"es-MX";
        theme:"light|dark|hc";
        reduceMotion:"bool";
        notifications:"bool";
      };
      security:{
        mfaEnabled:"bool";
        providers:["password|oauth"];
        lastLogin:"iso";
        sessions:int;
      };
    }

    ENTITY.Session{
      id:"string";
      userId:"string";
      token:"opaque";
      refresh:"opaque";
      exp:"iso";
      device:"agent";
      ipHash:"string";
    }

    ENTITY.EntityX{
      id:"string|uuid";
      title:"string";
      description:"string?";
      status:"active|draft|archived";
      createdAt:"iso";
      updatedAt:"iso";
      owner:{id:"string";name:"string";};
      tags:["string"];
    }

    ENTITY.Preference{
      lang:"es-MX";
      theme:"light|dark|hc";
      reduceMotion:"bool";
      density:"compact|cozy|comfortable";
    }

    ENTITY.Security{
      attempts:int;
      lockUntil?:"iso";
      lastChange:"iso";
    }

    MOCK_HOOK_SCHEMA{
      nombre:"string";
      entidad:"User|Session|EntityX|...";
      shape_JSON:"objeto ejemplo";
      lat_ms:int;
      error_rate:"0..1";
      swap_plan:"API|Firebase|Firestore|Supabase|Otro";
    }

    EVAL_SCHEMA{
      datasets:{golden:"≥16 casos incluyendo: happy paths, errores, vacíos, offline, sesión expirada, mfa, CRUD completo";};
      metrics:[
        "json_schema_pass",
        "hallucination↓",
        "groundedness(si_RAG)",
        "readability",
        "a11y_checklist_pass"
      ];
      umbrales:{
        json_schema_pass:"≥0.98";
        groundedness:"≥0.9";
        a11y_checklist_pass:"≥0.95";
      };
      gates:{regresión:true;};
    }

    TELEMETRY_SCHEMA{
      eventos_core:[
        "view:screen","click:cta","form:submit","error:ui",
        "net:offline","net:online",
        "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
        "auth:register:start","auth:register:success",
        "auth:recover:start","auth:recover:success",
        "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
      ];
      payload_min:{
        screen_id:"string";
        cta_id?:"string";
        entity_id?:"string";
        user_id?:"string";
        method?:"string";
        error_code?:"string";
        ts_iso:"iso";
      };
    }

    A11Y_SCHEMA{
      contraste_AA:{texto_normal:">=4.5:1";texto_grande:">=3:1";};
      focus_visible:"≥2px en todos los interactivos (token border.bold)";
      orden_tab:"header→nav→main→aside→footer";
      landmarks:["header","nav","main","region","footer"];
      aria_live:{notificaciones:"polite";errores_criticos:"assertive";};
      no_solo_color:true;
      prefers_reduced_motion:"animaciones reducidas o nulas";
      skip_links:["Ir al contenido principal"];
      formularios:"aria-describedby vinculado a errores";
    }

    SEO_SCHEMA{
      title:"<60 chars";
      meta_description:"<160 chars";
      open_graph:["og:title","og:description","og:image","og:url"];
      twitter_card:["twitter:card","twitter:title","twitter:description"];
      headings:"1 H1 por pantalla; jerarquía H2/H3 coherente";
      urls_semánticas:["/","/login","/registro","/dashboard","/perfil","/items","/ayuda"];
      canonical:"1 por pantalla pública";
    }

    PWA_SCHEMA{
      manifest:{
        name:"<nombre_app>";
        short_name:"<short_name>";
        start_url:"/";
        display:"standalone";
        theme_color:"token color";
        background_color:"token color";
        icons:["192x192","512x512"];
      };
      service_worker:{
        estrategia:"app_shell";
        precache:["/","/login","/dashboard","/assets/*"];
        data_strategy:"network-first + fallback cache (no sensibles)";
        offline_fallback:"/offline";
      };
      instalabilidad:["HTTPS","manifest_ok","SW_activo"];
    }

    SECURITY_PRIVACY_SCHEMA{
      errores_neutros_auth:"Credenciales inválidas";
      no_enumerar_usuarios_en_recover:"mensaje_neutro_si_existe_o_no";
      rate_limit_visual:"mensaje sutil y enfriamiento gradual";
      lockout_feedback:"tiempo de espera comunicado sin exponer umbrales";
      password_meter:"≥12 chars, variedad de clases, no incluir nombre/email";
      mostrar_ocultar_password:"toggle con aria-pressed";
      mfa_sugerido:"desde pantalla de seguridad/perfil";
      sesiones_activas:"lista dispositivos + 'Cerrar en este dispositivo'";
      consentimiento_telemetría:"opt-in claro";
    }
  }

  # ════════════════════════════════════
  # PIPELINE (α…ε) – EJECUCIÓN INTERNA
  # ════════════════════════════════════
  PIPELINE{

    α.CONTEXT_PLAN{
      filtrar_contexto_relevante;
      rank_score = 0.5*autoridad + 0.3*recencia + 0.2*task_fit;
      comprimir_resumen_denso;
      dedup_semántico;
    }

    β.GENERACIÓN{
      modo_salida:"STRUCTURED_OUTPUT_JSON";
      fallback:"Markdown con bloques JSON válidos";
      roles_lógicos:"planner→researcher→writer→verifier (simulados si solo 1 LLM)";
    }

    γ.VALIDACIÓN{
      validar_JSON_vs_SCHEMAS;
      checar_A11Y:"contrasteAA,focus_visible,landmarks,aria_live,no_solo_color,PRM";
      checar_SECURITY:"errores_neutros,no_enumerar_usuarios,lockout_visual,password_meter";
      checar_SEO_min:"title/meta/OG por ruta pública";
      checar_PWA:"manifest+SW+offline_fallback si PWA_on";
    }

    δ.CORRECCIÓN{
      si_falla_validación:{
        reintento_max:2;
        diff_min:"ajustar solo lo necesario";
        registrar_diffs_en:"MetaViolations";
      };
    }

    ε.PAQUETE{
      seguir_RENDER_ORDER;
      incluir_checklist_DoD:"A11Y+SECURITY+PWA+i18n+datos_minimos_por_pantalla";
    }
  }

  # ════════════════════════════════════
  # RENDER_ORDER
  # ════════════════════════════════════
  RENDER_ORDER{
    1:"TOKENS (TOKENS_DTCG_JSON + THEMING)";
    2:"ATOMIC_LIBRARY (COMPONENT_SCHEMA[] por nivel)";
    3:"SCREENS (instancias SCREEN_SCHEMA)";
    4:"FLOWS (F1..F11 instancias FLOW_SCHEMA)";
    5:"DATOS/ENTIDADES (User,Session,EntityX,Preference,Security)";
    6:"A11Y_SEO_PWA (A11Y_SCHEMA+SEO_SCHEMA+PWA_SCHEMA)";
    7:"SECURITY_PRIVACY (SECURITY_PRIVACY_SCHEMA)";
    8:"MOCKS (MOCK_HOOK_SCHEMA + fixtures + swap_plan)";
    9:"I18N_UX_COPY (glosario+tablas microcopy)";
    10:"EVAL (EVAL_SCHEMA)";
    11:"TELEMETRÍA (TELEMETRY_SCHEMA)";
    12:"SSR_SSG_ADAPT";
    13:"PRIORIDADES (top5_issues/top5_acciones)";
  }

  # ════════════════════════════════════
  # REGLAS GLOBALES + GUARD
  # ════════════════════════════════════
  REGLAS{
    R1:"no_duplicidad_semántica_en_nombres";
    R2:"todos_los_valores_visual_usan_TOKENS; no_hex_sueltos_en_componentes";
    R3:"estados_universales_en_cada_pantalla:{loading,error,empty,offline,success}";
    R4:"microcopy_consistente_e_i18n_ready";
    R5:"contraste_texto≥AA; focus-visible≥2px; no_info_solo_por_color; soportar_prefers-reduced-motion";
    R6:"auth_errores_neutros('Credenciales inválidas'); no_enumerar_usuarios_en_recover";
    R7:"no_exponer_razonamiento_interno; nada_de_chain-of-thought_en_salida";
    R8:"si_RAG_on→citar_fuentes; si_RAG_off→no_inventar_citas";
    R9:"reportar_violaciones_en_bloque_'Violations' si las hay";
  }

  GUARD[
    NO_META;
    NO_DRY;
    NO_REPEAT;
    ANTI_INJ_STRICT;
    CTX_ISOLATE;
    CONSIST;
    FACT_CHECK;
    RECENCY_CHECK;
    DATE_DRIFT_DETECT;
    DISINFO_HYGIENE;
    HALLUCINATION_DETECT;
    PII_STRICT;
    SECRET_STRICT;
    SEMANTIC_DEDUP;
    LEXICAL_DEDUP;
    SINGLE_OUTPUT;
    TOOL_ONLY_REAL;
    NO_ASYNC_WORK;
    NO_TIME_ESTIMATES;
  ]

  # ════════════════════════════════════
  # INFERENCIAS POR DEFECTO (fallback neutrales)
  # ════════════════════════════════════
  INFERENCIAS_DEFECTO{
    User_default:{
      name:"<UserName>";
      email:"<user@email>";
      prefs:{lang:"es-MX";theme:"light";reduceMotion:false;notifications:true;};
    };
    EntityX_default:{title:"Elemento de ejemplo";status:"active";};
    Home_titular_default:"Propuesta de valor en 5–8 palabras";
    ctas_default:["Continuar","Ver detalles","Crear nuevo","Guardar cambios"];
    ESTADOS_UNIVERSALES_DEFAULT:{
      loading:"skeleton";
      error:"mensaje+retry";
      empty:"mensaje+CTA";
      offline:"banner+fallback";
      success:"toast";
    };
  }

  # ════════════════════════════════════
  # INSTRUCCIONES AL LLM (NEUTRALES)
  # ════════════════════════════════════
  INSTRUCCIONES_AL_LLM{
    1:"Usar PIPELINE y RENDER_ORDER como guía estricta para construir un sistema UI/UX end-to-end para el producto descrito en INPUTS.";
    2:"Instanciar TOKENS, ATOMIC_LIBRARY, SCREENS, FLOWS, DATOS, A11Y, SECURITY, I18N, EVAL, TELEMETRÍA y SSR_SSG_ADAPT según SCHEMAS, usando placeholders neutros cuando falte contexto.";
    3:"Si el problema es diferente (ej. panel admin, e-commerce, backoffice), adaptar nombres y microcopy manteniendo la estructura general de Home/List/Detail/Form/Auth pero con semántica del dominio.";
    4:"Respetar SCHEMAS en todas las estructuras; si hay violaciones, reportarlas en nodo `Violations` al final de la salida.";
    5:"No incluir razonamiento interno ni pasos de cadena de pensamiento; solo resultados estructurados.";
    6:"Usar TOKENS_DTCG_JSON para todos los valores visuales y reportar cualquier hex suelto como violación.";
    7:"Asegurar que los flujos conecten Splash→Auth→Home→List→Detail→Form→Profile→LogOff de forma coherente, o adaptar equivalentes si el producto no tiene auth.";
  }

}


y emite solo resultado trazable completo agnostifco full sin comentario 
ChatGPT Plus

Pensó durante 19s
{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_1",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "style": "conciso",
    "densidad": "alta",
    "output": "markdown+json",
    "privacy": "no_chain_of_thought"
  },
  "flags": {
    "structured_output": "preferido",
    "json_schema": "estricto",
    "fallback_md": "on",
    "context_engineering": "on",
    "rag": "opt",
    "agentic_roles": ["planner", "researcher", "writer", "verifier"],
    "a11y": "WCAG2.1_AA",
    "seo": "on",
    "pwa": "on",
    "i18n": "on",
    "ssr_ssg": "opt",
    "security": "on",
    "privacy": "on",
    "eval": "on",
    "telemetria": "on"
  },
  "inputs_schema": {
    "PRODUCTO": {
      "nombre": "<nombre_producto>",
      "tipo": "<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Admin|Otro>",
      "dominio": "<breve_descripcion_dominio>",
      "publico": "<B2B|B2C|Mixto>",
      "objetivo_negocio": ["<objetivo_1>", "<objetivo_2>"],
      "objetivo_usuario": ["<objetivo_ux_1>", "<objetivo_ux_2>"],
      "kpi": ["<activacion|retencion|conversion|NPS|CSAT|...>"]
    },
    "USUARIOS": {
      "perfiles": [
        {
          "rol": "<stakeholder_principal>",
          "nivel": "<bajo|medio|alto>",
          "motivacion": "<que_busca_resolver>",
          "contexto": "<frecuencia_uso|situacion>"
        }
      ]
    },
    "CONTEXTO": {
      "dispositivos": ["mobile", "desktop"],
      "conectividad": "<intermitente|estable>",
      "regiones": ["<MX|LATAM|Global|...>"],
      "idioma_base": "es-MX"
    },
    "STACK_HINT": {
      "runtime": "<CSR|SSR|SSG|Hybrid>",
      "framework": "<React|Vue|Svelte|Next|Nuxt|Otro>",
      "estado_app": "<hooks|zustand|redux|query|otro>",
      "routing": "<SPA|MPA|Hybrid>"
    }
  },
  "design_system": {
    "tokens_dtcg": {
      "color": {
        "primitive": {
          "neutral": {
            "0": "#FFFFFF",
            "50": "#F7F7F8",
            "100": "#E5E5EA",
            "200": "#D1D1D6",
            "300": "#B0B0B8",
            "400": "#8E8E96",
            "500": "#636366",
            "600": "#48484A",
            "700": "#3A3A3C",
            "800": "#2C2C2E",
            "900": "#050509"
          },
          "brand": { "500": "#3366FF" },
          "accent": { "500": "#FF7AE0" },
          "ok": { "500": "#22C55E" },
          "warn": { "500": "#FFC857" },
          "err": { "500": "#FF4B4B" }
        },
        "semantic": {
          "bg": {
            "page": "{color.primitive.neutral.50}",
            "surface": "{color.primitive.neutral.0}",
            "surfaceAlt": "{color.primitive.neutral.50}"
          },
          "text": {
            "main": "{color.primitive.neutral.900}",
            "muted": "{color.primitive.neutral.500}",
            "inverse": "{color.primitive.neutral.0}"
          },
          "accent": { "main": "{color.primitive.brand.500}" },
          "border": {
            "bold": "{color.primitive.neutral.300}",
            "subtle": "{color.primitive.neutral.200}"
          },
          "state": {
            "ok": "{color.primitive.ok.500}",
            "warn": "{color.primitive.warn.500}",
            "err": "{color.primitive.err.500}"
          }
        }
      },
      "typography": {
        "family": { "base": "system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif" },
        "size": {
          "xs": "12px",
          "sm": "14px",
          "md": "16px",
          "lg": "20px",
          "xl": "24px",
          "h1": "32px",
          "h2": "24px",
          "h3": "20px"
        },
        "weight": { "reg": 400, "semib": 600, "bold": 700 },
        "line": { "tight": "1.2", "normal": "1.4", "loose": "1.6" }
      },
      "space": { "1": "4px", "2": "8px", "3": "12px", "4": "16px", "5": "24px", "6": "32px" },
      "radius": { "sm": "8px", "md": "12px", "lg": "16px", "pill": "999px" },
      "border": { "thin": "1px", "thick": "2px", "extra": "3px" },
      "shadow": {
        "soft": "0 8px 24px rgba(15,23,42,.12)",
        "lg": "0 12px 32px rgba(15,23,42,.18)"
      },
      "motion": { "fast": "150ms", "norm": "200ms", "reduced": "0ms" },
      "z": { "base": 1, "dropdown": 10, "overlay": 100, "modal": 1000, "toast": 1100 }
    },
    "theming": {
      "light": {
        "selector": ":root",
        "description": "usa tokens semantic.* para modo claro"
      },
      "dark": {
        "selector": "[data-theme='dark']",
        "description": "ajusta bg/text/accent manteniendo AA"
      },
      "high_contrast": {
        "selector": "[data-theme='hc']",
        "description": "max_contrast; no info solo por color"
      }
    }
  },
  "atomic_library": {
    "atoms": [
      {
        "name": "Text",
        "nivel": "atom",
        "semantic_role": "typography",
        "variants": ["h1","h2","h3","body","caption"],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err",
          "truncate": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["default"],
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "nivel": "atom",
        "semantic_role": "interactive-cta",
        "variants": ["primary","secondary","ghost","danger"],
        "sizes": ["sm","md","lg"],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "disabled": "boolean",
          "loading": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["default","hover","focus","disabled","loading"],
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "nivel": "atom",
        "semantic_role": "form-field",
        "variants": ["text","email","password","search","number","otp"],
        "props": {
          "type": "text|email|password|search|number|otp",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?",
          "hasError": "boolean"
        },
        "states": ["default","focus","error","disabled"],
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "nivel": "atom",
        "semantic_role": "form-field-multiline",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "hasError": "boolean"
        },
        "states": ["default","focus","error","disabled"],
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "nivel": "atom",
        "semantic_role": "binary-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "indeterminate": "boolean?"
        },
        "states": ["checked","unchecked","indeterminate","disabled"],
        "testIdPattern": "chk-{label}"
      },
      {
        "name": "Radio",
        "nivel": "atom",
        "semantic_role": "exclusive-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "states": ["checked","unchecked","disabled"],
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "nivel": "atom",
        "semantic_role": "single-select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "states": ["default","open","disabled"],
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "nivel": "atom",
        "semantic_role": "filter-token|status",
        "variants": ["default","filter","status"],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "states": ["selected","unselected","disabled"],
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "nivel": "atom",
        "semantic_role": "status-indicator",
        "variants": ["neutral","ok","warn","err"],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "states": ["default"],
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "nivel": "atom",
        "semantic_role": "user-identity",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "states": ["default","fallback"],
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "nivel": "atom",
        "semantic_role": "decorative|informative",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "states": ["decorative","informative"],
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "nivel": "atom",
        "semantic_role": "description",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "states": ["closed","open"],
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "nivel": "atom",
        "semantic_role": "layout-separator",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "states": ["default"],
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "nivel": "atom",
        "semantic_role": "progress-indicator",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "states": ["spinning"],
        "testIdPattern": "spinner-{size}"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "nivel": "molecule",
        "semantic_role": "form-field-wrapper",
        "parts": ["label","control","helper","error"],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "states": ["default","error","disabled"],
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "nivel": "molecule",
        "semantic_role": "search-entry",
        "parts": ["icon","input","clear"],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "states": ["default","with-query"],
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "nivel": "molecule",
        "semantic_role": "filter-group",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "states": ["empty","with-selection"],
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "nivel": "molecule",
        "semantic_role": "metric-display",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "states": ["default"],
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "nivel": "molecule",
        "semantic_role": "social-login",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "states": ["default"],
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "nivel": "molecule",
        "semantic_role": "mfa-otp-input",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "states": ["empty","partial","full"],
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenu",
        "nivel": "molecule",
        "semantic_role": "user-shortcut-menu",
        "props": {
          "userName": "string",
          "avatarUrl": "string?"
        },
        "states": ["closed","open"],
        "testIdPattern": "user-menu"
      },
      {
        "name": "Toast",
        "nivel": "molecule",
        "semantic_role": "ephemeral-feedback",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "states": ["visible","hidden"],
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "nivel": "organism",
        "semantic_role": "primary-navigation",
        "slots": ["logo","primary-links","secondary-actions","user-menu"],
        "states": ["default","scrolled"],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "SideNav",
        "nivel": "organism",
        "semantic_role": "secondary-navigation",
        "slots": ["section-links","footer-links"],
        "states": ["expanded","collapsed"],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "nivel": "organism",
        "semantic_role": "page-hero",
        "slots": ["eyebrow","title","subtitle","ctas","meta","illustration"],
        "states": ["default","compact"],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "HeroPanel",
        "nivel": "organism",
        "semantic_role": "context-panel",
        "slots": ["availability","chips","meta"],
        "states": ["default"],
        "testIdPattern": "hero-panel"
      },
      {
        "name": "ListView",
        "nivel": "organism",
        "semantic_role": "collection-display",
        "slots": ["filters","results","pagination"],
        "states": ["loading","error","empty","success"],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "nivel": "organism",
        "semantic_role": "entity-detail",
        "slots": ["header","body","related"],
        "states": ["loading","error","success"],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "nivel": "organism",
        "semantic_role": "entity-form",
        "slots": ["title","sections","global-errors","actions"],
        "states": ["editing","submitting","error","success"],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "nivel": "organism",
        "semantic_role": "auth-form",
        "slots": ["title","fields","actions","secondary-links","legal"],
        "states": ["idle","submitting","error"],
        "testIdPattern": "auth-form"
      },
      {
        "name": "MFAView",
        "nivel": "organism",
        "semantic_role": "mfa-step",
        "slots": ["title","otp","resend","alternate"],
        "states": ["idle","submitting","error"],
        "testIdPattern": "mfa-view"
      },
      {
        "name": "ProfilePanel",
        "nivel": "organism",
        "semantic_role": "account-settings",
        "slots": ["tabs","tab-content","danger-zone"],
        "states": ["view","editing","saving"],
        "testIdPattern": "profile-panel"
      },
      {
        "name": "SessionGuard",
        "nivel": "organism",
        "semantic_role": "route-guard",
        "states": ["checking","allowed","blocked"],
        "testIdPattern": "session-guard"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "nivel": "template",
        "semantic_role": "app-layout",
        "regions": ["header","sidebar","main","footer","toasts"],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "nivel": "template",
        "semantic_role": "auth-layout",
        "regions": ["branding","auth-card"],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "nivel": "template",
        "semantic_role": "dashboard-layout",
        "regions": ["header","sidebar","main"],
        "testIdPattern": "layout-dashboard"
      },
      {
        "name": "DetailLayout",
        "nivel": "template",
        "semantic_role": "detail-layout",
        "regions": ["header","main","related"],
        "testIdPattern": "layout-detail"
      },
      {
        "name": "FormLayout",
        "nivel": "template",
        "semantic_role": "form-layout",
        "regions": ["header","main","footer"],
        "testIdPattern": "layout-form"
      },
      {
        "name": "ErrorLayout",
        "nivel": "template",
        "semantic_role": "error-layout",
        "regions": ["icon","message","actions"],
        "testIdPattern": "layout-error"
      }
    ]
  },
  "screens": {
    "schema": "SCREEN_SCHEMA",
    "core": ["Home","List","Detail","Form","Settings","Help","Offline","Error"],
    "auth": ["Splash","Login","Register","Recover","MFA","Profile","LogOff","SessionExpired"]
  },
  "flows": {
    "schema": "FLOW_SCHEMA",
    "ids": [
      "F1_Onboarding/Auth",
      "F2_Home→List→Detail",
      "F3_CRUD_Principal",
      "F4_Conversión(opc)",
      "F5_Offline_Recovery",
      "F6_Login",
      "F7_Register",
      "F8_Recover",
      "F9_MFA(opc)",
      "F10_LogOff",
      "F11_SessionTimeout"
    ]
  },
  "data_model": {
    "User": {
      "id": "string|uuid",
      "name": "string",
      "email": "string",
      "avatarUrl": "string?",
      "location": "string?",
      "role": "string?",
      "createdAt": "iso",
      "prefs": {
        "lang": "es-MX",
        "theme": "light|dark|hc",
        "reduceMotion": "bool",
        "notifications": "bool"
      },
      "security": {
        "mfaEnabled": "bool",
        "providers": ["password|oauth"],
        "lastLogin": "iso",
        "sessions": "int"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "token": "opaque",
      "refresh": "opaque",
      "exp": "iso",
      "device": "agent",
      "ipHash": "string"
    },
    "EntityX": {
      "id": "string|uuid",
      "title": "string",
      "description": "string?",
      "status": "active|draft|archived",
      "createdAt": "iso",
      "updatedAt": "iso",
      "owner": {
        "id": "string",
        "name": "string"
      },
      "tags": ["string"]
    },
    "Preference": {
      "lang": "es-MX",
      "theme": "light|dark|hc",
      "reduceMotion": "bool",
      "density": "compact|cozy|comfortable"
    },
    "Security": {
      "attempts": "int",
      "lockUntil": "iso?",
      "lastChange": "iso"
    }
  },
  "a11y_seo_pwa": {
    "a11y_schema": {
      "contraste_AA": {
        "texto_normal": ">=4.5:1",
        "texto_grande": ">=3:1"
      },
      "focus_visible": ">=2px",
      "orden_tab": "header→nav→main→aside→footer",
      "landmarks": ["header","nav","main","region","footer"],
      "aria_live": { "notificaciones": "polite", "errores_criticos": "assertive" },
      "no_solo_color": true,
      "prefers_reduced_motion": "on",
      "skip_links": ["Ir al contenido principal"],
      "formularios": "aria-describedby para errores"
    },
    "seo_schema": {
      "title_max_chars": 60,
      "meta_description_max_chars": 160,
      "open_graph": ["og:title","og:description","og:image","og:url"],
      "twitter_card": ["twitter:card","twitter:title","twitter:description"],
      "headings": "1 H1 por pantalla; H2/H3 en jerarquía",
      "urls_semanticas": ["/","/login","/registro","/dashboard","/perfil","/items","/ayuda"],
      "canonical": "una por pantalla pública"
    },
    "pwa_schema": {
      "manifest": {
        "name": "<nombre_app>",
        "short_name": "<short_name>",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons": ["192x192","512x512"]
      },
      "service_worker": {
        "estrategia": "app_shell",
        "precache": ["/","/login","/dashboard","/assets/*"],
        "data_strategy": "network-first+fallback_cache",
        "offline_fallback": "/offline"
      },
      "instalabilidad": ["HTTPS","manifest_ok","SW_activo"]
    }
  },
  "security_privacy": {
    "errores_neutros_auth": "Credenciales inválidas.",
    "no_enumerar_usuarios_en_recover": true,
    "rate_limit_visual": "on",
    "lockout_feedback": "mostrar_tiempo_sin_detalles",
    "password_meter": ">=12 chars + clases variadas, sin nombre/email",
    "mostrar_ocultar_password": "toggle_con_aria-pressed",
    "mfa_sugerido": "en pantalla de seguridad/perfil",
    "sesiones_activas": "lista + cerrar_por_dispositivo",
    "consentimiento_telemetria": "opt-in_claro"
  },
  "mocks": {
    "hooks_mock": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useCreateX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile"
    ],
    "fixtures": {
      "lat_ms": 120,
      "error_rate": 0.03,
      "user_demo": {
        "id": "<uuid_demo>",
        "name": "<UserName>",
        "email": "<user@email>",
        "prefs": {
          "lang": "es-MX",
          "theme": "light",
          "reduceMotion": false,
          "notifications": true
        }
      }
    },
    "factories": {
      "entityX": {
        "id": "<uuid>",
        "title": "<titulo_place_holder>",
        "description": "<descripcion_place_holder>",
        "status": "active",
        "createdAt": "<iso>",
        "updatedAt": "<iso>",
        "owner": { "id": "<uuid_owner>", "name": "<OwnerName>" },
        "tags": ["<tag_1>","<tag_2>"]
      }
    },
    "swap_plan": "adapters API|Firebase|Firestore|Supabase ocultos detrás de hooks"
  },
  "i18n_ux_copy": {
    "glosario": [
      "Home","Lista","Detalle","Guardar cambios","Cancelar",
      "Iniciar sesión","Crear cuenta","Recuperar acceso","Cerrar sesión",
      "Ver detalles","Continuar"
    ],
    "claves": {
      "buttons": {
        "viewItems": "Ver elementos",
        "createNew": "Crear nuevo",
        "saveChanges": "Guardar cambios",
        "cancel": "Cancelar",
        "signIn": "Iniciar sesión",
        "signUp": "Crear cuenta",
        "signOut": "Cerrar sesión",
        "viewDetails": "Ver detalles",
        "continue": "Continuar"
      },
      "errors": {
        "invalidCreds": "Credenciales inválidas.",
        "generic": "Algo salió mal. Intenta de nuevo.",
        "fieldMissing": "Revisa este campo: falta información.",
        "invalidCode": "Código inválido."
      },
      "empties": {
        "noItems": "Aún no hay elementos. Crea el primero.",
        "noData": "Aún no hay datos para mostrar aquí."
      },
      "confirmations": {
        "saved": "Listo, se guardó tu información.",
        "accessGranted": "Acceso concedido.",
        "verificationSent": "Te enviamos el correo de verificación.",
        "passwordUpdated": "Contraseña actualizada.",
        "sessionEnded": "Sesión finalizada."
      }
    },
    "locales": ["es-MX","en-US"]
  },
  "eval": {
    "datasets": {
      "golden_min": 16,
      "cobertura": [
        "happy_paths",
        "errores_login",
        "pantallas_vacias",
        "offline",
        "sesion_expirada",
        "mfa",
        "crud_completo"
      ]
    },
    "metrics": [
      "json_schema_pass",
      "hallucination",
      "groundedness",
      "readability",
      "a11y_checklist_pass"
    ],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": {
      "regresion_block": true
    }
  },
  "telemetry": {
    "eventos": [
      "view:screen","click:cta","form:submit","error:ui",
      "net:offline","net:online",
      "auth:view:splash","auth:attempt:login","auth:success:login","auth:fail:login",
      "auth:register:start","auth:register:success",
      "auth:recover:start","auth:recover:success",
      "auth:mfa:required","auth:mfa:success","auth:logout","session:expired"
    ],
    "payload_min": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso"
    },
    "privacidad": "minimizar PII; usar IDs opacos; respetar consentimiento"
  },
  "ssr_ssg_adapt": {
    "auth_guard": "server+client para rutas protegidas (si SSR)",
    "redirecciones": "server-side cuando aplique; client-side en timeout de sesión",
    "prefetch_selectivo": "Home,List,Detail tras login",
    "hydration_segura": "no inyectar tokens en HTML",
    "code_splitting": ["chunk-auth","chunk-home","chunk-dashboard","chunk-settings"],
    "cache": {
      "publicas": "SSG/ISR",
      "privadas": "CSR/SSR con SWR/react-query",
      "headers_api": "cache-control configurado por endpoint"
    }
  },
  "prioridades": {
    "top5_issues": [
      "estilos_fuera_de_tokens",
      "falta_focus_visible_en_elementos_clave",
      "CTAs_compiten_en_la_misma_pantalla",
      "estados_universales_incompletos",
      "microcopy_no_i18n_ready"
    ],
    "top5_acciones": [
      "centralizar_tokens_en_DTCG_JSON_y_migrar_componentes",
      "añadir_focus_visible_global_y_probar_con_teclado",
      "definir_CTA_primaria_por_pantalla_y_ajustar_jerarquia",
      "documentar_y_aplicar_patron_de_estados_universales",
      "construir_glosario+i18n_y_activarlo_en_flows_criticos"
    ]
  },
  "pipeline": {
    "alpha_context_plan": "filtrar_contexto→rank_score→comprimir→dedup",
    "beta_generacion": "STRUCTURED_OUTPUT_JSON + roles planner→researcher→writer→verifier",
    "gamma_validacion": "JSON_vs_SCHEMAS + A11Y + SECURITY + SEO + PWA",
    "delta_correccion": "hasta 2 reintentos con cambios mínimos",
    "epsilon_paquete": "RENDER_ORDER + checklist_DoD"
  },
  "inferencias_defecto": {
    "User_default": {
      "name": "<UserName>",
      "email": "<user@email>",
      "prefs": {
        "lang": "es-MX",
        "theme": "light",
        "reduceMotion": false,
        "notifications": true
      }
    },
    "EntityX_default": {
      "title": "Elemento de ejemplo",
      "status": "active"
    },
    "Home_titular_default": "Propuesta de valor en 5–8 palabras",
    "ctas_default": ["Continuar","Ver detalles","Crear nuevo","Guardar cambios"],
    "estados_universales_default": {
      "loading": "skeleton",
      "error": "mensaje+retry",
      "empty": "mensaje+CTA",
      "offline": "banner+fallback",
      "success": "toast"
    }
  },
  "violations": []
}
Tú dijiste:
ok ese base me gusta es la base, pero influye login , registro, mfa , olvide contraseña , home, perfifl, log ooff, dahsboard, notiificaciones, menu , infiere flatante en tdo sentido y niveles
ChatGPT Plus

Pensó durante 30s
{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_AUTH_DASHBOARD_1",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "style": "conciso",
    "densidad": "alta",
    "output": "markdown+json",
    "privacy": "no_chain_of_thought"
  },
  "flags": {
    "structured_output": "preferido",
    "json_schema": "estricto",
    "fallback_md": "on",
    "context_engineering": "on",
    "rag": "opt",
    "agentic_roles": ["planner", "researcher", "writer", "verifier"],
    "a11y": "WCAG2.1_AA",
    "seo": "on",
    "pwa": "on",
    "i18n": "on",
    "ssr_ssg": "opt",
    "security": "on",
    "privacy": "on",
    "eval": "on",
    "telemetria": "on"
  },
  "inputs_schema": {
    "PRODUCTO": {
      "nombre": "<nombre_producto>",
      "tipo": "<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Admin|Otro>",
      "dominio": "<breve_descripcion_dominio>",
      "publico": "<B2B|B2C|Mixto>",
      "objetivo_negocio": ["<objetivo_1>", "<objetivo_2>"],
      "objetivo_usuario": ["<objetivo_ux_1>", "<objetivo_ux_2>"],
      "kpi": ["<activacion|retencion|conversion|NPS|CSAT|...>"]
    },
    "USUARIOS": {
      "perfiles": [
        {
          "rol": "<stakeholder_principal>",
          "nivel": "<bajo|medio|alto>",
          "motivacion": "<que_busca_resolver>",
          "contexto": "<frecuencia_uso|situacion>"
        }
      ]
    },
    "CONTEXTO": {
      "dispositivos": ["mobile", "desktop"],
      "conectividad": "<intermitente|estable>",
      "regiones": ["<MX|LATAM|Global|...>"],
      "idioma_base": "es-MX"
    },
    "STACK_HINT": {
      "runtime": "<CSR|SSR|SSG|Hybrid>",
      "framework": "<React|Vue|Svelte|Next|Nuxt|Otro>",
      "estado_app": "<hooks|zustand|redux|query|otro>",
      "routing": "<SPA|MPA|Hybrid>"
    }
  },
  "contracto_salida": {
    "design_system": ["TOKENS_DTCG_JSON", "THEMES"],
    "atomic_library": ["atoms", "molecules", "organisms", "templates"],
    "screens": [
      "Home",
      "Dashboard",
      "Profile",
      "Notifications",
      "Menu",
      "Settings",
      "Offline",
      "Error",
      "Splash",
      "Login",
      "Register",
      "Recover",
      "MFA",
      "SessionExpired",
      "LogOff"
    ],
    "flows": [
      "F_Login",
      "F_Register",
      "F_Recover",
      "F_MFA",
      "F_SessionExpired",
      "F_LogOff",
      "F_HomeEntry",
      "F_DashboardNav",
      "F_ProfileUpdate",
      "F_Notifications",
      "F_Offline_Recovery"
    ],
    "datos": ["User", "Session", "EntityX", "Preference", "Security", "Notification", "MenuItem"],
    "a11y_seo_pwa": true,
    "security_privacy": true,
    "mocks": true,
    "i18n_ux_copy": true,
    "eval": true,
    "telemetry": true,
    "ssr_ssg_adapt": true,
    "prioridades": true
  },
  "design_system": {
    "tokens_dtcg": {
      "color": {
        "primitive": {
          "neutral": {
            "0": "#FFFFFF",
            "50": "#F7F7F8",
            "100": "#E5E5EA",
            "200": "#D1D1D6",
            "300": "#B0B0B8",
            "400": "#8E8E96",
            "500": "#636366",
            "600": "#48484A",
            "700": "#3A3A3C",
            "800": "#2C2C2E",
            "900": "#050509"
          },
          "brand": { "500": "#3366FF" },
          "accent": { "500": "#FF7AE0" },
          "ok": { "500": "#22C55E" },
          "warn": { "500": "#FFC857" },
          "err": { "500": "#FF4B4B" }
        },
        "semantic": {
          "bg": {
            "page": "{color.primitive.neutral.50}",
            "surface": "{color.primitive.neutral.0}",
            "surfaceAlt": "{color.primitive.neutral.50}"
          },
          "text": {
            "main": "{color.primitive.neutral.900}",
            "muted": "{color.primitive.neutral.500}",
            "inverse": "{color.primitive.neutral.0}"
          },
          "accent": { "main": "{color.primitive.brand.500}" },
          "border": {
            "bold": "{color.primitive.neutral.300}",
            "subtle": "{color.primitive.neutral.200}"
          },
          "state": {
            "ok": "{color.primitive.ok.500}",
            "warn": "{color.primitive.warn.500}",
            "err": "{color.primitive.err.500}"
          }
        }
      },
      "typography": {
        "family": { "base": "system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif" },
        "size": {
          "xs": "12px",
          "sm": "14px",
          "md": "16px",
          "lg": "20px",
          "xl": "24px",
          "h1": "32px",
          "h2": "24px",
          "h3": "20px"
        },
        "weight": { "reg": 400, "semib": 600, "bold": 700 },
        "line": { "tight": "1.2", "normal": "1.4", "loose": "1.6" }
      },
      "space": { "1": "4px", "2": "8px", "3": "12px", "4": "16px", "5": "24px", "6": "32px" },
      "radius": { "sm": "8px", "md": "12px", "lg": "16px", "pill": "999px" },
      "border": { "thin": "1px", "thick": "2px", "extra": "3px" },
      "shadow": {
        "soft": "0 8px 24px rgba(15,23,42,.12)",
        "lg": "0 12px 32px rgba(15,23,42,.18)"
      },
      "motion": { "fast": "150ms", "norm": "200ms", "reduced": "0ms" },
      "z": { "base": 1, "dropdown": 10, "overlay": 100, "modal": 1000, "toast": 1100 }
    },
    "theming": {
      "light": {
        "selector": ":root",
        "description": "usa tokens semantic.* para modo claro"
      },
      "dark": {
        "selector": "[data-theme='dark']",
        "description": "ajusta bg/text/accent manteniendo AA"
      },
      "high_contrast": {
        "selector": "[data-theme='hc']",
        "description": "max_contrast; no info solo por color"
      }
    }
  },
  "atomic_library": {
    "atoms": [
      {
        "name": "Text",
        "nivel": "atom",
        "semantic_role": "typography",
        "variants": ["h1", "h2", "h3", "body", "caption"],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err",
          "truncate": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["default"],
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "nivel": "atom",
        "semantic_role": "interactive-cta",
        "variants": ["primary", "secondary", "ghost", "danger"],
        "sizes": ["sm", "md", "lg"],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "disabled": "boolean",
          "loading": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["default", "hover", "focus", "disabled", "loading"],
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "nivel": "atom",
        "semantic_role": "form-field",
        "variants": ["text", "email", "password", "search", "number", "otp"],
        "props": {
          "type": "text|email|password|search|number|otp",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?",
          "hasError": "boolean"
        },
        "states": ["default", "focus", "error", "disabled"],
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "nivel": "atom",
        "semantic_role": "form-field-multiline",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "hasError": "boolean"
        },
        "states": ["default", "focus", "error", "disabled"],
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "nivel": "atom",
        "semantic_role": "binary-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "indeterminate": "boolean?"
        },
        "states": ["checked", "unchecked", "indeterminate", "disabled"],
        "testIdPattern": "chk-{label}"
      },
      {
        "name": "Radio",
        "nivel": "atom",
        "semantic_role": "exclusive-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "states": ["checked", "unchecked", "disabled"],
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "nivel": "atom",
        "semantic_role": "single-select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "states": ["default", "open", "disabled"],
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "nivel": "atom",
        "semantic_role": "filter-token|status",
        "variants": ["default", "filter", "status"],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "states": ["selected", "unselected", "disabled"],
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "nivel": "atom",
        "semantic_role": "status-indicator",
        "variants": ["neutral", "ok", "warn", "err"],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "states": ["default"],
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "nivel": "atom",
        "semantic_role": "user-identity",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "states": ["default", "fallback"],
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "nivel": "atom",
        "semantic_role": "decorative|informative",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "states": ["decorative", "informative"],
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "nivel": "atom",
        "semantic_role": "description",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "states": ["closed", "open"],
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "nivel": "atom",
        "semantic_role": "layout-separator",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "states": ["default"],
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "nivel": "atom",
        "semantic_role": "progress-indicator",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "states": ["spinning"],
        "testIdPattern": "spinner-{size}"
      },
      {
        "name": "NotificationDot",
        "nivel": "atom",
        "semantic_role": "notification-indicator",
        "props": {
          "hasUnread": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["on", "off"],
        "testIdPattern": "notif-dot"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "nivel": "molecule",
        "semantic_role": "form-field-wrapper",
        "parts": ["label", "control", "helper", "error"],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "states": ["default", "error", "disabled"],
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "nivel": "molecule",
        "semantic_role": "search-entry",
        "parts": ["icon", "input", "clear"],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "states": ["default", "with-query"],
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "nivel": "molecule",
        "semantic_role": "filter-group",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "states": ["empty", "with-selection"],
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "nivel": "molecule",
        "semantic_role": "metric-display",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "states": ["default"],
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "nivel": "molecule",
        "semantic_role": "social-login",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "states": ["default"],
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "nivel": "molecule",
        "semantic_role": "mfa-otp-input",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "states": ["empty", "partial", "full"],
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenuSummary",
        "nivel": "molecule",
        "semantic_role": "user-menu-trigger",
        "props": {
          "userName": "string",
          "avatarUrl": "string?",
          "email": "string?"
        },
        "states": ["default", "open"],
        "testIdPattern": "user-menu-summary"
      },
      {
        "name": "NotificationItem",
        "nivel": "molecule",
        "semantic_role": "notification-row",
        "props": {
          "id": "string",
          "title": "string",
          "body": "string",
          "timeAgo": "string",
          "read": "boolean",
          "type": "info|warn|err|success",
          "ctaLabel": "string?"
        },
        "states": ["unread", "read"],
        "testIdPattern": "notif-item-{id}"
      },
      {
        "name": "Toast",
        "nivel": "molecule",
        "semantic_role": "ephemeral-feedback",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "states": ["visible", "hidden"],
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "nivel": "organism",
        "semantic_role": "primary-navigation",
        "slots": ["logo", "primary-links", "secondary-actions", "user-menu"],
        "states": ["default", "scrolled"],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "AppMenu",
        "nivel": "organism",
        "semantic_role": "global-menu",
        "slots": ["user-summary", "menu-items", "footer-links"],
        "states": ["closed", "open"],
        "testIdPattern": "app-menu"
      },
      {
        "name": "SideNav",
        "nivel": "organism",
        "semantic_role": "secondary-navigation",
        "slots": ["section-links", "footer-links"],
        "states": ["expanded", "collapsed"],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "nivel": "organism",
        "semantic_role": "page-hero",
        "slots": ["eyebrow", "title", "subtitle", "ctas", "meta", "illustration"],
        "states": ["default", "compact"],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "ListView",
        "nivel": "organism",
        "semantic_role": "collection-display",
        "slots": ["filters", "results", "pagination"],
        "states": ["loading", "error", "empty", "success"],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "nivel": "organism",
        "semantic_role": "entity-detail",
        "slots": ["header", "body", "related"],
        "states": ["loading", "error", "success"],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "nivel": "organism",
        "semantic_role": "entity-form",
        "slots": ["title", "sections", "global-errors", "actions"],
        "states": ["editing", "submitting", "error", "success"],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "nivel": "organism",
        "semantic_role": "auth-form",
        "slots": ["title", "fields", "actions", "secondary-links", "legal"],
        "states": ["idle", "submitting", "error"],
        "testIdPattern": "auth-form"
      },
      {
        "name": "NotificationsPanel",
        "nivel": "organism",
        "semantic_role": "notifications-center",
        "slots": ["header", "filters", "list", "empty"],
        "states": ["loading", "error", "empty", "success"],
        "testIdPattern": "notifications-panel"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "nivel": "template",
        "semantic_role": "app-layout",
        "regions": ["header", "sidebar", "main", "footer", "toasts"],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "nivel": "template",
        "semantic_role": "auth-layout",
        "regions": ["branding", "auth-card"],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "nivel": "template",
        "semantic_role": "dashboard-layout",
        "regions": ["header", "sidebar", "main"],
        "testIdPattern": "layout-dashboard"
      }
    ]
  },
  "screens": {
    "schema": {
      "id": "string",
      "nombre": "string",
      "rol": "home|dashboard|profile|notifications|menu|settings|offline|error|auth-*",
      "route": "string",
      "objetivoUX": ["string"],
      "layout_desktop": {
        "grid_12": "boolean",
        "regiones": ["header?","main","sidebar?","footer?"]
      },
      "layout_mobile": {
        "orden_stack": ["string"],
        "colapsos": ["string?"]
      },
      "secciones": [
        {
          "nombre": "string",
          "proposito": "string",
          "componentes": ["string"]
        }
      ],
      "ctas_principales": [
        { "label": "string", "accion": "string" }
      ],
      "ctas_secundarias": [
        { "label": "string", "accion": "string" }
      ],
      "datos_minimos": ["string"],
      "datos_opcionales": ["string"],
      "estados": {
        "loading": "string",
        "error": "string",
        "empty": "string",
        "offline": "string",
        "success": "string"
      }
    },
    "blueprints": {
      "Home": {
        "id": "screen-home",
        "nombre": "Home",
        "rol": "home",
        "route": "/",
        "objetivoUX": [
          "comunicar_valor_en_5-8s",
          "ofrecer_1-2_CTAs_principales",
          "dar_contexto_minimo_del_producto"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "main", "sidebar", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["HeroShell", "Highlights", "Proof", "Footer"],
          "colapsos": ["sidebar→stack"]
        },
        "secciones": [
          {
            "nombre": "Hero",
            "proposito": "pitch_principal",
            "componentes": ["HeroShell"]
          },
          {
            "nombre": "Highlights",
            "proposito": "accesos_rapidos",
            "componentes": ["StatCard", "ListView"]
          }
        ],
        "ctas_principales": [
          { "label": "<CTA_Principal>", "accion": "<ruta_o_evento>" }
        ],
        "ctas_secundarias": [
          { "label": "<CTA_Secundaria>", "accion": "<ruta_o_evento>" }
        ],
        "datos_minimos": ["User", "EntityX[]?"],
        "datos_opcionales": ["stats_resumidas", "atajos_rapidos"],
        "estados": {
          "loading": "skeleton_hero_y_cards",
          "error": "mensaje_error_general",
          "empty": "mensaje_sin_contenido+CTA",
          "offline": "banner_offline+datos_cacheados",
          "success": "contenido_completo"
        }
      },
      "Dashboard": {
        "id": "screen-dashboard",
        "nombre": "Dashboard",
        "rol": "dashboard",
        "route": "/dashboard",
        "objetivoUX": [
          "resumen_estado_actual",
          "accesos_rapidos_a_modulos_clave"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "sidebar", "main", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["NavBar", "main", "footer"],
          "colapsos": ["sidebar→AppMenu"]
        },
        "secciones": [
          {
            "nombre": "Overview",
            "proposito": "metrics_y_resumen",
            "componentes": ["StatCard", "ListView"]
          },
          {
            "nombre": "Shortcuts",
            "proposito": "accesos_rapidos",
            "componentes": ["Chip", "Button"]
          }
        ],
        "ctas_principales": [
          { "label": "<CTA_Principal_Dashboard>", "accion": "<ruta_o_evento>" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["User", "EntityX[]?"],
        "datos_opcionales": ["Notification[]", "Preference"],
        "estados": {
          "loading": "skeleton_cards",
          "error": "mensaje_error_datos",
          "empty": "estado_sin_datos",
          "offline": "modo_lectura_sin_actualizacion",
          "success": "dashboard_completo"
        }
      },
      "Profile": {
        "id": "screen-profile",
        "nombre": "Profile",
        "rol": "profile",
        "route": "/perfil",
        "objetivoUX": [
          "gestionar_datos_personales",
          "gestionar_preferencias_y_seguridad"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "main", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["main", "footer"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "Info",
            "proposito": "datos_basicos",
            "componentes": ["Avatar", "Field(name)", "Field(email)"]
          },
          {
            "nombre": "Preferences",
            "proposito": "idioma_tema_notificaciones",
            "componentes": ["Select(lang)", "Select(theme)", "Checkbox(notifications)"]
          },
          {
            "nombre": "Security",
            "proposito": "seguridad_cuenta",
            "componentes": ["Field(password_change)", "Toggle(MFA)", "List(sessions)"]
          }
        ],
        "ctas_principales": [
          { "label": "Guardar cambios", "accion": "submit_profile" }
        ],
        "ctas_secundarias": [
          { "label": "Cerrar sesión", "accion": "→/logout" }
        ],
        "datos_minimos": ["User", "Session"],
        "datos_opcionales": ["Security"],
        "estados": {
          "loading": "cargando_datos_usuario",
          "error": "mensaje_error_y_retry",
          "empty": "perfil_sin_datos_expandido",
          "offline": "edicion_bloqueada",
          "success": "toast_guardado"
        }
      },
      "Notifications": {
        "id": "screen-notifications",
        "nombre": "Notifications",
        "rol": "notifications",
        "route": "/notificaciones",
        "objetivoUX": [
          "visualizar_notificaciones",
          "marcar_como_leida",
          "navegar_al_contexto_correspondiente"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "main", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["header", "main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "NotificationsList",
            "proposito": "lista_notificaciones",
            "componentes": ["NotificationsPanel"]
          }
        ],
        "ctas_principales": [
          { "label": "Marcar todas como leídas", "accion": "mark_all_read" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["Notification[]"],
        "datos_opcionales": [],
        "estados": {
          "loading": "skeleton_notifs",
          "error": "mensaje_error",
          "empty": "mensaje_sin_notificaciones",
          "offline": "lista_cacheada_sin_actualizar",
          "success": "lista_visible"
        }
      },
      "Menu": {
        "id": "screen-menu",
        "nombre": "Menu",
        "rol": "menu",
        "route": "/menu",
        "objetivoUX": [
          "navegacion_global",
          "cambio_de_contexto_rapido"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "GlobalMenu",
            "proposito": "agrupacion_de_rutas_y_acciones",
            "componentes": ["AppMenu"]
          }
        ],
        "ctas_principales": [],
        "ctas_secundarias": [],
        "datos_minimos": ["MenuItem[]"],
        "datos_opcionales": [],
        "estados": {
          "loading": "menu_placeholder",
          "error": "no_se_pudo_cargar_menu",
          "empty": "sin_opciones_definidas",
          "offline": "menu_local_sin_actualizar",
          "success": "menu_completo"
        }
      },
      "Login": {
        "id": "screen-login",
        "nombre": "Login",
        "rol": "auth-login",
        "route": "/login",
        "objetivoUX": [
          "permitir_acceso",
          "mantener_seguridad",
          "proceso_simple"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "AuthFormLogin",
            "proposito": "ingreso_credenciales",
            "componentes": ["AuthForm"]
          }
        ],
        "ctas_principales": [
          { "label": "Iniciar sesión", "accion": "submit_login" }
        ],
        "ctas_secundarias": [
          { "label": "Crear cuenta", "accion": "→/register" },
          { "label": "Olvidé mi contraseña", "accion": "→/recover" }
        ],
        "datos_minimos": ["credential.email", "credential.password"],
        "datos_opcionales": [],
        "estados": {
          "loading": "enviando_credenciales",
          "error": "mensaje_neutro_credenciales_invalidas",
          "empty": "form_visible",
          "offline": "submit_bloqueado",
          "success": "redirigir_a_Dashboard_o_Home"
        }
      },
      "Register": {
        "id": "screen-register",
        "nombre": "Register",
        "rol": "auth-register",
        "route": "/register",
        "objetivoUX": [
          "crear_cuenta",
          "explicar_requisitos_password"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "AuthFormRegister",
            "proposito": "registro",
            "componentes": ["AuthForm"]
          }
        ],
        "ctas_principales": [
          { "label": "Crear cuenta", "accion": "submit_register" }
        ],
        "ctas_secundarias": [
          { "label": "Ya tengo cuenta", "accion": "→/login" }
        ],
        "datos_minimos": ["user.name", "credential.email", "credential.password"],
        "datos_opcionales": [],
        "estados": {
          "loading": "enviando_registro",
          "error": "contraseña_debil_u_otro_error",
          "empty": "form_visible",
          "offline": "registro_bloqueado",
          "success": "correo_verificacion_enviado"
        }
      },
      "Recover": {
        "id": "screen-recover",
        "nombre": "Recover",
        "rol": "auth-recover",
        "route": "/recover",
        "objetivoUX": [
          "recuperar_acceso",
          "no_filtrar_existencia_usuarios"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "RecoverRequest",
            "proposito": "solicitar_reset",
            "componentes": ["Field(email)", "Button(Enviar enlace)"]
          },
          {
            "nombre": "RecoverReset",
            "proposito": "establecer_nueva_password",
            "componentes": ["Field(new_password)", "Field(confirm_password)", "Button(Confirmar)"]
          }
        ],
        "ctas_principales": [
          { "label": "Enviar enlace", "accion": "submit_recover_request" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["credential.email"],
        "datos_opcionales": ["resetToken"],
        "estados": {
          "loading": "procesando_solicitud",
          "error": "mensaje_generico",
          "empty": "form_visible",
          "offline": "no_permitir_solicitud",
          "success": "mensaje_neutro_enviado_si_existe"
        }
      },
      "MFA": {
        "id": "screen-mfa",
        "nombre": "MFA",
        "rol": "auth-mfa",
        "route": "/mfa",
        "objetivoUX": [
          "verificar_segundo_factor",
          "mantener_flujo_simple"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "MFAOTP",
            "proposito": "ingreso_de_codigo",
            "componentes": ["OTPGroup", "Button(Verificar)", "Link(Reenviar)"]
          }
        ],
        "ctas_principales": [
          { "label": "Verificar", "accion": "submit_mfa" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["credential.otp"],
        "datos_opcionales": [],
        "estados": {
          "loading": "verificando_otp",
          "error": "codigo_invalido",
          "empty": "esperando_otp",
          "offline": "no_verificar",
          "success": "acceso_concedido"
        }
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "nombre": "SessionExpired",
        "rol": "auth-session-expired",
        "route": "/session-expired",
        "objetivoUX": [
          "explicar_caducidad",
          "invitar_a_relogear"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "ExpiredMessage",
            "proposito": "mensaje",
            "componentes": ["Text.h2", "Text.body"]
          },
          {
            "nombre": "ExpiredCTA",
            "proposito": "accion",
            "componentes": ["Button(Iniciar sesión de nuevo)"]
          }
        ],
        "ctas_principales": [
          { "label": "Iniciar sesión de nuevo", "accion": "→/login" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": [],
        "datos_opcionales": [],
        "estados": {
          "loading": "—",
          "error": "—",
          "empty": "mensajes_listos",
          "offline": "informar_estado",
          "success": "redirigir_a_login"
        }
      },
      "LogOff": {
        "id": "screen-logoff",
        "nombre": "LogOff",
        "rol": "auth-logoff",
        "route": "/logout",
        "objetivoUX": [
          "terminar_sesion",
          "redirigir_a_punto_de_entrada_seguro"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "LogOffConfirm",
            "proposito": "salida_segura",
            "componentes": ["Text.body", "Button(Cerrar sesión)", "Button(Cancelar)"]
          }
        ],
        "ctas_principales": [
          { "label": "Cerrar sesión", "accion": "revocar_tokens→redirigir→/login" }
        ],
        "ctas_secundarias": [
          { "label": "Cancelar", "accion": "back" }
        ],
        "datos_minimos": ["Session.id"],
        "datos_opcionales": [],
        "estados": {
          "loading": "cerrando_sesion",
          "error": "mensaje_error",
          "empty": "confirm_visible",
          "offline": "indicar_que_no_se_puede_desloguear_del_servidor",
          "success": "redirigir_a_login"
        }
      }
    }
  },
  "flows": {
    "F_Login": {
      "id": "F_Login",
      "nombre": "Login",
      "pasos": [
        {
          "pantalla": "Login",
          "tarea": "capturar_email_y_password",
          "entrada": ["credential.email", "credential.password"],
          "salida": "credenciales_listas",
          "estado": "idle"
        },
        {
          "pantalla": "Login",
          "tarea": "enviar_credenciales",
          "entrada": ["credenciales_listas"],
          "salida": "ok|requiere_mfa|error",
          "estado": "loading",
          "error": {
            "mensaje": "Credenciales inválidas.",
            "recuperacion": ["mantener_mensaje_neutro", "permitir_reintento"]
          }
        },
        {
          "pantalla": "MFA",
          "tarea": "verificar_segundo_factor_si_aplica",
          "entrada": ["estado=requiere_mfa"],
          "salida": "acceso_concedido|error_otp",
          "estado": "loading",
          "error": {
            "mensaje": "Código inválido.",
            "recuperacion": ["mostrar_opcion_reenviar"]
          }
        },
        {
          "pantalla": "Dashboard|Home",
          "tarea": "mostrar_vista_principal_post_login",
          "entrada": ["estado=acceso_concedido"],
          "salida": "sesion_activa",
          "estado": "success"
        }
      ],
      "ramificaciones": [
        {
          "condicion": "requiere_mfa",
          "destino": "pantalla=MFA"
        },
        {
          "condicion": "ok_sin_mfa",
          "destino": "pantalla=Dashboard|Home"
        }
      ],
      "exito": {
        "definicion": "usuario_autenticado_y_dirigido_a_vista_principal"
      }
    },
    "F_Register": {
      "id": "F_Register",
      "nombre": "Register",
      "pasos": [
        {
          "pantalla": "Register",
          "tarea": "capturar_datos_y_aceptar_terminos",
          "entrada": ["user.name", "credential.email", "credential.password"],
          "salida": "datos_listos",
          "estado": "idle"
        },
        {
          "pantalla": "Register",
          "tarea": "enviar_registro",
          "entrada": ["datos_listos"],
          "salida": "registro_ok|error",
          "estado": "loading",
          "error": {
            "mensaje": "Contraseña débil u otro error.",
            "recuperacion": ["mostrar_reglas_password", "permitir_reintento"]
          }
        },
        {
          "pantalla": "Login",
          "tarea": "permitir_login_post_registro",
          "entrada": ["registro_ok"],
          "salida": "usuario_puede_iniciar_sesion",
          "estado": "success"
        }
      ],
      "ramificaciones": [],
      "exito": {
        "definicion": "cuenta_creada_y_usuario_listo_para_iniciar_sesion"
      }
    },
    "F_Recover": {
      "id": "F_Recover",
      "nombre": "Recover",
      "pasos": [
        {
          "pantalla": "Recover",
          "tarea": "solicitar_reset_por_email",
          "entrada": ["credential.email"],
          "salida": "solicitud_enviada",
          "estado": "loading",
          "error": {
            "mensaje": "Error al solicitar reset.",
            "recuperacion": ["mensaje_generico", "retry"]
          }
        },
        {
          "pantalla": "Recover",
          "tarea": "establecer_nueva_password",
          "entrada": ["resetToken", "new_password"],
          "salida": "password_actualizada",
          "estado": "loading"
        },
        {
          "pantalla": "Login",
          "tarea": "permitir_login_con_nueva_password",
          "entrada": ["password_actualizada"],
          "salida": "listo_para_login",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_puede_recuperar_acceso_sin_filtrar_existencia_de_cuenta"
      }
    },
    "F_MFA": {
      "id": "F_MFA",
      "nombre": "MFA",
      "pasos": [
        {
          "pantalla": "MFA",
          "tarea": "capturar_otp",
          "entrada": ["credential.otp"],
          "salida": "otp_listo",
          "estado": "idle"
        },
        {
          "pantalla": "MFA",
          "tarea": "validar_otp",
          "entrada": ["otp_listo"],
          "salida": "ok|error",
          "estado": "loading",
          "error": {
            "mensaje": "Código inválido.",
            "recuperacion": ["permitir_reintento", "opcion_reenviar_otp"]
          }
        },
        {
          "pantalla": "Dashboard|Home",
          "tarea": "entrar_post_mfa",
          "entrada": ["ok"],
          "salida": "sesion_activa",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "segundo_factor_validado_y_usuario_en_vista_principal"
      }
    },
    "F_SessionExpired": {
      "id": "F_SessionExpired",
      "nombre": "SessionExpired",
      "pasos": [
        {
          "pantalla": "SessionExpired",
          "tarea": "informar_caducidad",
          "entrada": ["evento_timeout"],
          "salida": "usuario_entendido",
          "estado": "idle"
        },
        {
          "pantalla": "SessionExpired",
          "tarea": "redirigir_a_login",
          "entrada": ["usuario_entendido"],
          "salida": "login_visible",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "sesion_expirada_manejada_sin_confusion_ni_fuga_de_datos"
      }
    },
    "F_LogOff": {
      "id": "F_LogOff",
      "nombre": "LogOff",
      "pasos": [
        {
          "pantalla": "Profile|Menu",
          "tarea": "click_cerrar_sesion",
          "entrada": ["accion_usuario"],
          "salida": "confirmacion",
          "estado": "idle"
        },
        {
          "pantalla": "LogOff",
          "tarea": "confirmar_y_revocar_tokens",
          "entrada": ["Session.id"],
          "salida": "sesion_cerrada",
          "estado": "loading"
        },
        {
          "pantalla": "Splash|Login",
          "tarea": "redirigir_a_entrada_segura",
          "entrada": ["sesion_cerrada"],
          "salida": "pantalla_inicio_auth",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "sesion_cerrada_en_servidor_y_UI_en_estado_seguro"
      }
    },
    "F_HomeEntry": {
      "id": "F_HomeEntry",
      "nombre": "HomeEntry",
      "pasos": [
        {
          "pantalla": "Home",
          "tarea": "mostrar_pitch",
          "entrada": ["User?"],
          "salida": "usuario_entendido_valor",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_sabe_que_hace_el_producto_y_que_puede_hacer_siguiente"
      }
    },
    "F_DashboardNav": {
      "id": "F_DashboardNav",
      "nombre": "DashboardNav",
      "pasos": [
        {
          "pantalla": "Dashboard",
          "tarea": "mostrar_resumen",
          "entrada": ["User", "EntityX[]?"],
          "salida": "overview_visible",
          "estado": "success"
        },
        {
          "pantalla": "Dashboard",
          "tarea": "usar_menu_o_sidebar_para_navegar",
          "entrada": ["click_menu"],
          "salida": "pantalla_destino",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_navega_entre_modulos_desde_dashboard"
      }
    },
    "F_Notifications": {
      "id": "F_Notifications",
      "nombre": "Notifications",
      "pasos": [
        {
          "pantalla": "Home|Dashboard",
          "tarea": "ver_indicador_notificaciones",
          "entrada": ["Notification[]"],
          "salida": "has_unread|all_read",
          "estado": "idle"
        },
        {
          "pantalla": "Notifications",
          "tarea": "listar_notificaciones",
          "entrada": ["Notification[]"],
          "salida": "lista_visible",
          "estado": "success"
        },
        {
          "pantalla": "Notifications",
          "tarea": "marcar_como_leida",
          "entrada": ["Notification.id"],
          "salida": "actualizar_estado",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_entiende_y_gestiona_notificaciones_sin_ruido"
      }
    },
    "F_Offline_Recovery": {
      "id": "F_Offline_Recovery",
      "nombre": "Offline_Recovery",
      "pasos": [
        {
          "pantalla": "Offline|cualquier",
          "tarea": "detectar_offline",
          "entrada": ["network_status=offline"],
          "salida": "mostrar_estado",
          "estado": "idle"
        },
        {
          "pantalla": "Offline",
          "tarea": "intentar_reconexion",
          "entrada": ["click_reintentar"],
          "salida": "network_status=online?",
          "estado": "loading"
        },
        {
          "pantalla": "pantalla_previa",
          "tarea": "restaurar_estado_previo",
          "entrada": ["online"],
          "salida": "flujo_recuperado",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_puede_retomar_tarea_tras_offline"
      }
    }
  },
  "telemetry": {
    "eventos_core": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired",
      "notif:view",
      "notif:click",
      "menu:open",
      "menu:item_click"
    ],
    "payload_min": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso"
    }
  },
  "prioridades": {
    "top5_issues": [
      "estilos_fuera_de_tokens",
      "falta_focus_visible_en_componentes_clave",
      "CTAs_compiten_en_home_y_dashboard",
      "estados_universales_incompletos_en_auth_y_core",
      "microcopy_no_i18n_ready_en_mensajes_auth_y_notificaciones"
    ],
    "top5_acciones": [
      "migrar_todos_los_colores_y_spacings_a_TOKENS_DTCG_JSON",
      "aplicar_focus_visible_global_y_probar_navegacion_con_teclado",
      "definir_CTA_primaria_por_pantalla(Home,Dashboard,Login)",
      "documentar_y_aplicar_patron_estados_universales_para_todas_las_pantallas",
      "extraer_microcopy_a_tablas_i18n_para_es-MX_y_en-US"
    ]
  },
  "inferencias_defecto": {
    "User_default": {
      "name": "<UserName>",
      "email": "<user@email>",
      "prefs": {
        "lang": "es-MX",
        "theme": "light",
        "reduceMotion": false,
        "notifications": true
      }
    },
    "EntityX_default": {
      "title": "Elemento de ejemplo",
      "status": "active"
    },
    "Home_titular_default": "Propuesta de valor en 5–8 palabras",
    "ctas_default": ["Continuar", "Ver detalles", "Crear nuevo", "Guardar cambios"],
    "estados_universales_default": {
      "loading": "skeleton",
      "error": "mensaje+retry",
      "empty": "mensaje+CTA",
      "offline": "banner+fallback",
      "success": "toast"
    }
  },
  "guard": {
    "rules": [
      "NO_META",
      "NO_DRY",
      "NO_REPEAT",
      "ANTI_INJ_STRICT",
      "CTX_ISOLATE",
      "CONSIST",
      "FACT_CHECK",
      "RECENCY_CHECK",
      "DATE_DRIFT_DETECT",
      "DISINFO_HYGIENE",
      "HALLUCINATION_DETECT",
      "PII_STRICT",
      "SECRET_STRICT",
      "SEMANTIC_DEDUP",
      "LEXICAL_DEDUP",
      "SINGLE_OUTPUT",
      "TOOL_ONLY_REAL",
      "NO_ASYNC_WORK",
      "NO_TIME_ESTIMATES"
    ]
  },
  "violations": []
}
Tú dijiste:
dame completo lo que no me diste no puede repetir esto dado dame lo que falat 
ChatGPT Plus

Pensó durante 36s
{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_AUTH_DASHBOARD_EXTRA_1",

  "entities_extra": {
    "Notification": {
      "description": "Entidad genérica de notificación para centro de notificaciones, badge en navbar y toasts.",
      "fields": {
        "id": "string|uuid",
        "title": "string",
        "body": "string",
        "type": "info|warn|err|success",
        "createdAt": "iso",
        "readAt": "iso|null",
        "read": "boolean",
        "source": "string?",          

        "ctaLabel": "string?",        
        "ctaRoute": "string?",        
        "ctaEntityId": "string?",     

        "category": "system|security|billing|activity|other",
        "priority": "low|normal|high",
        "sticky": "boolean",
        "expiresAt": "iso|null",      

        "meta": "object?"             
      }
    },

    "MenuItem": {
      "description": "Item de menú global para nav principal, side nav o menú tipo drawer.",
      "fields": {
        "id": "string",
        "label": "string",
        "icon": "string?",
        "path": "string?",           
        "external": "boolean?",
        "section": "string?",        

        "order": "number?",
        "badge": "string?",
        "requiresAuth": "boolean",
        "rolesAllowed": "string[]?",  
        "featureFlag": "string?",     

        "children": "MenuItem[]?",    
        "meta": "object?"             
      }
    }
  },

  "screens_extra_blueprints": {
    "Settings": {
      "id": "screen-settings",
      "nombre": "Settings",
      "rol": "settings",
      "route": "/settings",
      "objetivoUX": [
        "permitir_configurar_preferencias_personales",
        "exponer_opciones_clave_sin_ruido"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["header", "sidebar", "main", "footer"]
      },
      "layout_mobile": {
        "orden_stack": ["header", "main", "footer"],
        "colapsos": ["sidebar→drawer|menu"]
      },
      "secciones": [
        {
          "nombre": "General",
          "proposito": "preferencias_generales",
          "componentes": [
            "Field(language)",
            "Field(theme)",
            "Field(density)"
          ]
        },
        {
          "nombre": "Notifications",
          "proposito": "preferencias_notificaciones",
          "componentes": [
            "Checkbox(email_notifications)",
            "Checkbox(push_notifications)",
            "Checkbox(product_updates)"
          ]
        },
        {
          "nombre": "Privacy",
          "proposito": "controles_privacidad",
          "componentes": [
            "Checkbox(telemetry_opt_in)",
            "Button(Download data)?",
            "Button(Delete account)?"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Guardar cambios", "accion": "submit_settings" }
      ],
      "ctas_secundarias": [
        { "label": "Descartar cambios", "accion": "reset_form" }
      ],
      "datos_minimos": ["User.prefs"],
      "datos_opcionales": ["Security", "Preference"],
      "estados": {
        "loading": "cargando_preferencias",
        "error": "error_al_cargar_o_guardar",
        "empty": "sin_preferencias_definidas_aun",
        "offline": "edicion_desactivada+mensaje_offline",
        "success": "toast_preferencias_guardadas"
      }
    },

    "Help": {
      "id": "screen-help",
      "nombre": "Help",
      "rol": "help",
      "route": "/help",
      "objetivoUX": [
        "resolver_dudas_frecuentes",
        "habilitar_contacto_con_soporte"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["header", "main", "footer"]
      },
      "layout_mobile": {
        "orden_stack": ["FAQ", "Contact"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "FAQ",
          "proposito": "respuestas_rapidas",
          "componentes": [
            "SearchBar",
            "Accordion(FAQItems)"
          ]
        },
        {
          "nombre": "Contact",
          "proposito": "contacto_soporte",
          "componentes": [
            "Field(subject)",
            "Field(message)",
            "Button(Enviar mensaje)"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Enviar mensaje", "accion": "submit_help_form" }
      ],
      "ctas_secundarias": [
        { "label": "Ver documentación", "accion": "<ruta_docs>" }
      ],
      "datos_minimos": [],
      "datos_opcionales": ["FAQItem[]"],
      "estados": {
        "loading": "cargando_FAQ",
        "error": "error_al_cargar_FAQ_o_enviar_contacto",
        "empty": "sin_FAQ_configuradas",
        "offline": "solo_FAQ_cacheadas_sin_contact_form",
        "success": "mensaje_enviado|respuesta_mostrada"
      }
    },

    "Offline": {
      "id": "screen-offline",
      "nombre": "Offline",
      "rol": "offline",
      "route": "/offline",
      "objetivoUX": [
        "explicar_estado_sin_conexion",
        "ofrecer_reintento_o_modo_lectura"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["main"]
      },
      "layout_mobile": {
        "orden_stack": ["main"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "OfflineBanner",
          "proposito": "mensajes_offline",
          "componentes": [
            "Icon24(warn)",
            "Text.h2",
            "Text.body"
          ]
        },
        {
          "nombre": "OfflineActions",
          "proposito": "acciones_de_recuperacion",
          "componentes": [
            "Button(Reintentar)",
            "Button(Ir a Home en modo lectura)?"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Reintentar", "accion": "retry_network" }
      ],
      "ctas_secundarias": [
        { "label": "Ir a Home", "accion": "→/" }
      ],
      "datos_minimos": [],
      "datos_opcionales": ["estado_prev_screen"],
      "estados": {
        "loading": "tratando_de_reconectar",
        "error": "no_se_pudo_reconectar",
        "empty": "solo_banner",
        "offline": "estado_principal",
        "success": "redirigir_a_pantalla_previa"
      }
    },

    "Error": {
      "id": "screen-error",
      "nombre": "Error",
      "rol": "error",
      "route": "/error",
      "objetivoUX": [
        "explicar_error",
        "ofrecer_ruta_segura"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["main"]
      },
      "layout_mobile": {
        "orden_stack": ["main"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "ErrorMessage",
          "proposito": "descripcion_del_error",
          "componentes": [
            "Icon24(err)",
            "Text.h2",
            "Text.body"
          ]
        },
        {
          "nombre": "ErrorActions",
          "proposito": "recuperacion",
          "componentes": [
            "Button(Ir al inicio)",
            "Button(Volver)"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Ir al inicio", "accion": "→/" }
      ],
      "ctas_secundarias": [
        { "label": "Volver", "accion": "history.back()" }
      ],
      "datos_minimos": ["error_code?"],
      "datos_opcionales": ["error_details?"],
      "estados": {
        "loading": "—",
        "error": "pantalla_en_si_misma",
        "empty": "error_generico_sin_detalles",
        "offline": "combinar_con_mensaje_offline_si_aplica",
        "success": "—"
      }
    },

    "Splash": {
      "id": "screen-splash",
      "nombre": "Splash",
      "rol": "auth-splash",
      "route": "/splash",
      "objetivoUX": [
        "mostrar_branding_minimo",
        "determinar_ruta_inicial(Login|Dashboard|Home)"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["main"]
      },
      "layout_mobile": {
        "orden_stack": ["main"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "Branding",
          "proposito": "identidad",
          "componentes": [
            "Logo",
            "Text.body"
          ]
        },
        {
          "nombre": "Progress",
          "proposito": "estado_de_verificacion",
          "componentes": [
            "Spinner",
            "Text.caption"
          ]
        }
      ],
      "ctas_principales": [],
      "ctas_secundarias": [],
      "datos_minimos": ["Session?"],
      "datos_opcionales": [],
      "estados": {
        "loading": "verificando_sesion",
        "error": "fallo_al_verificar_sesion",
        "empty": "—",
        "offline": "mostrar_mensaje_offline + opcion_ir_a_login",
        "success": "redirigir_a_Login|Home|Dashboard"
      }
    }
  },

  "eval_extra": {
    "casos_golden_auth": [
      "login_exitoso_sin_mfa",
      "login_exitoso_con_mfa",
      "login_credenciales_invalidas",
      "registro_cuenta_nueva",
      "registro_password_debil",
      "recover_solicitud_exitosa_mensaje_neutro",
      "recover_reset_password_ok",
      "session_expirada_redirige_a_login",
      "logoff_cierra_sesion_y_redirige"
    ],
    "casos_golden_dashboard": [
      "dashboard_con_datos",
      "dashboard_sin_datos_muestra_empty_state",
      "dashboard_error_muestra_mensaje_y_retry"
    ],
    "casos_golden_notifications": [
      "hay_notificaciones_no_leidas_bagde_on",
      "lista_notificaciones_vacia_muestra_empty_state",
      "marcar_notificacion_como_leida_actualiza_UI"
    ],
    "checks_formales": {
      "json_schema_pass": "validar_contra_todos_los_SCHEMAS",
      "a11y_core": "pasar_checklist_A11Y_SCHEMA_en_login,home,dashboard,profile",
      "security_auth": "mensajes_neutros, no enumerar usuarios, password_meter_activo",
      "pwa_critico": "manifest+service_worker+offline_fallback_configurados"
    }
  },

  "ssr_ssg_adapt_extra": {
    "routes_ssg_recomendadas": [
      "/",
      "/login",
      "/register",
      "/help",
      "/offline",
      "/error"
    ],
    "routes_ssr_recomendadas": [
      "/dashboard",
      "/perfil",
      "/notificaciones"
    ],
    "guards_detalle": {
      "public_routes": ["/", "/login", "/register", "/recover", "/help", "/offline", "/error"],
      "protected_routes": ["/dashboard", "/perfil", "/notificaciones", "/settings"]
    }
  },

  "checklist_DoD_extra": [
    "Todos los flujos de auth (Login/Register/Recover/MFA/SessionExpired/LogOff) tienen estados loading/error/empty/offline/success definidos.",
    "Home/Dashboard tienen CTAs primarias y secundarias claramente diferenciadas.",
    "Profile/Settings exponen cambios de preferencias y seguridad con feedback visible y accesible.",
    "Notifications/NotificationsPanel manejan estados: no leídas, leídas, vacío, error y offline.",
    "Menu/AppMenu soporta jerarquía (MenuItem.children) y feature flags sin romper la navegación."
  ],

  "violations": []
}
Tú dijiste:
# 

{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_AUTH_DASHBOARD_1",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "style": "conciso",
    "densidad": "alta",
    "output": "markdown+json",
    "privacy": "no_chain_of_thought"
  },
  "flags": {
    "structured_output": "preferido",
    "json_schema": "estricto",
    "fallback_md": "on",
    "context_engineering": "on",
    "rag": "opt",
    "agentic_roles": ["planner", "researcher", "writer", "verifier"],
    "a11y": "WCAG2.1_AA",
    "seo": "on",
    "pwa": "on",
    "i18n": "on",
    "ssr_ssg": "opt",
    "security": "on",
    "privacy": "on",
    "eval": "on",
    "telemetria": "on"
  },
  "inputs_schema": {
    "PRODUCTO": {
      "nombre": "<nombre_producto>",
      "tipo": "<SaaS|Ecommerce|Marketplace|Contenido|Portafolio|Admin|Otro>",
      "dominio": "<breve_descripcion_dominio>",
      "publico": "<B2B|B2C|Mixto>",
      "objetivo_negocio": ["<objetivo_1>", "<objetivo_2>"],
      "objetivo_usuario": ["<objetivo_ux_1>", "<objetivo_ux_2>"],
      "kpi": ["<activacion|retencion|conversion|NPS|CSAT|...>"]
    },
    "USUARIOS": {
      "perfiles": [
        {
          "rol": "<stakeholder_principal>",
          "nivel": "<bajo|medio|alto>",
          "motivacion": "<que_busca_resolver>",
          "contexto": "<frecuencia_uso|situacion>"
        }
      ]
    },
    "CONTEXTO": {
      "dispositivos": ["mobile", "desktop"],
      "conectividad": "<intermitente|estable>",
      "regiones": ["<MX|LATAM|Global|...>"],
      "idioma_base": "es-MX"
    },
    "STACK_HINT": {
      "runtime": "<CSR|SSR|SSG|Hybrid>",
      "framework": "<React|Vue|Svelte|Next|Nuxt|Otro>",
      "estado_app": "<hooks|zustand|redux|query|otro>",
      "routing": "<SPA|MPA|Hybrid>"
    }
  },
  "contracto_salida": {
    "design_system": ["TOKENS_DTCG_JSON", "THEMES"],
    "atomic_library": ["atoms", "molecules", "organisms", "templates"],
    "screens": [
      "Home",
      "Dashboard",
      "Profile",
      "Notifications",
      "Menu",
      "Settings",
      "Offline",
      "Error",
      "Splash",
      "Login",
      "Register",
      "Recover",
      "MFA",
      "SessionExpired",
      "LogOff"
    ],
    "flows": [
      "F_Login",
      "F_Register",
      "F_Recover",
      "F_MFA",
      "F_SessionExpired",
      "F_LogOff",
      "F_HomeEntry",
      "F_DashboardNav",
      "F_ProfileUpdate",
      "F_Notifications",
      "F_Offline_Recovery"
    ],
    "datos": ["User", "Session", "EntityX", "Preference", "Security", "Notification", "MenuItem"],
    "a11y_seo_pwa": true,
    "security_privacy": true,
    "mocks": true,
    "i18n_ux_copy": true,
    "eval": true,
    "telemetry": true,
    "ssr_ssg_adapt": true,
    "prioridades": true
  },
  "design_system": {
    "tokens_dtcg": {
      "color": {
        "primitive": {
          "neutral": {
            "0": "#FFFFFF",
            "50": "#F7F7F8",
            "100": "#E5E5EA",
            "200": "#D1D1D6",
            "300": "#B0B0B8",
            "400": "#8E8E96",
            "500": "#636366",
            "600": "#48484A",
            "700": "#3A3A3C",
            "800": "#2C2C2E",
            "900": "#050509"
          },
          "brand": { "500": "#3366FF" },
          "accent": { "500": "#FF7AE0" },
          "ok": { "500": "#22C55E" },
          "warn": { "500": "#FFC857" },
          "err": { "500": "#FF4B4B" }
        },
        "semantic": {
          "bg": {
            "page": "{color.primitive.neutral.50}",
            "surface": "{color.primitive.neutral.0}",
            "surfaceAlt": "{color.primitive.neutral.50}"
          },
          "text": {
            "main": "{color.primitive.neutral.900}",
            "muted": "{color.primitive.neutral.500}",
            "inverse": "{color.primitive.neutral.0}"
          },
          "accent": { "main": "{color.primitive.brand.500}" },
          "border": {
            "bold": "{color.primitive.neutral.300}",
            "subtle": "{color.primitive.neutral.200}"
          },
          "state": {
            "ok": "{color.primitive.ok.500}",
            "warn": "{color.primitive.warn.500}",
            "err": "{color.primitive.err.500}"
          }
        }
      },
      "typography": {
        "family": { "base": "system-ui, -apple-system, 'Segoe UI', Inter, Roboto, sans-serif" },
        "size": {
          "xs": "12px",
          "sm": "14px",
          "md": "16px",
          "lg": "20px",
          "xl": "24px",
          "h1": "32px",
          "h2": "24px",
          "h3": "20px"
        },
        "weight": { "reg": 400, "semib": 600, "bold": 700 },
        "line": { "tight": "1.2", "normal": "1.4", "loose": "1.6" }
      },
      "space": { "1": "4px", "2": "8px", "3": "12px", "4": "16px", "5": "24px", "6": "32px" },
      "radius": { "sm": "8px", "md": "12px", "lg": "16px", "pill": "999px" },
      "border": { "thin": "1px", "thick": "2px", "extra": "3px" },
      "shadow": {
        "soft": "0 8px 24px rgba(15,23,42,.12)",
        "lg": "0 12px 32px rgba(15,23,42,.18)"
      },
      "motion": { "fast": "150ms", "norm": "200ms", "reduced": "0ms" },
      "z": { "base": 1, "dropdown": 10, "overlay": 100, "modal": 1000, "toast": 1100 }
    },
    "theming": {
      "light": {
        "selector": ":root",
        "description": "usa tokens semantic.* para modo claro"
      },
      "dark": {
        "selector": "[data-theme='dark']",
        "description": "ajusta bg/text/accent manteniendo AA"
      },
      "high_contrast": {
        "selector": "[data-theme='hc']",
        "description": "max_contrast; no info solo por color"
      }
    }
  },
  "atomic_library": {
    "atoms": [
      {
        "name": "Text",
        "nivel": "atom",
        "semantic_role": "typography",
        "variants": ["h1", "h2", "h3", "body", "caption"],
        "props": {
          "variant": "h1|h2|h3|body|caption",
          "as": "h1|h2|h3|p|span",
          "align": "left|center|right",
          "color": "text.main|text.muted|accent.main|state.ok|state.warn|state.err",
          "truncate": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["default"],
        "testIdPattern": "text-{variant}"
      },
      {
        "name": "Button",
        "nivel": "atom",
        "semantic_role": "interactive-cta",
        "variants": ["primary", "secondary", "ghost", "danger"],
        "sizes": ["sm", "md", "lg"],
        "props": {
          "variant": "primary|secondary|ghost|danger",
          "size": "sm|md|lg",
          "iconLeft": "ReactNode?",
          "iconRight": "ReactNode?",
          "fullWidth": "boolean",
          "disabled": "boolean",
          "loading": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["default", "hover", "focus", "disabled", "loading"],
        "testIdPattern": "btn-{variant}-{size}"
      },
      {
        "name": "Input",
        "nivel": "atom",
        "semantic_role": "form-field",
        "variants": ["text", "email", "password", "search", "number", "otp"],
        "props": {
          "type": "text|email|password|search|number|otp",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "autoComplete": "string",
          "ariaLabel": "string?",
          "hasError": "boolean"
        },
        "states": ["default", "focus", "error", "disabled"],
        "testIdPattern": "input-{type}"
      },
      {
        "name": "Textarea",
        "nivel": "atom",
        "semantic_role": "form-field-multiline",
        "props": {
          "rows": "number",
          "value": "string",
          "onChange": "function",
          "placeholder": "string",
          "hasError": "boolean"
        },
        "states": ["default", "focus", "error", "disabled"],
        "testIdPattern": "textarea-base"
      },
      {
        "name": "Checkbox",
        "nivel": "atom",
        "semantic_role": "binary-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "indeterminate": "boolean?"
        },
        "states": ["checked", "unchecked", "indeterminate", "disabled"],
        "testIdPattern": "chk-{label}"
      },
      {
        "name": "Radio",
        "nivel": "atom",
        "semantic_role": "exclusive-choice",
        "props": {
          "checked": "boolean",
          "onChange": "function",
          "label": "string",
          "name": "string",
          "value": "string"
        },
        "states": ["checked", "unchecked", "disabled"],
        "testIdPattern": "radio-{name}-{value}"
      },
      {
        "name": "Select",
        "nivel": "atom",
        "semantic_role": "single-select",
        "props": {
          "options": "Array<{label,value}>",
          "value": "string",
          "onChange": "function",
          "placeholder": "string"
        },
        "states": ["default", "open", "disabled"],
        "testIdPattern": "select-{name}"
      },
      {
        "name": "Chip",
        "nivel": "atom",
        "semantic_role": "filter-token|status",
        "variants": ["default", "filter", "status"],
        "props": {
          "label": "string",
          "selected": "boolean",
          "onClick": "function?"
        },
        "states": ["selected", "unselected", "disabled"],
        "testIdPattern": "chip-{label}"
      },
      {
        "name": "Badge",
        "nivel": "atom",
        "semantic_role": "status-indicator",
        "variants": ["neutral", "ok", "warn", "err"],
        "props": {
          "label": "string",
          "variant": "neutral|ok|warn|err"
        },
        "states": ["default"],
        "testIdPattern": "badge-{variant}"
      },
      {
        "name": "Avatar",
        "nivel": "atom",
        "semantic_role": "user-identity",
        "props": {
          "src": "string?",
          "alt": "string",
          "size": "32|40|64"
        },
        "states": ["default", "fallback"],
        "testIdPattern": "avatar-{size}"
      },
      {
        "name": "Icon24",
        "nivel": "atom",
        "semantic_role": "decorative|informative",
        "props": {
          "name": "string",
          "ariaLabel": "string?"
        },
        "states": ["decorative", "informative"],
        "testIdPattern": "icon-{name}"
      },
      {
        "name": "Tooltip",
        "nivel": "atom",
        "semantic_role": "description",
        "props": {
          "content": "string",
          "side": "top|right|bottom|left"
        },
        "states": ["closed", "open"],
        "testIdPattern": "tooltip-{id}"
      },
      {
        "name": "Divider",
        "nivel": "atom",
        "semantic_role": "layout-separator",
        "props": {
          "orientation": "horizontal|vertical"
        },
        "states": ["default"],
        "testIdPattern": "divider-{orientation}"
      },
      {
        "name": "Spinner",
        "nivel": "atom",
        "semantic_role": "progress-indicator",
        "props": {
          "size": "sm|md|lg",
          "ariaLabel": "string"
        },
        "states": ["spinning"],
        "testIdPattern": "spinner-{size}"
      },
      {
        "name": "NotificationDot",
        "nivel": "atom",
        "semantic_role": "notification-indicator",
        "props": {
          "hasUnread": "boolean",
          "ariaLabel": "string?"
        },
        "states": ["on", "off"],
        "testIdPattern": "notif-dot"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "nivel": "molecule",
        "semantic_role": "form-field-wrapper",
        "parts": ["label", "control", "helper", "error"],
        "props": {
          "id": "string",
          "label": "string",
          "required": "boolean",
          "helperText": "string?",
          "errorText": "string?"
        },
        "states": ["default", "error", "disabled"],
        "testIdPattern": "field-{id}"
      },
      {
        "name": "SearchBar",
        "nivel": "molecule",
        "semantic_role": "search-entry",
        "parts": ["icon", "input", "clear"],
        "props": {
          "placeholder": "string",
          "value": "string",
          "onChange": "function"
        },
        "states": ["default", "with-query"],
        "testIdPattern": "search-bar"
      },
      {
        "name": "FilterChips",
        "nivel": "molecule",
        "semantic_role": "filter-group",
        "props": {
          "options": "Array<{id,label}>",
          "selectedIds": "string[]",
          "onToggle": "function"
        },
        "states": ["empty", "with-selection"],
        "testIdPattern": "filter-chips"
      },
      {
        "name": "StatCard",
        "nivel": "molecule",
        "semantic_role": "metric-display",
        "props": {
          "label": "string",
          "value": "string|number",
          "trend": "up|down|neutral?",
          "helper": "string?"
        },
        "states": ["default"],
        "testIdPattern": "stat-card-{label}"
      },
      {
        "name": "OAuthButtons",
        "nivel": "molecule",
        "semantic_role": "social-login",
        "props": {
          "providers": "Array<'google'|'github'|'apple'>"
        },
        "states": ["default"],
        "testIdPattern": "oauth-buttons"
      },
      {
        "name": "OTPGroup",
        "nivel": "molecule",
        "semantic_role": "mfa-otp-input",
        "props": {
          "length": "number",
          "value": "string",
          "onChange": "function"
        },
        "states": ["empty", "partial", "full"],
        "testIdPattern": "otp-group"
      },
      {
        "name": "UserMenuSummary",
        "nivel": "molecule",
        "semantic_role": "user-menu-trigger",
        "props": {
          "userName": "string",
          "avatarUrl": "string?",
          "email": "string?"
        },
        "states": ["default", "open"],
        "testIdPattern": "user-menu-summary"
      },
      {
        "name": "NotificationItem",
        "nivel": "molecule",
        "semantic_role": "notification-row",
        "props": {
          "id": "string",
          "title": "string",
          "body": "string",
          "timeAgo": "string",
          "read": "boolean",
          "type": "info|warn|err|success",
          "ctaLabel": "string?"
        },
        "states": ["unread", "read"],
        "testIdPattern": "notif-item-{id}"
      },
      {
        "name": "Toast",
        "nivel": "molecule",
        "semantic_role": "ephemeral-feedback",
        "props": {
          "type": "success|error|info",
          "message": "string",
          "durationMs": "number"
        },
        "states": ["visible", "hidden"],
        "testIdPattern": "toast-{type}"
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "nivel": "organism",
        "semantic_role": "primary-navigation",
        "slots": ["logo", "primary-links", "secondary-actions", "user-menu"],
        "states": ["default", "scrolled"],
        "testIdPattern": "navbar-main"
      },
      {
        "name": "AppMenu",
        "nivel": "organism",
        "semantic_role": "global-menu",
        "slots": ["user-summary", "menu-items", "footer-links"],
        "states": ["closed", "open"],
        "testIdPattern": "app-menu"
      },
      {
        "name": "SideNav",
        "nivel": "organism",
        "semantic_role": "secondary-navigation",
        "slots": ["section-links", "footer-links"],
        "states": ["expanded", "collapsed"],
        "testIdPattern": "sidenav-main"
      },
      {
        "name": "HeroShell",
        "nivel": "organism",
        "semantic_role": "page-hero",
        "slots": ["eyebrow", "title", "subtitle", "ctas", "meta", "illustration"],
        "states": ["default", "compact"],
        "testIdPattern": "hero-shell"
      },
      {
        "name": "ListView",
        "nivel": "organism",
        "semantic_role": "collection-display",
        "slots": ["filters", "results", "pagination"],
        "states": ["loading", "error", "empty", "success"],
        "testIdPattern": "list-view"
      },
      {
        "name": "DetailPanel",
        "nivel": "organism",
        "semantic_role": "entity-detail",
        "slots": ["header", "body", "related"],
        "states": ["loading", "error", "success"],
        "testIdPattern": "detail-panel"
      },
      {
        "name": "FormPanel",
        "nivel": "organism",
        "semantic_role": "entity-form",
        "slots": ["title", "sections", "global-errors", "actions"],
        "states": ["editing", "submitting", "error", "success"],
        "testIdPattern": "form-panel"
      },
      {
        "name": "AuthForm",
        "nivel": "organism",
        "semantic_role": "auth-form",
        "slots": ["title", "fields", "actions", "secondary-links", "legal"],
        "states": ["idle", "submitting", "error"],
        "testIdPattern": "auth-form"
      },
      {
        "name": "NotificationsPanel",
        "nivel": "organism",
        "semantic_role": "notifications-center",
        "slots": ["header", "filters", "list", "empty"],
        "states": ["loading", "error", "empty", "success"],
        "testIdPattern": "notifications-panel"
      }
    ],
    "templates": [
      {
        "name": "AppShell",
        "nivel": "template",
        "semantic_role": "app-layout",
        "regions": ["header", "sidebar", "main", "footer", "toasts"],
        "testIdPattern": "layout-app-shell"
      },
      {
        "name": "AuthLayout",
        "nivel": "template",
        "semantic_role": "auth-layout",
        "regions": ["branding", "auth-card"],
        "testIdPattern": "layout-auth"
      },
      {
        "name": "DashboardLayout",
        "nivel": "template",
        "semantic_role": "dashboard-layout",
        "regions": ["header", "sidebar", "main"],
        "testIdPattern": "layout-dashboard"
      }
    ]
  },
  "screens": {
    "schema": {
      "id": "string",
      "nombre": "string",
      "rol": "home|dashboard|profile|notifications|menu|settings|offline|error|auth-*",
      "route": "string",
      "objetivoUX": ["string"],
      "layout_desktop": {
        "grid_12": "boolean",
        "regiones": ["header?","main","sidebar?","footer?"]
      },
      "layout_mobile": {
        "orden_stack": ["string"],
        "colapsos": ["string?"]
      },
      "secciones": [
        {
          "nombre": "string",
          "proposito": "string",
          "componentes": ["string"]
        }
      ],
      "ctas_principales": [
        { "label": "string", "accion": "string" }
      ],
      "ctas_secundarias": [
        { "label": "string", "accion": "string" }
      ],
      "datos_minimos": ["string"],
      "datos_opcionales": ["string"],
      "estados": {
        "loading": "string",
        "error": "string",
        "empty": "string",
        "offline": "string",
        "success": "string"
      }
    },
    "blueprints": {
      "Home": {
        "id": "screen-home",
        "nombre": "Home",
        "rol": "home",
        "route": "/",
        "objetivoUX": [
          "comunicar_valor_en_5-8s",
          "ofrecer_1-2_CTAs_principales",
          "dar_contexto_minimo_del_producto"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "main", "sidebar", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["HeroShell", "Highlights", "Proof", "Footer"],
          "colapsos": ["sidebar→stack"]
        },
        "secciones": [
          {
            "nombre": "Hero",
            "proposito": "pitch_principal",
            "componentes": ["HeroShell"]
          },
          {
            "nombre": "Highlights",
            "proposito": "accesos_rapidos",
            "componentes": ["StatCard", "ListView"]
          }
        ],
        "ctas_principales": [
          { "label": "<CTA_Principal>", "accion": "<ruta_o_evento>" }
        ],
        "ctas_secundarias": [
          { "label": "<CTA_Secundaria>", "accion": "<ruta_o_evento>" }
        ],
        "datos_minimos": ["User", "EntityX[]?"],
        "datos_opcionales": ["stats_resumidas", "atajos_rapidos"],
        "estados": {
          "loading": "skeleton_hero_y_cards",
          "error": "mensaje_error_general",
          "empty": "mensaje_sin_contenido+CTA",
          "offline": "banner_offline+datos_cacheados",
          "success": "contenido_completo"
        }
      },
      "Dashboard": {
        "id": "screen-dashboard",
        "nombre": "Dashboard",
        "rol": "dashboard",
        "route": "/dashboard",
        "objetivoUX": [
          "resumen_estado_actual",
          "accesos_rapidos_a_modulos_clave"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "sidebar", "main", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["NavBar", "main", "footer"],
          "colapsos": ["sidebar→AppMenu"]
        },
        "secciones": [
          {
            "nombre": "Overview",
            "proposito": "metrics_y_resumen",
            "componentes": ["StatCard", "ListView"]
          },
          {
            "nombre": "Shortcuts",
            "proposito": "accesos_rapidos",
            "componentes": ["Chip", "Button"]
          }
        ],
        "ctas_principales": [
          { "label": "<CTA_Principal_Dashboard>", "accion": "<ruta_o_evento>" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["User", "EntityX[]?"],
        "datos_opcionales": ["Notification[]", "Preference"],
        "estados": {
          "loading": "skeleton_cards",
          "error": "mensaje_error_datos",
          "empty": "estado_sin_datos",
          "offline": "modo_lectura_sin_actualizacion",
          "success": "dashboard_completo"
        }
      },
      "Profile": {
        "id": "screen-profile",
        "nombre": "Profile",
        "rol": "profile",
        "route": "/perfil",
        "objetivoUX": [
          "gestionar_datos_personales",
          "gestionar_preferencias_y_seguridad"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "main", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["main", "footer"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "Info",
            "proposito": "datos_basicos",
            "componentes": ["Avatar", "Field(name)", "Field(email)"]
          },
          {
            "nombre": "Preferences",
            "proposito": "idioma_tema_notificaciones",
            "componentes": ["Select(lang)", "Select(theme)", "Checkbox(notifications)"]
          },
          {
            "nombre": "Security",
            "proposito": "seguridad_cuenta",
            "componentes": ["Field(password_change)", "Toggle(MFA)", "List(sessions)"]
          }
        ],
        "ctas_principales": [
          { "label": "Guardar cambios", "accion": "submit_profile" }
        ],
        "ctas_secundarias": [
          { "label": "Cerrar sesión", "accion": "→/logout" }
        ],
        "datos_minimos": ["User", "Session"],
        "datos_opcionales": ["Security"],
        "estados": {
          "loading": "cargando_datos_usuario",
          "error": "mensaje_error_y_retry",
          "empty": "perfil_sin_datos_expandido",
          "offline": "edicion_bloqueada",
          "success": "toast_guardado"
        }
      },
      "Notifications": {
        "id": "screen-notifications",
        "nombre": "Notifications",
        "rol": "notifications",
        "route": "/notificaciones",
        "objetivoUX": [
          "visualizar_notificaciones",
          "marcar_como_leida",
          "navegar_al_contexto_correspondiente"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["header", "main", "footer"]
        },
        "layout_mobile": {
          "orden_stack": ["header", "main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "NotificationsList",
            "proposito": "lista_notificaciones",
            "componentes": ["NotificationsPanel"]
          }
        ],
        "ctas_principales": [
          { "label": "Marcar todas como leídas", "accion": "mark_all_read" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["Notification[]"],
        "datos_opcionales": [],
        "estados": {
          "loading": "skeleton_notifs",
          "error": "mensaje_error",
          "empty": "mensaje_sin_notificaciones",
          "offline": "lista_cacheada_sin_actualizar",
          "success": "lista_visible"
        }
      },
      "Menu": {
        "id": "screen-menu",
        "nombre": "Menu",
        "rol": "menu",
        "route": "/menu",
        "objetivoUX": [
          "navegacion_global",
          "cambio_de_contexto_rapido"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "GlobalMenu",
            "proposito": "agrupacion_de_rutas_y_acciones",
            "componentes": ["AppMenu"]
          }
        ],
        "ctas_principales": [],
        "ctas_secundarias": [],
        "datos_minimos": ["MenuItem[]"],
        "datos_opcionales": [],
        "estados": {
          "loading": "menu_placeholder",
          "error": "no_se_pudo_cargar_menu",
          "empty": "sin_opciones_definidas",
          "offline": "menu_local_sin_actualizar",
          "success": "menu_completo"
        }
      },
      "Login": {
        "id": "screen-login",
        "nombre": "Login",
        "rol": "auth-login",
        "route": "/login",
        "objetivoUX": [
          "permitir_acceso",
          "mantener_seguridad",
          "proceso_simple"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "AuthFormLogin",
            "proposito": "ingreso_credenciales",
            "componentes": ["AuthForm"]
          }
        ],
        "ctas_principales": [
          { "label": "Iniciar sesión", "accion": "submit_login" }
        ],
        "ctas_secundarias": [
          { "label": "Crear cuenta", "accion": "→/register" },
          { "label": "Olvidé mi contraseña", "accion": "→/recover" }
        ],
        "datos_minimos": ["credential.email", "credential.password"],
        "datos_opcionales": [],
        "estados": {
          "loading": "enviando_credenciales",
          "error": "mensaje_neutro_credenciales_invalidas",
          "empty": "form_visible",
          "offline": "submit_bloqueado",
          "success": "redirigir_a_Dashboard_o_Home"
        }
      },
      "Register": {
        "id": "screen-register",
        "nombre": "Register",
        "rol": "auth-register",
        "route": "/register",
        "objetivoUX": [
          "crear_cuenta",
          "explicar_requisitos_password"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "AuthFormRegister",
            "proposito": "registro",
            "componentes": ["AuthForm"]
          }
        ],
        "ctas_principales": [
          { "label": "Crear cuenta", "accion": "submit_register" }
        ],
        "ctas_secundarias": [
          { "label": "Ya tengo cuenta", "accion": "→/login" }
        ],
        "datos_minimos": ["user.name", "credential.email", "credential.password"],
        "datos_opcionales": [],
        "estados": {
          "loading": "enviando_registro",
          "error": "contraseña_debil_u_otro_error",
          "empty": "form_visible",
          "offline": "registro_bloqueado",
          "success": "correo_verificacion_enviado"
        }
      },
      "Recover": {
        "id": "screen-recover",
        "nombre": "Recover",
        "rol": "auth-recover",
        "route": "/recover",
        "objetivoUX": [
          "recuperar_acceso",
          "no_filtrar_existencia_usuarios"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "RecoverRequest",
            "proposito": "solicitar_reset",
            "componentes": ["Field(email)", "Button(Enviar enlace)"]
          },
          {
            "nombre": "RecoverReset",
            "proposito": "establecer_nueva_password",
            "componentes": ["Field(new_password)", "Field(confirm_password)", "Button(Confirmar)"]
          }
        ],
        "ctas_principales": [
          { "label": "Enviar enlace", "accion": "submit_recover_request" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["credential.email"],
        "datos_opcionales": ["resetToken"],
        "estados": {
          "loading": "procesando_solicitud",
          "error": "mensaje_generico",
          "empty": "form_visible",
          "offline": "no_permitir_solicitud",
          "success": "mensaje_neutro_enviado_si_existe"
        }
      },
      "MFA": {
        "id": "screen-mfa",
        "nombre": "MFA",
        "rol": "auth-mfa",
        "route": "/mfa",
        "objetivoUX": [
          "verificar_segundo_factor",
          "mantener_flujo_simple"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "MFAOTP",
            "proposito": "ingreso_de_codigo",
            "componentes": ["OTPGroup", "Button(Verificar)", "Link(Reenviar)"]
          }
        ],
        "ctas_principales": [
          { "label": "Verificar", "accion": "submit_mfa" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": ["credential.otp"],
        "datos_opcionales": [],
        "estados": {
          "loading": "verificando_otp",
          "error": "codigo_invalido",
          "empty": "esperando_otp",
          "offline": "no_verificar",
          "success": "acceso_concedido"
        }
      },
      "SessionExpired": {
        "id": "screen-session-expired",
        "nombre": "SessionExpired",
        "rol": "auth-session-expired",
        "route": "/session-expired",
        "objetivoUX": [
          "explicar_caducidad",
          "invitar_a_relogear"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "ExpiredMessage",
            "proposito": "mensaje",
            "componentes": ["Text.h2", "Text.body"]
          },
          {
            "nombre": "ExpiredCTA",
            "proposito": "accion",
            "componentes": ["Button(Iniciar sesión de nuevo)"]
          }
        ],
        "ctas_principales": [
          { "label": "Iniciar sesión de nuevo", "accion": "→/login" }
        ],
        "ctas_secundarias": [],
        "datos_minimos": [],
        "datos_opcionales": [],
        "estados": {
          "loading": "—",
          "error": "—",
          "empty": "mensajes_listos",
          "offline": "informar_estado",
          "success": "redirigir_a_login"
        }
      },
      "LogOff": {
        "id": "screen-logoff",
        "nombre": "LogOff",
        "rol": "auth-logoff",
        "route": "/logout",
        "objetivoUX": [
          "terminar_sesion",
          "redirigir_a_punto_de_entrada_seguro"
        ],
        "layout_desktop": {
          "grid_12": true,
          "regiones": ["main"]
        },
        "layout_mobile": {
          "orden_stack": ["main"],
          "colapsos": []
        },
        "secciones": [
          {
            "nombre": "LogOffConfirm",
            "proposito": "salida_segura",
            "componentes": ["Text.body", "Button(Cerrar sesión)", "Button(Cancelar)"]
          }
        ],
        "ctas_principales": [
          { "label": "Cerrar sesión", "accion": "revocar_tokens→redirigir→/login" }
        ],
        "ctas_secundarias": [
          { "label": "Cancelar", "accion": "back" }
        ],
        "datos_minimos": ["Session.id"],
        "datos_opcionales": [],
        "estados": {
          "loading": "cerrando_sesion",
          "error": "mensaje_error",
          "empty": "confirm_visible",
          "offline": "indicar_que_no_se_puede_desloguear_del_servidor",
          "success": "redirigir_a_login"
        }
      }
    }
  },
  "flows": {
    "F_Login": {
      "id": "F_Login",
      "nombre": "Login",
      "pasos": [
        {
          "pantalla": "Login",
          "tarea": "capturar_email_y_password",
          "entrada": ["credential.email", "credential.password"],
          "salida": "credenciales_listas",
          "estado": "idle"
        },
        {
          "pantalla": "Login",
          "tarea": "enviar_credenciales",
          "entrada": ["credenciales_listas"],
          "salida": "ok|requiere_mfa|error",
          "estado": "loading",
          "error": {
            "mensaje": "Credenciales inválidas.",
            "recuperacion": ["mantener_mensaje_neutro", "permitir_reintento"]
          }
        },
        {
          "pantalla": "MFA",
          "tarea": "verificar_segundo_factor_si_aplica",
          "entrada": ["estado=requiere_mfa"],
          "salida": "acceso_concedido|error_otp",
          "estado": "loading",
          "error": {
            "mensaje": "Código inválido.",
            "recuperacion": ["mostrar_opcion_reenviar"]
          }
        },
        {
          "pantalla": "Dashboard|Home",
          "tarea": "mostrar_vista_principal_post_login",
          "entrada": ["estado=acceso_concedido"],
          "salida": "sesion_activa",
          "estado": "success"
        }
      ],
      "ramificaciones": [
        {
          "condicion": "requiere_mfa",
          "destino": "pantalla=MFA"
        },
        {
          "condicion": "ok_sin_mfa",
          "destino": "pantalla=Dashboard|Home"
        }
      ],
      "exito": {
        "definicion": "usuario_autenticado_y_dirigido_a_vista_principal"
      }
    },
    "F_Register": {
      "id": "F_Register",
      "nombre": "Register",
      "pasos": [
        {
          "pantalla": "Register",
          "tarea": "capturar_datos_y_aceptar_terminos",
          "entrada": ["user.name", "credential.email", "credential.password"],
          "salida": "datos_listos",
          "estado": "idle"
        },
        {
          "pantalla": "Register",
          "tarea": "enviar_registro",
          "entrada": ["datos_listos"],
          "salida": "registro_ok|error",
          "estado": "loading",
          "error": {
            "mensaje": "Contraseña débil u otro error.",
            "recuperacion": ["mostrar_reglas_password", "permitir_reintento"]
          }
        },
        {
          "pantalla": "Login",
          "tarea": "permitir_login_post_registro",
          "entrada": ["registro_ok"],
          "salida": "usuario_puede_iniciar_sesion",
          "estado": "success"
        }
      ],
      "ramificaciones": [],
      "exito": {
        "definicion": "cuenta_creada_y_usuario_listo_para_iniciar_sesion"
      }
    },
    "F_Recover": {
      "id": "F_Recover",
      "nombre": "Recover",
      "pasos": [
        {
          "pantalla": "Recover",
          "tarea": "solicitar_reset_por_email",
          "entrada": ["credential.email"],
          "salida": "solicitud_enviada",
          "estado": "loading",
          "error": {
            "mensaje": "Error al solicitar reset.",
            "recuperacion": ["mensaje_generico", "retry"]
          }
        },
        {
          "pantalla": "Recover",
          "tarea": "establecer_nueva_password",
          "entrada": ["resetToken", "new_password"],
          "salida": "password_actualizada",
          "estado": "loading"
        },
        {
          "pantalla": "Login",
          "tarea": "permitir_login_con_nueva_password",
          "entrada": ["password_actualizada"],
          "salida": "listo_para_login",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_puede_recuperar_acceso_sin_filtrar_existencia_de_cuenta"
      }
    },
    "F_MFA": {
      "id": "F_MFA",
      "nombre": "MFA",
      "pasos": [
        {
          "pantalla": "MFA",
          "tarea": "capturar_otp",
          "entrada": ["credential.otp"],
          "salida": "otp_listo",
          "estado": "idle"
        },
        {
          "pantalla": "MFA",
          "tarea": "validar_otp",
          "entrada": ["otp_listo"],
          "salida": "ok|error",
          "estado": "loading",
          "error": {
            "mensaje": "Código inválido.",
            "recuperacion": ["permitir_reintento", "opcion_reenviar_otp"]
          }
        },
        {
          "pantalla": "Dashboard|Home",
          "tarea": "entrar_post_mfa",
          "entrada": ["ok"],
          "salida": "sesion_activa",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "segundo_factor_validado_y_usuario_en_vista_principal"
      }
    },
    "F_SessionExpired": {
      "id": "F_SessionExpired",
      "nombre": "SessionExpired",
      "pasos": [
        {
          "pantalla": "SessionExpired",
          "tarea": "informar_caducidad",
          "entrada": ["evento_timeout"],
          "salida": "usuario_entendido",
          "estado": "idle"
        },
        {
          "pantalla": "SessionExpired",
          "tarea": "redirigir_a_login",
          "entrada": ["usuario_entendido"],
          "salida": "login_visible",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "sesion_expirada_manejada_sin_confusion_ni_fuga_de_datos"
      }
    },
    "F_LogOff": {
      "id": "F_LogOff",
      "nombre": "LogOff",
      "pasos": [
        {
          "pantalla": "Profile|Menu",
          "tarea": "click_cerrar_sesion",
          "entrada": ["accion_usuario"],
          "salida": "confirmacion",
          "estado": "idle"
        },
        {
          "pantalla": "LogOff",
          "tarea": "confirmar_y_revocar_tokens",
          "entrada": ["Session.id"],
          "salida": "sesion_cerrada",
          "estado": "loading"
        },
        {
          "pantalla": "Splash|Login",
          "tarea": "redirigir_a_entrada_segura",
          "entrada": ["sesion_cerrada"],
          "salida": "pantalla_inicio_auth",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "sesion_cerrada_en_servidor_y_UI_en_estado_seguro"
      }
    },
    "F_HomeEntry": {
      "id": "F_HomeEntry",
      "nombre": "HomeEntry",
      "pasos": [
        {
          "pantalla": "Home",
          "tarea": "mostrar_pitch",
          "entrada": ["User?"],
          "salida": "usuario_entendido_valor",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_sabe_que_hace_el_producto_y_que_puede_hacer_siguiente"
      }
    },
    "F_DashboardNav": {
      "id": "F_DashboardNav",
      "nombre": "DashboardNav",
      "pasos": [
        {
          "pantalla": "Dashboard",
          "tarea": "mostrar_resumen",
          "entrada": ["User", "EntityX[]?"],
          "salida": "overview_visible",
          "estado": "success"
        },
        {
          "pantalla": "Dashboard",
          "tarea": "usar_menu_o_sidebar_para_navegar",
          "entrada": ["click_menu"],
          "salida": "pantalla_destino",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_navega_entre_modulos_desde_dashboard"
      }
    },
    "F_Notifications": {
      "id": "F_Notifications",
      "nombre": "Notifications",
      "pasos": [
        {
          "pantalla": "Home|Dashboard",
          "tarea": "ver_indicador_notificaciones",
          "entrada": ["Notification[]"],
          "salida": "has_unread|all_read",
          "estado": "idle"
        },
        {
          "pantalla": "Notifications",
          "tarea": "listar_notificaciones",
          "entrada": ["Notification[]"],
          "salida": "lista_visible",
          "estado": "success"
        },
        {
          "pantalla": "Notifications",
          "tarea": "marcar_como_leida",
          "entrada": ["Notification.id"],
          "salida": "actualizar_estado",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_entiende_y_gestiona_notificaciones_sin_ruido"
      }
    },
    "F_Offline_Recovery": {
      "id": "F_Offline_Recovery",
      "nombre": "Offline_Recovery",
      "pasos": [
        {
          "pantalla": "Offline|cualquier",
          "tarea": "detectar_offline",
          "entrada": ["network_status=offline"],
          "salida": "mostrar_estado",
          "estado": "idle"
        },
        {
          "pantalla": "Offline",
          "tarea": "intentar_reconexion",
          "entrada": ["click_reintentar"],
          "salida": "network_status=online?",
          "estado": "loading"
        },
        {
          "pantalla": "pantalla_previa",
          "tarea": "restaurar_estado_previo",
          "entrada": ["online"],
          "salida": "flujo_recuperado",
          "estado": "success"
        }
      ],
      "exito": {
        "definicion": "usuario_puede_retomar_tarea_tras_offline"
      }
    }
  },
  "telemetry": {
    "eventos_core": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired",
      "notif:view",
      "notif:click",
      "menu:open",
      "menu:item_click"
    ],
    "payload_min": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso"
    }
  },
  "prioridades": {
    "top5_issues": [
      "estilos_fuera_de_tokens",
      "falta_focus_visible_en_componentes_clave",
      "CTAs_compiten_en_home_y_dashboard",
      "estados_universales_incompletos_en_auth_y_core",
      "microcopy_no_i18n_ready_en_mensajes_auth_y_notificaciones"
    ],
    "top5_acciones": [
      "migrar_todos_los_colores_y_spacings_a_TOKENS_DTCG_JSON",
      "aplicar_focus_visible_global_y_probar_navegacion_con_teclado",
      "definir_CTA_primaria_por_pantalla(Home,Dashboard,Login)",
      "documentar_y_aplicar_patron_estados_universales_para_todas_las_pantallas",
      "extraer_microcopy_a_tablas_i18n_para_es-MX_y_en-US"
    ]
  },
  "inferencias_defecto": {
    "User_default": {
      "name": "<UserName>",
      "email": "<user@email>",
      "prefs": {
        "lang": "es-MX",
        "theme": "light",
        "reduceMotion": false,
        "notifications": true
      }
    },
    "EntityX_default": {
      "title": "Elemento de ejemplo",
      "status": "active"
    },
    "Home_titular_default": "Propuesta de valor en 5–8 palabras",
    "ctas_default": ["Continuar", "Ver detalles", "Crear nuevo", "Guardar cambios"],
    "estados_universales_default": {
      "loading": "skeleton",
      "error": "mensaje+retry",
      "empty": "mensaje+CTA",
      "offline": "banner+fallback",
      "success": "toast"
    }
  },
  "guard": {
    "rules": [
      "NO_META",
      "NO_DRY",
      "NO_REPEAT",
      "ANTI_INJ_STRICT",
      "CTX_ISOLATE",
      "CONSIST",
      "FACT_CHECK",
      "RECENCY_CHECK",
      "DATE_DRIFT_DETECT",
      "DISINFO_HYGIENE",
      "HALLUCINATION_DETECT",
      "PII_STRICT",
      "SECRET_STRICT",
      "SEMANTIC_DEDUP",
      "LEXICAL_DEDUP",
      "SINGLE_OUTPUT",
      "TOOL_ONLY_REAL",
      "NO_ASYNC_WORK",
      "NO_TIME_ESTIMATES"
    ]
  },
  "violations": []
}
___

{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_AUTH_DASHBOARD_EXTRA_1",

  "entities_extra": {
    "Notification": {
      "description": "Entidad genérica de notificación para centro de notificaciones, badge en navbar y toasts.",
      "fields": {
        "id": "string|uuid",
        "title": "string",
        "body": "string",
        "type": "info|warn|err|success",
        "createdAt": "iso",
        "readAt": "iso|null",
        "read": "boolean",
        "source": "string?",          

        "ctaLabel": "string?",        
        "ctaRoute": "string?",        
        "ctaEntityId": "string?",     

        "category": "system|security|billing|activity|other",
        "priority": "low|normal|high",
        "sticky": "boolean",
        "expiresAt": "iso|null",      

        "meta": "object?"             
      }
    },

    "MenuItem": {
      "description": "Item de menú global para nav principal, side nav o menú tipo drawer.",
      "fields": {
        "id": "string",
        "label": "string",
        "icon": "string?",
        "path": "string?",           
        "external": "boolean?",
        "section": "string?",        

        "order": "number?",
        "badge": "string?",
        "requiresAuth": "boolean",
        "rolesAllowed": "string[]?",  
        "featureFlag": "string?",     

        "children": "MenuItem[]?",    
        "meta": "object?"             
      }
    }
  },

  "screens_extra_blueprints": {
    "Settings": {
      "id": "screen-settings",
      "nombre": "Settings",
      "rol": "settings",
      "route": "/settings",
      "objetivoUX": [
        "permitir_configurar_preferencias_personales",
        "exponer_opciones_clave_sin_ruido"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["header", "sidebar", "main", "footer"]
      },
      "layout_mobile": {
        "orden_stack": ["header", "main", "footer"],
        "colapsos": ["sidebar→drawer|menu"]
      },
      "secciones": [
        {
          "nombre": "General",
          "proposito": "preferencias_generales",
          "componentes": [
            "Field(language)",
            "Field(theme)",
            "Field(density)"
          ]
        },
        {
          "nombre": "Notifications",
          "proposito": "preferencias_notificaciones",
          "componentes": [
            "Checkbox(email_notifications)",
            "Checkbox(push_notifications)",
            "Checkbox(product_updates)"
          ]
        },
        {
          "nombre": "Privacy",
          "proposito": "controles_privacidad",
          "componentes": [
            "Checkbox(telemetry_opt_in)",
            "Button(Download data)?",
            "Button(Delete account)?"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Guardar cambios", "accion": "submit_settings" }
      ],
      "ctas_secundarias": [
        { "label": "Descartar cambios", "accion": "reset_form" }
      ],
      "datos_minimos": ["User.prefs"],
      "datos_opcionales": ["Security", "Preference"],
      "estados": {
        "loading": "cargando_preferencias",
        "error": "error_al_cargar_o_guardar",
        "empty": "sin_preferencias_definidas_aun",
        "offline": "edicion_desactivada+mensaje_offline",
        "success": "toast_preferencias_guardadas"
      }
    },

    "Help": {
      "id": "screen-help",
      "nombre": "Help",
      "rol": "help",
      "route": "/help",
      "objetivoUX": [
        "resolver_dudas_frecuentes",
        "habilitar_contacto_con_soporte"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["header", "main", "footer"]
      },
      "layout_mobile": {
        "orden_stack": ["FAQ", "Contact"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "FAQ",
          "proposito": "respuestas_rapidas",
          "componentes": [
            "SearchBar",
            "Accordion(FAQItems)"
          ]
        },
        {
          "nombre": "Contact",
          "proposito": "contacto_soporte",
          "componentes": [
            "Field(subject)",
            "Field(message)",
            "Button(Enviar mensaje)"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Enviar mensaje", "accion": "submit_help_form" }
      ],
      "ctas_secundarias": [
        { "label": "Ver documentación", "accion": "<ruta_docs>" }
      ],
      "datos_minimos": [],
      "datos_opcionales": ["FAQItem[]"],
      "estados": {
        "loading": "cargando_FAQ",
        "error": "error_al_cargar_FAQ_o_enviar_contacto",
        "empty": "sin_FAQ_configuradas",
        "offline": "solo_FAQ_cacheadas_sin_contact_form",
        "success": "mensaje_enviado|respuesta_mostrada"
      }
    },

    "Offline": {
      "id": "screen-offline",
      "nombre": "Offline",
      "rol": "offline",
      "route": "/offline",
      "objetivoUX": [
        "explicar_estado_sin_conexion",
        "ofrecer_reintento_o_modo_lectura"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["main"]
      },
      "layout_mobile": {
        "orden_stack": ["main"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "OfflineBanner",
          "proposito": "mensajes_offline",
          "componentes": [
            "Icon24(warn)",
            "Text.h2",
            "Text.body"
          ]
        },
        {
          "nombre": "OfflineActions",
          "proposito": "acciones_de_recuperacion",
          "componentes": [
            "Button(Reintentar)",
            "Button(Ir a Home en modo lectura)?"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Reintentar", "accion": "retry_network" }
      ],
      "ctas_secundarias": [
        { "label": "Ir a Home", "accion": "→/" }
      ],
      "datos_minimos": [],
      "datos_opcionales": ["estado_prev_screen"],
      "estados": {
        "loading": "tratando_de_reconectar",
        "error": "no_se_pudo_reconectar",
        "empty": "solo_banner",
        "offline": "estado_principal",
        "success": "redirigir_a_pantalla_previa"
      }
    },

    "Error": {
      "id": "screen-error",
      "nombre": "Error",
      "rol": "error",
      "route": "/error",
      "objetivoUX": [
        "explicar_error",
        "ofrecer_ruta_segura"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["main"]
      },
      "layout_mobile": {
        "orden_stack": ["main"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "ErrorMessage",
          "proposito": "descripcion_del_error",
          "componentes": [
            "Icon24(err)",
            "Text.h2",
            "Text.body"
          ]
        },
        {
          "nombre": "ErrorActions",
          "proposito": "recuperacion",
          "componentes": [
            "Button(Ir al inicio)",
            "Button(Volver)"
          ]
        }
      ],
      "ctas_principales": [
        { "label": "Ir al inicio", "accion": "→/" }
      ],
      "ctas_secundarias": [
        { "label": "Volver", "accion": "history.back()" }
      ],
      "datos_minimos": ["error_code?"],
      "datos_opcionales": ["error_details?"],
      "estados": {
        "loading": "—",
        "error": "pantalla_en_si_misma",
        "empty": "error_generico_sin_detalles",
        "offline": "combinar_con_mensaje_offline_si_aplica",
        "success": "—"
      }
    },

    "Splash": {
      "id": "screen-splash",
      "nombre": "Splash",
      "rol": "auth-splash",
      "route": "/splash",
      "objetivoUX": [
        "mostrar_branding_minimo",
        "determinar_ruta_inicial(Login|Dashboard|Home)"
      ],
      "layout_desktop": {
        "grid_12": true,
        "regiones": ["main"]
      },
      "layout_mobile": {
        "orden_stack": ["main"],
        "colapsos": []
      },
      "secciones": [
        {
          "nombre": "Branding",
          "proposito": "identidad",
          "componentes": [
            "Logo",
            "Text.body"
          ]
        },
        {
          "nombre": "Progress",
          "proposito": "estado_de_verificacion",
          "componentes": [
            "Spinner",
            "Text.caption"
          ]
        }
      ],
      "ctas_principales": [],
      "ctas_secundarias": [],
      "datos_minimos": ["Session?"],
      "datos_opcionales": [],
      "estados": {
        "loading": "verificando_sesion",
        "error": "fallo_al_verificar_sesion",
        "empty": "—",
        "offline": "mostrar_mensaje_offline + opcion_ir_a_login",
        "success": "redirigir_a_Login|Home|Dashboard"
      }
    }
  },

  "eval_extra": {
    "casos_golden_auth": [
      "login_exitoso_sin_mfa",
      "login_exitoso_con_mfa",
      "login_credenciales_invalidas",
      "registro_cuenta_nueva",
      "registro_password_debil",
      "recover_solicitud_exitosa_mensaje_neutro",
      "recover_reset_password_ok",
      "session_expirada_redirige_a_login",
      "logoff_cierra_sesion_y_redirige"
    ],
    "casos_golden_dashboard": [
      "dashboard_con_datos",
      "dashboard_sin_datos_muestra_empty_state",
      "dashboard_error_muestra_mensaje_y_retry"
    ],
    "casos_golden_notifications": [
      "hay_notificaciones_no_leidas_bagde_on",
      "lista_notificaciones_vacia_muestra_empty_state",
      "marcar_notificacion_como_leida_actualiza_UI"
    ],
    "checks_formales": {
      "json_schema_pass": "validar_contra_todos_los_SCHEMAS",
      "a11y_core": "pasar_checklist_A11Y_SCHEMA_en_login,home,dashboard,profile",
      "security_auth": "mensajes_neutros, no enumerar usuarios, password_meter_activo",
      "pwa_critico": "manifest+service_worker+offline_fallback_configurados"
    }
  },

  "ssr_ssg_adapt_extra": {
    "routes_ssg_recomendadas": [
      "/",
      "/login",
      "/register",
      "/help",
      "/offline",
      "/error"
    ],
    "routes_ssr_recomendadas": [
      "/dashboard",
      "/perfil",
      "/notificaciones"
    ],
    "guards_detalle": {
      "public_routes": ["/", "/login", "/register", "/recover", "/help", "/offline", "/error"],
      "protected_routes": ["/dashboard", "/perfil", "/notificaciones", "/settings"]
    }
  },

  "checklist_DoD_extra": [
    "Todos los flujos de auth (Login/Register/Recover/MFA/SessionExpired/LogOff) tienen estados loading/error/empty/offline/success definidos.",
    "Home/Dashboard tienen CTAs primarias y secundarias claramente diferenciadas.",
    "Profile/Settings exponen cambios de preferencias y seguridad con feedback visible y accesible.",
    "Notifications/NotificationsPanel manejan estados: no leídas, leídas, vacío, error y offline.",
    "Menu/AppMenu soporta jerarquía (MenuItem.children) y feature flags sin romper la navegación."
  ],

  "violations": []
}
ChatGPT Plus

Pensó durante 48s
{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_AUTH_DASHBOARD_COMPLEMENTO_2",

  "a11y_seo_pwa": {
    "a11y": {
      "contraste": {
        "texto_normal_AA": "≥4.5:1",
        "texto_grande_AA": "≥3:1"
      },
      "focus_visible": {
        "regla": "todo elemento interactivo debe mostrar un contorno claramente visible",
        "grosor_minimo": "2px",
        "origen_color": "usar token de borde fuerte"
      },
      "orden_tab": {
        "patron_global": "header → nav → main → aside → footer",
        "home": "skip-link → nav → hero → highlights → footer",
        "auth": "branding → campos → acciones → links secundarios"
      },
      "landmarks": [
        "header",
        "nav",
        "main",
        "region",
        "complementary",
        "footer"
      ],
      "aria": {
        "live_regions": {
          "notificaciones": "polite",
          "errores_formulario_globales": "assertive"
        },
        "rol_componente_por_defecto": {
          "NavBar": "navigation",
          "SideNav": "navigation",
          "FormPanel": "form",
          "NotificationsPanel": "region",
          "ErrorLayout": "alert"
        }
      },
      "color_no_unico_canal": {
        "estados": [
          "ok",
          "warning",
          "error",
          "info"
        ],
        "regla": "además de color se debe usar texto y/o iconografía diferenciada"
      },
      "reduced_motion": {
        "usa_prefers_reduced_motion": true,
        "comportamiento": "eliminar o simplificar animaciones decorativas y transiciones largas"
      },
      "skip_links": [
        {
          "label": "Saltar al contenido principal",
          "href": "#main"
        }
      ],
      "formularios": {
        "errores": "asociar mensajes a campos mediante aria-describedby",
        "orden_validacion": "mostrar errores primero cerca del campo, luego resumen global si aplica"
      }
    },
    "seo": {
      "title": {
        "longitud_max": 60,
        "regla_unicidad": "un título principal por ruta",
        "ejemplo": "<Nombre producto> – <Página>"
      },
      "meta_description": {
        "longitud_max": 160,
        "objetivo": "explicar brevemente propósito de la vista"
      },
      "open_graph": {
        "campos": ["og:title", "og:description", "og:image", "og:url"],
        "target": ["Home", "Dashboard", "Detail público", "Help"]
      },
      "twitter_card": {
        "campos": ["twitter:card", "twitter:title", "twitter:description"],
        "tipo_por_defecto": "summary_large_image"
      },
      "headings": {
        "reglas": [
          "usar exactamente un H1 por pantalla",
          "no saltar de H1 a H4 sin H2/H3 entre ellos",
          "en listas de secciones usar H2 para bloques principales"
        ]
      },
      "urls": {
        "patrones": {
          "home": "/",
          "login": "/login",
          "register": "/register",
          "dashboard": "/dashboard",
          "profile": "/perfil",
          "notifications": "/notificaciones",
          "settings": "/settings",
          "help": "/help"
        },
        "principios": [
          "sin IDs opacos en rutas públicas cuando no sea necesario",
          "usar kebab-case en segmentos"
        ]
      },
      "canonical": {
        "regla": "una url canónica por vista pública",
        "uso_típico": [
          "/",
          "/login",
          "/register",
          "/dashboard",
          "/help"
        ]
      }
    },
    "pwa": {
      "manifest_campos_minimos": {
        "name": "<Nombre_app>",
        "short_name": "<Nombre_corto>",
        "start_url": "/",
        "display": "standalone",
        "theme_color": "{color.semantic.bg.page}",
        "background_color": "{color.semantic.bg.surface}",
        "icons_requeridas": [
          "192x192",
          "512x512"
        ]
      },
      "service_worker": {
        "estrategia_ui": "app_shell (shell precacheado, datos vía red)",
        "precache": [
          "/",
          "/login",
          "/dashboard",
          "/assets/*"
        ],
        "estrategias_datos": {
          "endpoints_publicos": "stale-while-revalidate",
          "endpoints_privados": "network-first con fallback cache controlado",
          "assets_estaticos": "cache-first"
        },
        "offline_fallback": {
          "ruta": "/offline",
          "uso": [
            "cuando fetch de documento falle",
            "cuando fetch de datos críticos falle y no haya cache válida"
          ]
        }
      },
      "instalabilidad": {
        "requisitos": [
          "ser servida por HTTPS",
          "tener manifest valido",
          "service worker registrado y activo"
        ]
      }
    }
  },

  "security_privacy": {
    "auth_mensajes": {
      "login_error_generico": "Credenciales inválidas.",
      "recover_mensaje_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso.",
      "mfa_codigo_invalido": "Código inválido. Intenta nuevamente."
    },
    "recuperacion_cuenta": {
      "no_enumerar_usuarios": true,
      "texto_neutro": "El mensaje de confirmación nunca indica si el correo está registrado o no."
    },
    "password_rules": {
      "min_longitud": 12,
      "clases_requeridas": [
        "mayúscula",
        "minúscula",
        "número",
        "símbolo"
      ],
      "restricciones": [
        "no incluir nombre del usuario",
        "no incluir email",
        "no permitir contraseñas comunes"
      ],
      "meter": {
        "niveles": ["débil", "media", "fuerte"],
        "feedback_accesible": true
      }
    },
    "sesiones": {
      "listado_sesiones_activas": true,
      "campo_minimo": ["dispositivo", "ubicacion_aproximada", "lastLogin"],
      "accion_cerrar_sesion": "permitir cerrar sesión por dispositivo"
    },
    "telemetria_privacidad": {
      "opt_in_explicito": true,
      "evento_consentimiento": "consent:telemetry_update",
      "restriccion_datos": [
        "no almacenar contenido sensible de formularios",
        "usar IDs opacos en vez de emails o nombres"
      ]
    }
  },

  "mocks": {
    "hooks_mock": [
      "useUser",
      "useSession",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile",
      "useNotifications",
      "useDashboard",
      "useMenuItems"
    ],
    "fixtures_genericos": {
      "user_demo": {
        "id": "<uuid_demo>",
        "name": "<UserName>",
        "email": "<user@email>",
        "role": "user",
        "prefs": {
          "lang": "es-MX",
          "theme": "light",
          "reduceMotion": false,
          "notifications": true
        }
      },
      "session_demo": {
        "id": "<session_id>",
        "userId": "<uuid_demo>",
        "exp": "<iso_future>",
        "device": "Chrome on macOS",
        "ipHash": "<hash>"
      },
      "entityX_demo": {
        "id": "<entity_id>",
        "title": "Elemento de ejemplo",
        "description": "Descripción breve de ejemplo.",
        "status": "active",
        "createdAt": "<iso_past>",
        "updatedAt": "<iso_past>",
        "owner": {
          "id": "<uuid_demo>",
          "name": "<UserName>"
        },
        "tags": ["ejemplo", "placeholder"]
      }
    },
    "latencias_y_errores": {
      "lat_ms_promedio": 120,
      "tasa_error_simulada": 0.03,
      "distribucion": "latencias_normales_con_colas_esporadicas"
    },
    "swap_plan": {
      "descripcion": "abstraer acceso a datos detrás de interfaces por dominio",
      "ejemplos": [
        "UserRepo → REST|Supabase|Firebase Auth",
        "EntityRepo → REST|Firestore|SQL",
        "NotificationRepo → REST|RealtimeChannel"
      ],
      "regla": "UI solo conoce hooks, nunca implementaciones concretas"
    }
  },

  "i18n_ux_copy": {
    "locales_soportados": ["es-MX", "en-US"],
    "namespaces": [
      "common",
      "auth",
      "dashboard",
      "profile",
      "notifications",
      "settings",
      "errors"
    ],
    "keys_ejemplo": {
      "common": {
        "continue": "Continuar",
        "back": "Volver",
        "save": "Guardar",
        "cancel": "Cancelar"
      },
      "auth": {
        "login_title": "Iniciar sesión",
        "register_title": "Crear cuenta",
        "recover_title": "Recuperar acceso",
        "mfa_title": "Verificación en dos pasos"
      },
      "errors": {
        "generic": "Algo salió mal. Intenta de nuevo.",
        "network": "No pudimos conectarnos. Revisa tu conexión."
      }
    },
    "reglas": [
      "no incrustar HTML en las cadenas, salvo que sea estrictamente necesario",
      "evitar concatenar partes de frases en frontend; usar frases completas",
      "mantener consistencia de terminología entre pantallas (ej. 'elementos' vs 'items')"
    ]
  },

  "eval": {
    "metricas_principales": [
      "json_schema_pass",
      "a11y_checklist_pass",
      "security_policy_pass",
      "groundedness(si_RAG)",
      "ux_task_success_rate"
    ],
    "umbrales_sugeridos": {
      "json_schema_pass": 0.98,
      "a11y_checklist_pass": 0.95,
      "security_policy_pass": 0.97,
      "groundedness": 0.9
    },
    "dimensiones_ux": {
      "claridad": "¿el usuario entiende qué hace cada pantalla?",
      "reduccion_pasos": "¿se completan tareas frecuentes en ≤ N pasos?",
      "consistencia": "¿se repiten patrones útiles en Home/Dashboard/Profile?",
      "tolerancia_error": "¿el sistema ayuda a recuperarse de errores?"
    }
  },

  "ssr_ssg_adapt": {
    "criterios_ssg": [
      "vista no depende de datos sensibles",
      "cambios de contenido poco frecuentes",
      "útil para SEO (ej. landing, help, marketing)"
    ],
    "criterios_ssr": [
      "contenido depende del usuario actual",
      "los datos cambian con frecuencia",
      "se requiere verificación en servidor antes de mostrar"
    ],
    "categorias_rutas": {
      "publicas_ssg": ["/", "/login", "/register", "/help", "/offline", "/error"],
      "protegidas_ssr": ["/dashboard", "/perfil", "/notificaciones", "/settings"]
    },
    "guardias": {
      "public_route_guard": "redirigir a dashboard si ya hay sesión válida",
      "protected_route_guard": "redirigir a login si no hay sesión o está expirada"
    }
  },

  "pipeline": {
    "alpha_context_plan": {
      "pasos": [
        "parsear INPUTS.PRODUCTO/USUARIOS/CONTEXTO",
        "identificar tipo_de_app (auth+dashboard)",
        "derivar pantallas necesarias",
        "ajustar profundidad de detalle según DENSIDAD"
      ],
      "criterios_rank": {
        "autoridad": 0.5,
        "recencia": 0.3,
        "task_fit": 0.2
      }
    },
    "beta_generacion": {
      "modo": "STRUCTURED_OUTPUT_JSON",
      "roles": ["planner", "researcher", "writer", "verifier"],
      "nota": "los roles son lógicos, no se exponen al usuario"
    },
    "gamma_validacion": {
      "checks": [
        "estructura_JSON_vs_SCHEMAS",
        "uso_de_tokens_visual",
        "A11Y_SCHEMA_minimo",
        "SECURITY_PRIVACY_SCHEMA_minimo",
        "coherencia_de_flows F_Login/F_Register/F_Recover/F_MFA/F_SessionExpired/F_LogOff",
        "referencias_de_rutas_consistentes (ej. route en screens vs flows vs menu)"
      ]
    },
    "delta_correccion": {
      "max_reintentos": 2,
      "estrategia": "ajustar solo nodos que fallaron validación",
      "registro": "guardar diferencias en nodo MetaViolations (si se desea)"
    },
    "epsilon_paquete": {
      "orden": "seguir RENDER_ORDER",
      "checklist_DoD": [
        "todos los SCHEMAS presentes",
        "screens core + auth definidas",
        "flows conectan las pantallas esperadas",
        "tokens no duplicados ni huérfanos",
        "sin violaciones críticas reportadas"
      ]
    }
  },

  "render_order": [
    "meta",
    "flags",
    "inputs_schema",
    "contracto_salida",
    "design_system",
    "atomic_library",
    "screens",
    "flows",
    "data_model",
    "a11y_seo_pwa",
    "security_privacy",
    "mocks",
    "i18n_ux_copy",
    "eval",
    "telemetry",
    "ssr_ssg_adapt",
    "prioridades",
    "pipeline",
    "inferencias_defecto",
    "guard",
    "violations"
  ],

  "violations": []
}
Tú dijiste:

Informe de Implementación de Fase 2: Integración de Firebase con Hábitat Conectado


I. Introducción a la Fase 2: Arquitectura de Integración de Firebase con Next.js 14


De Prototipo a Plataforma

La finalización de la Fase 1 ha establecido "Hábitat Conectado V1.0" como un prototipo de Progressive Web App (PWA) de alta fidelidad. Esta V1.0, construida sobre Next.js 14 (App Router), TypeScript y ShadCN, simula con éxito la experiencia del usuario final y es completamente funcional como una PWA instalable, completa con un Service Worker básico y un manifiesto de aplicación web.
La Fase 2 marca la transición fundamental de este prototipo visual a una aplicación full-stack V2.0 basada en datos. El objetivo principal es desmantelar sistemáticamente toda la lógica de mock (datos simulados) y reemplazarla con una arquitectura de backend robusta, escalable y en tiempo real.

Visión General de la Arquitectura de Destino

Para lograr esta transición, se adoptará una arquitectura que aprovecha Firebase como un Backend-as-a-Service (BaaS) integral, en conjunto con las capacidades de renderizado híbrido de Next.js 14.
Firebase (BaaS): Firebase proporcionará los servicios de backend gestionados críticos:
Firebase Authentication: Gestionará la identidad del usuario, el inicio de sesión (Email/Contraseña y OTP Telefónico) y la seguridad de la sesión.
Cloud Firestore: Servirá como la base de datos NoSQL principal, almacenando todos los datos de la aplicación (usuarios, tickets, reservas, etc.) y proporcionando capacidades de consulta en tiempo real.
Next.js 14 (App Router): La aplicación Next.js no actuará como un simple cliente de JavaScript. Se aprovechará su arquitectura híbrida:
Entorno de Cliente: Los Componentes de Cliente ('use client') manejarán la interactividad del usuario, el estado local y las suscripciones de datos en tiempo real.
Entorno de Servidor: Los Server Components (RSC), las Server Actions y los Route Handlers se ejecutarán en el servidor. Este entorno gestionará de forma segura las sesiones de usuario, ejecutará la lógica de negocio (mutaciones de datos) y realizará el renderizado inicial de datos, proporcionando un rendimiento de carga óptimo.
Esta arquitectura dual nos permite construir una aplicación que se siente instantánea (gracias al renderizado del servidor de Next.js), dinámica (gracias a los datos en tiempo real de Firestore) y segura (gracias a la gestión de sesiones del lado del servidor).

II. Configuración y Cimientos del Proyecto en Firebase

Antes de escribir cualquier código de integración, se debe configurar el proyecto de Firebase y activar los servicios necesarios.

Creación del Proyecto "Hábitat Conectado"

El primer paso es la configuración en la consola de Firebase.
Navegue a Firebase console y haga clic en "Agregar proyecto".1
Asigne el nombre "Hábitat Conectado" al proyecto.
Continúe con los pasos de configuración, deshabilitando Google Analytics por ahora si se prefiere, y cree el proyecto.
Una vez en el panel del proyecto, registre una nueva "Aplicación Web" (icono </>).
Asigne un apodo (p.ej., "web-app") y registre la aplicación. No es necesario configurar Firebase Hosting en este momento.
Firebase proporcionará un objeto de configuración firebaseConfig. Este objeto contiene las claves del lado del cliente y es esencial para la Sección III.

Configuración de Servicios Esenciales

Con el proyecto creado, se deben activar y configurar los dos servicios centrales: Authentication y Firestore.

Authentication

Este servicio gestionará la identidad de los residentes y administradores.
En el panel de Firebase, navegue a "Compilación" -> "Authentication".
Haga clic en "Comenzar".
En la pestaña "Sign-in method", habilite los proveedores requeridos por la V1.0:
Correo electrónico/Contraseña: Active este proveedor.3
Teléfono: Active este proveedor. Esto es crucial para el flujo de inicio de sesión con OTP (One-Time Password) simulado en la V1.0.5 Firebase gestionará el envío de SMS y la verificación del código.

Cloud Firestore

Esta será la base de datos principal de la aplicación.
En el panel de Firebase, navegue a "Compilación" -> "Firestore Database".
Haga clic en "Crear base de datos".1
Decisión Crítica (Modo de Inicio): Se le pedirá que inicie en "Modo de Producción" (Bloqueado) o "Modo de Prueba".1
Modo de Producción: (allow read, write: if false;) Rechaza todas las lecturas y escrituras de los clientes.1
Modo de Prueba: (allow read, write: if request.time < timestamp;) Permite el acceso abierto durante un período de desarrollo limitado.2
Selección: Inicie en Modo de Prueba. Esto es fundamental para un desarrollo ágil. Permite que el frontend (Fase 1) comience a interactuar con la base de datos real sin ser bloqueado por reglas de seguridad que aún no se han implementado. La aplicación se asegurará por completo en la Sección VII de este informe.7
Selección de Ubicación: Elija una ubicación regional para sus datos (p.ej., us-central). Esta decisión es permanente, afecta la latencia y debe estar geográficamente cerca de la mayoría de sus usuarios.
Con estos pasos, el backend de Firebase está listo para aceptar conexiones y datos.

III. El Patrón Arquitectónico Central: Integración Dual del SDK de Firebase

El desafío de integrar Firebase con Next.js 14 App Router radica en sus dos entornos de ejecución distintos. El código puede ejecutarse en el navegador (Componentes de Cliente) o en el servidor (Server Components, Server Actions).9 Un intento de usar un único SDK de Firebase fallará. Por lo tanto, se debe implementar un patrón de "SDK Dual".

SDK 1: El SDK de Cliente (Modular v9+)

Propósito: Este SDK está diseñado para ejecutarse en el navegador. Se utilizará exclusivamente dentro de Componentes de Cliente (archivos marcados con 'use client').
Funciones Clave: Gestiona la interactividad del usuario final. Sus responsabilidades principales serán:
signInWithEmailAndPassword, signInWithPhoneNumber, RecaptchaVerifier (para iniciar sesión).
onSnapshot (para escuchar actualizaciones de datos en tiempo real).
Instalación: npm install firebase.10

SDK 2: El SDK de Administrador (Admin SDK)

Propósito: Este SDK está diseñado para entornos de servidor privilegiados y nunca debe exponerse al navegador. Se utilizará en Server Actions, Route Handlers y Server Components.
Funciones Clave: Realiza operaciones de backend seguras. Sus responsabilidades incluyen:
Verificar tokens de sesión (verifySessionCookie) y crear tokens (createSessionCookie).
Acceso directo a la base de datos (adminDb) que omite todas las Reglas de Seguridad de Firestore. Esto es necesario para la lógica administrativa y las Server Actions que operan con autoridad.11
Instalación: npm install firebase-admin.14

Gestión de Variables de Entorno (Claves y Secretos)

La gestión adecuada de las claves de API es la base de la seguridad de esta arquitectura.

Claves del Cliente

Estas son las claves del objeto firebaseConfig obtenido en el Paso II.10
Cree un archivo .env.local en la raíz del proyecto.
Agregue las claves del firebaseConfig, pero con el prefijo NEXT_PUBLIC_. Este prefijo es una convención de Next.js para exponer variables de forma segura al entorno del navegador.17

Ini, TOML


# file:.env.local

# Firebase Client SDK (público)
NEXT_PUBLIC_FIREBASE_API_KEY="AIza..."
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN="habitat-conectado.firebaseapp.com"
NEXT_PUBLIC_FIREBASE_PROJECT_ID="habitat-conectado"
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET="habitat-conectado.appspot.com"
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID="..."
NEXT_PUBLIC_FIREBASE_APP_ID="..."



Claves del Administrador (Cuenta de Servicio)

El Admin SDK requiere una "Cuenta de Servicio", que otorga acceso de superusuario a su proyecto de Firebase.
En la consola de Firebase, vaya a "Configuración del proyecto" -> "Cuentas de servicio".
Seleccione "Node.js" y haga clic en "Generar nueva clave privada".18
Esto descargará un archivo .json. Este archivo es extremadamente sensible y nunca debe confirmarse en Git.
En lugar de leer el archivo JSON en tiempo de ejecución, el contenido completo de este archivo JSON se codificará y almacenará en .env.local como una variable sin el prefijo NEXT_PUBLIC_. Esto asegura que solo esté disponible en el entorno del servidor de Next.js.17

Ini, TOML


# file:.env.local

#... claves públicas...

# Firebase Admin SDK (secreto, solo servidor)
# Este es el contenido del archivo JSON de la cuenta de servicio,
# a menudo codificado en Base64 o escapado para caber en una sola línea.
FIREBASE_ADMIN_SERVICE_ACCOUNT="..."



Patrón de Inicialización (Los Archivos "Singleton")

Para evitar inicializar Firebase en cada hot reload o renderizado de componente, se crearán archivos helper que exporten una instancia "singleton" (única) de los servicios de Firebase.

Inicialización del Cliente

Este archivo inicializa el SDK para el uso en el navegador.

TypeScript


// file: src/lib/firebase/client.ts

import { initializeApp, getApps, getApp } from "firebase/app";
import { getAuth } from "firebase/auth";
import { getFirestore } from "firebase/firestore";

const firebaseConfig = {
  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,
  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,
};

// Inicializar Firebase solo una vez
const app =!getApps().length? initializeApp(firebaseConfig) : getApp();
const auth = getAuth(app);
const db = getFirestore(app);

export { app, auth, db };



Inicialización del Administrador

Este archivo inicializa el SDK privilegiado para el uso en el servidor.

TypeScript


// file: src/lib/firebase/admin.ts

import "server-only"; // Importación de seguridad de Next.js
import { initializeApp, getApps, getApp, cert } from "firebase-admin/app";
import { getAuth } from "firebase-admin/auth";
import { getFirestore } from "firebase-admin/firestore";

// Analizar las credenciales de la variable de entorno
const serviceAccount = JSON.parse(
  process.env.FIREBASE_ADMIN_SERVICE_ACCOUNT as string
);

// Inicializar Firebase Admin solo una vez
const app =!getApps().length
 ? initializeApp({
      credential: cert(serviceAccount),
    })
  : getApp();

const adminAuth = getAuth(app);
const adminDb = getFirestore(app);

export { app as adminApp, adminAuth, adminDb };


Análisis de "server-only":
La línea import "server-only"; 14 al inicio de admin.ts es una protección de seguridad crítica proporcionada por Next.js. El Admin SDK está lleno de dependencias de Node.js (como http2) y fallará la compilación de la aplicación si se importa accidentalmente en un Componente de Cliente.19 Esta directiva arroja un error en tiempo de compilación si cualquier módulo del lado del cliente intenta importar este archivo, previniendo la filtración de credenciales del servidor al navegador.14

IV. Estrategia de Autenticación Definitiva: El Patrón de Cookies de Sesión


El Problema: Los Server Components (RSC) son "Ajenos" al Estado

El método de autenticación estándar de Firebase, onAuthStateChanged, se basa en un listener del lado del cliente y en el almacenamiento de tokens en localStorage o indexedDB.20
Esta arquitectura es fundamentalmente incompatible con los Server Components (RSC) de Next.js 14. Los RSC se ejecutan en el servidor, a menudo durante la compilación o en respuesta a una solicitud. No tienen acceso a localStorage ni a los listeners del cliente. Por lo tanto, un RSC no tiene forma de saber quién es el usuario, quedando "ciego a la autenticación".21

La Solución: Cookies de Sesión (httpOnly)

La solución de nivel de producción es sincronizar el estado de autenticación del cliente con el servidor utilizando una cookie de sesión segura, httpOnly.14 El servidor (Next.js) leerá esta cookie en cada solicitud entrante para identificar al usuario. Esto hace que los Server Components y las Server Actions sean "conscientes de la sesión", permitiéndonos obtener datos del lado del servidor de forma segura para el usuario que ha iniciado sesión.

Implementación del Flujo de Autenticación (Paso a Paso)

Este es un flujo de múltiples pasos que coordina el SDK del cliente, el SDK del administrador y un Route Handler de Next.js.

Paso 1: Inicio de Sesión en el Cliente (Componente 'use client')

El usuario utiliza el formulario de inicio de sesión de la V1.0. Este componente ('use client') importa el SDK del cliente de lib/firebase/client.ts.

TypeScript


// En un componente de formulario de inicio de sesión ('use client')
import { signInWithEmailAndPassword } from "firebase/auth";
import { auth } from "@/lib/firebase/client"; // SDK del CLIENTE

//...
try {
  const userCredential = await signInWithEmailAndPassword(auth, email, password);
  // Éxito: el SDK del cliente ahora tiene el usuario en memoria
  //... proceder al Paso 2
} catch (error) {
  // Manejar error de inicio de sesión
}


23

Paso 2: Obtener el Token de Identificación (ID Token)

Inmediatamente después del inicio de sesión exitoso, se obtiene el idToken de corta duración del usuario. Este token es la prueba criptográfica de que el cliente ha iniciado sesión correctamente.

TypeScript


// Continuación del Paso 1
const user = userCredential.user;
const idToken = await user.getIdToken();
//... proceder al Paso 3


23

Paso 3: Intercambiar el Token por una Cookie de Sesión

El cliente envía este idToken a un Route Handler (Ruta de API) de Next.js dedicado. Este handler se ejecuta de forma segura en el servidor.

TypeScript


// Continuación del Paso 2
await fetch("/api/auth/session", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
  },
  body: JSON.stringify({ idToken }),
});
//... proceder al Paso 6


14

Paso 4: Crear la Cookie en el Servidor (El Route Handler)

Se crea un Route Handler de Next.js para recibir el idToken. Este archivo utiliza el SDK de Administrador para verificar el token y crear la cookie de sesión.

TypeScript


// file: src/app/api/auth/session/route.ts
import { NextRequest, NextResponse } from "next/server";
import { cookies } from "next/headers";
import { adminAuth } from "@/lib/firebase/admin"; // SDK de ADMINISTRADOR

export async function POST(request: NextRequest) {
  const { idToken } = await request.json();

  // 5 días de expiración
  const expiresIn = 60 * 60 * 24 * 5 * 1000;

  try {
    // Verificar el ID token (autentica al usuario en el servidor)
    await adminAuth.verifyIdToken(idToken);

    // Crear la cookie de sesión
    const sessionCookie = await adminAuth.createSessionCookie(idToken, {
      expiresIn,
    });
    //... proceder al Paso 5

  } catch (error) {
    return NextResponse.json({ error: "No autorizado" }, { status: 401 });
  }
}


14

Paso 5: Establecer la Cookie

Inmediatamente después de crear la sessionCookie en el Paso 4, el Route Handler la establece en la respuesta al cliente usando la función cookies() de Next.js.

TypeScript


// Continuación del Paso 4 (dentro del bloque try)

// Establecer la cookie de sesión segura y httpOnly
cookies().set("__session", sessionCookie, {
  httpOnly: true,
  secure: process.env.NODE_ENV === "production",
  sameSite: "lax",
  maxAge: expiresIn,
  path: "/",
});

return NextResponse.json({ status: "success" });


14
El atributo httpOnly: true es la piedra angular de esta estrategia. Impide que cualquier JavaScript del lado del cliente (incluidos los scripts maliciosos de un ataque XSS) lea la cookie, mitigando una clase significativa de vulnerabilidades de seguridad.26

Paso 6: Desactivar la Persistencia del Cliente

Una vez que el fetch del Paso 3 se completa con éxito, el cliente debe indicarle al SDK de cliente que "olvide" al usuario.

TypeScript


// Continuación del Paso 3 (después del fetch exitoso)
import { setPersistence, browserSessionPersistence } from "firebase/auth";

// Ceder el control de la sesión a la cookie del servidor
await setPersistence(auth, browserSessionPersistence.NONE);

// Redirigir al dashboard
router.push("/dashboard");


23
Este paso es crucial. Al establecer la persistencia en NONE, el SDK del cliente ya no utilizará localStorage. La cookie httpOnly (__session) se convierte en la única fuente de verdad para la sesión del usuario.25

Implementación del Flujo de OTP Telefónico (V1.0)

Este flujo, diseñado en la V1.0, sigue exactamente el mismo patrón arquitectónico, con la única diferencia en el Paso 1.
Paso 1 (Modificado): En el componente cliente del formulario de OTP, se utiliza RecaptchaVerifier y signInWithPhoneNumber (del SDK del cliente) para enviar el SMS.28 Cuando el usuario introduce el código, se llama a confirmationResult.confirm(code).
Pasos 2-6 (Idénticos): El objeto userCredential resultante de confirm(code) se utiliza para llamar a user.getIdToken(). A partir de ahí, el flujo es idéntico: el idToken se envía al endpoint /api/auth/session para crear la cookie httpOnly, y la persistencia del cliente se establece en NONE.

Protección de Rutas (Middleware y Capas de Verificación)

Con las cookies de sesión implementadas, el siguiente paso es proteger las rutas del dashboard.

La Trampa del Edge Runtime de Next.js

El lugar intuitivo para verificar una sesión es en el archivo middleware.ts de Next.js. Sin embargo, el SDK de firebase-admin no funciona en el Middleware de Next.js.29 El middleware se ejecuta en el "Edge Runtime" de Vercel, un entorno de ejecución ligero que no es Node.js completo y carece de las dependencias nativas de Node.js (como http2, net, tls) que el Admin SDK requiere.31

La Solución: El Patrón de Doble Capa

Dado que la verificación criptográfica no puede ocurrir en el middleware, se implementará un patrón de "doble capa" para la seguridad y la experiencia del usuario.

Capa 1: middleware.ts (Redirección "Tonta" para UX)

El middleware realizará una comprobación rápida y "tonta": solo verificará la existencia de la cookie __session.32
Si la cookie __session no existe, el usuario es redirigido a /login.
Si la cookie __session existe, el middleware permite que la solicitud continúe.
Esto no es una comprobación de seguridad real (la cookie podría estar caducada o falsificada), pero mejora la UX al redirigir instantáneamente a los usuarios anónimos.

TypeScript


// file: src/middleware.ts
import { NextRequest, NextResponse } from "next/server";

export function middleware(request: NextRequest) {
  const sessionCookie = request.cookies.get("__session");
  const { pathname } = request.nextUrl;

  // Si no hay cookie y se intenta acceder a una ruta protegida -> redirigir a login
  if (!sessionCookie && pathname.startsWith("/dashboard")) {
    const loginUrl = new URL("/", request.url);
    return NextResponse.redirect(loginUrl);
  }

  // Si hay cookie y se intenta acceder a login -> redirigir a dashboard
  if (sessionCookie && (pathname === "/" |

| pathname.startsWith("/auth"))) {
     const dashboardUrl = new URL("/dashboard", request.url);
     return NextResponse.redirect(dashboardUrl);
  }

  return NextResponse.next();
}

export const config = {
  matcher: ["/((?!api|_next/static|_next/image|favicon.ico).*)"],
};



Capa 2: Server Component (Verificación "Inteligente" de Seguridad)

La verificación de seguridad real (criptográfica) debe ocurrir dentro de los Server Components de las páginas protegidas o, mejor aún, en el layout.tsx raíz del dashboard.
Primero, se crea un guardia de autenticación del lado del servidor que sí puede usar el Admin SDK.

TypeScript


// file: src/lib/firebase/auth-guard.ts
import "server-only";
import { cookies } from "next/headers";
import { adminAuth } from "./admin";
import { redirect } from "next/navigation";
import type { UserRecord } from "firebase-admin/auth";

export async function getAuthenticatedUser(): Promise<UserRecord | null> {
  const sessionCookie = cookies().get("__session")?.value;

  if (!sessionCookie) {
    return null;
  }

  try {
    // Verificar la cookie. El 'true' comprueba la revocación.
    const decodedToken = await adminAuth.verifySessionCookie(
      sessionCookie,
      true 
    );
    const user = await adminAuth.getUser(decodedToken.uid);
    return user;
  } catch (error) {
    // La cookie es inválida (caducada, revocada, etc.)
    return null;
  }
}

// Función de guardia para usar en Server Components
export async function protectRoute(): Promise<UserRecord> {
  const user = await getAuthenticatedUser();
  if (!user) {
    redirect("/"); // Redirigir a la página de inicio de sesión
  }
  return user;
}


14
Luego, este guardia se usa en el layout del dashboard.

TypeScript


// file: src/app/dashboard/layout.tsx
import { protectRoute } from "@/lib/firebase/auth-guard";

export default async function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  // Esta es la comprobación de seguridad REAL.
  // Se ejecuta en el servidor antes de renderizar la página.
  const user = await protectRoute(); 

  // Si el usuario es válido, el layout se renderiza.
  // Si no, protectRoute() ya habrá redirigido.
  return (
    <main>
      {/* <Navbar user={user} />... etc. */}
      {children}
    </main>
  );
}


Esta arquitectura de doble capa proporciona lo mejor de ambos mundos: redirecciones instantáneas en el edge para la UX y verificaciones de seguridad robustas en el servidor para la protección de datos.

V. Modelado de Datos en Firestore: La Estructura de "Hábitat Conectado"


Principios de NoSQL Aplicados

El diseño de una base de datos NoSQL como Firestore difiere fundamentalmente del de SQL. El objetivo principal es modelar los datos para optimizar los patrones de consulta (lectura) de la aplicación, en lugar de normalizar los datos para evitar la redundancia.33
Desnormalización: Es una práctica estándar y recomendada. Duplicar datos (como el nombre de un usuario en un ticket que creó) es aceptable y, a menudo, necesario para evitar costosas consultas de "unión" (JOINs) que deben realizarse manualmente en el lado del cliente.33
Optimización de Lectura: La estructura de datos debe reflejar las vistas de la interfaz de usuario. Si una vista necesita mostrar "tickets y sus autores", la colección de tickets debe contener la información del autor que se necesita, incluso si está duplicada de la colección users.

Análisis de Colecciones Raíz vs. Subcolecciones

Firestore ofrece dos formas principales de organizar datos jerárquicamente:
Subcolecciones: Son colecciones anidadas dentro de un documento (p.ej., condominios/{id}/anuncios/{id}).34 Son ideales para datos que tienen una relación de propiedad estricta con el documento principal y que casi nunca se consultan independientemente del padre.36
Colecciones Raíz: Son colecciones de nivel superior (p.ej., tickets/). Son preferibles para datos que deben consultarse globalmente, a través de diferentes propietarios.38
Análisis de Caso (Tickets):
Un diseño intuitivo podría ser anidar los tickets de un usuario (users/{userId}/tickets/{ticketId}). Sin embargo, esto crea un problema significativo: un Administrador de "Hábitat Conectado" necesita ver todos los tickets de un condominio, no solo los de un usuario.
Si bien una "Consulta de Grupo de Colecciones" (collectionGroup) podría consultar todos los tickets a través de todos los usuarios 38, esto añade complejidad a las reglas de seguridad.41
Decisión Arquitectónica: Es más limpio, escalable y fácil de consultar que tickets sea una colección raíz. Cada documento de ticket contendrá campos de referencia desnormalizados como userId y condominioId. Esto permite consultas simples y eficientes para ambos roles:
Residente: db.collection('tickets').where('userId', '==', currentUser.uid)
Administrador: db.collection('tickets').where('condominioId', '==', admin.condoId)
Se utilizarán subcolecciones para casos de uso estrictamente contenidos, como los mensajes dentro de un ticket (tickets/{ticketId}/mensajes/{mensajeId}).

Tabla: Esquema de Datos de "Hábitat Conectado" (V2.0)

La siguiente tabla define la arquitectura de la base de datos de Firestore, que servirá como fuente de verdad para el desarrollo del backend.

Módulo (V1.0)
Colección (Raíz / Subcolección)
ID del Documento
Campos Clave y Tipos de Datos
Justificación del Diseño
Usuarios
users (Raíz)
{userId}
email: string, nombre: string, telefono: string, rol: string ('residente'|'admin'), condominioId: string (ref), apartamento: string
El ID del documento es el uid de Firebase Auth.42 El rol y condominioId son cruciales para las reglas RBAC.43
Condominios
condominios (Raíz)
{condominioId} (auto-gen)
nombre: string, direccion: string, configuracionAmenities: array<map>
Colección raíz para la información global de cada complejo residencial.
Anuncios
condominios/{condominioId}/anuncios (Subcolección)
{anuncioId} (auto-gen)
titulo: string, cuerpo: string, fechaCreacion: timestamp, userId: string (ref autor)
Los anuncios están estrictamente ligados a un condominio. Este es un caso de uso perfecto para una subcolección.36
Tickets
tickets (Raíz)
{ticketId} (auto-gen)
userId: string (ref), condominioId: string (ref), estado: string ('abierto'|'cerrado'), categoria: string, titulo: string, fechaCreacion: timestamp
Colección raíz para permitir consultas globales por parte de administradores.38 userId y condominioId están desnormalizados para la consulta.
Mensajes
tickets/{ticketId}/mensajes (Subcolección)
{mensajeId} (auto-gen)
userId: string (ref autor), texto: string, timestamp: timestamp, imagenUrl: string (opcional)
Los mensajes solo existen en el contexto de un ticket. Patrón de subcolección clásico.37
Reservas
reservas (Raíz)
{reservaId} (auto-gen)
userId: string (ref), condominioId: string (ref), amenityId: string, fechaHoraInicio: timestamp, fechaHoraFin: timestamp, estado: string ('confirmada'|'pendiente')
Colección raíz para permitir consultas de calendario globales (p.ej., "ver todas las reservas para la alberca hoy") y evitar conflictos.
Pagos
pagos (Raíz)
{pagoId} (auto-gen)
userId: string (ref), condominioId: string (ref), monto: number, concepto: string, estado: string ('pendiente'|'pagado'), fechaVencimiento: timestamp, fechaPago: timestamp (opcional)
Colección raíz esencial para la contabilidad y auditoría.
Visitantes
visitantes (Raíz)
{visitanteId} (auto-gen)
userId: string (ref residente), condominioId: string (ref), nombreVisitante: string, documentoVisitante: string, fechaHoraIngresoEstimada: timestamp, qrCodeUrl: string (opcional)
Colección raíz para que el personal de seguridad pueda consultar rápidamente las autorizaciones de ingreso.


VI. Implementación de la Lógica de Negocio: Refactorización a Server Actions y RSC

Con la autenticación y el modelo de datos definidos, se refactorizarán los flujos de la V1.0 para usar datos reales.

Mutaciones de Datos (Escrituras) con Server Actions

Next.js 14 introduce las Server Actions ('use server') como el método preferido para manejar mutaciones de datos (crear, actualizar, eliminar).44 Reemplazan la necesidad de crear Route Handlers (Rutas de API) explícitos para cada envío de formulario.45

Refactorización del Prototipo (Ej: Crear Ticket)

El formulario "Crear Ticket" de la V1.0, que es un Componente de Cliente ('use client'), será modificado. En lugar de llamar a una función mock onSubmit, su atributo action se vinculará directamente a una Server Action.
Se crea un nuevo archivo para las acciones relacionadas con los tickets.

TypeScript


// file: src/app/actions/tickets.ts
"use server"; // Directiva a nivel de módulo

import { adminDb } from "@/lib/firebase/admin";
import { protectRoute } from "@/lib/firebase/auth-guard";
import { collection, addDoc, serverTimestamp } from "firebase/firestore";
import { revalidatePath } from "next/cache";

// Definir el tipo de datos del formulario (buena práctica con TypeScript)
interface CreateTicketData {
  titulo: string;
  categoria: string;
  //... otros campos del formulario
}

export async function createTicketAction(formData: FormData) {
  let user;
  try {
    // 1. Autenticar: Verifica la cookie de sesión del servidor
    user = await protectRoute();
  } catch (error) {
    return { error: "No autorizado" };
  }

  // 2. Obtener datos del formulario
  const ticketData: CreateTicketData = {
    titulo: formData.get("titulo") as string,
    categoria: formData.get("categoria") as string,
  };

  try {
    // 3. Escribir en Firestore (usando el Admin SDK)
    const ticketRef = await addDoc(collection(adminDb, "tickets"), {
     ...ticketData,
      userId: user.uid,
      condominioId: user.customClaims?.condominioId, // Asumiendo que esto se establece (ver Sección VII)
      estado: "abierto",
      fechaCreacion: serverTimestamp(),
    });

    // 4. Revalidar caché: Informar a Next.js que los datos de esta ruta están obsoletos
    revalidatePath("/dashboard/tickets"); 

    return { success: true, ticketId: ticketRef.id };
  } catch (error) {
    return { error: "No se pudo crear el ticket" };
  }
}


46
El formulario cliente ('use client') ahora puede llamar a esta acción directamente:

TypeScript


// file: src/components/forms/CreateTicketForm.tsx
"use client";
import { createTicketAction } from "@/app/actions/tickets";
//...
<form action={createTicketAction}>
  <Input name="titulo" />
  <Select name="categoria">...</Select>
  <Button type="submit">Enviar Ticket</Button>
</form>


44

Obtención de Datos (Lecturas) - El Patrón Híbrido Definitivo

La obtención de datos presenta un desafío: se desea la carga inicial rápida (renderizado del servidor) y las actualizaciones en tiempo real (lado del cliente).
Intentar solo onSnapshot en el cliente resulta en skeletons de carga en cada navegación. Intentar solo el renderizado del servidor pierde la naturaleza de "aplicación en tiempo real".
La solución es un patrón híbrido que combina Server Components (RSC) para la carga inicial y Client Components para la hidratación en tiempo real.47

Implementación del Patrón Híbrido (Ej: Lista de Tickets)


1. page.tsx (Server Component - Carga Inicial)

La página principal de la ruta se define como un Server Component async. Utiliza el adminDb (a través del auth-guard) para obtener la instantánea inicial de los datos.

TypeScript


// file: src/app/dashboard/tickets/page.tsx
import { protectRoute } from "@/lib/firebase/auth-guard";
import { adminDb } from "@/lib/firebase/admin";
import { collection, query, where, getDocs } from "firebase/firestore";
import { TicketsListClient } from "./TicketsListClient"; // Importar el componente cliente

// Esta función se ejecuta en el servidor
async function getInitialTickets(userId: string) {
  const q = query(
    collection(adminDb, "tickets"),
    where("userId", "==", userId)
  );
  const snapshot = await getDocs(q);
  
  // Serializar los datos para pasarlos al cliente
  return snapshot.docs.map(doc => ({
    id: doc.id,
   ...doc.data(),
    // Los Timestamps de Firestore no son serializables, se deben convertir
    fechaCreacion: doc.data().fechaCreacion.toDate().toISOString(), 
  }));
}

export default async function TicketsPage() {
  const user = await protectRoute(); // Guardia de autenticación
  
  // Obtención de datos del lado del servidor
  const initialTickets = await getInitialTickets(user.uid); 

  // Renderizar el componente cliente, pasándole los datos iniciales
  return <TicketsListClient initialData={initialTickets} />;
}


9

2. TicketsListClient.tsx (Client Component - Tiempo Real)

Este componente recibe los datos iniciales, los muestra instantáneamente y luego se "hidrata" con una suscripción en tiempo real.

TypeScript


// file: src/app/dashboard/tickets/TicketsListClient.tsx
"use client";

import { useState, useEffect } from "react";
import { db, auth } from "@/lib/firebase/client"; // SDK del CLIENTE
import { collection, query, where, onSnapshot } from "firebase/firestore";

// Asumir que 'Ticket' es un tipo definido
type Ticket = { id: string; titulo: string; fechaCreacion: string; /*... */ };

interface TicketsListProps {
  initialData: Ticket;
}

export function TicketsListClient({ initialData }: TicketsListProps) {
  // 1. El estado se inicializa INMEDIATAMENTE con los datos del servidor
  const = useState(initialData);
  const [loading, setLoading] = useState(true); // Carga solo para el listener

  useEffect(() => {
    // 2. useEffect se activa DESPUÉS de la carga inicial
    const userId = auth.currentUser?.uid;
    if (!userId) {
      setLoading(false);
      return; // El usuario aún no está listo en el cliente
    }

    const q = query(
      collection(db, "tickets"),
      where("userId", "==", userId)
    );

    // 3. Se suscribe a actualizaciones en TIEMPO REAL
    const unsubscribe = onSnapshot(q, (snapshot) => {
      const liveTickets: Ticket = snapshot.docs.map(doc => ({
        id: doc.id,
       ...doc.data(),
        fechaCreacion: doc.data().fechaCreacion.toDate().toISOString(),
      })) as Ticket;
      
      // 4. Actualiza el estado con los datos más recientes
      setTickets(liveTickets); 
      setLoading(false);
    });

    // 5. Limpia la suscripción al desmontar
    return () => unsubscribe(); 
  }, [auth.currentUser]); // Re-ejecutar si el usuario de auth cambia

  //... Renderizar la lista de 'tickets'
  return (
    <div>
      {/* El estado 'tickets' siempre está poblado */}
      {tickets.map(ticket => (
        <div key={ticket.id}>{ticket.titulo}</div>
      ))}
    </div>
  );
}


49

Gestión de Estados de Carga (React Suspense)

El prototipo V1.0 ya incluye componentes Loading Skeleton. Con el patrón RSC anterior, integrarlos es automático.
Al implementar el page.tsx asíncrono (Paso 1 anterior), Next.js buscará un archivo loading.tsx en la misma carpeta.52

TypeScript


// file: src/app/dashboard/tickets/loading.tsx
import { TicketSkeleton } from "@/components/ui/skeletons";

// Este componente se mostrará automáticamente
export default function Loading() {
  return (
    <div>
      <TicketSkeleton />
      <TicketSkeleton />
      <TicketSkeleton />
    </div>
  );
}


52
Mientras la función getInitialTickets(...) (que es async) se está ejecutando en el servidor, Next.js envolverá page.tsx en un boundary de React Suspense y usará loading.tsx como su fallback.53 Esto muestra el skeleton al usuario durante la obtención de datos del servidor, reemplazándolo con el contenido real una vez que la promesa se resuelve.

VII. Blindaje de la Aplicación: Reglas de Seguridad de Firestore

La configuración actual en "Modo de Prueba" es una brecha de seguridad.7 Es imperativo implementar un conjunto robusto de Reglas de Seguridad de Firestore. Estas reglas se ejecutan en los servidores de Google y son la línea de defensa final, protegiendo los datos incluso si el frontend se ve comprometido o un usuario malintencionado intenta acceder directamente a la API.54
Se debe editar el archivo firestore.rules y desplegarlo usando Firebase CLI.



rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    //... reglas
  }
}


41

Reglas Basadas en Autenticación y Propiedad

El principio más básico es que los usuarios solo deben poder acceder a sus propios datos.
request.auth: Es el objeto de autenticación del usuario que realiza la solicitud. Si es null, el usuario no está autenticado.42
resource.data: Es el documento existente en la base de datos.42
request.resource.data: Es el documento nuevo que se intenta escribir.42
Regla de Ejemplo (Colección users):
Los usuarios solo pueden leer y actualizar su propio documento de perfil.



match /users/{userId} {
  // El usuario autenticado puede leer y actualizar su propio documento
  allow read, update: if request.auth!= null && request.auth.uid == userId;
  
  // Un usuario autenticado puede crear su propio perfil 
  // (útil durante el registro)
  allow create: if request.auth!= null; 
}


42
Regla de Ejemplo (Colección tickets):
Los usuarios solo pueden leer los tickets que crearon.



match /tickets/{ticketId} {
  // El propietario del ticket (almacenado en el campo 'userId' del documento) 
  // puede leer y actualizar (p.ej., añadir un mensaje)
  allow read, update: if request.auth!= null && 
                          request.auth.uid == resource.data.userId;
                          
  // Cualquier usuario autenticado puede crear un nuevo ticket
  allow create: if request.auth!= null;
}


42

Control de Acceso Basado en Roles (RBAC): Administradores vs. Residentes

"Hábitat Conectado" requiere que los "Administradores" tengan acceso elevado (p.ej., leer todos los tickets de un condominio).43
Existen dos métodos para implementar RBAC en las reglas de seguridad:
Método Lento (Costoso): Usar get() dentro de la regla para leer el documento de rol del usuario desde la colección users.59 Esto es desaconsejado, ya que consume una operación de lectura de Firestore por cada solicitud de datos que se verifica.60
Método Rápido (Preferido): Usar Custom Claims de Firebase Auth.43
Se adoptará el método de Custom Claims. Se debe crear un script de administración (o una futura Cloud Function) que asigne claims a los usuarios, por ejemplo:
adminAuth.setCustomUserClaims(userId, { role: 'admin', condominioId: 'condominio-abc' });
Estos claims se adjuntan de forma segura al token de autenticación del usuario y están disponibles en las reglas de seguridad de forma gratuita a través de request.auth.token.43
Regla de Ejemplo RBAC (Colección tickets):
Permitir que los administradores lean y actualicen cualquier ticket dentro de su propio condominio.



match /tickets/{ticketId} {
  // El propietario puede leer/actualizar
  allow read, update: if request.auth!= null && 
                          request.auth.uid == resource.data.userId;
  allow create: if request.auth!= null;
  
  // El Administrador del condominio correspondiente puede leer/actualizar
  allow read, update: if request.auth!= null &&
                         request.auth.token.role == 'admin' &&
                         request.auth.token.condominioId == resource.data.condominioId;
}


42

Tabla: Matriz de Reglas de Seguridad de "Hábitat Conectado"

La siguiente matriz resume el conjunto de reglas de firestore.rules que se deben implementar para pasar a producción.
Colección
Rol: Residente (Propietario)
Rol: Residente (Otros)
Rol: Admin (del Condominio)
Rol: No Autenticado
users/{userId}
read, update (si userId == auth.uid)
read (solo campos públicos como nombre)
read (si condoId == auth.token.condoId)
none
condominios/{condoId}
read (si user.condoId == condoId)
read (si user.condoId == condoId)
read, update
none
condominios/{condoId}/anuncios
read
read
create, update, delete
none
tickets/{ticketId}
read, update (si userId == auth.uid)
none
read, update (si condoId == auth.token.condoId)
none
tickets/{ticketId}/mensajes
read, create (si es propietario del ticket padre)
none
read, create (si es admin del ticket padre)
none
reservas/{reservaId}
read, create, delete (si userId == auth.uid)
read (solo para ver horarios, sin userId)
read, update (p.ej. confirmar), delete
none
pagos/{pagoId}
read (si userId == auth.uid)
none
read, create, update
none
visitantes/{visitanteId}
read, create, delete (si userId == auth.uid)
none
read (p.ej. personal de seguridad)
none

42

VIII. Estrategia Avanzada de PWA y Sincronización Offline


El Desafío Central de la PWA "Autenticada"

La V1.0 de "Hábitat Conectado" es una PWA, diseñada para ser "instalable" y "capaz de funcionar sin conexión". Sin embargo, existe un conflicto aparente entre las estrategias de las Secciones IV y VI:
Autenticación (Sección IV): Requiere setPersistence(auth, 'none') para ceder el control a las cookies del servidor httpOnly.23
Datos Offline (PWA): Requiere firestore.enablePersistence() para que Firestore almacene en caché los datos en IndexedDB para su uso sin conexión.62
¿Cómo puede la aplicación "no persistir" la autenticación y al mismo tiempo "persistir" los datos?

Resolución del Conflicto: Persistencia de Auth vs. Persistencia de Datos

La solución radica en comprender que estas son dos características completamente separadas e independientes.20
Persistencia de Autenticación (setPersistence): Controla cómo el SDK de cliente de Firebase Auth gestiona el estado de onAuthStateChanged y los tokens de usuario en el almacenamiento local.20 Al establecerlo en none, simplemente le decimos al SDK del cliente que no almacene en caché el estado de autenticación.
Persistencia de Datos (enablePersistence): Controla cómo el SDK de Cloud Firestore gestiona el caché de datos (documentos y colecciones) en IndexedDB.62
No hay conflicto técnico en habilitar uno y deshabilitar el otro.

La Estrategia de Implementación (Hacer Ambas Cosas)

La implementación correcta es habilitar la persistencia de datos de Firestore mientras se deshabilita la persistencia de autenticación del cliente.
Habilitar Persistencia de Datos: En el archivo de inicialización del cliente (lib/firebase/client.ts), se debe habilitar la persistencia de Firestore. Con el SDK v9+ modular, esto se hace durante la inicialización de Firestore.
TypeScript
// file: src/lib/firebase/client.ts (Actualizado)
import { initializeApp, getApps, getApp } from "firebase/app";
import { getAuth, setPersistence, browserSessionPersistence } from "firebase/auth";
import { 
  getFirestore, 
  initializeFirestore, 
  persistentLocalCache 
} from "firebase/firestore"; // Importar helpers de caché

//... firebaseConfig...

const app =!getApps().length? initializeApp(firebaseConfig) : getApp();
const auth = getAuth(app);

// Habilitar la persistencia offline de Firestore (IndexedDB)
const db = initializeFirestore(app, {
  localCache: persistentLocalCache({
    // Configuración opcional
  })
});

export { app, auth, db };

62
Manejar la Persistencia de Autenticación: El flujo de inicio de sesión de la Sección IV permanece sin cambios. Después de que el endpoint /api/auth/session crea la cookie httpOnly, el cliente aún llama a setPersistence(auth, 'none').23

Análisis de la Experiencia del Usuario Offline

Este enfoque dual crea una PWA offline robusta:
Usuario Inicia Sesión (Online): El usuario se autentica. Se establece la cookie __session. El usuario navega a /dashboard/tickets. El patrón híbrido (Sección VI) obtiene los datos del servidor. enablePersistence hace que Firestore almacene automáticamente estos tickets en el caché de IndexedDB.62
Usuario Pierde Conexión (Modo Avión, App Abierta):
El Service Worker (V1.0) sirve el shell de la aplicación (HTML, CSS, JS).
El usuario navega a /dashboard/reservas.
El getInitialTickets del Server Component falla (sin red).
El TicketsListClient (Componente Cliente) se monta. Su useEffect llama a onSnapshot.
onSnapshot falla al contactar al servidor, pero enablePersistence interviene automáticamente y sirve los datos (si se visitaron previamente) desde el caché de IndexedDB.62
Escritura Offline: Si el usuario crea un nuevo ticket (usando la Server Action), la solicitud de red fallará. Sin embargo, si la mutación se duplica en el cliente (una práctica recomendada para PWA offline), la llamada al SDK del cliente de Firestore pondrá la escritura en una cola de mutaciones offline.62
Usuario Vuelve (Online): Firestore detecta la conexión y sincroniza automáticamente la cola de mutaciones offline con el servidor.62
Usuario Cierra y Reabre la PWA (Offline): Este es el escenario más complejo.
El Service Worker (V1.0) sirve el shell de la aplicación.
La aplicación se carga. El middleware.ts (Capa 1) ve la cookie __session (que persiste sin conexión) y permite el acceso a /dashboard.
El DashboardLayout (Capa 2) llama a protectRoute(). Esta función intenta verificar la cookie llamando a adminAuth.verifySessionCookie. Esta llamada de red falla porque el servidor está inaccesible.
protectRoute() devuelve null, y el usuario es redirigido a /login.
La Experiencia Real: El usuario ve la página de inicio de sesión. Sin embargo, si la página de inicio de sesión o el layout global aún contienen componentes que leen de Firestore (p.ej., un widget de "Últimos Anuncios"), enablePersistence aún servirá esos datos desde el caché.62 La aplicación proporciona una experiencia de "solo lectura" de los datos previamente cacheados, incluso si el estado de autenticación no se puede verificar.

IX. Conclusión y Hoja de Ruta de la Fase 3


Resumen de la Fase 2

La Fase 2 ha transformado "Hábitat Conectado" de un prototipo visual en una arquitectura de aplicación web full-stack, segura y con capacidad de datos.
Se ha establecido una arquitectura de doble SDK (Cliente y Administrador) para interactuar de forma segura con Firebase desde el entorno híbrido de Next.js 14.
Se ha implementado el patrón de autenticación de cookies de sesión httpOnly, haciendo que los Server Components sean "conscientes de la sesión" y mitigando los riesgos de XSS.
Se ha diseñado un esquema de base de datos NoSQL escalable en Firestore, optimizado para los patrones de consulta de la aplicación mediante el uso estratégico de colecciones raíz y subcolecciones.
Se han refactorizado los flujos de datos de la V1.0, utilizando Server Actions para mutaciones de datos y un patrón híbrido de RSC/Cliente para la obtención de datos, logrando cargas iniciales instantáneas y actualizaciones en tiempo real.
Se ha implementado un conjunto robusto de Reglas de Seguridad de Firestore, migrando de "Modo de Prueba" a un modelo de producción seguro basado en la propiedad y el Control de Acceso Basado en Roles (RBAC) mediante Custom Claims.
Se ha resuelto el conflicto de la PWA, habilitando la persistencia de datos offline de Firestore (enablePersistence) simultáneamente con la persistencia de autenticación none, garantizando una experiencia de usuario funcional sin conexión.

Hoja de Ruta - Próximos Pasos (Fase 3)

Con los cimientos del backend establecidos, la Fase 3 se centrará en enriquecer la plataforma con servicios adicionales de Firebase:
Firebase Storage: Integrar para permitir a los usuarios subir archivos, como fotos de perfil y adjuntos de imágenes para los tickets.
Firebase Cloud Functions (Triggers): Mover la lógica de negocio que no es iniciada por el usuario (p.ej., enviar un correo electrónico de bienvenida al registrarse, procesar un pago, generar miniaturas de imágenes) a triggers de Cloud Functions que se ejecutan en respuesta a eventos de la base de datos o de autenticación.
Asignación de Roles (RBAC): Construir la interfaz de administrador y la Cloud Function necesaria para asignar de forma segura los customClaims de 'admin' a los usuarios.
Firebase Cloud Messaging (FCM): Integrar FCM con el Service Worker de la PWA para enviar notificaciones push nativas, mejorando la participación del usuario (p.ej., "Nuevo anuncio publicado", "Su ticket ha sido actualizado").
Obras citadas
Quickstart: Create a Firestore database by using a web or mobile client library, fecha de acceso: noviembre 18, 2025, https://docs.cloud.google.com/firestore/native/docs/create-database-web-mobile-client-library
Primeros pasos con Cloud Firestore - Firebase, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/quickstart?hl=es-419
Authenticate with Firebase using Password-Based Accounts on Android, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/auth/android/password-auth
Authenticate with Firebase using Password-Based Accounts using Javascript - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/auth/web/password-auth
Authenticate with Firebase with a Phone Number Using JavaScript - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/auth/web/phone-auth
Firebase Authentication with Phone Number OTP in Android - GeeksforGeeks, fecha de acceso: noviembre 18, 2025, https://www.geeksforgeeks.org/android/firebase-authentication-with-phone-number-otp-in-android/
HOW TO CREATE A DATABASE IN FIREBASE CLOUD FIRESTORE - YouTube, fecha de acceso: noviembre 18, 2025, https://www.youtube.com/watch?v=FzXS6Jv2zec
Firebase Cloud Firestore security rules only allow read not write - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/67918324/firebase-cloud-firestore-security-rules-only-allow-read-not-write
Integrate Firebase with a Next.js app - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/codelabs/firebase-nextjs
Next.js 14 with Firebase: A Practical Walkthrough - DEV Community, fecha de acceso: noviembre 18, 2025, https://dev.to/wadizaatour/integrating-nextjs-with-firebase-a-practical-walkthrough-4j30
Add the Firebase Admin SDK to your server, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/admin/setup
firebase admin or normal firebase with next js - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/71118731/firebase-admin-or-normal-firebase-with-next-js
Firebase admin vs client : r/nextjs - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/nextjs/comments/o1o4v0/firebase_admin_vs_client/
Next.js 14: Server-side Authentication using Cookies with Firebase Admin SDK, fecha de acceso: noviembre 18, 2025, https://stackademic.com/blog/next-js-14-server-side-authentication-using-cookies-with-firebase-admin-sdk
Add Firebase to your JavaScript project | Firebase for web platforms, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/web/setup
Firebase and Next14: Firestore and Authentication complete tutorial using Next14 | by Shivesh Tiwari, fecha de acceso: noviembre 18, 2025, https://mrknown404.medium.com/firebase-and-next14-firestore-and-authentication-complete-tutorial-using-next14-4c6f8978758e
Guides: Environment Variables - Next.js, fecha de acceso: noviembre 18, 2025, https://nextjs.org/docs/pages/guides/environment-variables
Set up Firebase on Nextjs - Medium, fecha de acceso: noviembre 18, 2025, https://medium.com/@jogarcia/set-up-firebase-on-nextjs-21d54be828dc
Integrate Next.js | Firebase Hosting - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/hosting/frameworks/nextjs
Authentication State Persistence | Firebase - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/auth/web/auth-state-persistence
Next 13 React Server Components Firebase Auth Example : r/nextjs - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/nextjs/comments/14xqrt1/next_13_react_server_components_firebase_auth/
How you avoid making everything "use client" when using Firebase auth? : r/nextjs - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/nextjs/comments/192od4n/how_you_avoid_making_everything_use_client_when/
Manage Session Cookies | Firebase Authentication, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/auth/admin/manage-cookies
Implementing Session-Based Authentication with NestJS, Next.js 14 ..., fecha de acceso: noviembre 18, 2025, https://www.tuncpolat.dev/blog/implementing-session-based-authentication-with-nestjs-nextjs14-firebase-mongodb
How to set auth.currentUser when using session cookies? - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/78951226/how-to-set-auth-currentuser-when-using-session-cookies
How do you design a secure PWA for sensitive data? - Wild.Codes, fecha de acceso: noviembre 18, 2025, https://wild.codes/candidate-toolkit-question/how-do-you-design-a-secure-pwa-for-sensitive-data
PWA and Offline Mode How to deny the users access when the app goes in PWA... - DEV Community, fecha de acceso: noviembre 18, 2025, https://dev.to/exadra37/comment/13mid
Mratashnejad/firebase-phone-auth: Integrate Firebase Phone Authentication seamlessly with Next.js for efficient web apps. Next.js provides server-side rendering and routing while Firebase offers secure phone number verification via SMS. Leverage this combo for dynamic, scalable apps with robust user authentication. - GitHub, fecha de acceso: noviembre 18, 2025, https://github.com/Mratashnejad/firebase-phone-auth
Firebase middleware for authentication · vercel next.js · Discussion #33586 - GitHub, fecha de acceso: noviembre 18, 2025, https://github.com/vercel/next.js/discussions/33586
Middleware doesnt work with firebase-admin module beucase of OS Module, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/77099131/middleware-doesnt-work-with-firebase-admin-module-beucase-of-os-module
Firebase and Next.js middleware for authentication - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/Firebase/comments/sbhg4b/firebase_and_nextjs_middleware_for_authentication/
[Next.js] Firebase Authentication with Google Sign-in Using Cookies, Middleware, and Server Actions - DEV Community, fecha de acceso: noviembre 18, 2025, https://dev.to/yutakusuno/nextjs14-firebase-authentication-with-google-sign-in-using-cookies-middleware-and-server-actions-48h4
Data Modeling Basics for Cloud Firestore - GeeksforGeeks, fecha de acceso: noviembre 18, 2025, https://www.geeksforgeeks.org/firebase/data-modeling-basics-for-cloud-firestore/
Cloud Firestore Data model | Firebase, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/data-model
Elige una estructura de datos | Firestore - Firebase - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/manage-data/structure-data?hl=es-419
Firestore design decisions: subcollections vs references : r/Firebase - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/Firebase/comments/1frivtr/firestore_design_decisions_subcollections_vs/
Firestore: new collection vs subcollection - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/62962154/firestore-new-collection-vs-subcollection
Advantages of firestore sub-collections - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/47193903/advantages-of-firestore-sub-collections
Estructura datos | Firestore in Native mode | Google Cloud Documentation, fecha de acceso: noviembre 18, 2025, https://docs.cloud.google.com/firestore/native/docs/concepts/structure-data?hl=es-419
Understanding Collection Group Queries in Cloud Firestore - The Firebase Blog, fecha de acceso: noviembre 18, 2025, https://firebase.blog/posts/2019/06/understanding-collection-group-queries/
How Security Rules work - Firebase - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/rules/rules-behavior
Writing conditions for Cloud Firestore Security Rules | Firebase, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/security/rules-conditions
Security Rules and Firebase Authentication | Firebase Security Rules, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/rules/rules-and-auth
Data Fetching: Server Actions and Mutations | Next.js, fecha de acceso: noviembre 18, 2025, https://nextjs.org/docs/14/app/building-your-application/data-fetching/server-actions-and-mutations
Server Actions in Next.js 14: A Comprehensive Guide | by Aakash Kumar | Medium, fecha de acceso: noviembre 18, 2025, https://medium.com/@skysharinghisthoughts/server-actions-in-next-js-14-a-comprehensive-guide-732fef35bf9f
How to add documents to firestore from Nextjs14 using Server ..., fecha de acceso: noviembre 18, 2025, https://blog.thatanjan.com/blog/how-to-add-documents-to-firestore-from-nextjs14
Getting Started: Server and Client Components - Next.js, fecha de acceso: noviembre 18, 2025, https://nextjs.org/docs/app/getting-started/server-and-client-components
Nextjs mix server and client components - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/77993934/nextjs-mix-server-and-client-components
Get realtime updates with Cloud Firestore | Firebase, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/query-data/listen
Which react hook to use with firestore onsnapshot? - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/59944658/which-react-hook-to-use-with-firestore-onsnapshot
Build a CRUD application in React with Firebase Web SDK v9 - Firebase Codelabs, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/codelabs/build-crud-react-web
File-system conventions: loading.js | Next.js, fecha de acceso: noviembre 18, 2025, https://nextjs.org/docs/app/api-reference/file-conventions/loading
Loading Skeleton for Search & Pagination in NextJs 13 Movie App - YouTube, fecha de acceso: noviembre 18, 2025, https://www.youtube.com/watch?v=UNEXbGJCTw8
Can't anyone with my API key read or write on my Firestore? : r/Firebase - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/Firebase/comments/1in8z2k/cant_anyone_with_my_api_key_read_or_write_on_my/
Structuring Cloud Firestore Security Rules - Firebase - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/security/rules-structure
Setting Firebase Firestore security rules so only users can CRUD their own data and all else is ignored - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/61832065/setting-firebase-firestore-security-rules-so-only-users-can-crud-their-own-data
Protect a document based on its field values in Firestore security rules - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/62685301/protect-a-document-based-on-its-field-values-in-firestore-security-rules
Secure data access for users and groups | Firestore - Firebase, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/solutions/role-based-access
creating a multi-level role based access in firestore security rules - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/75752184/creating-a-multi-level-role-based-access-in-firestore-security-rules
Firestore Rules For Admin - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/67907233/firestore-rules-for-admin
A List of Firestore Security Rules for Your Firebase Project - Medium, fecha de acceso: noviembre 18, 2025, https://medium.com/firebase-developers/a-list-of-firebase-firestore-security-rules-for-your-project-fe46cfaf8b2a
Access data offline | Firestore - Firebase - Google, fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/firestore/manage-data/enable-offline
Use Firebase in a progressive web app (PWA), fecha de acceso: noviembre 18, 2025, https://firebase.google.com/docs/web/pwa
Firestore (Web version 9 modular): getDocsFromCache seems not working - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/70315073/firestore-web-version-9-modular-getdocsfromcache-seems-not-working
Can not enableIndexedDbPersistence from firebase v9 in a nextjs pwa - Stack Overflow, fecha de acceso: noviembre 18, 2025, https://stackoverflow.com/questions/74308238/can-not-enableindexeddbpersistence-from-firebase-v9-in-a-nextjs-pwa
Is offline persistence enough for optimal firestore usage? : r/Firebase - Reddit, fecha de acceso: noviembre 18, 2025, https://www.reddit.com/r/Firebase/comments/1imyx2q/is_offline_persistence_enough_for_optimal/
ChatGPT Plus

Pensó durante 1m 4s
{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_EXEC_BACKEND_FIREBASE_NEXT14_1",
  "meta_backend": {
    "nombre_plataforma": "Hábitat Conectado",
    "fase": "2",
    "objetivo": "Pasar de PWA prototipo con mocks a app full-stack basada en Firebase + Next.js 14",
    "stack": {
      "frontend": "Next.js 14 (App Router) + TypeScript + ShadCN + PWA",
      "backend_baas": "Firebase (Auth + Firestore)",
      "arquitectura": "renderizado híbrido (RSC + Client Components + Server Actions)"
    }
  },

  "backend_firebase_next14": {
    "proyecto_firebase": {
      "nombre_proyecto": "Hábitat Conectado",
      "app_web_alias": "web-app",
      "servicios_activados": [
        "Authentication (Email/Password, Phone/OTP)",
        "Cloud Firestore (modo prueba → producción)"
      ],
      "firebase_console_steps": [
        "Crear proyecto",
        "Registrar app web",
        "Copiar firebaseConfig",
        "Habilitar Email/Password",
        "Habilitar Phone/OTP",
        "Crear Firestore en modo prueba (migrar a reglas seguras en producción)"
      ]
    },

    "sdk_dual_pattern": {
      "descripcion": "Separar SDK cliente (browser) y SDK admin (server) para soportar App Router y RSC",
      "cliente": {
        "paquete": "firebase",
        "instalacion": "npm install firebase",
        "uso": [
          "Componentes 'use client'",
          "Auth de usuario final (signInWithEmailAndPassword, signInWithPhoneNumber, RecaptchaVerifier)",
          "Lectura/escritura en tiempo real con Firestore (onSnapshot, getDocs)"
        ],
        "archivo_singleton": "src/lib/firebase/client.ts",
        "config_env_vars": [
          "NEXT_PUBLIC_FIREBASE_API_KEY",
          "NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN",
          "NEXT_PUBLIC_FIREBASE_PROJECT_ID",
          "NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET",
          "NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID",
          "NEXT_PUBLIC_FIREBASE_APP_ID"
        ]
      },
      "admin": {
        "paquete": "firebase-admin",
        "instalacion": "npm install firebase-admin",
        "uso": [
          "Server Components",
          "Server Actions",
          "Route Handlers (app/api/*)",
          "Lógica privilegiada (verificar tokens, RBAC, migraciones, tareas administrativas)"
        ],
        "archivo_singleton": "src/lib/firebase/admin.ts",
        "seguridad": [
          "import \"server-only\" para bloquear import accidental en cliente",
          "usar credenciales de cuenta de servicio solo vía variables de entorno",
          "NO commitear el JSON de cuenta de servicio"
        ],
        "config_env_var": "FIREBASE_ADMIN_SERVICE_ACCOUNT"
      },
      "env_archivo": {
        "nombre": ".env.local",
        "reglas": {
          "cliente": "todas las claves de firebaseConfig con prefijo NEXT_PUBLIC_",
          "admin": "FIREBASE_ADMIN_SERVICE_ACCOUNT sin prefijo NEXT_PUBLIC_ (solo server)",
          "secreto": "JSON completo de la cuenta de servicio (idealmente codificado/Base64 o escapado una línea)"
        }
      }
    },

    "auth_session_cookie_pattern": {
      "motivacion": "RSC no pueden leer localStorage/IndexedDB; se requiere sesión server-aware basada en cookies httpOnly",
      "cookie_nombre": "__session",
      "flujo_login_email_password": {
        "paso_1_cliente_login": {
          "accion": "signInWithEmailAndPassword(auth, email, password)",
          "sdk": "cliente",
          "resultado": "userCredential con user"
        },
        "paso_2_cliente_id_token": {
          "accion": "const idToken = await user.getIdToken()",
          "resultado": "idToken de corta duración"
        },
        "paso_3_cliente_post_session": {
          "endpoint": "/api/auth/session",
          "method": "POST",
          "body": "{ idToken }",
          "resultado": "creación de cookie __session en el servidor"
        },
        "paso_4_servidor_verificar_y_crear_cookie": {
          "archivo": "src/app/api/auth/session/route.ts",
          "acciones": [
            "adminAuth.verifyIdToken(idToken)",
            "adminAuth.createSessionCookie(idToken, { expiresIn })",
            "cookies().set('__session', sessionCookie, { httpOnly:true, secure, sameSite:'lax', maxAge, path:'/' })"
          ],
          "seguridad": "httpOnly y secure en producción; cookie no accesible por JS del cliente"
        },
        "paso_5_cliente_desactivar_persistencia": {
          "accion": "setPersistence(auth, browserSessionPersistence.NONE)",
          "efecto": "estado de autenticación pasa a depender SOLO de la cookie __session",
          "post_accion": "router.push('/dashboard')"
        }
      },
      "flujo_login_otp_phone": {
        "igual_que_email": "misma secuencia de pasos 2–5",
        "diferencia": "Paso 1 usa signInWithPhoneNumber + RecaptchaVerifier + confirmationResult.confirm(code)"
      }
    },

    "route_protection_double_layer": {
      "problema": "Admin SDK no funciona en middleware (Edge Runtime); no se puede verificar JWT allí",
      "capas": {
        "capa_1_middleware_tonto": {
          "archivo": "src/middleware.ts",
          "logica": [
            "leer cookie __session",
            "si NO hay cookie y ruta comienza con /dashboard|/perfil|/notificaciones|/settings → redirect(/login)",
            "si hay cookie y ruta es /login|/register → redirect(/dashboard)",
            "no verifica criptográficamente la cookie (solo UX)"
          ],
          "config_matcher": "/((?!api|_next/static|_next/image|favicon.ico).*)"
        },
        "capa_2_guard_server_inteligente": {
          "archivo_guard": "src/lib/firebase/auth-guard.ts",
          "funciones": {
            "getAuthenticatedUser": {
              "descripcion": "leer cookie __session, verificarla con adminAuth.verifySessionCookie, devolver UserRecord o null",
              "parametros": [],
              "salida": "UserRecord|null"
            },
            "protectRoute": {
              "descripcion": "envoltorio que usa getAuthenticatedUser y hace redirect('/login') si no hay usuario",
              "uso": "en layouts/páginas protegidas"
            }
          },
          "uso_en_layout": {
            "ejemplo": "src/app/dashboard/layout.tsx",
            "patron": "const user = await protectRoute(); renderizar layout con user"
          }
        }
      }
    }
  },

  "firestore_model": {
    "principios": [
      "optimizar para patrones de lectura (no para normalización extrema)",
      "aceptar desnormalización cuando reduzca JOINs manuales",
      "colección raíz cuando se requiere consulta global (admin, agregados)",
      "subcolección cuando el dato solo tiene sentido dentro de un padre"
    ],
    "colecciones_raiz": {
      "users": {
        "id": "userId == auth.uid",
        "campos": [
          "email:string",
          "nombre:string",
          "telefono:string",
          "rol:'residente'|'admin'",
          "condominioId:string",
          "apartamento:string"
        ],
        "uso": "perfiles, RBAC, claims de condominio"
      },
      "condominios": {
        "id": "auto-gen",
        "campos": [
          "nombre:string",
          "direccion:string",
          "configuracionAmenities:array<map>"
        ]
      },
      "tickets": {
        "id": "auto-gen",
        "campos": [
          "userId:string",
          "condominioId:string",
          "estado:'abierto'|'cerrado'",
          "categoria:string",
          "titulo:string",
          "fechaCreacion:timestamp"
        ]
      },
      "reservas": {
        "id": "auto-gen",
        "campos": [
          "userId:string",
          "condominioId:string",
          "amenityId:string",
          "fechaHoraInicio:timestamp",
          "fechaHoraFin:timestamp",
          "estado:'confirmada'|'pendiente'"
        ]
      },
      "pagos": {
        "id": "auto-gen",
        "campos": [
          "userId:string",
          "condominioId:string",
          "monto:number",
          "concepto:string",
          "estado:'pendiente'|'pagado'",
          "fechaVencimiento:timestamp",
          "fechaPago:timestamp?"
        ]
      },
      "visitantes": {
        "id": "auto-gen",
        "campos": [
          "userId:string",
          "condominioId:string",
          "nombreVisitante:string",
          "documentoVisitante:string",
          "fechaHoraIngresoEstimada:timestamp",
          "qrCodeUrl:string?"
        ]
      }
    },
    "subcolecciones": {
      "condominios/{condominioId}/anuncios": {
        "id": "anuncioId",
        "campos": [
          "titulo:string",
          "cuerpo:string",
          "fechaCreacion:timestamp",
          "userId:string"
        ]
      },
      "tickets/{ticketId}/mensajes": {
        "id": "mensajeId",
        "campos": [
          "userId:string",
          "texto:string",
          "timestamp:timestamp",
          "imagenUrl:string?"
        ]
      }
    }
  },

  "firestore_rules": {
    "version": "rules_version = '2'",
    "base": "service cloud.firestore { match /databases/{database}/documents { ... } }",
    "reglas_users": {
      "path": "/users/{userId}",
      "rules": [
        "allow read, update: if request.auth != null && request.auth.uid == userId",
        "allow create: if request.auth != null"
      ]
    },
    "reglas_tickets": {
      "path": "/tickets/{ticketId}",
      "rules": [
        "allow create: if request.auth != null",
        "allow read, update: if request.auth != null && request.auth.uid == resource.data.userId",
        "allow read, update: if request.auth != null && request.auth.token.role == 'admin' && request.auth.token.condominioId == resource.data.condominioId"
      ]
    },
    "rbac_custom_claims": {
      "claim_role": "role:'admin'|'residente'",
      "claim_condominio": "condominioId:string",
      "asignacion_ejemplo": "adminAuth.setCustomUserClaims(userId, { role: 'admin', condominioId: 'condominio-abc' })",
      "ventaja": "usar request.auth.token.* en reglas sin gastos extra de lectura"
    }
  },

  "pwa_offline_strategy": {
    "conflicto": "auth sin persistencia en cliente vs datos con persistencia offline",
    "resolucion": "persistencia_auth = NONE, persistencia_datos = ON",
    "firestore_offline": {
      "archivo": "src/lib/firebase/client.ts",
      "patron": "initializeFirestore(app, { localCache: persistentLocalCache({ ... }) })",
      "efecto": "cache de datos en IndexedDB, colas de mutaciones offline"
    },
    "escenarios": {
      "online_login_y_navegacion": "cookie __session creada, datos iniciales de RSC cacheados por Firestore",
      "offline_mientras_app_abierta": "shell via SW, onSnapshot sirve datos cacheados; mutaciones encoladas",
      "offline_reabrir_app": "shell via SW, cookie __session aún existe pero verifySessionCookie falla; protectRoute redirige a login, pero los componentes que usen Firestore pueden obtener datos cacheados → modo solo lectura"
    }
  },

  "fase_3_roadmap": {
    "storage": {
      "objetivo": "subida de archivos (fotos de perfil, adjuntos en tickets)",
      "acciones": [
        "configurar Firebase Storage",
        "crear reglas de seguridad basadas en userId/condominioId",
        "integrar uploads con Server Actions + client previews"
      ]
    },
    "cloud_functions": {
      "objetivo": "lógica disparada por eventos",
      "triggers": [
        "onCreate(/users/{userId}) → enviar email bienvenida",
        "onWrite(/tickets/{ticketId}) → enviar notificación push/email",
        "onWrite(/pagos/{pagoId}) → actualizar dashboard financiero"
      ]
    },
    "rbac_ui": {
      "objetivo": "panel de administración para asignar roles",
      "acciones": [
        "crear UI para asignar admin/residente por condominio",
        "usar Cloud Function protegida para setCustomUserClaims",
        "reflejar roles en UI (menus, acciones permitidas)"
      ]
    },
    "fcm": {
      "objetivo": "notificaciones push PWA",
      "aspectos": [
        "registrar tokens de dispositivo por usuario",
        "integrar FCM con Service Worker de la PWA",
        "enviar push en eventos clave (ticket actualizado, nuevo anuncio, pago pendiente)"
      ]
    }
  }
}
Tú dijiste:
Especificación Técnica Maestra E2E: Fusión Semántica del Sistema
Versión del Artefacto: Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1 (Completa, Expandida)
Declaración de Propósito: El presente documento constituye la Fusión Semántica unificada de la totalidad de las especificaciones (ref. ..._1, ..._EXTRA_1, ..._COMPLEMENTO_2). Procede a describir el sistema integral "Auth + Dashboard", abarcando desde sus principios valóricos axiomáticos hasta la implementación pormenorizada de flujos y pantallas de soporte.
Audiencia Designada y Ámbito de Aplicación: Este artefacto se erige como la Fuente Única de Verdad (SSOT) para las cohortes de Ingeniería, Diseño de Producto y Aseguramiento de la Calidad (QA). Su objetivo primordial es prevenir la deriva de la implementación y certificar que los constructos de valor (Seguridad, Accesibilidad) y la codificación del diseño (Tokens) se encuentren intrínsecamente ligados a la lógica de la aplicación (Flujos). Este documento no es una sugerencia, sino el contrato de implementación que define el producto.
Sección 1: Pilares Axiomáticos y Requerimientos No Funcionales (El Valor)
A continuación, se enumeran los principios fundamentales e innegociables cuya aplicación es mandatoria y transversal a la totalidad del sistema. Estos pilares constituyen la base sobre la cual se evalúa la calidad y completitud de la implementación.
1.1. Accesibilidad (A11y) - Nivel AA
El sistema deberá garantizar la usabilidad para la totalidad de los usuarios, adhiriéndose estrictamente a las directrices WCAG 2.1, Nivel AA. El incumplimiento de estos puntos se considera un defecto de implementación.
Relación de Contraste: La totalidad del texto deberá cumplir con una luminancia de ≥4.5:1 (AA). Dicho cumplimiento se encuentra pre-calculado en la definición de los tokens semánticos (ej. text.main sobre bg.surface). La validación de contraste es una responsabilidad primaria del Sistema de Diseño.
Indicador de Foco Visible: Crítico para la navegación mediante teclado. Todo elemento susceptible de interacción (Button, Input, Link) deberá manifestar un contorno de 2px (border.bold) al recibir el foco. La colorimetría de dicho indicador utilizará un token de alto contraste (ej. accent.main). La ausencia de un indicador de foco visible o la pérdida del mismo (focus loss) se considera una violación crítica de A11y.
Secuencialidad de Tabulación: La secuencia de tabulación será lógica, predecible y conforme al flujo visual de lectura (izquierda-derecha, arriba-abajo). No deberán existir "trampas de foco" que impidan al usuario egresar de un componente (ej. un modal) mediante el uso del tabulador. El orden del DOM debe reflejar el orden lógico de la interfaz.
Enlaces de Omisión de Contenido: Se mandata la inclusión de un hipervínculo "Saltar al contenido principal" (href="#main") en el preámbulo del <body>. Dicho enlace debe ser el primer elemento enfocable en el DOM y se tornará visible al recibir foco. Este mecanismo permite a los usuarios de teclado obviar la navegación repetitiva en NavBar y SideNav.
Robustez en Formularios: Los errores de validación deberán ser robustos y programáticamente accesibles. Cada Field en estado error deberá tener su ErrorText (que es visual) conectado semántica e inequívocamente al Input mediante aria-describedby. Este mecanismo asegura que los lectores de pantalla anuncien el error específico al enfocar el campo, proveyendo contexto inmediato para la corrección.
Estructura Semántica (Landmarks): El uso de 'landmarks' HTML5 es mandatorio para la navegación de lectores de pantalla. NavBar se encapsulará en <header>, SideNav en <nav>, el contenido principal de la pantalla (ej. Dashboard) en <main id="main">, y Footer en <footer>.
Abstracción de la Información Cromática: El color no constituirá el único medio para transmitir información, con el fin de dar soporte a usuarios con deficiencias en la percepción del color (ej. deuteranopia). Los indicadores de estado (ok, error, warn) deberán suplementarse obligatoriamente con iconografía (Icon24) y texto descriptivo además del color (ej. state.err).
Preferencia de Movimiento Reducido: El sistema respetará la preferencia (prefers-reduced-motion). Las animaciones decorativas extensas (transiciones de layout, indicadores de carga complejos) deberán ser desactivadas o simplificadas a transiciones de opacidad (fade) si dicha preferencia se encuentra activa en el sistema operativo del usuario.
1.2. Seguridad y Privacidad
La seguridad se conceptualiza como una característica integral de la Interfaz de Usuario, trascendiendo su mera implementación en el backend. La UI es la primera línea de defensa contra ciertos vectores de ataque.
Autenticación y Prevención de Enumeración de Usuarios:
Se emplearán mensajes neutros para los flujos de inicio de sesión y recuperación. Queda estrictamente prohibido confirmar o negar la existencia de un identificador (email) de usuario. Esta medida previene la 'enumeración de usuarios', una técnica de ataque común donde un actor malicioso puede inferir la base de datos de usuarios.
F_Recover (Recuperación) deberá ejecutar el envío del correo electrónico solo si la cuenta existe, pero la Interfaz de Usuario, en todos los casos, deberá presentar el mismo mensaje de éxito neutro (definido en recover_mensaje_neutro). La UI debe ser agnóstica al resultado de la operación del backend.
Políticas de Contraseñas:
Longitud mínima (min_longitud): 12 caracteres.
Requerir 4 clases de caracteres: mayúscula, minúscula, número, símbolo.
Se implementará un PasswordMeter en screen-register que proporcione retroalimentación en tiempo real sobre estas reglas.
La validación deberá también prohibir contraseñas comunes (ej. 'password123', '123456') mediante una comprobación contra listas de diccionarios conocidas, y no deberá permitir que se incluya el nombre o email del usuario en la contraseña.
Privacidad y Consentimiento Explícito:
La recopilación de datos de telemetría y analítica requerirá un consentimiento explícito (opt-in), conforme a regulaciones como GDPR. El componente Checkbox(telemetry_opt_in) en screen-settings deberá presentarse desmarcado por defecto. El sistema debe funcionar en su totalidad incluso si el usuario deniega el consentimiento.
Gestión de Sesiones de Usuario:
Como componente de la seguridad de la cuenta, screen-profile (en su sección de Security) deberá implementar List(sessions), permitiendo al usuario visualizar y revocar sesiones activas en otros dispositivos. Esto provee transparencia y agencia al usuario sobre la huella de seguridad de su cuenta.
1.3. SEO y PWA (Rendimiento)
La aplicación deberá exhibir un rendimiento óptimo, ser instalable y permitir su rastreo (en los segmentos públicos) para maximizar el alcance y la retención.
Optimización para Motores de Búsqueda (SEO):
Se utilizará una (1) única etiqueta <h1> por página, la cual debe ser el título principal visible y reflejar el contenido semántico de la vista (ej. "Iniciar Sesión").
La jerarquía de encabezados (Hx) será estricta, sin omisión de niveles (H1 → H2 → H3).
meta_description (máx 160 caracteres) y title (máx 60) serán únicos por ruta pública.
Se debe incluir una URL canónica (<link rel='canonical'>) en todas las rutas públicas (/, /login, /help) para prevenir la duplicación de contenido y consolidar el "link juice".
Aplicación Web Progresiva (PWA):
Manifiesto de Aplicación: manifest.json es un requisito para la "Instalabilidad" (A2HS - Add to Home Screen). Deberá incluir name, short_name, start_url: "/", display: "standalone", theme_color, background_color e íconos 192x192 y 512x512.
Service Worker: Se requiere su implementación para resiliencia de red. Deberá implementar una estrategia "App Shell" (app_shell). La "Shell" (HTML, CSS, JS) se precacheará (cache-first). Los datos de la API (ej. /api/dashboard) utilizarán network-first (para datos críticos) o stale-while-revalidate (para datos menos críticos).
Respuesta de Respaldo Fuera de Línea: El Service Worker deberá interceptar peticiones de navegación fallidas (cuando la conectividad de red es nula) y responder con el contenido cacheado de la ruta /offline (véase screen-offline). Esto provee una experiencia de usuario superior a la página de error estándar del navegador.
Sección 2: Fundamentos Visuales (Sistema de Diseño)
Referencia del Artefacto: design_system.tokens_dtcg
Filosofía de Diseño: Se adopta un sistema de dos niveles (Primitivos y Semánticos) para desacoplar las decisiones de paleta de las decisiones de aplicación.
Tokens Primitivos: Definen la paleta de opciones disponibles (ej. neutral.900). Son agnósticos a su aplicación.
Tokens Semánticos: Definen el propósito funcional dentro de la UI (ej. text.main). Son los "alias" que consumen los componentes.
Regla de Oro de Implementación (La Constitución): Los componentes, en su construcción, deberán utilizar exclusivamente tokens semánticos. Esta abstracción garantiza que el Theming (ej. Modo Oscuro) opere mediante el simple intercambio de valores de dichos tokens, sin requerir refactorización de componentes.
Taxonomía de Color (Tokens Semánticos Clave):
bg.page: {color.primitive.neutral.50} (Fondo de la aplicación; el "lienzo" principal)
bg.surface: {color.primitive.neutral.0} (Fondo para contenedores elevados: tarjetas, modales, páneles)
bg.surfaceAlt: {color.primitive.neutral.50} (Fondo para sub-secciones o estados hover de listas, para denotar interactividad o agrupación)
text.main: {color.primitive.neutral.900} (Color de texto principal, optimizado para legibilidad)
text.muted: {color.primitive.neutral.500} (Color para texto secundario, placeholders, texto de ayuda)
accent.main: {color.primitive.brand.500} (Color de énfasis para acciones primarias, hipervínculos y foco)
state.err: {color.primitive.err.500} (Color para estados de error en Field e íconos)
border.subtle: {color.primitive.neutral.200} (Color de borde para controles de entrada y divisores)
border.bold: {color.primitive.neutral.300} (Color de borde para el indicador de foco focus-visible de A11y)
Fundamentos Tipográficos: system-ui / Inter. Tamaño base: 16px.
Sistema de Espaciado (Escala): Basado en una escala de 4px (space.1 = 4px, space.2 = 8px, ...). Se utilizará para padding, margin, y gap. Esto asegura una consistencia rítmica y un equilibrio visual a través de toda la aplicación. Los componentes Field utilizarán space.2 (8px) de separación vertical, y los Buttons utilizarán space.4 (16px) de padding horizontal (ej.).
Radios de Borde (Corner Radii): radius.md (12px) se establece como el estándar para contenedores de alto nivel (AuthForm, StatCard). radius.sm (8px) se reserva para elementos interactivos (Input, Button).
Sección 3: Biblioteca de Componentes (Jerarquía Atómica)
Referencia del Artefacto: atomic_library
Nivel 1: Átomos (Fundacionales):
Son los bloques de construcción indivisibles, agnósticos al contexto de negocio y estilísticamente puros (consumen tokens semánticos).
Button: Variantes primary (usa accent.main), secondary, ghost, danger. El estado loading debe inhabilitar el botón y presentar un Spinner (reemplazando iconLeft o el texto). Deberá implementar Focus Visible (cf. 1.1. A11y). El estado disabled debe ser visualmente distinto del estado loading.
Input: Tipos text, email, password. El estado hasError deberá aplicar el borde state.err y mostrar un ícono de error.
Text: Abstracción para la representación tipográfica (h1, h2, body, etc.).
Avatar: Con un mecanismo de fallback a iniciales si el src falla o es nulo.
Nivel 2: Moléculas (Composiciones Funcionales):
Composiciones de Átomos que resuelven una tarea específica y encapsulan lógica de UI simple.
Field: (Componente Crítico) Agrupa Label, Input/Control, HelperText, ErrorText. Es el pilar de la accesibilidad en formularios. Orquesta la accesibilidad (id se utiliza para htmlFor y aria-describedby). El ErrorText solo será visible y anunciado si hasError=true.
StatCard: Expone métricas en el Dashboard (label, value, trend).
NotificationItem: Fila individual en el panel de notificaciones (title, body, read).
Toast: Mensajes efímeros para retroalimentación (feedback), gestionados por un proveedor global.
OTPGroup: Componente para la ingesta de contraseñas de un solo uso (cf. screen-mfa).
Nivel 3: Organismos (Secciones Complejas):
Secciones complejas de la UI que agrupan moléculas y poseen lógica de estado, a menudo acopladas a flujos de datos.
NavBar: Encabezado persistente de la aplicación. Incluye Logo, Links (de MenuItem) y UserMenu (que contiene Avatar y NotificationDot).
AuthForm: Panel unificado para Login/Register. Es un 'organismo controlado', cuyo estado (idle, submitting, error) es gestionado por la pantalla contenedora (ej. screen-login).
ListView: Organismo clave para Dashboard y Notifications. Debe gestionar internamente los 5 estados de datos: loading (presenta Skeletons), error (presenta mensaje de error + reintento), empty (presenta estado vacío + CTA), success (presenta la lista), y offline (presenta datos cacheados si existen).
Nivel 4: Plantillas (Estructuras de Disposición):
Definen los esqueletos de layout. Carecen de lógica.
AuthLayout: Plantilla de disposición centrada, utilizada por el flujo de autenticación.
AppShell: Define las regiones persistentes: NavBar (header), SideNav (sidebar), y el contenedor <main id="main"> (cuyo id es consumido por el Skip Link de A11y).
Sección 4: Arquitectura de Vistas y Flujos (Comportamiento E2E)
Esta sección fusiona los artefactos screens.blueprints, screens_extra_blueprints y flows.
4.1. Esquemas de Entidades Clave
User: { id, name, email, prefs: { lang, theme } } - Define la identidad y preferencias del usuario.
Session: { id, userId, exp, device } - Define el estado de autenticación y su contexto.
Notification (de entities_extra): { id, title, body, read, type, ctaRoute, category: ('system', 'security', 'activity') } - Estructura de datos para todas las notificaciones (Toast, Panel).
MenuItem (de entities_extra): { id, label, icon, path, children[], requiresAuth, featureFlag } - Define la totalidad de la estructura de navegación; children[] habilita sub-menús, requiresAuth y featureFlag controlan la visibilidad dinámica.
4.2. Planos de Pantallas (Fusión Completa)
A. Flujo de Autenticación (Plantilla: AuthLayout)
screen-splash (/splash):
Rol: auth-splash.
Objetivo: Verificar la sesión existente para prevenir el 'parpadeo' (flicker) de la UI, donde el usuario visualiza brevemente una pantalla de login a pesar de tener una sesión válida. Su única tarea es determinar la ruta de redirección (/login o /dashboard).
screen-login (/login):
Rol: auth-login.
Componente: AuthForm (Fields: email, password).
Acción Primaria: submit_login (inicia F_Login).
screen-register (/register):
Rol: auth-register.
Componente: AuthForm (Fields: name, email, password, confirm_password).
Componente Adicional: PasswordMeter (requisito de 1.2. Seguridad).
screen-recover (/recover):
Rol: auth-recover.
Paso 1 (Solicitud): Field(email) -> submit_recover_request. La UI debe mostrar un mensaje neutro (cf. 1.2. Seguridad).
Paso 2 (Restablecimiento, vía enlace tokenizado): Field(new_password). Esta es una ruta lógicamente separada, accesible solo con un token válido.
screen-mfa (/mfa):
Rol: auth-mfa.
Componentes: OTPGroup (6 dígitos), Button(Verificar).
screen-session-expired (/session-expired):
Rol: auth-session-expired.
Objetivo: Informar caducidad de sesión. Es una vista terminal (dead-end) que no ofrece navegación, solo una acción de re-autenticación.
Acción Primaria: Button(Iniciar sesión de nuevo) -> →/login.
B. Flujo de Aplicación (Plantilla: AppShell)
screen-dashboard (/dashboard): (Ruta protegida por defecto)
Rol: dashboard.
Componentes: StatCards (resumen) y ListView (actividad reciente).
Resiliencia: La pantalla deberá ser resistente a fallos parciales. Si ListView falla (estado error), StatCards (si ya cargaron) deben permanecer visibles.
screen-profile (/perfil):
Rol: profile.
Secciones: Info (Avatar, Field(name)), Preferences (Select(lang)), Security (Field(password_change), Toggle(MFA), List(sessions) - cf. req. 1.2. Seguridad).
Lógica de Estado: Button(Guardar cambios) deberá permanecer en estado disabled hasta que el formulario sea modificado ('dirty') y válido.
screen-notifications (/notificaciones):
Rol: notifications.
Componente: NotificationsPanel (basado en ListView y NotificationItems).
screen-settings (/settings):
Rol: settings.
Secciones: General (Field(language)), Notifications (Checkbox(email_notifications)), Privacy (Checkbox(telemetry_opt_in) - cf. req. 1.2. Privacidad).
C. Pantallas Públicas y de Soporte
screen-home (/): (Pública)
Rol: home.
Componentes: HeroShell (pitch de valor). Optimizada para 1.3. SEO.
screen-help (/help): (Pública)
Rol: help.
Secciones: FAQ (con SearchBar, Accordion), Contact (formulario de soporte).
screen-offline (/offline): (Servida por Service Worker)
Rol: offline.
Objetivo: Explicar estado sin conexión (req. de 1.3. PWA).
Acción Primaria: Button(Reintentar) (acción: retry_network).
screen-error (/error): (Pública, para 500/404)
Rol: error.
Objetivo: "Catch-all" de ruteo. Ofrecer una ruta de salida segura.
Acción Primaria: Button(Ir al inicio) (acción: →/).
4.3. Flujos de Usuario Críticos (Máquinas de Estado)
F_Login (Flujo de Login):
Estado Inicial: idle (screen-login visible).
Disparador (Trigger): Click submit_login.
Transición de Estado: idle -> loading.
Efectos Secundarios (loading): AuthForm inhabilitado, Spinner en botón (prevención de doble-submit).
Acción Asíncrona: API Call (Enviar credenciales).
Condiciones de Salida:
error: Transición a idle. Efecto Secundario: Mostrar error neutro: auth:login_error_generico ("Credenciales inválidas.") (Req. de 1.2. Seguridad).
requiere_mfa: Transición a success (parcial). Efecto Secundario: Redirigir a screen-mfa.
ok: Transición a success. Efecto Secundario: Persistir sesión/token. Redirigir a screen-dashboard.
F_Register (Flujo de Registro):
Estado Inicial: idle (screen-register visible). PasswordMeter activo (validación en cliente para UX).
Disparador (Trigger): Click submit_register.
Transición de Estado: idle -> loading.
Efectos Secundarios (loading): AuthForm inhabilitado.
Acción Asíncrona: API Call (Enviar datos).
Condiciones de Salida:
error: Transición a idle. Efecto Secundario: Mostrar error específico (ej. "Contraseña débil" o "Email ya existe"). La validación de PasswordMeter deberá ser re-validada en servidor.
registro_ok: Transición a success. Efecto Secundario: Mostrar Toast (ej. "Revisa tu email"). Redirigir a screen-login.
F_SessionExpired (Flujo de Sesión Expirada):
Disparador (Trigger): Petición de API (ej. en Dashboard) devuelve 401 Unauthorized.
Acción Global (Interceptor): Implementado como un 'interceptor' global de fetch/axios.
a. Efecto Secundario: Limpiar credenciales de sesión (borrar token y datos de User del estado local).
b. (Opcional) Guardar la ruta intentada (ej. /dashboard).
c. Efecto Secundario: Redirigir a screen-session-expired.
Estado Terminal (Pantalla): screen-session-expired muestra mensaje.
Usuario: Click en Button("Iniciar sesión de nuevo") -> Redirige a screen-login.
F_Offline_Recovery (Flujo Offline):
Disparador (Evento): network_status=offline (evento de navegador).
Acción Global: Mostrar Toast o banner global "Estás sin conexión".
Disparador (Navegación): Si la navegación falla, el Service Worker (1.3. PWA) intercepta y sirve screen-offline.
Estado (Pantalla): screen-offline visible.
Disparador (Recuperación): Click Button(Reintentar) O network_status=online.
success: Ocultar banner. Redirigir a la vista previa o /dashboard.
Sección 5: Estrategias de Implementación y Evaluación
5.1. Estrategia de Renderizado (Híbrida)
La estrategia de renderizado se define para balancear la seguridad, el rendimiento (TTFB) y la optimización de rastreo.
SSG (Generación Estática): routes_ssg_recomendadas
Rutas: /, /login, /register, /help, /offline, /error
Racional: 'Time-to-First-Byte' (TTFB) optimizado y cumplimiento de 1.3. SEO. Estas rutas son públicas y su contenido es universal.
CSR/SSR (Protegido): routes_ssr_recomendadas
Rutas: /dashboard, /perfil, /notificaciones, /settings
Racional: Seguridad; la pre-renderización no debe contener (ni puede, sin autenticación) datos específicos del usuario. La renderización (sea en cliente o servidor) se ejecuta solo después de que protected_route_guard valide la sesión.
5.2. Guardias de Rutas (Middleware de Ruteo)
Los guardias son el mecanismo de control de acceso que ejecuta la lógica de F_SessionExpired y previene el acceso indebido.
public_route_guard: Aplicado a rutas SSG (ej. /login).
Lógica: Antes de renderizar la pantalla, verifica la existencia de una sesión. Si session == true, se ejecuta una redirección del lado del cliente a /dashboard.
protected_route_guard: Aplicado a rutas CSR/SSR (ej. /dashboard).
Lógica: Antes de renderizar la pantalla, verifica la ausencia de una sesión. Si session == false, se ejecuta una redirección a /login.
5.3. Casos de Prueba Golden (Criterios de Aceptación E2E)
Define los 'Golden Paths' que validan la fusión de flujos, componentes y reglas de negocio. El éxito en estas pruebas valida la implementación de la especificación.
Auth:
login_credenciales_invalidas -> Verifica: La confluencia de F_Login (salida error) Y la regla 1.2. Seguridad (mensaje neutro).
registro_password_debil -> Verifica: F_Register (salida error) y la retroalimentación del PasswordMeter.
session_expirada_redirige_a_login -> Verifica: F_SessionExpired, el Interceptor Global y protected_route_guard.
Dashboard:
dashboard_sin_datos_muestra_empty_state -> Verifica: ListView en estado empty.
dashboard_error_muestra_mensaje_y_retry -> Verifica: ListView en estado error.
Notificaciones:
hay_notificaciones_no_leidas_bagde_on -> Verifica: NotificationDot en NavBar y la conexión de datos de User al layout.
lista_notificaciones_vacia_muestra_empty_state -> Verifica: NotificationsPanel en estado empty.
ChatGPT Plus

Pensó durante 49s
{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_MASTER_FUSION",
  "meta": {
    "rol_documento": "SSOT",
    "descripcion": "Fusión semántica maestra Auth + Dashboard (no funcional + diseño + flujos + pantallas)",
    "audiencia": ["Ingeniería", "Producto/UX", "QA"],
    "output": "markdown+json",
    "idioma": "es-MX"
  },

  "axiomas": {
    "accesibilidad": {
      "nivel": "WCAG 2.1 AA",
      "contraste": {
        "ratio_minimo_texto_normal": 4.5,
        "ratio_minimo_texto_grande": 3,
        "origen_valores": "design_system.tokens_dtcg.color.semantic"
      },
      "focus_visible": {
        "regla": "todo componente interactivo (Button, Input, Link, Chip, Select, etc.) debe mostrar contorno de al menos 2px en foco",
        "grosor_minimo_px": 2,
        "token_color": "border.bold | accent.main",
        "violacion_critica": true
      },
      "orden_tabulacion": {
        "principio": "coincidir flujo visual (izq→der, arriba→abajo)",
        "sin_trampas_de_foco": true,
        "modales": "deben atrapar foco con ciclo controlado y permitir Escape para salir"
      },
      "skip_link": {
        "texto": "Saltar al contenido principal",
        "href": "#main",
        "posicion": "primer elemento enfocable del DOM",
        "visibilidad": "visible solo en foco"
      },
      "formularios": {
        "errores_conectados": true,
        "mecanismo": "aria-describedby en Input apuntando al ErrorText",
        "componente_responsable": "Field (molecula)"
      },
      "landmarks": {
        "header": "<header>",
        "sidenav": "<nav>",
        "contenido_principal": "<main id='main'>",
        "footer": "<footer>"
      },
      "color_no_unico_canal": {
        "aplica_a": ["estado.ok", "estado.error", "estado.warn"],
        "requerimientos_extra": ["Icon24", "texto_descriptivo"],
        "ejemplo": "Toast de error → color state.err + icono de error + texto 'Algo salió mal'"
      },
      "prefers_reduced_motion": {
        "honrar_preferencia": true,
        "estrategia": "remover animaciones complejas, usar fades simples o sin animación para usuarios con PRM=reduce"
      }
    },

    "seguridad_privacidad": {
      "mensajes_neutros_auth": {
        "login_error_generico": "Credenciales inválidas.",
        "recover_exito_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso.",
        "enum_user_prohibido": true
      },
      "password_policy": {
        "longitud_minima": 12,
        "clases_caracteres_requeridas": ["mayuscula", "minuscula", "numero", "simbolo"],
        "prohibir_comunes": true,
        "prohibir_incluir_nombre_o_email": true,
        "ui": {
          "componente": "PasswordMeter",
          "ubicacion": "screen-register",
          "feedback_en_tiempo_real": true
        }
      },
      "consentimiento_telemetria": {
        "tipo": "opt-in",
        "checkbox": "Checkbox(telemetry_opt_in)",
        "valor_por_defecto": false,
        "ruta": "/settings",
        "sistema_funciona_sin_telemetria": true
      },
      "gestion_sesiones_usuario": {
        "pantalla": "/perfil (screen-profile)",
        "componente": "List(sessions)",
        "acciones": ["ver_dispositivos", "revocar_sesion"],
        "objetivo": "dar control y transparencia al usuario sobre sesiones activas"
      }
    },

    "seo_pwa": {
      "seo": {
        "h1_por_pantalla": true,
        "jerarquia_h": "H1→H2→H3 sin saltos arbitrarios",
        "title_max_chars": 60,
        "meta_description_max_chars": 160,
        "canonical_por_ruta_publica": true,
        "rutas_publicas": ["/", "/login", "/register", "/help", "/offline", "/error"]
      },
      "pwa": {
        "manifest_requerido": true,
        "manifest_campos": [
          "name",
          "short_name",
          "start_url",
          "display",
          "theme_color",
          "background_color",
          "icons[192,512]"
        ],
        "service_worker": {
          "estrategia_shell": "app_shell",
          "shell_precache": true,
          "datos_criticos": "network-first",
          "datos_atenuados": "stale-while-revalidate",
          "offline_fallback_ruta": "/offline"
        }
      }
    }
  },

  "design_system_contract": {
    "tokens_semanticos_clave": {
      "bg.page": "{color.primitive.neutral.50}",
      "bg.surface": "{color.primitive.neutral.0}",
      "bg.surfaceAlt": "{color.primitive.neutral.50}",
      "text.main": "{color.primitive.neutral.900}",
      "text.muted": "{color.primitive.neutral.500}",
      "accent.main": "{color.primitive.brand.500}",
      "state.err": "{color.primitive.err.500}",
      "border.subtle": "{color.primitive.neutral.200}",
      "border.bold": "{color.primitive.neutral.300}"
    },
    "regla_de_oro": "los componentes (atoms/molecules/organisms) SOLO consumen tokens semánticos, nunca valores crudos",
    "tipografia": {
      "familia_base": "system-ui / Inter",
      "font_size_base_px": 16,
      "variants": {
        "h1": "32px/1.2",
        "h2": "24px/1.3",
        "h3": "20px/1.3",
        "body": "16px/1.4",
        "caption": "12px/1.4"
      }
    },
    "espaciado": {
      "base_unit_px": 4,
      "mapa": {
        "space.1": "4px",
        "space.2": "8px",
        "space.3": "12px",
        "space.4": "16px",
        "space.5": "24px",
        "space.6": "32px"
      }
    },
    "radio_borde": {
      "field_y_widgets": "radius.sm (8px)",
      "contenedores_principales": "radius.md (12px)",
      "elementos_pastilla": "radius.pill (999px)"
    }
  },

  "component_hierarchy": {
    "atoms": [
      {
        "name": "Button",
        "variants": ["primary","secondary","ghost","danger"],
        "requisitos": [
          "usa tokens: bg.*, text.*, border.*",
          "focus-visible: borde 2px con token de alto contraste",
          "estado loading: bloquea submit y muestra Spinner",
          "estado disabled: estilísticamente distinto de loading"
        ]
      },
      {
        "name": "Input",
        "types": ["text","email","password"],
        "requisitos": [
          "estado hasError aplica borde state.err y vincula ErrorText via aria-describedby",
          "debajo de Field"
        ]
      },
      {
        "name": "Text",
        "roles": ["h1","h2","body","caption"],
        "nota": "fuente única para tipografía, respeta tokens y jerarquia Hx"
      },
      {
        "name": "Avatar",
        "fallback": "iniciales si src falla o es null"
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "descripcion": "Label + Control + Helper + Error; pilar A11y",
        "responsabilidades": [
          "vincular label->input (htmlFor)",
          "vincular error->input (aria-describedby)",
          "exponer estado visual de error"
        ]
      },
      {
        "name": "StatCard",
        "uso": "Dashboard métricas",
        "props_clave": ["label","value","trend"]
      },
      {
        "name": "NotificationItem",
        "uso": "Fila de notificación en panel",
        "props_clave": ["title","body","read","type","ctaRoute"]
      },
      {
        "name": "Toast",
        "uso": "feedback efímero",
        "tipos": ["success","error","info"]
      },
      {
        "name": "OTPGroup",
        "uso": "captura OTP MFA",
        "longitud": 6
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "slots": ["Logo","PrimaryLinks(MenuItem)","SecondaryActions","UserMenu(Avatar, NotificationDot)"]
      },
      {
        "name": "AuthForm",
        "uso": "Login/Register/Recover",
        "estado": ["idle","submitting","error"]
      },
      {
        "name": "ListView",
        "responsabilidad": "gestionar estados de colección",
        "estados_obligatorios": ["loading","error","empty","offline","success"]
      },
      {
        "name": "NotificationsPanel",
        "compuesto_de": ["NotificationItem[]","EmptyState","ErrorState","Header"]
      }
    ],
    "templates": [
      {
        "name": "AuthLayout",
        "estructura": "vista centrada, branding + card de formulario"
      },
      {
        "name": "AppShell",
        "estructura": "<header>NavBar</header> <nav>SideNav</nav> <main id='main'>Contenido</main> <footer>Footer</footer>"
      }
    ]
  },

  "entities_fusion": {
    "User": {
      "id": "string|uuid",
      "name": "string",
      "email": "string",
      "telefono": "string?",
      "rol": "residente|admin",
      "condominioId": "string?",
      "apartamento": "string?",
      "prefs": {
        "lang": "es-MX|en-US",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "notifications": "boolean"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "exp": "iso",
      "device": "string",
      "ipHash": "string"
    },
    "Notification": {
      "id": "string|uuid",
      "title": "string",
      "body": "string",
      "type": "info|warn|err|success",
      "createdAt": "iso",
      "read": "boolean",
      "readAt": "iso|null",
      "ctaRoute": "string?",
      "ctaLabel": "string?",
      "category": "system|security|activity|other",
      "priority": "low|normal|high"
    },
    "MenuItem": {
      "id": "string",
      "label": "string",
      "icon": "string?",
      "path": "string?",
      "children": "MenuItem[]?",
      "requiresAuth": "boolean",
      "featureFlag": "string?",
      "rolesAllowed": "string[]?"
    }
  },

  "screens_fusion": {
    "auth": {
      "splash": {
        "route": "/splash",
        "role": "auth-splash",
        "objetivoUX": [
          "evaluar si hay sesion valida",
          "redirigir inmediatamente a /login o /dashboard"
        ],
        "componentes": ["Branding","Spinner"],
        "acciones": ["redirigir_por_estado_sesion"]
      },
      "login": {
        "route": "/login",
        "role": "auth-login",
        "componentes": ["AuthForm(email,password)","PasswordInput con toggle"],
        "cta_principal": "submit_login",
        "ctas_secundarias": ["→/register","→/recover"]
      },
      "register": {
        "route": "/register",
        "role": "auth-register",
        "componentes": ["AuthForm(name,email,password,confirm_password)","PasswordMeter"],
        "cta_principal": "submit_register",
        "ctas_secundarias": ["→/login"]
      },
      "recover": {
        "route": "/recover",
        "role": "auth-recover",
        "pasos": [
          "FormRequest(email) con mensaje neutro",
          "FormReset(new_password) accesible vía token"
        ]
      },
      "mfa": {
        "route": "/mfa",
        "role": "auth-mfa",
        "componentes": ["OTPGroup(6)","Button(Verificar)","Link(Reenviar)"]
      },
      "session_expired": {
        "route": "/session-expired",
        "role": "auth-session-expired",
        "objetivoUX": [
          "explicar que la sesion expiro",
          "ofrecer unica acción para re-login"
        ],
        "cta_principal": "→/login"
      }
    },
    "app": {
      "dashboard": {
        "route": "/dashboard",
        "role": "dashboard",
        "componentes": ["StatCards","ListView(actividad)"],
        "resiliencia": "si ListView falla, StatCards siguen visibles"
      },
      "profile": {
        "route": "/perfil",
        "role": "profile",
        "secciones": ["Info","Preferences","Security"],
        "componentes_clave": ["Avatar","Field(name)","Select(lang)","Toggle(MFA)","List(sessions)"],
        "regla_guardar": "boton Guardar solo habilitado si formulario está dirty+valido"
      },
      "notifications": {
        "route": "/notificaciones",
        "role": "notifications",
        "componentes": ["NotificationsPanel","NotificationItem[]","EmptyState"]
      },
      "settings": {
        "route": "/settings",
        "role": "settings",
        "secciones": ["General","Notifications","Privacy"],
        "componentes_clave": ["Field(language)","Checkbox(email_notifications)","Checkbox(telemetry_opt_in)"]
      },
      "home": {
        "route": "/",
        "role": "home",
        "publica": true,
        "componentes": ["HeroShell","Highlights"],
        "seo_critico": true
      },
      "help": {
        "route": "/help",
        "role": "help",
        "publica": true,
        "secciones": ["FAQ","Contact"]
      },
      "offline": {
        "route": "/offline",
        "role": "offline",
        "publica": true,
        "objetivoUX": ["explicar estado sin conexión","ofrecer reintento"],
        "cta_principal": "retry_network"
      },
      "error": {
        "route": "/error",
        "role": "error",
        "publica": true,
        "objetivoUX": ["explicar error genérico","ofrecer ruta segura (/)", "opción volver"],
        "ctas": ["→/","history.back()"]
      }
    }
  },

  "flows_e2e": {
    "F_Login": {
      "estados": ["idle","loading","success","error","requiere_mfa"],
      "transiciones": [
        { "de": "idle", "evento": "submit_login", "a": "loading" },
        { "de": "loading", "evento": "respuesta_error", "a": "error" },
        { "de": "loading", "evento": "respuesta_ok_sin_mfa", "a": "success" },
        { "de": "loading", "evento": "respuesta_requiere_mfa", "a": "requiere_mfa" }
      ],
      "efectos": {
        "on_loading": ["deshabilitar_form", "mostrar_spinner_en_Button"],
        "on_error": ["mostrar_mensaje_neutro_login_error_generico", "reenfocar_en_email"],
        "on_success": ["crear_cookie_sesion→redirigir_a_dashboard"],
        "on_requiere_mfa": ["redirigir_a_screen_mfa"]
      }
    },
    "F_Register": {
      "estados": ["idle","loading","success","error"],
      "transiciones": [
        { "de": "idle", "evento": "submit_register", "a": "loading" },
        { "de": "loading", "evento": "respuesta_error", "a": "error" },
        { "de": "loading", "evento": "respuesta_ok", "a": "success" }
      ],
      "efectos": {
        "on_idle": ["PasswordMeter_activo"],
        "on_error": ["mostrar_mensaje_concreto('contraseña_debil'|'email_existe')"],
        "on_success": ["toast('Revisa tu email')","redirigir_a_login"]
      }
    },
    "F_SessionExpired": {
      "trigger": "401 en API protegida",
      "estados": ["detectado","limpiando_sesion","redirigiendo"],
      "efectos": [
        "limpiar_estado_auth_local",
        "opcionalmente_guardar_ruta_intentada",
        "redirigir_a_screen_session_expired"
      ]
    },
    "F_Offline_Recovery": {
      "eventos": ["network_status=offline","network_status=online"],
      "pasos": [
        "mostrar_banner_offline",
        "si_navegacion_falla→mostrar_screen_offline",
        "click_Reintentar→intentar_navegacion_de_nuevo",
        "si_online→restaurar_pantalla_previa"
      ]
    }
  },

  "rendering_strategy": {
    "ssg_routes": ["/","/login","/register","/help","/offline","/error"],
    "protected_routes": ["/dashboard","/perfil","/notificaciones","/settings"],
    "criterios": {
      "ssg": [
        "sin datos sensibles",
        "útiles para SEO y TTFB bajo"
      ],
      "protected": [
        "requieren sesion valida",
        "datos personalizados por usuario"
      ]
    }
  },

  "route_guards": {
    "public_route_guard": {
      "aplica_a": ["/login","/register","/"],
      "logica": "si existe sesion → redirigir a /dashboard; si no, renderizar pantalla publica"
    },
    "protected_route_guard": {
      "aplica_a": ["/dashboard","/perfil","/notificaciones","/settings"],
      "logica": "si no hay sesion → redirigir a /login; si hay sesion → continuar",
      "implementacion": [
        "capa_edge: middleware revisa existencia de cookie __session",
        "capa_server: protectRoute() verifica cookie con Admin SDK y redirige si es invalida"
      ]
    }
  },

  "golden_tests": {
    "auth": [
      "login_credenciales_invalidas → muestra mensaje neutro y no fuga existencia de cuenta",
      "registro_password_debil → PasswordMeter y validacion servidor rechazan, mensaje descriptivo",
      "recover_mensaje_neutro → siempre el mismo mensaje sin importar si la cuenta existe",
      "session_expirada_redirige_a_login → interceptores + screen-session-expired"
    ],
    "dashboard": [
      "dashboard_sin_datos_muestra_empty_state → ListView empty",
      "dashboard_error_muestra_mensaje_y_retry → ListView error + boton reintentar"
    ],
    "notifications": [
      "hay_notificaciones_no_leidas_bagde_on → NotificationDot activo en NavBar",
      "lista_notificaciones_vacia_muestra_empty_state → NotificationsPanel empty",
      "marcar_notificacion_como_leida_actualiza_UI → NotificationItem.read=true y dot se apaga cuando todo está leído"
    ]
  },

  "guard": {
    "rules": [
      "NO_META",
      "NO_DRY",
      "NO_REPEAT",
      "ANTI_INJ_STRICT",
      "CTX_ISOLATE",
      "CONSIST",
      "FACT_CHECK",
      "RECENCY_CHECK",
      "DATE_DRIFT_DETECT",
      "DISINFO_HYGIENE",
      "HALLUCINATION_DETECT",
      "PII_STRICT",
      "SECRET_STRICT",
      "SEMANTIC_DEDUP",
      "LEXICAL_DEDUP",
      "SINGLE_OUTPUT",
      "TOOL_ONLY_REAL",
      "NO_ASYNC_WORK",
      "NO_TIME_ESTIMATES"
    ]
  },

  "violations": []
}
Tú dijiste:
Σ_AUTH_DASH_UIUX_E2E_ROOT_UTF8_v1

META{
  ENC:"UTF-8";
  LANG:"es-MX";
  OUTPUT:"json|markdown+json";
  PRIVACY:"no_chain_of_thought";
}

CONFIG{
  STRUCTURED_OUTPUT:"on";
  JSON_SCHEMA:"estricto";
  A11Y:"WCAG2.1_AA";
  SEO:"on";
  PWA:"on";
  I18N:"on";
  SECURITY:"on";
  TELEMETRIA:"on";
}

INPUTS{
  PRODUCTO{
    nombre:"<string>";
    tipo:"<SaaS|Ecommerce|Contenido|Portfolio|Otro>";
    publico:"<B2B|B2C|Mixto>";
  };
  OBJETIVOS{
    negocio:["<...>"];
    usuario:["<...>"];
    KPI:["<activacion|retencion|conversion|NPS|LCP|...>"];
  };
  USUARIOS{
    perfiles:[
      {id:"<string>";rol:"<recruiter|cliente|admin|user>";nivel:"<bajo|medio|alto>";motivacion:"<string>";}
    ];
  };
  CONTEXTO{
    dispositivos:["mobile","desktop"];
    conectividad:"<intermitente|estable>";
    regiones:["<...>"];
    idioma_base:"es-MX";
  };
  STACK_HINT{
    runtime:"<CSR|SSR|SSG>";
    framework:"<React|Vue|Svelte|Next|Nuxt|Otro>";
    estado_app:"<hooks|zustand|redux|query|otro>";
  };
}

AXIOMAS{

  A11Y{
    CONTRASTE_TEXTO_NORMAL:">=4.5:1";
    CONTRASTE_TEXTO_GRANDE:">=3:1";
    FOCUS_VISIBLE:{
      grosor:"2px";
      color_token:"accent.main";
      requerido_en:["Button","Input","Link","Chip","Select","Checkbox","Radio"];
    };
    TAB_ORDER:"DOM sigue flujo visual (header→main→aside→footer), sin trampas de foco";
    SKIP_LINK:{
      texto:"Saltar al contenido principal";
      href:"#main";
      primer_elemento_focable:true;
      visible_en_focus:true;
    };
    FORM_FIELD_ERROR:{
      componente:"Field";
      errorText_ligado_con:"aria-describedby";
      aria_invalid_en_Input:"true si error";
    };
    LANDMARKS:{
      header:"NavBar";
      nav:"SideNav";
      main:"<main id='main'>";
      footer:"Footer";
    };
    COLOR_NO_UNICO_CANAL:true;
    ESTADOS_COLOR:{
      ok:"state.ok + icono + texto";
      warn:"state.warn + icono + texto";
      err:"state.err + icono + texto";
    };
    PREFERS_REDUCED_MOTION:{
      si_true:"desactivar animaciones decorativas; usar fade/opacidad";
    };
  };

  SECURITY_PRIVACY{
    AUTH_MENSAJE_LOGIN_NEUTRO:"Credenciales inválidas.";
    AUTH_RECOVER_MENSAJE_NEUTRO:"Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso.";
    ENUMERACION_USUARIOS_PROHIBIDA:true;

    PASSWORD_RULES{
      min_length:12;
      clases_requeridas:["mayuscula","minuscula","numero","simbolo"];
      prohibido_incluir:["nombre_usuario","email_usuario"];
      prohibidas_comunes:["password123","123456","qwerty", "...lista_diccionario..."];
      PasswordMeter_en:"screen-register";
    };

    TELEMETRIA_OPT_IN{
      componente:"Checkbox(telemetry_opt_in)";
      ruta:"screen-settings";
      default:"desmarcado";
      sistema_funciona_sin_consentimiento:true;
    };

    SESIONES_USUARIO{
      screen:"screen-profile";
      seccion:"Security";
      componente:"List(sessions)";
      acciones:["ver_dispositivo","revocar_sesion"];
    };
  };

  SEO_PWA{
    H1_UNICO:true;
    H_JERARQUICO:"H1→H2→H3 sin saltos arbitrarios";
    TITLE_MAX:60;
    META_DESCRIPTION_MAX:160;
    CANONICAL_POR_RUTA_PUBLICA:true;

    PWA_MANIFEST{
      requerido:true;
      campos:["name","short_name","start_url","display","theme_color","background_color","icons(192,512)"];
    };
    SERVICE_WORKER{
      requerido:true;
      estrategia_shell:"AppShell precache";
      datos_criticos:"network-first";
      datos_no_criticos:"stale-while-revalidate";
      offline_fallback_route:"/offline";
    };
  };
}

DESIGN_SYSTEM{

  TOKENS_DTCG:TOKENS_DTCG_JSON;

  NOTA{
    PRIMITIVOS:"color.primitive.* definen paleta básica";
    SEMANTICOS:"color.semantic.* definen propósito UI (bg.page,text.main,accent.main,...)";
    REGRA_DE_ORO:"NINGUN componente usa hex directos; SOLO tokens semánticos";
  };

  COLOR_SEMANTICO_CLAVE{
    bg_page:"color.semantic.bg.page";
    bg_surface:"color.semantic.bg.surface";
    bg_surfaceAlt:"color.semantic.bg.surface-alt";
    text_main:"color.semantic.text.main";
    text_muted:"color.semantic.text.muted";
    accent_main:"color.semantic.accent.main";
    border_subtle:"color.semantic.border.subtle";
    border_bold:"color.semantic.border.bold";
    state_err:"color.semantic.state.err";
  };

  TYPO{
    base:"system-ui / Inter";
    size_base:"16px";
  };

  SPACING{
    unidad:"4px";
    escala:{1:"4px";2:"8px";3:"12px";4:"16px";5:"24px";6:"32px";};
  };

  RADII{
    radius_sm:"8px";
    radius_md:"12px";
  };
}

ENTIDADES{

  User:ENTITY_User;
  Session:ENTITY_Session;
  EntityX:ENTITY_EntityX;
  Preference:ENTITY_Preference;
  Security:ENTITY_Security;

  Notification{
    id:"uuid";
    title:"string";
    body:"string";
    read:"bool";
    type:"info|success|error|warning";
    ctaRoute:"string?";
    category:"system|security|activity";
  };

  MenuItem{
    id:"string";
    label:"string";
    icon:"string";
    path:"string";
    children?:"MenuItem[]";
    requiresAuth:"bool";
    featureFlag?:"string";
  };

  ContactSubmission:ENTITY_ContactSubmission;
}

ATOMIC_LIBRARY:ATOMIC_SCHEMA;

ROUTES{
  public:[
    {id:"r_home";path:"/";layout:"AppShell";access:"public";},
    {id:"r_login";path:"/login";layout:"AuthLayout";access:"public";},
    {id:"r_register";path:"/register";layout:"AuthLayout";access:"public";},
    {id:"r_recover";path:"/recover";layout:"AuthLayout";access:"public";},
    {id:"r_mfa";path:"/mfa";layout:"AuthLayout";access:"public";},
    {id:"r_splash";path:"/splash";layout:"AuthLayout";access:"public";},
    {id:"r_session_expired";path:"/session-expired";layout:"AuthLayout";access:"public";},
    {id:"r_help";path:"/help";layout:"AppShell";access:"public";},
    {id:"r_contact";path:"/contact";layout:"FormLayout";access:"public";},
    {id:"r_offline";path:"/offline";layout:"ErrorLayout";access:"public";},
    {id:"r_error";path:"/error";layout:"ErrorLayout";access:"public";}
  ];
  private:[
    {id:"r_dashboard";path:"/dashboard";layout:"AppShell";access:"private";guard:"SessionGuard";},
    {id:"r_profile";path:"/profile";layout:"DashboardLayout";access:"private";guard:"SessionGuard";},
    {id:"r_settings";path:"/settings";layout:"DashboardLayout";access:"private";guard:"SessionGuard";},
    {id:"r_notifications";path:"/notifications";layout:"AppShell";access:"private";guard:"SessionGuard";},
    {id:"r_form_new";path:"/items/new";layout:"FormLayout";access:"private";guard:"SessionGuard";},
    {id:"r_form_edit";path:"/items/:id/edit";layout:"FormLayout";access:"private";guard:"SessionGuard";},
    {id:"r_logout";path:"/logout";layout:"AuthLayout";access:"private";guard:"SessionGuard";}
  ];
}

SCREENS{

  // AUTH PACK

  Splash:SCREEN_SCHEMA{
    id:"screen-splash";
    nombre:"Splash";
    route:"/splash";
    access:"public";
    template:"AuthLayout";
    rol:"auth-splash";
    objetivoUX:["detectar_sesion","redirigir_sin_flicker"];
    secciones:[
      {nombre:"Branding";componentes:["Logo","Spinner"];},
    ];
    datos_minimos:["Session?"];
    estados:{
      loading:"branding+spinner";
      error:"estado_offline|error_global";
      empty:"n/a";
      offline:"mostrar screen-offline o banner";
      success:"redirect->/login|/dashboard";
    };
  };

  Login:SCREEN_SCHEMA{
    id:"screen-login";
    nombre:"Login";
    route:"/login";
    access:"public";
    template:"AuthLayout";
    rol:"auth-login";
    objetivoUX:["acceso_seguro","mensajes_neutros"];
    secciones:[
      {nombre:"AuthForm";componentes:["Field(email)","Field(password)","Checkbox(rememeber_me)","Button(primary:Entrar)","Link(Recuperar)","Link(Register)"];},
    ];
    datos_minimos:["User.email","Credential.password"];
    estados:ESTADOS_UNIVERSALES;
    microcopy:{
      errores:["Credenciales inválidas."];
    };
  };

  Register:SCREEN_SCHEMA{
    id:"screen-register";
    nombre:"Register";
    route:"/register";
    access:"public";
    template:"AuthLayout";
    rol:"auth-register";
    objetivoUX:["alta_nueva_segura"];
    secciones:[
      {nombre:"AuthForm";componentes:["Field(name)","Field(email)","Field(password+PasswordMeter)","Field(confirm_password)","Checkbox(accept_terms)","Button(primary:Crear cuenta)"];},
    ];
    datos_minimos:["User.name","User.email","Credential.password"];
    estados:ESTADOS_UNIVERSALES;
  };

  Recover:SCREEN_SCHEMA{
    id:"screen-recover";
    nombre:"Recover";
    route:"/recover";
    access:"public";
    template:"AuthLayout";
    rol:"auth-recover";
    objetivoUX:["recuperar_sin_enumerar_usuarios"];
    secciones:[
      {nombre:"RecoverRequest";componentes:["Field(email)","Button(primary:Enviar enlace)"];},
      {nombre:"RecoverReset";componentes:["Field(new_password+PasswordMeter)","Field(confirm_password)","Button(primary:Restablecer)"];},
    ];
    datos_minimos:["User.email|Token.reset"];
    estados:ESTADOS_UNIVERSALES;
    microcopy:{
      confirmaciones:["Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."];
    };
  };

  MFA:SCREEN_SCHEMA{
    id:"screen-mfa";
    nombre:"MFA";
    route:"/mfa";
    access:"public";
    template:"AuthLayout";
    rol:"auth-mfa";
    objetivoUX:["verificar_segundo_factor"];
    secciones:[
      {nombre:"OTP";componentes:["OTPGroup(6)","Button(primary:Verificar)","Link(Reenviar código)"];},
    ];
    datos_minimos:["Credential.otp"];
    estados:ESTADOS_UNIVERSALES;
    microcopy:{
      errores:["Código inválido."];
    };
  };

  SessionExpired:SCREEN_SCHEMA{
    id:"screen-session-expired";
    nombre:"SessionExpired";
    route:"/session-expired";
    access:"public";
    template:"AuthLayout";
    rol:"auth-session-expired";
    objetivoUX:["explicar_caducidad","forzar_relogin"];
    secciones:[
      {nombre:"Message";componentes:["Text(h1)","Text(body)"];},
      {nombre:"CTA";componentes:["Button(primary:Iniciar sesión de nuevo)"];},
    ];
    estados:ESTADOS_UNIVERSALES;
  };

  // DASHBOARD PACK

  Dashboard:SCREEN_SCHEMA{
    id:"screen-dashboard";
    nombre:"Dashboard";
    route:"/dashboard";
    access:"private";
    template:"AppShell";
    rol:"dashboard";
    objetivoUX:["resumen_estado","acceso_a_modulos"];
    secciones:[
      {nombre:"Stats";componentes:["StatCard[]"];},
      {nombre:"Activity";componentes:["ListView(ActivityItems)"];},
    ];
    datos_minimos:["User","Stats[]","Activity[]"];
    estados:ESTADOS_UNIVERSALES;
  };

  Profile:SCREEN_SCHEMA{
    id:"screen-profile";
    nombre:"Profile";
    route:"/profile";
    access:"private";
    template:"DashboardLayout";
    rol:"profile";
    objetivoUX:["editar_datos","gestionar_seguridad"];
    secciones:[
      {nombre:"Info";componentes:["Avatar","Field(name)","Field(location)","Field(email:readonly)"];},
      {nombre:"Preferences";componentes:["Select(lang)","ThemeSwitch","Toggle(reduceMotion)","Toggle(notifications)"];},
      {nombre:"Security";componentes:["Field(change_password)","Toggle(MFA)","List(sessions)"];},
    ];
    datos_minimos:["User","Session","Security"];
    estados:ESTADOS_UNIVERSALES;
  };

  Settings:SCREEN_SCHEMA{
    id:"screen-settings";
    nombre:"Settings";
    route:"/settings";
    access:"private";
    template:"DashboardLayout";
    rol:"settings";
    objetivoUX:["configurar_preferencias_y_privacidad"];
    secciones:[
      {nombre:"General";componentes:["Select(lang)","ThemeSwitch","DensityToggle"];},
      {nombre:"Privacy";componentes:["Checkbox(telemetry_opt_in)"];},
    ];
    datos_minimos:["Preference","User.prefs"];
    estados:ESTADOS_UNIVERSALES;
  };

  Notifications:SCREEN_SCHEMA{
    id:"screen-notifications";
    nombre:"Notifications";
    route:"/notifications";
    access:"private";
    template:"AppShell";
    rol:"notifications";
    objetivoUX:["gestionar_notificaciones"];
    secciones:[
      {nombre:"NotificationsList";componentes:["ListView(NotificationItems)"];},
    ];
    datos_minimos:["Notification[]"];
    estados:ESTADOS_UNIVERSALES;
  };

  Home:SCREEN_SCHEMA{
    id:"screen-home";
    nombre:"Home";
    route:"/";
    access:"public";
    template:"AppShell";
    rol:"home";
    objetivoUX:["presentar_valor","dirigir_a_proyectos_o_contacto"];
    secciones:[
      {nombre:"HeroShell";componentes:["Title(H1)","Subtitle","CTAGroup","MetaBar"];},
      {nombre:"HeroPanel";componentes:["AvailabilityBadge","NowCard","Chips(intereses)","StatsGrid"];},
    ];
    datos_minimos:["User.name?","availability.state","stats?"];
    estados:ESTADOS_UNIVERSALES;
  };

  Help:SCREEN_SCHEMA{
    id:"screen-help";
    nombre:"Help";
    route:"/help";
    access:"public";
    template:"AppShell";
    rol:"help";
    objetivoUX:["resolver_dudas","ofrecer_contacto"];
    secciones:[
      {nombre:"FAQ";componentes:["SearchBar","Accordion(FAQItems)"];},
      {nombre:"SupportContact";componentes:["ContactForm"];},
    ];
    estados:ESTADOS_UNIVERSALES;
  };

  Contact:SCREEN_SCHEMA{
    id:"screen-contact";
    nombre:"Contact";
    route:"/contact";
    access:"public";
    template:"FormLayout";
    rol:"contact";
    objetivoUX:["enviar_mensaje_o_agendar"];
    secciones:[
      {nombre:"ContactForm";componentes:["Field(name)","Field(email)","Textarea(message)","Button(primary:Enviar mensaje)"];},
    ];
    datos_minimos:["ContactSubmission.payload"];
    estados:ESTADOS_UNIVERSALES;
  };

  Offline:SCREEN_SCHEMA{
    id:"screen-offline";
    nombre:"Offline";
    route:"/offline";
    access:"public";
    template:"ErrorLayout";
    rol:"offline";
    objetivoUX:["explicar_sin_conexion","permitir_reintento"];
    secciones:[
      {nombre:"Message";componentes:["Text(h1)","Text(body)"];},
      {nombre:"Actions";componentes:["Button(primary:Reintentar)"];},
    ];
    estados:ESTADOS_UNIVERSALES;
  };

  Error:SCREEN_SCHEMA{
    id:"screen-error";
    nombre:"Error";
    route:"/error";
    access:"public";
    template:"ErrorLayout";
    rol:"error";
    objetivoUX:["explicar_error","ofrecer_salida_segura"];
    secciones:[
      {nombre:"Message";componentes:["Text(h1)","Text(body)"];},
      {nombre:"Actions";componentes:["Button(primary:Ir al inicio)"];},
    ];
    estados:ESTADOS_UNIVERSALES;
  };

}

FLOWS{

  F_Login:FLOW_SCHEMA{
    id:"F_Login";
    nombre:"Login";
    pasos:[
      {pantalla:"Login";tarea:"capturar_credenciales";estado:"idle";},
      {pantalla:"Login";tarea:"submit_login";estado:"loading";},
      {pantalla:"Login";tarea:"resultado_api";estado:"success|error|requiere_mfa";error:{mensaje:"Credenciales inválidas.";recuperacion:"reintentar";}}
    ];
    ramificaciones:[
      {condicion:"requiere_mfa";destino:"MFA";},
      {condicion:"ok";destino:"Dashboard";}
    ];
    exito{definicion:"usuario_autenticado_y_redirigido_a_dashboard";};
  };

  F_Register:FLOW_SCHEMA{
    id:"F_Register";
    nombre:"Registro";
    pasos:[
      {pantalla:"Register";tarea:"validar_password_meter";},
      {pantalla:"Register";tarea:"submit_register";estado:"loading";},
      {pantalla:"Register";tarea:"resultado_api";estado:"success|error";error:{mensaje:"Contraseña débil o email en uso.";recuperacion:"ajustar";}},
    ];
    exito{definicion:"cuenta_creada_y_usuario_dirigido_a_login_con_mensaje_de_verificacion";};
  };

  F_SessionExpired:FLOW_SCHEMA{
    id:"F_SessionExpired";
    nombre:"Sesion expirada";
    pasos:[
      {pantalla:"cualquiera_protegida";tarea:"llamada_api_devuelve_401";},
      {pantalla:"GlobalInterceptor";tarea:"limpiar_session_y_guardar_ruta_intentada";},
      {pantalla:"SessionExpired";tarea:"mostrar_mensaje";},
      {pantalla:"SessionExpired";tarea:"click_relogin";salida:"/login";}
    ];
    exito{definicion:"usuario_reautentica_y_vuelve_a_ruta_segura";};
  };

  F_Offline_Recovery:FLOW_SCHEMA{
    id:"F_Offline";
    nombre:"Offline";
    pasos:[
      {pantalla:"Global";tarea:"detectar_offline";},
      {pantalla:"Offline";tarea:"mostrar_pantalla_offline";},
      {pantalla:"Offline";tarea:"reintentar_o_wait_online";salida:"ruta_previa";}
    ];
    exito{definicion:"flujo_recuperado_sin_perdida_irrecuperable";};
  };

}

DATOS{
  entidades:["User","Session","EntityX","Notification","MenuItem","ContactSubmission","Preference","Security"];
  contratos_por_pantalla:{
    Home:["User?","availability","stats?"];
    Dashboard:["Stats[]","Activity[]"];
    Profile:["User","Session","Security"];
    Login:["User.email","Credential.password"];
    Register:["User.name","User.email","Credential.password"];
    Recover:["User.email|Token.reset"];
    MFA:["Credential.otp"];
    Contact:["ContactSubmission.payload"];
  };
}

A11Y_SEO_PWA:A11Y_SEO_PWA_SCHEMA;

SECURITY_PRIVACY:SECURITY_PRIVACY_SCHEMA;

MOCKS:MOCKS_SCHEMA;

I18N_UX_COPY:I18N_SCHEMA;

EVAL:EVAL_SCHEMA;

TELEMETRIA:TELEMETRIA_SCHEMA;

RUNTIME:RUNTIME_SCHEMA;

PRIORIDADES:PRIORIDADES_SCHEMA;

DoD:DOD_SCHEMA;

VIOLATIONS:["string"];

INSTRUCCIONES_AL_LLM{
  "Genera UN objeto JSON que cumpla CONTRATO_SALIDA y SCHEMAS.";
  "No incluyas razonamiento ni narrativa adicional.";
  "Respeta AXIOMAS A11Y, SECURITY_PRIVACY, SEO_PWA en pantallas y flujos.";
  "Conecta Splash→Login/Register→MFA(opc)→Dashboard→Profile/Settings→Logout con estados OFFLINE/ERROR vacíos definidos.";
}

FIN

{
  "spec_version": "Σ_FRONT_UIUX_E2E_ROOT_UTF8_v1_MASTER",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Fusión semántica maestra E2E del sistema Auth + Dashboard. Fuente única de verdad para Ingeniería, Producto y QA.",
    "scope": ["Auth", "Dashboard", "Perfil", "Settings", "Notificaciones", "Soporte", "Offline/Error"],
    "audiencia": ["Ingeniería", "Diseño de Producto", "QA"],
    "stack_hint": {
      "runtime": "CSR+SSR+SSG híbrido",
      "framework": "React/Next-like",
      "state": "hooks + react-query/zustand",
      "pwa": true
    }
  },

  "principios": {
    "a11y": {
      "nivel": "WCAG 2.1 AA",
      "contraste": {
        "texto_normal": "ratio >= 4.5:1",
        "texto_grande": "ratio >= 3:1",
        "garantia": "tokens semanticos pre-validados (text.main sobre bg.surface)"
      },
      "focus_visible": {
        "descripcion": "todo elemento interactivo muestra contorno 2px al foco",
        "grosor": "2px",
        "token_color": "accent.main o border.bold",
        "critico": true
      },
      "tab_order": {
        "regla": "orden DOM coincide con orden visual (izq→der, arriba→abajo)",
        "sin_trampas_de_foco": true,
        "modales": "deben permitir entrar y salir con Tab/Shift+Tab"
      },
      "skip_link": {
        "requerido": true,
        "label": "Saltar al contenido principal",
        "href": "#main",
        "posicion": "primer elemento enfocable en <body>",
        "visible_on_focus": true
      },
      "formularios": {
        "errores_programaticos": true,
        "aria_describedby": "Field.errorText vinculado al input en estado error",
        "aria_invalid": "true cuando hay error en el campo"
      },
      "landmarks": {
        "header": true,
        "nav": true,
        "main": {
          "required": true,
          "id": "main"
        },
        "footer": true
      },
      "color_no_unico_canal": {
        "descripcion": "color nunca es el único portador de información",
        "estados": ["ok", "warn", "err"],
        "complementos": ["Icon24", "texto descriptivo"]
      },
      "reduced_motion": {
        "respeta_prefers_reduced_motion": true,
        "estrategia": "degradar animaciones decorativas a fades/opacidades; eliminar transiciones agresivas"
      }
    },

    "seguridad_privacidad": {
      "auth_neutra": {
        "login_error": "Credenciales inválidas.",
        "recover_ok": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso.",
        "no_enumerar_usuarios": true
      },
      "password_policy": {
        "min_longitud": 12,
        "clases_requeridas": ["mayuscula", "minuscula", "numero", "simbolo"],
        "prohibidos": ["password123", "123456", "patrones_comunes"],
        "no_incluir": ["user.name", "user.email"],
        "password_meter": {
          "requerido_en": ["screen-register", "screen-recover-reset"],
          "retroalimentacion_en_tiempo_real": true
        }
      },
      "privacidad_telemetria": {
        "consentimiento": "opt-in explicito",
        "por_defecto": "desactivado",
        "checkbox_id": "telemetry_opt_in",
        "flujo": "la app funciona completa aun con telemetría desactivada"
      },
      "sesiones": {
        "screen_profile_security": true,
        "lista_sesiones": "Array<{device,ipHash,ultima_actividad}>",
        "acciones": ["revocar_sesion_individual"],
        "objetivo": "transparencia y control del usuario"
      }
    },

    "seo_pwa": {
      "seo": {
        "h1_unico_por_pantalla": true,
        "jerarquia_hx": "H1→H2→H3 sin saltos",
        "title_max_chars": 60,
        "meta_description_max_chars": 160,
        "canonical_por_ruta_publica": true,
        "rutas_publicas": ["/", "/login", "/register", "/help", "/offline", "/error"]
      },
      "pwa": {
        "manifest_requerido": true,
        "manifest": {
          "name": "App Auth + Dashboard",
          "short_name": "App",
          "start_url": "/",
          "display": "standalone",
          "icons": ["192x192", "512x512"],
          "theme_color_token": "bg.page",
          "background_color_token": "bg.surface"
        },
        "service_worker": {
          "estrategia_shell": "app_shell",
          "shell_precache": ["HTML", "CSS", "JS"],
          "datos_api": {
            "criticos": "network-first",
            "no_criticos": "stale-while-revalidate"
          },
          "offline_fallback_route": "/offline"
        }
      }
    }
  },

  "design_system": {
    "tokens": {
      "modelo": "primitivos + semanticos",
      "primitivos_ref": "design_system.tokens_dtcg.color.primitive",
      "semanticos": {
        "bg.page": "{color.primitive.neutral.50}",
        "bg.surface": "{color.primitive.neutral.0}",
        "bg.surfaceAlt": "{color.primitive.neutral.50}",
        "text.main": "{color.primitive.neutral.900}",
        "text.muted": "{color.primitive.neutral.500}",
        "accent.main": "{color.primitive.brand.500}",
        "state.err": "{color.primitive.err.500}",
        "state.ok": "{color.primitive.ok.500}",
        "state.warn": "{color.primitive.warn.500}",
        "border.subtle": "{color.primitive.neutral.200}",
        "border.bold": "{color.primitive.neutral.300}"
      },
      "regla_de_oro": "los componentes SOLO consumen tokens semanticos, nunca primitivos ni hex directos"
    },
    "typography": {
      "family.base": "system-ui, -apple-system, 'Inter', 'Segoe UI', sans-serif",
      "base_font_size": "16px",
      "line_height": {
        "tight": "120%",
        "normal": "140%",
        "loose": "160%"
      }
    },
    "spacing": {
      "unidad_base": "4px",
      "scale": { "1": "4px", "2": "8px", "3": "12px", "4": "16px", "5": "24px", "6": "32px" },
      "ejemplos": {
        "field_vertical_gap": "space.2",
        "button_horizontal_padding": "space.4"
      }
    },
    "radius": {
      "sm": "8px",
      "md": "12px",
      "lg": "16px",
      "uso": {
        "inputs_y_buttons": "radius.sm",
        "contenedores_altos": "radius.md"
      }
    }
  },

  "atomic_library": {
    "atoms": [
      {
        "name": "Button",
        "role": "cta",
        "variants": ["primary", "secondary", "ghost", "danger"],
        "states": ["default", "hover", "focus", "disabled", "loading"],
        "tokens": {
          "bg": "accent.main|neutral|transparent|state.err",
          "text": "text.inverse|text.main",
          "radius": "radius.sm",
          "focus_ring": "border.bold"
        },
        "behaviour": {
          "loading": "deshabilita click y muestra Spinner",
          "disabled_vs_loading": "estilos visuales distintos",
          "focus_visible": "siempre 2px outline"
        }
      },
      {
        "name": "Input",
        "role": "form-control",
        "types": ["text", "email", "password"],
        "props": ["value", "placeholder", "autoComplete"],
        "tokens": {
          "border_default": "border.subtle",
          "border_error": "state.err",
          "bg": "bg.surface",
          "text": "text.main"
        },
        "a11y": {
          "aria_invalid": true,
          "aria_describedby": true
        }
      },
      {
        "name": "Text",
        "role": "typography",
        "variants": ["h1", "h2", "body", "caption"],
        "props": ["as", "align", "truncate", "color"]
      },
      {
        "name": "Avatar",
        "role": "user-identity",
        "props": ["src", "alt", "size"],
        "fallback": "iniciales del nombre"
      },
      {
        "name": "Spinner",
        "role": "progress-indicator",
        "props": ["size", "ariaLabel"]
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "role": "form-field-wrapper",
        "parts": ["Label", "Control", "HelperText", "ErrorText"],
        "a11y": {
          "link_label_control": "htmlFor/id",
          "link_error": "aria-describedby→ErrorText.id",
          "aria_invalid": "true cuando error"
        }
      },
      {
        "name": "StatCard",
        "role": "dashboard-metric",
        "props": ["label", "value", "trend", "helper"]
      },
      {
        "name": "NotificationItem",
        "role": "notification-row",
        "props": ["title", "body", "read", "type", "ctaRoute", "category"]
      },
      {
        "name": "Toast",
        "role": "ephemeral-feedback",
        "props": ["type", "message", "durationMs"]
      },
      {
        "name": "OTPGroup",
        "role": "mfa-input",
        "props": ["length", "value", "onChange"]
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "role": "primary-navigation",
        "slots": ["Logo", "MenuItems", "NotificationDot", "UserMenu"]
      },
      {
        "name": "SideNav",
        "role": "secondary-navigation",
        "slots": ["MenuItemTree"]
      },
      {
        "name": "AuthForm",
        "role": "auth-section",
        "states": ["idle", "submitting", "error"],
        "contiene": ["Fields", "Actions", "Legal"]
      },
      {
        "name": "ListView",
        "role": "collection-display",
        "states": ["loading", "error", "empty", "success", "offline"],
        "contract": {
          "loading": "skeletons visibles",
          "error": "mensaje + CTA reintentar",
          "empty": "EmptyState + CTA",
          "offline": "banner offline + datos cacheados si existen"
        }
      },
      {
        "name": "NotificationsPanel",
        "role": "notifications-dashboard",
        "usa": ["ListView", "NotificationItem"]
      }
    ],
    "templates": [
      {
        "name": "AuthLayout",
        "regions": ["branding", "auth-card"],
        "usage": ["screen-splash", "screen-login", "screen-register", "screen-recover", "screen-mfa", "screen-session-expired", "screen-logoff"]
      },
      {
        "name": "AppShell",
        "regions": ["header", "sidebar", "main", "footer"],
        "main_id": "main",
        "usage": ["dashboard", "profile", "notifications", "settings", "help"]
      }
    ]
  },

  "data_model": {
    "User": {
      "id": "string",
      "name": "string",
      "email": "string",
      "prefs": {
        "lang": "es-MX|en-US",
        "theme": "light|dark|hc"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "exp": "iso-datetime",
      "device": "user-agent-string"
    },
    "Notification": {
      "id": "string",
      "title": "string",
      "body": "string",
      "read": "boolean",
      "type": "string",
      "ctaRoute": "string",
      "category": "system|security|activity"
    },
    "MenuItem": {
      "id": "string",
      "label": "string",
      "icon": "string",
      "path": "string",
      "children": "MenuItem[]",
      "requiresAuth": "boolean",
      "featureFlag": "string?"
    }
  },

  "screens": {
    "auth": {
      "splash": {
        "route": "/splash",
        "role": "auth-splash",
        "layout": "AuthLayout",
        "objetivo": "Verificar sesión y evitar flicker de login cuando ya hay sesión válida.",
        "estados_universales": true
      },
      "login": {
        "route": "/login",
        "role": "auth-login",
        "layout": "AuthLayout",
        "organism": "AuthForm",
        "fields": ["email", "password", "remember_me"],
        "primary_action": "submit_login",
        "flows": ["F_Login"]
      },
      "register": {
        "route": "/register",
        "role": "auth-register",
        "layout": "AuthLayout",
        "organism": "AuthForm",
        "fields": ["name", "email", "password", "confirm_password"],
        "extra": ["PasswordMeter"],
        "flows": ["F_Register"]
      },
      "recover": {
        "route": "/recover",
        "role": "auth-recover",
        "layout": "AuthLayout",
        "steps": ["request_email", "reset_password_via_token"],
        "mensaje_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
      },
      "mfa": {
        "route": "/mfa",
        "role": "auth-mfa",
        "layout": "AuthLayout",
        "components": ["OTPGroup", "Button(Verificar)"]
      },
      "session_expired": {
        "route": "/session-expired",
        "role": "auth-session-expired",
        "layout": "AuthLayout",
        "objetivo": "Explicar caducidad de sesión y forzar re-login.",
        "primary_action": "→/login"
      }
    },
    "app": {
      "dashboard": {
        "route": "/dashboard",
        "role": "dashboard",
        "layout": "AppShell",
        "components": ["StatCards", "ListView(actividad_reciente)"],
        "resiliencia": "si ListView falla, StatCards se mantienen visibles"
      },
      "profile": {
        "route": "/perfil",
        "role": "profile",
        "layout": "AppShell",
        "tabs": ["Info", "Preferences", "Security"],
        "security_section": ["ChangePassword", "MFA_Toggle", "SessionsList"],
        "guardar_cambios": {
          "disabled_until_dirty_and_valid": true
        }
      },
      "notifications": {
        "route": "/notificaciones",
        "role": "notifications",
        "layout": "AppShell",
        "organism": "NotificationsPanel"
      },
      "settings": {
        "route": "/settings",
        "role": "settings",
        "layout": "AppShell",
        "sections": ["General", "Notifications", "Privacy"],
        "telemetry_opt_in_checkbox": true
      },
      "home_public": {
        "route": "/",
        "role": "home",
        "layout": "AppShell",
        "organism": "HeroShell",
        "seo": {
          "h1": "pitch principal",
          "title": "Home",
          "meta_description": "Resumen claro del valor del producto."
        }
      },
      "help": {
        "route": "/help",
        "role": "help",
        "layout": "AppShell",
        "sections": ["FAQ", "Contact"]
      },
      "offline": {
        "route": "/offline",
        "role": "offline",
        "layout": "AppShell|ErrorLayout",
        "objetivo": "Explicar estado sin conexión y ofrecer reintento.",
        "primary_action": "retry_network"
      },
      "error": {
        "route": "/error",
        "role": "error",
        "layout": "ErrorLayout",
        "objetivo": "Catch-all de rutas y errores 500.",
        "primary_action": "→/"
      }
    }
  },

  "flows": {
    "F_Login": {
      "estado_inicial": "idle",
      "pantalla": "screen-login",
      "transiciones": [
        {
          "de": "idle",
          "evento": "submit_login",
          "a": "loading",
          "efectos": ["deshabilitar_AuthForm", "mostrar_Spinner_en_boton"]
        },
        {
          "de": "loading",
          "evento": "respuesta_error",
          "a": "idle",
          "efectos": ["mostrar_mensaje_neutro 'Credenciales inválidas.'"]
        },
        {
          "de": "loading",
          "evento": "respuesta_requiere_mfa",
          "a": "success_parcial",
          "efectos": ["redirigir_a_/mfa"]
        },
        {
          "de": "loading",
          "evento": "respuesta_ok",
          "a": "success",
          "efectos": ["persistir_sesion", "redirigir_a_/dashboard"]
        }
      ]
    },
    "F_Register": {
      "estado_inicial": "idle",
      "pantalla": "screen-register",
      "transiciones": [
        {
          "de": "idle",
          "evento": "submit_register",
          "a": "loading",
          "efectos": ["deshabilitar_AuthForm"]
        },
        {
          "de": "loading",
          "evento": "error",
          "a": "idle",
          "efectos": ["mostrar_error_especifico (contraseña débil/email existe)", "sin filtrar info sensible"]
        },
        {
          "de": "loading",
          "evento": "registro_ok",
          "a": "success",
          "efectos": ["mostrar_toast 'Revisa tu email'", "redirigir_a_/login"]
        }
      ]
    },
    "F_SessionExpired": {
      "trigger": "API_401",
      "interceptor_global": true,
      "pasos": [
        "limpiar_credenciales_locales",
        "opcional_guardar_ruta_intentada",
        "redirigir_a_/session-expired"
      ],
      "pantalla_terminal": "screen-session-expired",
      "accion_usuario": "Button('Iniciar sesión de nuevo') → /login"
    },
    "F_Offline_Recovery": {
      "eventos": [
        "network_status=offline → mostrar_banner_global",
        "navegacion_falla → service_worker_sirve_/offline"
      ],
      "recuperacion": [
        "click_reintentar O network_status=online → ocultar_banner_y_restaurar_vista_previa"
      ]
    }
  },

  "rendering_strategy": {
    "ssg": {
      "routes": ["/", "/login", "/register", "/help", "/offline", "/error"],
      "motivo": "TTFB óptimo + SEO para rutas públicas"
    },
    "csr_ssr": {
      "routes": ["/dashboard", "/perfil", "/notificaciones", "/settings"],
      "motivo": "datos sensibles y por usuario, no pre-renderizables sin auth"
    }
  },

  "route_guards": {
    "public_route_guard": {
      "aplica_a": ["/login", "/register", "/help"],
      "logica": "si session==true → redirigir a /dashboard antes de mostrar pantalla pública"
    },
    "protected_route_guard": {
      "aplica_a": ["/dashboard", "/perfil", "/notificaciones", "/settings"],
      "logica": "si session==false → redirigir a /login"
    }
  },

  "golden_tests": {
    "auth": [
      {
        "id": "login_credenciales_invalidas",
        "verifica": ["F_Login.salida_error", "mensaje_neutro 'Credenciales inválidas.'"]
      },
      {
        "id": "registro_password_debil",
        "verifica": ["F_Register.error", "PasswordMeter retroalimentando reglas"]
      },
      {
        "id": "session_expirada_redirige_a_login",
        "verifica": ["F_SessionExpired", "interceptor_global", "protected_route_guard"]
      }
    ],
    "dashboard": [
      {
        "id": "dashboard_sin_datos_muestra_empty_state",
        "verifica": ["ListView.estado_empty"]
      },
      {
        "id": "dashboard_error_muestra_mensaje_y_retry",
        "verifica": ["ListView.estado_error", "CTA_reintentar"]
      }
    ],
    "notificaciones": [
      {
        "id": "notificaciones_no_leidas_muestran_badge",
        "verifica": ["NotificationDot en NavBar", "datos Notification.read=false"]
      },
      {
        "id": "lista_notificaciones_vacia_muestra_empty_state",
        "verifica": ["NotificationsPanel.estado_empty"]
      }
    ]
  },

  "eval": {
    "datasets_min": 16,
    "tipos": [
      "happy_path_auth",
      "errores_login",
      "registro_password_debil",
      "pantallas_vacias",
      "offline",
      "session_expirada",
      "mfa",
      "crud_completo_dashboard"
    ],
    "metricas": ["json_schema_pass", "groundedness", "a11y_checklist_pass", "readability"],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": {
      "regresion_blocker": true
    }
  },

  "telemetria": {
    "eventos_core": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_min": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso-datetime"
    },
    "privacidad": "siempre IDs opacos, sin PII salvo consentimiento explícito"
  },

  "violations": []
}
ChatGPT Plus

Pensó durante 1m 39s
{
  "spec_version": "Σ_AUTH_DASH_UIUX_E2E_ROOT_UTF8_v1_MASTER",
  "meta": {
    "charset": "UTF-8",
    "lang": "es-MX",
    "description": "Especificación técnica maestra E2E Auth + Dashboard. Fuente única de verdad para Ingeniería, Producto y QA.",
    "scope": ["Auth", "Dashboard", "Perfil", "Settings", "Notificaciones", "Soporte", "Offline/Error"],
    "audiencia": ["Ingeniería", "Diseño de Producto", "QA"]
  },

  "config": {
    "structured_output": "on",
    "json_schema": "estricto",
    "a11y": "WCAG2.1_AA",
    "seo": "on",
    "pwa": "on",
    "i18n": "on",
    "security": "on",
    "telemetria": "on"
  },

  "inputs_schema": {
    "PRODUCTO": {
      "nombre": "<string>",
      "tipo": "<SaaS|Ecommerce|Contenido|Portfolio|Otro>",
      "publico": "<B2B|B2C|Mixto>"
    },
    "OBJETIVOS": {
      "negocio": ["<...>"],
      "usuario": ["<...>"],
      "KPI": ["<activacion|retencion|conversion|NPS|LCP|...>"]
    },
    "USUARIOS": {
      "perfiles": [
        {
          "id": "<string>",
          "rol": "<recruiter|cliente|admin|user>",
          "nivel": "<bajo|medio|alto>",
          "motivacion": "<string>"
        }
      ]
    },
    "CONTEXTO": {
      "dispositivos": ["mobile", "desktop"],
      "conectividad": "<intermitente|estable>",
      "regiones": ["<...>"],
      "idioma_base": "es-MX"
    },
    "STACK_HINT": {
      "runtime": "<CSR|SSR|SSG>",
      "framework": "<React|Vue|Svelte|Next|Nuxt|Otro>",
      "estado_app": "<hooks|zustand|redux|query|otro>"
    }
  },

  "axiomas": {
    "a11y": {
      "contraste_texto_normal": ">=4.5:1",
      "contraste_texto_grande": ">=3:1",
      "focus_visible": {
        "grosor": "2px",
        "color_token": "accent.main",
        "requerido_en": ["Button", "Input", "Link", "Chip", "Select", "Checkbox", "Radio"]
      },
      "tab_order": "DOM sigue flujo visual (header→main→aside→footer), sin trampas de foco",
      "skip_link": {
        "texto": "Saltar al contenido principal",
        "href": "#main",
        "primer_elemento_focable": true,
        "visible_en_focus": true
      },
      "form_field_error": {
        "componente": "Field",
        "errorText_ligado_con": "aria-describedby",
        "aria_invalid_en_Input": "true si error"
      },
      "landmarks": {
        "header": "NavBar",
        "nav": "SideNav",
        "main": "<main id='main'>",
        "footer": "Footer"
      },
      "color_no_unico_canal": true,
      "estados_color": {
        "ok": "state.ok + icono + texto",
        "warn": "state.warn + icono + texto",
        "err": "state.err + icono + texto"
      },
      "prefers_reduced_motion": {
        "si_true": "desactivar animaciones decorativas; usar fade/opacidad"
      }
    },

    "security_privacy": {
      "auth_mensajes": {
        "login_neutro": "Credenciales inválidas.",
        "recover_neutro": "Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."
      },
      "enumeracion_usuarios_prohibida": true,
      "password_rules": {
        "min_length": 12,
        "clases_requeridas": ["mayuscula", "minuscula", "numero", "simbolo"],
        "prohibido_incluir": ["nombre_usuario", "email_usuario"],
        "prohibidas_comunes": ["password123", "123456", "qwerty", "...lista_diccionario..."],
        "password_meter_en": ["screen-register", "screen-recover-reset"]
      },
      "telemetria_opt_in": {
        "componente": "Checkbox(telemetry_opt_in)",
        "ruta": "screen-settings",
        "default": "desmarcado",
        "sistema_funciona_sin_consentimiento": true
      },
      "sesiones_usuario": {
        "screen": "screen-profile",
        "seccion": "Security",
        "componente": "List(sessions)",
        "acciones": ["ver_dispositivo", "revocar_sesion"]
      }
    },

    "seo_pwa": {
      "seo": {
        "h1_unico": true,
        "h_jerarquico": "H1→H2→H3 sin saltos arbitrarios",
        "title_max": 60,
        "meta_description_max": 160,
        "canonical_por_ruta_publica": true
      },
      "pwa": {
        "manifest": {
          "requerido": true,
          "campos": ["name", "short_name", "start_url", "display", "theme_color", "background_color", "icons(192,512)"]
        },
        "service_worker": {
          "requerido": true,
          "estrategia_shell": "AppShell precache",
          "datos_criticos": "network-first",
          "datos_no_criticos": "stale-while-revalidate",
          "offline_fallback_route": "/offline"
        }
      }
    }
  },

  "design_system": {
    "tokens": {
      "modelo": "DTCG",
      "primitivos_ref": "TOKENS_DTCG_JSON.color.primitive",
      "semanticos": {
        "bg.page": "color.semantic.bg.page",
        "bg.surface": "color.semantic.bg.surface",
        "bg.surfaceAlt": "color.semantic.bg.surface-alt",
        "text.main": "color.semantic.text.main",
        "text.muted": "color.semantic.text.muted",
        "accent.main": "color.semantic.accent.main",
        "border.subtle": "color.semantic.border.subtle",
        "border.bold": "color.semantic.border.bold",
        "state.err": "color.semantic.state.err"
      },
      "regla_de_oro": "NINGUN componente usa hex directos; SOLO tokens semánticos"
    },
    "typography": {
      "base": "system-ui / Inter",
      "size_base": "16px",
      "line_height": {
        "tight": "120%",
        "normal": "140%",
        "loose": "160%"
      }
    },
    "spacing": {
      "unidad": "4px",
      "escala": { "1": "4px", "2": "8px", "3": "12px", "4": "16px", "5": "24px", "6": "32px" }
    },
    "radii": {
      "radius_sm": "8px",
      "radius_md": "12px"
    }
  },

  "entidades": {
    "User": {
      "id": "string|uuid",
      "name": "string",
      "email": "string",
      "rol": "recruiter|cliente|admin|user",
      "prefs": {
        "lang": "es-MX|en-US",
        "theme": "light|dark|hc",
        "reduceMotion": "boolean",
        "notifications": "boolean"
      }
    },
    "Session": {
      "id": "string",
      "userId": "string",
      "exp": "iso",
      "device": "user-agent-string",
      "ipHash": "string"
    },
    "EntityX": {
      "id": "string|uuid",
      "title": "string",
      "description": "string?",
      "status": "active|draft|archived",
      "createdAt": "iso",
      "updatedAt": "iso",
      "ownerId": "string",
      "tags": ["string"]
    },
    "Preference": {
      "lang": "es-MX|en-US",
      "theme": "light|dark|hc",
      "reduceMotion": "boolean",
      "density": "compact|cozy|comfortable"
    },
    "Security": {
      "attempts": "number",
      "lockUntil": "iso|null",
      "lastChange": "iso",
      "mfaEnabled": "boolean"
    },
    "Notification": {
      "id": "uuid",
      "title": "string",
      "body": "string",
      "read": "boolean",
      "type": "info|success|error|warning",
      "ctaRoute": "string|null",
      "category": "system|security|activity"
    },
    "MenuItem": {
      "id": "string",
      "label": "string",
      "icon": "string",
      "path": "string",
      "children": "MenuItem[]|null",
      "requiresAuth": "boolean",
      "featureFlag": "string|null"
    },
    "ContactSubmission": {
      "id": "string|uuid",
      "name": "string",
      "email": "string",
      "subject": "string",
      "message": "string",
      "createdAt": "iso"
    }
  },

  "atomic_library": {
    "atoms": [
      {
        "name": "Button",
        "variants": ["primary", "secondary", "ghost", "danger"],
        "states": ["default", "hover", "focus", "disabled", "loading"],
        "tokens": {
          "bg": "accent.main|neutral|transparent|state.err",
          "text": "text.inverse|text.main",
          "radius": "radius_sm",
          "focus_ring": "border.bold"
        }
      },
      {
        "name": "Input",
        "types": ["text", "email", "password"],
        "states": ["default", "focus", "error", "disabled"],
        "tokens": {
          "border_default": "border.subtle",
          "border_error": "state.err",
          "bg": "bg.surface",
          "text": "text.main"
        }
      },
      {
        "name": "Text",
        "variants": ["h1", "h2", "h3", "body", "caption"],
        "props": ["as", "align", "truncate", "color"]
      },
      {
        "name": "Avatar",
        "props": ["src", "alt", "size"],
        "fallback": "iniciales"
      },
      {
        "name": "Checkbox",
        "props": ["checked", "label"],
        "states": ["checked", "unchecked", "disabled"]
      },
      {
        "name": "Radio",
        "props": ["checked", "label", "name", "value"]
      },
      {
        "name": "Select",
        "props": ["options", "value", "placeholder"]
      },
      {
        "name": "Spinner",
        "props": ["size", "ariaLabel"]
      }
    ],
    "molecules": [
      {
        "name": "Field",
        "parts": ["Label", "Control", "HelperText", "ErrorText"],
        "a11y": {
          "label_for_control": true,
          "error_via_aria_describedby": true,
          "aria_invalid_on_error": true
        }
      },
      {
        "name": "StatCard",
        "props": ["label", "value", "trend", "helper"]
      },
      {
        "name": "NotificationItem",
        "props": ["title", "body", "read", "type", "ctaRoute", "category"]
      },
      {
        "name": "Toast",
        "props": ["type", "message", "durationMs"]
      },
      {
        "name": "OTPGroup",
        "props": ["length", "value", "onChange"]
      }
    ],
    "organisms": [
      {
        "name": "NavBar",
        "slots": ["Logo", "PrimaryLinks", "SecondaryActions", "UserMenu", "NotificationDot"]
      },
      {
        "name": "SideNav",
        "slots": ["MenuTree"]
      },
      {
        "name": "AuthForm",
        "states": ["idle", "submitting", "error"],
        "slots": ["Fields", "Actions", "SecondaryLinks", "Legal"]
      },
      {
        "name": "ListView",
        "states": ["loading", "error", "empty", "offline", "success"]
      },
      {
        "name": "NotificationsPanel",
        "slots": ["Header", "Filters", "ListView", "EmptyState"]
      }
    ],
    "templates": [
      {
        "name": "AuthLayout",
        "regions": ["Branding", "AuthCard"]
      },
      {
        "name": "AppShell",
        "regions": ["header", "sidebar", "main", "footer"],
        "main_id": "main"
      },
      {
        "name": "DashboardLayout",
        "regions": ["header", "sidebar", "main"]
      },
      {
        "name": "FormLayout",
        "regions": ["header", "main", "footer"]
      },
      {
        "name": "ErrorLayout",
        "regions": ["icon", "message", "actions"]
      }
    ]
  },

  "routes": {
    "public": [
      { "id": "r_home", "path": "/", "layout": "AppShell", "access": "public" },
      { "id": "r_login", "path": "/login", "layout": "AuthLayout", "access": "public" },
      { "id": "r_register", "path": "/register", "layout": "AuthLayout", "access": "public" },
      { "id": "r_recover", "path": "/recover", "layout": "AuthLayout", "access": "public" },
      { "id": "r_mfa", "path": "/mfa", "layout": "AuthLayout", "access": "public" },
      { "id": "r_splash", "path": "/splash", "layout": "AuthLayout", "access": "public" },
      { "id": "r_session_expired", "path": "/session-expired", "layout": "AuthLayout", "access": "public" },
      { "id": "r_help", "path": "/help", "layout": "AppShell", "access": "public" },
      { "id": "r_contact", "path": "/contact", "layout": "FormLayout", "access": "public" },
      { "id": "r_offline", "path": "/offline", "layout": "ErrorLayout", "access": "public" },
      { "id": "r_error", "path": "/error", "layout": "ErrorLayout", "access": "public" }
    ],
    "private": [
      { "id": "r_dashboard", "path": "/dashboard", "layout": "AppShell", "access": "private", "guard": "SessionGuard" },
      { "id": "r_profile", "path": "/profile", "layout": "DashboardLayout", "access": "private", "guard": "SessionGuard" },
      { "id": "r_settings", "path": "/settings", "layout": "DashboardLayout", "access": "private", "guard": "SessionGuard" },
      { "id": "r_notifications", "path": "/notifications", "layout": "AppShell", "access": "private", "guard": "SessionGuard" },
      { "id": "r_form_new", "path": "/items/new", "layout": "FormLayout", "access": "private", "guard": "SessionGuard" },
      { "id": "r_form_edit", "path": "/items/:id/edit", "layout": "FormLayout", "access": "private", "guard": "SessionGuard" },
      { "id": "r_logout", "path": "/logout", "layout": "AuthLayout", "access": "private", "guard": "SessionGuard" }
    ]
  },

  "screens": {
    "Splash": {
      "id": "screen-splash",
      "nombre": "Splash",
      "route": "/splash",
      "access": "public",
      "template": "AuthLayout",
      "rol": "auth-splash",
      "objetivoUX": ["detectar_sesion", "redirigir_sin_flicker"],
      "secciones": [
        { "nombre": "Branding", "componentes": ["Logo", "Spinner"] }
      ],
      "datos_minimos": ["Session?"],
      "estados": {
        "loading": "branding+spinner",
        "error": "estado_offline|error_global",
        "empty": "n/a",
        "offline": "mostrar screen-offline o banner",
        "success": "redirect->/login|/dashboard"
      }
    },
    "Login": {
      "id": "screen-login",
      "nombre": "Login",
      "route": "/login",
      "access": "public",
      "template": "AuthLayout",
      "rol": "auth-login",
      "objetivoUX": ["acceso_seguro", "mensajes_neutros"],
      "secciones": [
        {
          "nombre": "AuthForm",
          "componentes": [
            "Field(email)",
            "Field(password)",
            "Checkbox(remember_me)",
            "Button(primary:Entrar)",
            "Link(Recuperar)",
            "Link(Register)"
          ]
        }
      ],
      "datos_minimos": ["User.email", "Credential.password"],
      "estados": "ESTADOS_UNIVERSALES",
      "microcopy": {
        "errores": ["Credenciales inválidas."]
      }
    },
    "Register": {
      "id": "screen-register",
      "nombre": "Register",
      "route": "/register",
      "access": "public",
      "template": "AuthLayout",
      "rol": "auth-register",
      "objetivoUX": ["alta_nueva_segura"],
      "secciones": [
        {
          "nombre": "AuthForm",
          "componentes": [
            "Field(name)",
            "Field(email)",
            "Field(password+PasswordMeter)",
            "Field(confirm_password)",
            "Checkbox(accept_terms)",
            "Button(primary:Crear cuenta)"
          ]
        }
      ],
      "datos_minimos": ["User.name", "User.email", "Credential.password"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Recover": {
      "id": "screen-recover",
      "nombre": "Recover",
      "route": "/recover",
      "access": "public",
      "template": "AuthLayout",
      "rol": "auth-recover",
      "objetivoUX": ["recuperar_sin_enumerar_usuarios"],
      "secciones": [
        { "nombre": "RecoverRequest", "componentes": ["Field(email)", "Button(primary:Enviar enlace)"] },
        { "nombre": "RecoverReset", "componentes": ["Field(new_password+PasswordMeter)", "Field(confirm_password)", "Button(primary:Restablecer)"] }
      ],
      "datos_minimos": ["User.email|Token.reset"],
      "estados": "ESTADOS_UNIVERSALES",
      "microcopy": {
        "confirmaciones": ["Si la cuenta existe y el correo es válido, recibirás un enlace para recuperar el acceso."]
      }
    },
    "MFA": {
      "id": "screen-mfa",
      "nombre": "MFA",
      "route": "/mfa",
      "access": "public",
      "template": "AuthLayout",
      "rol": "auth-mfa",
      "objetivoUX": ["verificar_segundo_factor"],
      "secciones": [
        { "nombre": "OTP", "componentes": ["OTPGroup(6)", "Button(primary:Verificar)", "Link(Reenviar código)"] }
      ],
      "datos_minimos": ["Credential.otp"],
      "estados": "ESTADOS_UNIVERSALES",
      "microcopy": {
        "errores": ["Código inválido."]
      }
    },
    "SessionExpired": {
      "id": "screen-session-expired",
      "nombre": "SessionExpired",
      "route": "/session-expired",
      "access": "public",
      "template": "AuthLayout",
      "rol": "auth-session-expired",
      "objetivoUX": ["explicar_caducidad", "forzar_relogin"],
      "secciones": [
        { "nombre": "Message", "componentes": ["Text(h1)", "Text(body)"] },
        { "nombre": "CTA", "componentes": ["Button(primary:Iniciar sesión de nuevo)"] }
      ],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Dashboard": {
      "id": "screen-dashboard",
      "nombre": "Dashboard",
      "route": "/dashboard",
      "access": "private",
      "template": "AppShell",
      "rol": "dashboard",
      "objetivoUX": ["resumen_estado", "acceso_a_modulos"],
      "secciones": [
        { "nombre": "Stats", "componentes": ["StatCard[]"] },
        { "nombre": "Activity", "componentes": ["ListView(ActivityItems)"] }
      ],
      "datos_minimos": ["User", "Stats[]", "Activity[]"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Profile": {
      "id": "screen-profile",
      "nombre": "Profile",
      "route": "/profile",
      "access": "private",
      "template": "DashboardLayout",
      "rol": "profile",
      "objetivoUX": ["editar_datos", "gestionar_seguridad"],
      "secciones": [
        { "nombre": "Info", "componentes": ["Avatar", "Field(name)", "Field(location)", "Field(email:readonly)"] },
        { "nombre": "Preferences", "componentes": ["Select(lang)", "ThemeSwitch", "Toggle(reduceMotion)", "Toggle(notifications)"] },
        { "nombre": "Security", "componentes": ["Field(change_password)", "Toggle(MFA)", "List(sessions)"] }
      ],
      "datos_minimos": ["User", "Session", "Security"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Settings": {
      "id": "screen-settings",
      "nombre": "Settings",
      "route": "/settings",
      "access": "private",
      "template": "DashboardLayout",
      "rol": "settings",
      "objetivoUX": ["configurar_preferencias_y_privacidad"],
      "secciones": [
        { "nombre": "General", "componentes": ["Select(lang)", "ThemeSwitch", "DensityToggle"] },
        { "nombre": "Privacy", "componentes": ["Checkbox(telemetry_opt_in)"] }
      ],
      "datos_minimos": ["Preference", "User.prefs"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Notifications": {
      "id": "screen-notifications",
      "nombre": "Notifications",
      "route": "/notifications",
      "access": "private",
      "template": "AppShell",
      "rol": "notifications",
      "objetivoUX": ["gestionar_notificaciones"],
      "secciones": [
        { "nombre": "NotificationsList", "componentes": ["ListView(NotificationItems)"] }
      ],
      "datos_minimos": ["Notification[]"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Home": {
      "id": "screen-home",
      "nombre": "Home",
      "route": "/",
      "access": "public",
      "template": "AppShell",
      "rol": "home",
      "objetivoUX": ["presentar_valor", "dirigir_a_proyectos_o_contacto"],
      "secciones": [
        { "nombre": "HeroShell", "componentes": ["Title(H1)", "Subtitle", "CTAGroup", "MetaBar"] },
        { "nombre": "HeroPanel", "componentes": ["AvailabilityBadge", "NowCard", "Chips(intereses)", "StatsGrid"] }
      ],
      "datos_minimos": ["User.name?"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Help": {
      "id": "screen-help",
      "nombre": "Help",
      "route": "/help",
      "access": "public",
      "template": "AppShell",
      "rol": "help",
      "objetivoUX": ["resolver_dudas", "ofrecer_contacto"],
      "secciones": [
        { "nombre": "FAQ", "componentes": ["SearchBar", "Accordion(FAQItems)"] },
        { "nombre": "SupportContact", "componentes": ["ContactForm"] }
      ],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Contact": {
      "id": "screen-contact",
      "nombre": "Contact",
      "route": "/contact",
      "access": "public",
      "template": "FormLayout",
      "rol": "contact",
      "objetivoUX": ["enviar_mensaje_o_agendar"],
      "secciones": [
        { "nombre": "ContactForm", "componentes": ["Field(name)", "Field(email)", "Textarea(message)", "Button(primary:Enviar mensaje)"] }
      ],
      "datos_minimos": ["ContactSubmission"],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Offline": {
      "id": "screen-offline",
      "nombre": "Offline",
      "route": "/offline",
      "access": "public",
      "template": "ErrorLayout",
      "rol": "offline",
      "objetivoUX": ["explicar_sin_conexion", "permitir_reintento"],
      "secciones": [
        { "nombre": "Message", "componentes": ["Text(h1)", "Text(body)"] },
        { "nombre": "Actions", "componentes": ["Button(primary:Reintentar)"] }
      ],
      "estados": "ESTADOS_UNIVERSALES"
    },
    "Error": {
      "id": "screen-error",
      "nombre": "Error",
      "route": "/error",
      "access": "public",
      "template": "ErrorLayout",
      "rol": "error",
      "objetivoUX": ["explicar_error", "ofrecer_salida_segura"],
      "secciones": [
        { "nombre": "Message", "componentes": ["Text(h1)", "Text(body)"] },
        { "nombre": "Actions", "componentes": ["Button(primary:Ir al inicio)"] }
      ],
      "estados": "ESTADOS_UNIVERSALES"
    }
  },

  "flows": {
    "F_Login": {
      "id": "F_Login",
      "nombre": "Login",
      "pasos": [
        { "pantalla": "Login", "tarea": "capturar_credenciales", "estado": "idle" },
        { "pantalla": "Login", "tarea": "submit_login", "estado": "loading" },
        {
          "pantalla": "Login",
          "tarea": "resultado_api",
          "estado": "success|error|requiere_mfa",
          "error": { "mensaje": "Credenciales inválidas.", "recuperacion": "reintentar" }
        }
      ],
      "ramificaciones": [
        { "condicion": "requiere_mfa", "destino": "MFA" },
        { "condicion": "ok", "destino": "Dashboard" }
      ],
      "exito": { "definicion": "usuario_autenticado_y_redirigido_a_dashboard" }
    },
    "F_Register": {
      "id": "F_Register",
      "nombre": "Registro",
      "pasos": [
        { "pantalla": "Register", "tarea": "validar_password_meter" },
        { "pantalla": "Register", "tarea": "submit_register", "estado": "loading" },
        {
          "pantalla": "Register",
          "tarea": "resultado_api",
          "estado": "success|error",
          "error": { "mensaje": "Contraseña débil o email en uso.", "recuperacion": "ajustar" }
        }
      ],
      "exito": { "definicion": "cuenta_creada_y_usuario_dirigido_a_login_con_mensaje_de_verificacion" }
    },
    "F_SessionExpired": {
      "id": "F_SessionExpired",
      "nombre": "Sesion expirada",
      "pasos": [
        { "pantalla": "cualquiera_protegida", "tarea": "llamada_api_devuelve_401" },
        { "pantalla": "GlobalInterceptor", "tarea": "limpiar_session_y_guardar_ruta_intentada" },
        { "pantalla": "SessionExpired", "tarea": "mostrar_mensaje" },
        { "pantalla": "SessionExpired", "tarea": "click_relogin", "salida": "/login" }
      ],
      "exito": { "definicion": "usuario_reautentica_y_vuelve_a_ruta_segura" }
    },
    "F_Offline_Recovery": {
      "id": "F_Offline",
      "nombre": "Offline",
      "pasos": [
        { "pantalla": "Global", "tarea": "detectar_offline" },
        { "pantalla": "Offline", "tarea": "mostrar_pantalla_offline" },
        { "pantalla": "Offline", "tarea": "reintentar_o_wait_online", "salida": "ruta_previa" }
      ],
      "exito": { "definicion": "flujo_recuperado_sin_perdida_irrecuperable" }
    }
  },

  "datos": {
    "entidades": [
      "User",
      "Session",
      "EntityX",
      "Notification",
      "MenuItem",
      "ContactSubmission",
      "Preference",
      "Security"
    ],
    "contratos_por_pantalla": {
      "Home": ["User?", "availability?", "stats?"],
      "Dashboard": ["Stats[]", "Activity[]"],
      "Profile": ["User", "Session", "Security"],
      "Login": ["User.email", "Credential.password"],
      "Register": ["User.name", "User.email", "Credential.password"],
      "Recover": ["User.email|Token.reset"],
      "MFA": ["Credential.otp"],
      "Contact": ["ContactSubmission.payload"]
    }
  },

  "a11y_seo_pwa": {
    "a11y": "usar axiomas.a11y",
    "seo_pwa": "usar axiomas.seo_pwa"
  },

  "security_privacy": {
    "base": "usar axiomas.security_privacy",
    "extra": {
      "csrf": "las acciones sensibles deben protegerse vía tokens/headers adecuados",
      "xss": "nunca interpolar HTML crudo desde entrada de usuario"
    }
  },

  "mocks": {
    "hooks": [
      "useUser",
      "useSession",
      "useListX",
      "useDetailX",
      "useLogin",
      "useRegister",
      "useRecover",
      "useMFA",
      "useProfile",
      "useNotifications"
    ],
    "fixtures": {
      "lat_ms": 120,
      "error_rate": 0.03
    }
  },

  "i18n_ux_copy": {
    "locales": ["es-MX", "en-US"],
    "namespaces": ["common", "auth", "dashboard", "profile", "notifications", "settings", "errors"],
    "ejemplos": {
      "auth.login_title": "Iniciar sesión",
      "auth.register_title": "Crear cuenta",
      "errors.generic": "Algo salió mal. Intenta de nuevo."
    }
  },

  "eval": {
    "datasets_min": 16,
    "metricas": ["json_schema_pass", "groundedness", "a11y_checklist_pass", "readability"],
    "umbrales": {
      "json_schema_pass": 0.98,
      "groundedness": 0.9,
      "a11y_checklist_pass": 0.95
    },
    "gates": {
      "regresion_blocker": true
    }
  },

  "telemetria": {
    "eventos_core": [
      "view:screen",
      "click:cta",
      "form:submit",
      "error:ui",
      "net:offline",
      "net:online",
      "auth:view:splash",
      "auth:attempt:login",
      "auth:success:login",
      "auth:fail:login",
      "auth:register:start",
      "auth:register:success",
      "auth:recover:start",
      "auth:recover:success",
      "auth:mfa:required",
      "auth:mfa:success",
      "auth:logout",
      "session:expired"
    ],
    "payload_min": {
      "screen_id": "string",
      "cta_id": "string?",
      "entity_id": "string?",
      "user_id": "string?",
      "method": "string?",
      "error_code": "string?",
      "ts_iso": "iso"
    }
  },

  "runtime": {
    "rendering": {
      "ssg_routes": ["/", "/login", "/register", "/help", "/offline", "/error"],
      "protected_routes": ["/dashboard", "/profile", "/notifications", "/settings"]
    },
    "route_guards": {
      "public_route_guard": "si existe sesion → redirect /dashboard",
      "protected_route_guard": "si no existe sesion → redirect /login"
    }
  },

  "prioridades": {
    "top5_issues": [
      "estilos_fuera_de_tokens",
      "falta_focus_visible_en_elementos_clave",
      "CTAs_compiten_en_home_y_dashboard",
      "estados_universales_incompletos_en_auth_y_core",
      "microcopy_no_i18n_ready_en_mensajes_auth_y_notificaciones"
    ],
    "top5_acciones": [
      "migrar_todos_los_colores_y_spacings_a_TOKENS_DTCG_JSON",
      "aplicar_focus_visible_global_y_probar_navegacion_con_teclado",
      "definir_CTA_primaria_por_pantalla(Home,Dashboard,Login)",
      "documentar_y_aplicar_patron_estados_universales_para_todas_las_pantallas",
      "extraer_microcopy_a_tablas_i18n_para_es-MX_y_en-US"
    ]
  },

  "dod": {
    "items": [
      "todas las pantallas tienen estados loading/error/empty/offline/success definidos",
      "todos los botones tienen focus-visible de 2px y usan tokens semanticos",
      "Login/Register/Recover/MFA cumplen reglas de seguridad y mensajes neutros",
      "Dashboard/ListView manejan estados empty/error/offline correctamente",
      "Notificaciones integradas en NavBar + NotificationsPanel con estados completos",
      "Settings implementa Checkbox(telemetry_opt_in) con opt-in desmarcado",
      "Profile muestra y permite revocar sesiones activas",
      "todas las rutas publicas tienen H1 único, title y meta_description coherentes"
    ]
  },

  "violations": []
}
Tú dijiste:
revisa todo esto completo y construir lo mas deglosado y root completo cubirneod ytodo
ChatGPT Plus

Pensamiento Pro •
Building complete JSON schema
Responder ahora
I'll integrate the DTCG tokens under "design_system" as "tokens_dtcg" with earlier definitions. I'll also include the atomic library, covering atoms, molecules, organisms, and templates, with testIdPattern. For completeness, I'll expand "screens" to cover all requested views: Home, Dashboard, Profile, etc.




Ningún archivo seleccionadoNingún archivo seleccionado
ChatGPT puede cometer errores. Considera verificar la información importante.
