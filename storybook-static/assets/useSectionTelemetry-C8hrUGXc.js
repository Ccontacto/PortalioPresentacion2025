import{s as f,i as u,r as y}from"./iframe-Dk93WtSj.js";const a="portfolio_section_metrics",E="telemetry:section-metrics",b=e=>u(e)?typeof e.views=="number"&&typeof e.totalMs=="number"&&(typeof e.lastViewed=="number"||e.lastViewed===null):!1,v=e=>u(e)?Object.values(e).every(b):!1,l=()=>f.get(a,{},v)??{},T=e=>{typeof window>"u"||typeof window.dispatchEvent!="function"||window.dispatchEvent(new CustomEvent(E,{detail:e}))},d=e=>{f.set(a,e),T(e)},w=(e,t)=>(e[t]||(e[t]={views:0,totalMs:0,lastViewed:null}),e[t]),V=e=>{const t=l(),n=w(t,e);n.views+=1,n.lastViewed=Date.now(),d(t)},c=(e,t)=>{if(Number.isNaN(t)||t<=0)return;const n=l(),o=w(n,e);o.totalMs+=t,o.lastViewed=Date.now(),d(n)};function h(e,t={}){const{threshold:n=.4}=t;y.useEffect(()=>{if(typeof window>"u"||typeof document>"u"||typeof IntersectionObserver>"u")return;const o=document.getElementById(e);if(!o)return;let r=null;const i=new IntersectionObserver(s=>{s.forEach(m=>{if(m.isIntersecting)r=performance.now(),V(e);else if(r!==null){const p=performance.now()-r;c(e,p),r=null}})},{threshold:n});return i.observe(o),()=>{if(i.disconnect(),r!==null){const s=performance.now()-r;c(e,s)}}},[e,n])}export{h as u};
