# Trace Log · 2025-02-10

## Context
- Repository: portfolio-jctr-2025
- Objective: aplicar mejoras de accesibilidad/UX especificadas (focus trap, contraste, tokens, boundary) bajo restricciones de tiempo y reintentos.

## Milestones
1. ✅ Inventario inicial y verificación de estado (previo a este log).
2. ✅ Definir acciones pendientes con detalle y preparar entorno (incluye dependencias).
3. ✅ Implementar focus trap robusto en menú móvil (`focus-trap-react`).
4. ✅ Ajustar tokens/contraste en CSS (incluye stat cards, CTAs).
5. ✅ Revisar estructura StrictMode/ErrorBoundary en `main`.
6. ✅ Ejecutar validaciones (`npm test`, `npm run build`) y documentar resultados.

## Notes
- Cada hito tiene máximo dos intentos; si falla dos veces detenerse y reportar.
- Registraré al final de cada hito: tiempo aproximado, resultado, next-step.

### Milestone 2 · Registro
- Tiempo: ~5 min
- Acciones: confirmación de pendientes (focus trap, tokens/contraste, boundary), instalación `focus-trap-react@^10.2.1`.
- Resultado: entorno listo para implementaciones siguientes.
- Next: implementar focus trap robusto en menú móvil.

### Milestone 3 · Registro
- Tiempo: ~15 min
- Acciones: refactor de `Header` para usar `FocusTrap`, cleanup de efecto manual de Tab, cierre delegado a `onDeactivate`, primer control con `data-focus-default`.
- Resultado: menú móvil con focus-trap consistente y scroll bloqueado.
- Next: estandarizar tokens/contrastes en CSS.

### Milestone 4 · Registro
- Tiempo: ~45 min
- Acciones: migración global de estilos a tokens (`--surface-*`, `--shadow-*`, gradientes CTA), ajustes de contraste en CTAs/stat cards, limpieza de overrides `.dark`, verificación rápida de ratios con script.
- Resultado: componentes clave sin hex directos, contrastes reforzados y variables listas para modos.
- Next: revisar `StrictMode/ErrorBoundary` en `main.tsx`.

### Milestone 5 · Registro
- Tiempo: ~10 min
- Acciones: mover `ErrorBoundary` al bootstrap (`main.tsx`) manteniendo `React.StrictMode`, limpieza del wrapper dentro de `App`.
- Resultado: jerarquía consistente; errores globales capturados desde la raíz.
- Next: correr pruebas/build y documentar resultados.

### Milestone 6 · Registro
- Tiempo: ~15 min
- Acciones: polifills (`matchMedia`, `IntersectionObserver`) estabilizados, fixes en Dock/Projects tests y foco, `npm test -- --run` verde, `npm run build` exitoso tras corregir llaves CSS.
- Resultado: suite en verde, build Vite/TS lista.
- Next: preparar resumen final.
